=== PROJECT CONTEXT EXPORT ===

PROJECT STRUCTURE:
tool_crawl_quang_cao/
    .gitignore
    b77da63d-af55-43c2-ab7f-364250b20e30.json
    BUILD.txt
    comments.json
    HUONG_DAN_SU_DUNG.md
    readme.md
    response_debug.txt
    users.json
    backend/
        .gitignore
        build.bat
        build_exe.spec
        main.py
        requirements.txt
        response_debug.txt
        run_api.py
        app/
            api.py
            __init__.py
        config/
            cloneM.txt
            groups.json
            payload.txt
            settings.json
        core/
            account_status.py
            browser.py
            control.py
            join_groups.py
            nst.py
            paths.py
            runner.py
            scraper.py
            search_worker.py
            settings.py
            utils.py
            __init__.py
        data/
            account_status.json
            runtime_control.json
            post_ids/
                b77da63d-af55-43c2-ab7f-364250b20e30.json
                caabaa64-f2c5-4254-a83b-7f6d57632503.json
            results/
                all_results_20251222_220621.json
                all_results_20251222_230001.json
                all_results_20251224_000724.json
                all_results_20251224_002824.json
                all_results_20251224_010549.json
                all_results_20251224_013325.json
                all_results_20251225_022251.json
                all_results_20251225_024322.json
                all_results_20251225_032851.json
                all_results_20251225_161451.json
        worker/
            check_cookies.py
            get_all_info.py
            get_id.py
            get_payload.py
            get_post_from_page.py
            single_get_comment.py
            single_get_reactions.py
            __init__.py
    frontend/
        data.json
        index.html
        script.js
        style.css
        icon/
            Icon_of_Zalo.svg.webp
            logo-messenger-inkythuatso-2-01-30-15-47-51.jpg
            zalo-icon.png

==================================================

--- START FILE: b77da63d-af55-43c2-ab7f-364250b20e30.json ---
[

  {
    "id": "122152945058694563",
    "flag": "xanh",
    "text": "ðŸŽ‰ ðŸŒ¸ â€œTáº¿t Ä‘áº¿n xuÃ¢n vá» â€“ tÃ¬m viá»‡c Ä‘Ã¢u xa, Vingroup chÃ o Ä‘Ã³n â€“ má»Ÿ lá»‘i thÄƒng hoa!â€ ðŸŒ¸ ðŸŽ‰ ðŸ¢ VINGROUP â€“ TUYá»‚N Dá»¤NG KHá»I VÄ‚N PHÃ’NG TOÃ€N QUá»C ðŸ‡»ðŸ‡³ ðŸ‡»ðŸ‡³ Báº¡n Ä‘ang tÃ¬m kiáº¿m má»™t mÃ´i trÆ°á»ng á»•n Ä‘á»‹nh â€“ chuyÃªn nghiá»‡p â€“ cÃ³ lá»™ trÃ¬nh thÄƒng tiáº¿n rÃµ rÃ ng? ðŸ‡»ðŸ‡³ Vingroup â€“ Táº­p Ä‘oÃ n kinh táº¿ tÆ° nhÃ¢n hÃ ng Ä‘áº§u Viá»‡t Nam â€“ Ä‘ang má»Ÿ rá»™ng Ä‘á»™i ngÅ© vÄƒn phÃ²ng trÃªn toÃ n quá»‘c, sáºµn sÃ ng Ä‘á»“ng hÃ nh cÃ¹ng báº¡n bÆ°á»›c vÃ o nÄƒm má»›i vá»›i nhiá»u cÆ¡ há»™i phÃ¡t triá»ƒn Ä‘á»™t phÃ¡. ðŸ’¢ Vá»Š TRÃ ÄANG TUYá»‚N ðŸ”– NhÃ¢n ViÃªn Káº¿ ToÃ¡n ðŸ”– ChuyÃªn ViÃªn Quáº£n LÃ½ Kinh Doanh ðŸ”– NhÃ¢n ViÃªn TÆ° Váº¥n ChÄƒm SÃ³c KhÃ¡ch HÃ ng ðŸ”– TrÆ°á»Ÿng PhÃ²ng Xuáº¥t Nháº­p Kháº©u ðŸ”– TrÆ°á»Ÿng PhÃ²ng Tiáº¿p Thá»‹ ThÆ°Æ¡ng Máº¡i ðŸ”– TrÆ°á»Ÿng PhÃ²ng HÃ nh ChÃ­nh NhÃ¢n Sá»± ðŸ“ LÃ m viá»‡c táº¡i cÃ¡c vÄƒn phÃ²ng Ä‘áº¡i diá»‡n trÃªn toÃ n quá»‘c ðŸŽ¯ Táº I SAO Báº N NÃŠN á»¨NG TUYá»‚N NGAY? â–ªï¸ Thu nháº­p háº¥p dáº«n, thÆ°á»Ÿng Táº¿t rÃµ rÃ ng â–ªï¸ Báº£o hiá»ƒm Ä‘áº§y Ä‘á»§, phÃºc lá»£i á»•n Ä‘á»‹nh â–ªï¸ CÆ¡ há»™i phÃ¡t triá»ƒn sá»± nghiá»‡p, Ä‘Æ°á»£c Ä‘Ã o táº¡o chuyÃªn sÃ¢u â–ªï¸ MÃ´i trÆ°á»ng lÃ m viá»‡c minh báº¡ch, hiá»‡n Ä‘áº¡i, chuyÃªn nghiá»‡p ðŸ“¨ Ná»™p há»“ sÆ¡ trá»±c tuyáº¿n táº¡i: https://qrco.de/tuyendungVinGroup ðŸ‘‰ Tag ngÆ°á»i phÃ¹ há»£p hoáº·c chia sáº» ngay cÆ¡ há»™i tuyá»‡t vá»i nÃ y! ðŸŒŸ VINGROUP â€“ NÆ¡i tÃ i nÄƒng Ä‘Æ°á»£c phÃ¡t huy vÃ  thÃ nh cÃ´ng Ä‘Æ°á»£c ghi nháº­n. CÃ¹ng khá»Ÿi Ä‘á»™ng nÄƒm má»›i vá»›i bÆ°á»›c tiáº¿n vá»¯ng vÃ ng trong sá»± nghiá»‡p! #Vingroup #TuyenDungTet2025 #CoHoiNgheNghiep #ViecLamVanPhong #DonXuanVingroup",
    "owning_profile": {
      "__typename": "User",
      "name": "Tuyá»ƒn Dá»¥ng VinGroup",
      "id": "61570836905496"
    }
  },
  {
    "id": "4432161690347913",
    "flag": "vÃ ng",
    "text": "[HÃ  ÄÃ´ng, HN] TUYá»‚N Váº¬N HÃ€NH SÃ€N TMÄT LÆ¯Æ NG 6M - 12M !! KHÃ”NG YC KINH NGHIá»†M",
    "owning_profile": {
      "__typename": "User",
      "name": "Nguyá»…n HÃ  Thu",
      "id": "100007869585114"
    }
  },
  {
    "id": "122171583440394422",
    "flag": "xanh",
    "text": "âœ¨ NHA KHOA META TUYá»‚N Dá»¤NG âœ¨ Vá»‹ trÃ­: BÃ¡c sÄ© RÄƒng Sá»© Tháº©m Má»¹ ChÃºng tÃ´i tÃ¬m kiáº¿m bÃ¡c sÄ© cÃ³ Ä‘á»‹nh hÆ°á»›ng phÃ¡t triá»ƒn lÃ¢u dÃ i trong lÄ©nh vá»±c rÄƒng sá»© tháº©m má»¹, mong muá»‘n lÃ m viá»‡c trong mÃ´i trÆ°á»ng chuáº©n chá»‰nh, tÃ´n trá»ng chuyÃªn mÃ´n vÃ  giÃ¡ trá»‹ cÃ¡ nhÃ¢n. ðŸ’° Thu nháº­p: Thá»a thuáº­n theo nÄƒng lá»±c (LÆ°Æ¡ng cá»©ng + KPI + ThÆ°á»Ÿng + Phá»¥ cáº¥p) ðŸ”¹ Há»‡ thá»‘ng mÃ¡y mÃ³c hiá»‡n Ä‘áº¡i ðŸ”¹ Nguá»“n khÃ¡ch á»•n Ä‘á»‹nh ðŸ”¹ Ekip há»— trá»£ chuyÃªn mÃ´n ðŸ”¹ Quy trÃ¬nh rÃµ rÃ ng â€“ minh báº¡ch ðŸ“ Äá»‹a chá»‰: 391 TrÆ°á»ng Chinh, Thanh XuÃ¢n, HÃ  Ná»™i ðŸ“² LiÃªn há»‡ á»©ng tuyá»ƒn: 036.903.6666",
    "owning_profile": {
      "__typename": "User",
      "name": "Tuyá»ƒn Dá»¥ng NhÃ¢n Sá»± Nha Khoa HÃ  Ná»™i",
      "id": "61561832674763"
    }
  },
  {
    "id": "24955032474094131",
    "flag": "vÃ ng",
    "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
    "owning_profile": {
      "__typename": "User",
      "name": "Gia Minh",
      "id": "61568481862081"
    }
  },
  {
    "id": "2198533247305479",
    "flag": "vÃ ng",
    "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
    "owning_profile": {
      "__typename": "User",
      "name": "Trang LÃª",
      "id": "100006577548369"
    }
  }
 
]
--- END FILE: b77da63d-af55-43c2-ab7f-364250b20e30.json ---

--- START FILE: comments.json ---
[
    {
        "id": "100076814636713",
        "name": "Nguyá»…n Huy",
        "text": "Nguyá»…n Duy HÃ²a hÃ²a pháº£i khÃ´ng hÃ²a",
        "created_time_vn": "2025-12-17 20:42:01"
    },
    {
        "id": "100064510548300",
        "name": "Nguyá»…n Duy HÃ²a",
        "text": "Äá»«ng gáº¯p lá»­a bá» vÃ o tay tÃ´i",
        "created_time_vn": "2025-12-17 20:48:48"
    }
]
--- END FILE: comments.json ---

--- START FILE: users.json ---
[]
--- END FILE: users.json ---

--- START FILE: backend\main.py ---
from core.runner import AppRunner

if __name__ == "__main__":
    AppRunner().run()

--- END FILE: backend\main.py ---

--- START FILE: backend\run_api.py ---
# backend/run_api.py
import uvicorn
import sys
import os
import webbrowser
import threading
import time
from multiprocessing import freeze_support
from pathlib import Path

# --- Cáº¤U HÃŒNH ÄÆ¯á»œNG DáºªN QUAN TRá»ŒNG ---
# Láº¥y Ä‘Æ°á»ng dáº«n thÆ° má»¥c chá»©a file cháº¡y hiá»‡n táº¡i (backend)
base_dir = os.path.dirname(os.path.abspath(__file__))

# 1. ThÃªm 'backend' vÃ o sys.path Ä‘á»ƒ gá»i Ä‘Æ°á»£c 'app', 'core'
if base_dir not in sys.path:
    sys.path.append(base_dir)

# 2. ThÃªm 'backend/worker' vÃ o sys.path Ä‘á»ƒ gá»i Ä‘Æ°á»£c 'single_get_reactions', 'get_id', ...
worker_dir = os.path.join(base_dir, "worker")
if worker_dir not in sys.path:
    sys.path.append(worker_dir)
# --------------------------------------

# === Ã‰P PYINSTALLER NHáº¬N DIá»†N MODULE ===
try:
    import core.paths
    import core.settings
    # Import app chÃ­nh
    from app.api import app 
    
    # Import thá»§ cÃ´ng cÃ¡c file trong worker Ä‘á»ƒ PyInstaller khÃ´ng bá» sÃ³t
    # (DÃ¹ng try-except lá»“ng Ä‘á»ƒ trÃ¡nh crash náº¿u file chÆ°a cháº¡y tá»›i)
    try:
        import worker.single_get_reactions
        import worker.single_get_comment
        import worker.get_all_info
        import worker.get_id
    except ImportError:
        pass
        
except ImportError as e:
    print(f"CRITICAL ERROR: Thiáº¿u module! Chi tiáº¿t: {e}")
    print("Sáº¿p kiá»ƒm tra láº¡i xem Ä‘Ã£ cÃ³ file __init__.py trong thÆ° má»¥c 'worker' chÆ°a nhÃ©!")
    input("An Enter de thoat...")
    sys.exit(1)
# =======================================

def open_browser():
    """Äá»£i server cháº¡y rá»“i má»Ÿ trÃ¬nh duyá»‡t"""
    time.sleep(2) 
    try:
        from core.paths import get_frontend_dir
        frontend_path = get_frontend_dir() / "index.html"
        
        if frontend_path.exists():
            print(f"\nðŸŒ Äang má»Ÿ giao diá»‡n: {frontend_path}")
            webbrowser.open(frontend_path.as_uri())
        else:
            print(f"\nâš ï¸ KhÃ´ng tÃ¬m tháº¥y frontend táº¡i: {frontend_path}")
    except Exception as e:
        print(f"Lá»—i má»Ÿ trÃ¬nh duyá»‡t: {e}")

if __name__ == "__main__":
    freeze_support()
    
    threading.Thread(target=open_browser, daemon=True).start()
    
    print("=" * 60)
    print("ðŸš€ Äang khá»Ÿi Ä‘á»™ng Tool Crawl...")
    print("=" * 60)
    
    uvicorn.run(
        app,
        host="0.0.0.0",
        port=8000,
        log_level="info",
        reload=False 
    )
--- END FILE: backend\run_api.py ---

--- START FILE: backend\app\api.py ---
from multiprocessing import Process
import time
from typing import Optional, Any, Dict
from pathlib import Path
import json
import os
import tempfile
import threading
import re
from urllib.parse import quote_plus
from concurrent.futures import ThreadPoolExecutor, as_completed
from datetime import datetime

from fastapi import Body, FastAPI, HTTPException, Query
from fastapi.middleware.cors import CORSMiddleware
from pydantic import BaseModel
from fastapi.concurrency import run_in_threadpool

from core.settings import SETTINGS_PATH
from core.nst import connect_profile, stop_profile, stop_all_browsers
from core.browser import FBController
from core import control as control_state
from core.control import smart_sleep
from core.scraper import SimpleBot
from core.settings import get_settings
from worker.get_all_info import get_all_info_from_post_ids_dir, get_info_for_profile_ids
from core.paths import get_data_dir, get_settings_path
app = FastAPI(title="NST Tool API", version="1.0.0")
class InfoRunRequest(BaseModel):
    mode: str = "all"  # "all" hoáº·c "selected"
    profiles: list[str] | None = None


# Cho phÃ©p frontend (file tÄ©nh) gá»i API qua localhost
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Bot processes (má»—i profile 1 process Ä‘á»™c láº­p RUN/REST)
_bot_lock = threading.Lock()
_bot_processes: Dict[str, Process] = {}
_settings_lock = threading.Lock()
_join_groups_lock = threading.Lock()
_join_groups_processes: Dict[str, Process] = {}
_feed_lock = threading.Lock()
_feed_processes: Dict[str, Process] = {}


def _hard_stop_everything(reason: str = "") -> dict:
    """
    STOP kiá»ƒu "fresh start":
    - Signal STOP ngay (set_global_emergency_stop=True) Ä‘á»ƒ cÃ¡c loop thoÃ¡t náº¿u cÃ²n sá»‘ng
    - ÄÃ³ng toÃ n bá»™ NST browser
    - Terminate runner/join/feed processes (Ä‘Ã³ng háº³n, khÃ´ng giá»¯ sleep)
    - Reset runtime_control.json vá» máº·c Ä‘á»‹nh (Sáº´N SÃ€NG)
    """
    global _bot_processes

    print("=" * 60)
    print(f"ðŸ›‘ [HARD_STOP] {reason}".strip())
    print("=" * 60)

    # 1) Signal STOP
    try:
        control_state.set_global_emergency_stop(True)
    except Exception:
        pass

    # 2) Close all NST browsers
    nst_ok = False
    nst_err = None
    try:
        nst_ok = bool(stop_all_browsers())
    except Exception as e:
        nst_err = str(e)
        print(f"âš ï¸ stop_all_browsers lá»—i: {e}")

    # 3) Kill bot processes
    bot_killed: list[str] = []
    try:
        with _bot_lock:
            for pid, proc in list(_bot_processes.items()):
                try:
                    if proc and proc.is_alive():
                        proc.terminate()
                        proc.join(timeout=3)
                        bot_killed.append(pid)
                except Exception:
                    pass
                _bot_processes.pop(pid, None)
    except Exception:
        pass

    # 4) Kill join groups processes
    join_killed: list[str] = []
    try:
        with _join_groups_lock:
            _prune_join_group_processes()
            for pid, proc in list(_join_groups_processes.items()):
                try:
                    if proc and proc.is_alive():
                        proc.terminate()
                        proc.join(timeout=3)
                        join_killed.append(pid)
                except Exception:
                    pass
                _join_groups_processes.pop(pid, None)
    except Exception:
        pass

    # 5) Kill feed processes
    feed_killed: list[str] = []
    try:
        with _feed_lock:
            _prune_feed_processes()
            for pid, proc in list(_feed_processes.items()):
                try:
                    if proc and proc.is_alive():
                        proc.terminate()
                        proc.join(timeout=3)
                        feed_killed.append(pid)
                except Exception:
                    pass
                _feed_processes.pop(pid, None)
    except Exception:
        pass

    # 6) Reset runtime state vá» máº·c Ä‘á»‹nh (Ä‘á»ƒ láº§n sau báº¥m cháº¡y lÃ  "má»›i hoÃ n toÃ n")
    try:
        control_state.reset_all_state()
    except Exception:
        # fallback: Ã­t nháº¥t clear emergency stop Ä‘á»ƒ UI khÃ´ng bá»‹ káº¹t
        try:
            control_state.reset_emergency_stop(clear_stopped_profiles=True)
        except Exception:
            pass

    return {
        "status": "ok",
        "nst_stop_all_ok": nst_ok,
        "nst_error": nst_err,
        "bot_killed": bot_killed,
        "join_killed": join_killed,
        "feed_killed": feed_killed,
    }


def _prune_bot_processes() -> None:
    dead = []
    for pid, proc in list(_bot_processes.items()):
        try:
            if not proc.is_alive():
                dead.append(pid)
        except Exception:
            dead.append(pid)
    for pid in dead:
        _bot_processes.pop(pid, None)


def _run_bot_profile_loop(
    profile_id: str,
    run_minutes: int,
    rest_minutes: int,
    text: str,
    mode: str,
) -> None:
    """
    Worker Ä‘á»™c láº­p cho 1 profile:
    - cháº¡y RUN_MINUTES (active time, pause freeze)
    - ngá»§ REST_MINUTES (pause freeze)
    - láº·p láº¡i cho tá»›i khi STOP (global hoáº·c stop theo profile)
    """
    pid = str(profile_id or "").strip()
    if not pid:
        return

    cfg = get_settings()
    target_url = cfg.target_url
    m = str(mode or "feed").strip().lower()
    if m not in ("feed", "search"):
        m = "feed"
    t = str(text or "").strip()
    if m == "search" and t:
        q = quote_plus(t)
        target_url = f"https://www.facebook.com/search/posts/?q={q}"

    run_m = int(run_minutes or 0)
    rest_m = int(rest_minutes or 0)
    if run_m <= 0:
        run_m = int(getattr(cfg, "run_minutes", 30) or 30)
    if rest_m <= 0:
        rest_m = int(getattr(cfg, "rest_minutes", 120) or 120)

    duration_seconds = max(1, run_m * 60)
    rest_seconds = max(1, rest_m * 60)

    try:
        while True:
            # STOP/PAUSE trÆ°á»›c khi báº¯t Ä‘áº§u phiÃªn
            stop, paused, reason = control_state.check_flags(pid)
            if stop:
                print(f"ðŸ›‘ [{pid}] STOP trÆ°á»›c khi start loop ({reason})")
                try:
                    control_state.set_profile_state(pid, "STOPPED")
                except Exception:
                    pass
                return
            if paused:
                print(f"â¸ï¸ [{pid}] PAUSED trÆ°á»›c khi start loop ({reason})")
                control_state.wait_if_paused(pid, sleep_seconds=0.5)

            fb: Optional[FBController] = None
            try:
                control_state.set_profile_state(pid, "RUNNING")
            except Exception:
                pass

            try:
                ws = connect_profile(pid)
                fb = FBController(ws)
                fb.profile_id = pid
                # tuyá»‡t Ä‘á»‘i Ä‘á»™c láº­p: chá»‰ xá»­ lÃ½ trong profile nÃ y
                try:
                    fb.all_profile_ids = [pid]
                except Exception:
                    pass
                # filter text náº¿u cÃ³
                try:
                    if t:
                        parts = []
                        for chunk in t.replace("\n", ",").split(","):
                            s = " ".join(str(chunk).strip().split())
                            if s:
                                parts.append(s)
                        seen = set()
                        user_keywords = []
                        for x in parts:
                            k = x.lower()
                            if k in seen:
                                continue
                            seen.add(k)
                            user_keywords.append(x)
                        fb.user_keywords = user_keywords
                except Exception:
                    pass
                fb.connect()
                bot = SimpleBot(fb)
                bot.run(target_url, duration=duration_seconds)
            except RuntimeError as e:
                # STOP/BROWSER_CLOSED/ACCOUNT_BANNED => thoÃ¡t phiÃªn
                if (
                    "EMERGENCY_STOP" in str(e)
                    or "BROWSER_CLOSED" in str(e)
                    or "ACCOUNT_BANNED" in str(e)
                ):
                    print(f"ðŸ›‘ [{pid}] Dá»«ng bot ({e})")
                    return
                raise
            except Exception as e:
                error_str = str(e)
                print(f"âŒ Lá»—i á»Ÿ profile {pid}: {error_str}")
                
                # Náº¿u lÃ  lá»—i nghiÃªm trá»ng (profile khÃ´ng tá»“n táº¡i, NST khÃ´ng cháº¡y), dá»«ng ngay
                is_critical_error = (
                    "khÃ´ng tá»“n táº¡i" in error_str.lower() or
                    "profile" in error_str.lower() and "not found" in error_str.lower() or
                    "khÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n nst" in error_str.lower() or
                    "nst server" in error_str.lower()
                )
                
                try:
                    control_state.set_profile_state(pid, "ERROR")
                except Exception:
                    pass
                
                # Náº¿u lÃ  lá»—i nghiÃªm trá»ng, dá»«ng loop ngay
                if is_critical_error:
                    print(f"ðŸ›‘ [{pid}] Dá»«ng loop do lá»—i nghiÃªm trá»ng: {error_str}")
                    return
            finally:
                # Ä‘Ã³ng playwright + NST profile best-effort
                try:
                    if fb and getattr(fb, "page", None):
                        try:
                            fb.page.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if fb and getattr(fb, "browser", None) and getattr(fb.browser, "contexts", None):
                        for ctx in list(fb.browser.contexts):
                            try:
                                ctx.close()
                            except Exception:
                                pass
                except Exception:
                    pass
                try:
                    if fb and getattr(fb, "browser", None):
                        try:
                            fb.browser.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if fb and getattr(fb, "play", None):
                        try:
                            fb.play.stop()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    stop_profile(pid)
                except Exception:
                    pass

            # Check stop sau khi káº¿t thÃºc phiÃªn
            stop, paused, reason = control_state.check_flags(pid)
            if stop:
                print(f"ðŸ›‘ [{pid}] STOP sau phiÃªn ({reason}) -> thoÃ¡t loop")
                try:
                    control_state.set_profile_state(pid, "STOPPED")
                except Exception:
                    pass
                return

            # REST (Ä‘á»™c láº­p theo profile) - pause freeze
            try:
                smart_sleep(rest_seconds, pid)
            except RuntimeError as e:
                if "EMERGENCY_STOP" in str(e):
                    print(f"ðŸ›‘ [{pid}] STOP trong REST -> thoÃ¡t")
                    try:
                        control_state.set_profile_state(pid, "STOPPED")
                    except Exception:
                        pass
                    return
                raise
    except RuntimeError as e:
        if "EMERGENCY_STOP" in str(e):
            print(f"ðŸ›‘ [{pid}] EMERGENCY_STOP trong loop -> thoÃ¡t")
            try:
                control_state.set_profile_state(pid, "STOPPED")
            except Exception:
                pass
            return
        raise


def _run_join_groups_worker(profile_id: str, groups: list[str]) -> None:
    """Worker cháº¡y join groups cho 1 profile (Ä‘á»ƒ cháº¡y song song nhiá»u profile)."""
    try:
        from core.join_groups import run_batch_join_from_list
        run_batch_join_from_list(profile_id, groups)
    except Exception as exc:
        print(f"âŒ Join groups worker lá»—i ({profile_id}): {exc}")


def _run_feed_worker(
    profile_id: str,
    mode: str,
    text: str,
    run_minutes: int,
    rest_minutes: int,
    all_profile_ids: Optional[list[str]] = None,
) -> None:
    """
    Worker cháº¡y nuÃ´i acc (feed/search & like) cho 1 profile theo vÃ²ng láº·p:
    cháº¡y run_minutes -> táº¯t -> nghá»‰ rest_minutes -> láº·p láº¡i.
    Náº¿u rest_minutes <= 0 thÃ¬ chá»‰ cháº¡y 1 láº§n.
    """
    try:
        from core.search_worker import feed_and_like, search_and_like
        m = str(mode or "feed").strip().lower()
        run_m = int(run_minutes or 0)
        rest_m = int(rest_minutes or 0)
        if run_m <= 0:
            run_m = 30

        try:
            while True:
                # STOP/PAUSE checkpoint
                stop, paused, reason = control_state.check_flags(profile_id)
                if stop:
                    print(f"ðŸ›‘ [FEED] {profile_id} EMERGENCY_STOP ({reason}) -> dá»«ng worker")
                    break
                if paused:
                    print(f"â¸ï¸ [FEED] {profile_id} PAUSED ({reason}) -> sleep")
                    control_state.wait_if_paused(profile_id, sleep_seconds=0.5)

                try:
                    if m == "search":
                        search_and_like(profile_id, text or "", duration_minutes=run_m, all_profile_ids=all_profile_ids)
                    else:
                        feed_and_like(profile_id, text or "", duration_minutes=run_m, all_profile_ids=all_profile_ids)
                except RuntimeError as e:
                    if "EMERGENCY_STOP" in str(e):
                        print(f"ðŸ›‘ [FEED] {profile_id} EMERGENCY_STOP trong bot ({reason}) -> dá»«ng")
                        return
                    raise

                if rest_m <= 0:
                    break

                # nghá»‰ rá»“i cháº¡y láº¡i (pause freeze)
                try:
                    smart_sleep(rest_m * 60, profile_id)
                except RuntimeError as e:
                    if "EMERGENCY_STOP" in str(e):
                        print(f"ðŸ›‘ [FEED] {profile_id} EMERGENCY_STOP trong REST -> dá»«ng")
                        return
                    raise
        except RuntimeError as e:
            if "EMERGENCY_STOP" in str(e):
                print(f"ðŸ›‘ [FEED] {profile_id} EMERGENCY_STOP trong loop -> dá»«ng")
                return
            raise
    except Exception as exc:
        print(f"âŒ Feed worker lá»—i ({profile_id}): {exc}")


def _close_fb_controller_best_effort(fb: Optional[FBController], profile_id: str) -> None:
    """
    ÄÃ³ng sáº¡ch tab/context playwright + yÃªu cáº§u NST stop (giá»‘ng logic trong cookie fetch).
    """
    try:
        if fb and getattr(fb, "page", None):
            try:
                fb.page.close()
            except Exception:
                pass
    except Exception:
        pass
    try:
        if fb and getattr(fb, "browser", None) and getattr(fb.browser, "contexts", None):
            for ctx in list(fb.browser.contexts):
                try:
                    ctx.close()
                except Exception:
                    pass
    except Exception:
        pass
    try:
        if fb and getattr(fb, "browser", None):
            try:
                fb.browser.close()
            except Exception:
                pass
    except Exception:
        pass
    try:
        if fb and getattr(fb, "play", None):
            try:
                fb.play.stop()
            except Exception:
                pass
    except Exception:
        pass

    # Best-effort: yÃªu cáº§u NST stop/close browser instance cá»§a profile
    try:
        stop_profile(profile_id)
    except Exception:
        pass


def _force_close_nst_tabs_for_profile(profile_id: str) -> dict:
    """
    Force Ä‘Ã³ng tab NST theo Ä‘Ãºng kiá»ƒu cookie:
    connect -> attach CDP -> close page/context/browser/play -> stop_profile
    """
    pid = _norm_profile_id(profile_id)
    if not pid:
        return {"profile_id": profile_id, "ok": False, "reason": "empty_profile_id"}

    fb: Optional[FBController] = None
    connected = False
    try:
        ws = connect_profile(pid)
        fb = FBController(ws)
        fb.profile_id = pid
        fb.connect()
        connected = True
        return {"profile_id": pid, "ok": True, "connected": True}
    except Exception as exc:
        # Náº¿u connect fail váº«n cá»‘ stop_profile á»Ÿ finally
        return {"profile_id": pid, "ok": False, "connected": connected, "reason": str(exc)}
    finally:
        _close_fb_controller_best_effort(fb, pid)


def _norm_profile_id(value: str) -> str:
    """Chuáº©n hoÃ¡ profile_id: bá» toÃ n bá»™ whitespace (trÃ¡nh lá»—i dÃ­nh space khi copy/paste)."""
    return re.sub(r"\s+", "", str(value or "")).strip()


class RunRequest(BaseModel):
    run_minutes: Optional[int] = None
    rest_minutes: Optional[int] = None
    profile_ids: Optional[list[str]] = None
    # text filter cho scan bÃ i viáº¿t (dÃ¹ng trong core/browser.py)
    text: Optional[str] = None
    # mode cho scan bÃ i viáº¿t: "feed" | "search"
    mode: Optional[str] = None


## NOTE: AppRunner mode Ä‘Ã£ Ä‘Æ°á»£c thay báº±ng bot per-profile Ä‘á»™c láº­p (xem _run_bot_profile_loop)


@app.get("/health")
def health_check() -> dict:
    return {"status": "ok"}


@app.post("/run")
def run_bot(payload: Optional[RunRequest] = Body(None)) -> dict:
    """
    Start bot per-profile Ä‘á»™c láº­p (má»—i profile 1 process loop RUN/REST).
    """
    # start per-profile bot processes (Ä‘á»™c láº­p)

    run_minutes = payload.run_minutes if payload else None
    rest_minutes = payload.rest_minutes if payload else None
    profile_ids = payload.profile_ids if payload else None
    text = payload.text if payload else None
    mode = payload.mode if payload else None

    # Validate profile_ids (báº¯t buá»™c chá»n profile nhÆ° UI)
    if not profile_ids:
        raise HTTPException(status_code=400, detail="profile_ids rá»—ng")
    pids = [_norm_profile_id(x) for x in (profile_ids or [])]
    pids = [p for p in pids if p]
    if not pids:
        raise HTTPException(status_code=400, detail="profile_ids khÃ´ng há»£p lá»‡")

    # Náº¿u user báº¥m CHáº Y mÃ  trÆ°á»›c Ä‘Ã³ Ä‘Ã£ STOP/PAUSE, auto reset Ä‘á»ƒ job cháº¡y Ä‘Æ°á»£c.
    # - Táº¯t GLOBAL_PAUSE
    # - Náº¿u Ä‘ang GLOBAL_EMERGENCY_STOP thÃ¬ reset
    # - resume_profiles cho Ä‘Ãºng cÃ¡c profile Ä‘Æ°á»£c yÃªu cáº§u cháº¡y.
    try:
        # LuÃ´n clear global_pause khi báº¥m báº¥t ká»³ nÃºt start nÃ o (scan/feed/search)
        control_state.set_global_pause(False)

        stop, _paused, reason = control_state.check_flags(None)
        if stop:
            print(f"ðŸŸ¡ [/run] GLOBAL_EMERGENCY_STOP Ä‘ang báº­t ({reason}) -> auto reset Ä‘á»ƒ cháº¡y")
            control_state.reset_emergency_stop(clear_stopped_profiles=False)
        # Náº¿u profile Ä‘ang bá»‹ stop riÃªng láº» thÃ¬ clear Ä‘á»ƒ cháº¡y Ä‘Æ°á»£c
        control_state.resume_profiles(pids)
    except Exception as _e:
        pass

    # Dá»n state cÅ© trong runtime_control: chá»‰ giá»¯ profile_states cá»§a Ä‘Ãºng pids Ä‘ang cháº¡y
    try:
        def _keep_only_selected(st: dict) -> None:
            ps = st.get("profile_states")
            if not isinstance(ps, dict):
                ps = {}
            keep = {pid: ps.get(pid) or "RUNNING" for pid in pids}
            st["profile_states"] = keep
            # remove paused/stopped ngoÃ i danh sÃ¡ch Ä‘Æ°á»£c cháº¡y (trÃ¡nh hiá»‡n profile láº¡)
            st["paused_profiles"] = [x for x in (st.get("paused_profiles") or []) if str(x) in set(pids)]
            st["stopped_profiles"] = [x for x in (st.get("stopped_profiles") or []) if str(x) in set(pids)]
        control_state._update(_keep_only_selected)  # type: ignore[attr-defined]
    except Exception:
        pass

    # âœ… Cháº·n cháº¡y náº¿u báº¥t ká»³ profile nÃ o thiáº¿u cookie/access_token
    _validate_profiles_requirements(pids, require_cookie=True, require_access_token=True)

    m = str(mode or "feed").strip().lower()
    if m not in ("feed", "search"):
        m = "feed"
    # Search báº¯t buá»™c cÃ³ text Ä‘á»ƒ search
    if m == "search" and not str(text or "").strip():
        raise HTTPException(status_code=400, detail="Search cáº§n text")

    started: list[str] = []
    skipped: list[dict] = []
    run_m = int(run_minutes or 0) if payload else 0
    rest_m = int(rest_minutes or 0) if payload else 0
    txt = str(text or "")
    md = str(m or "feed")

    with _bot_lock:
        _prune_bot_processes()
        for pid in pids:
            existing = _bot_processes.get(pid)
            if existing and existing.is_alive():
                skipped.append({"profile_id": pid, "reason": "already_running"})
                continue
            proc = Process(
                target=_run_bot_profile_loop,
                args=(pid, run_m, rest_m, txt, md),
                daemon=True,
            )
            proc.start()
            _bot_processes[pid] = proc
            started.append(pid)

    return {"status": "ok", "started": started, "skipped": skipped, "running": list(_bot_processes.keys())}


@app.post("/stop")
def stop_bot() -> dict:
    """
    STOP (fresh start):
    - ÄÃ³ng háº³n má»i thá»© (NST + kill runner/jobs)
    - Reset runtime_control.json vá» máº·c Ä‘á»‹nh
    - Láº§n sau báº¥m cháº¡y sáº½ tÃ­nh láº¡i RUN/REST tá»« Ä‘áº§u (PAUSE má»›i lÃ  cÃ¡i giá»¯ timer)
    """
    return _hard_stop_everything(reason="/stop")


@app.get("/status")
def status() -> dict:
    with _bot_lock:
        _prune_bot_processes()
        running = [pid for pid, proc in _bot_processes.items() if proc and proc.is_alive()]
    return {"running": len(running) > 0, "bot_profile_ids": running}


@app.get("/settings")
def get_settings_json() -> dict:
    """
    Tráº£ ná»™i dung file backend/config/settings.json Ä‘á»ƒ frontend hiá»ƒn thá»‹.
    """
    path: Path = SETTINGS_PATH
    if not path.exists():
        raise HTTPException(status_code=404, detail=f"KhÃ´ng tÃ¬m tháº¥y settings.json: {path}")

    try:
        with path.open(encoding="utf-8") as f:
            raw = json.load(f)
    except json.JSONDecodeError as exc:
        raise HTTPException(status_code=400, detail=f"settings.json khÃ´ng há»£p lá»‡: {exc}") from exc
    except Exception as exc:
        raise HTTPException(status_code=500, detail=f"KhÃ´ng Ä‘á»c Ä‘Æ°á»£c settings.json: {exc}") from exc

    return raw


def _read_settings_raw() -> Dict[str, Any]:
    path: Path = SETTINGS_PATH
    if not path.exists():
        raise HTTPException(status_code=404, detail=f"KhÃ´ng tÃ¬m tháº¥y settings.json: {path}")
    try:
        with path.open(encoding="utf-8") as f:
            raw = json.load(f)
    except json.JSONDecodeError as exc:
        raise HTTPException(status_code=400, detail=f"settings.json khÃ´ng há»£p lá»‡: {exc}") from exc
    except Exception as exc:
        raise HTTPException(status_code=500, detail=f"KhÃ´ng Ä‘á»c Ä‘Æ°á»£c settings.json: {exc}") from exc

    if not isinstance(raw, dict):
        raise HTTPException(status_code=400, detail="settings.json pháº£i lÃ  object")
    return raw


def _validate_profiles_requirements(
    profile_ids: list[str],
    *,
    require_cookie: bool = True,
    require_access_token: bool = True,
) -> None:
    """
    Náº¿u cÃ³ profile thiáº¿u cookie/access_token (theo require_*), sáº½ raise 400 vÃ  KHÃ”NG cho start job.
    """
    raw = _read_settings_raw()
    profiles = raw.get("PROFILE_IDS") or {}
    if not isinstance(profiles, dict):
        profiles = {}

    missing_list: list[dict] = []
    for pid in profile_ids:
        cfg = profiles.get(pid)
        missing: list[str] = []
        if not isinstance(cfg, dict):
            # profile chÆ°a tá»“n táº¡i trong settings.json
            if require_cookie:
                missing.append("cookie")
            if require_access_token:
                missing.append("access_token")
        else:
            if require_cookie and not str(cfg.get("cookie") or "").strip():
                missing.append("cookie")
            if require_access_token and not str(cfg.get("access_token") or cfg.get("accessToken") or "").strip():
                missing.append("access_token")

        if missing:
            missing_list.append({"profile_id": pid, "missing": missing})

    if missing_list:
        raise HTTPException(
            status_code=400,
            detail={
                "message": "Thiáº¿u cáº¥u hÃ¬nh profile (cookie/access_token). HÃ£y cáº­p nháº­t trÆ°á»›c khi cháº¡y.",
                "missing": missing_list,
            },
        )


def _atomic_write_json(path: Path, data: Dict[str, Any]) -> None:
    """
    Ghi JSON an toÃ n: write temp file cÃ¹ng thÆ° má»¥c rá»“i replace.
    """
    directory = str(path.parent)
    os.makedirs(directory, exist_ok=True)

    fd, tmp_path = tempfile.mkstemp(prefix="settings_", suffix=".json", dir=directory)
    try:
        with os.fdopen(fd, "w", encoding="utf-8") as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
            f.write("\n")
        os.replace(tmp_path, str(path))
    except Exception:
        try:
            os.remove(tmp_path)
        except Exception:
            pass
        raise


def _merge_group_ids(existing: Any, new_items: list[str]) -> list[str]:
    """Merge + de-dupe group ids, giá»¯ thá»© tá»± (existing trÆ°á»›c)."""
    base: list[str] = []
    if isinstance(existing, list):
        base = [str(x).strip() for x in existing if str(x).strip()]
    elif isinstance(existing, str):
        base = [s.strip() for s in existing.split(",") if s.strip()]

    seen: set[str] = set()
    merged: list[str] = []
    for gid in base + new_items:
        gid2 = str(gid or "").strip()
        if not gid2 or gid2 in seen:
            continue
        seen.add(gid2)
        merged.append(gid2)
    return merged


def _write_settings_raw(raw: Dict[str, Any]) -> None:
    try:
        _atomic_write_json(SETTINGS_PATH, raw)
    except Exception as exc:
        raise HTTPException(status_code=500, detail=f"KhÃ´ng ghi Ä‘Æ°á»£c settings.json: {exc}") from exc


class ApiKeyPayload(BaseModel):
    api_key: str


class ProfileCreatePayload(BaseModel):
    profile_id: str


class ProfileUpdatePayload(BaseModel):
    cookie: Optional[str] = None
    access_token: Optional[str] = None
    fb_dtsg: Optional[str] = None
    lsd: Optional[str] = None
    spin_r: Optional[str] = None
    spin_t: Optional[str] = None


class ProfileGroupsPayload(BaseModel):
    # CÃ³ thá»ƒ truyá»n 1 group hoáº·c nhiá»u group (append).
    group_id: Optional[str] = None
    group_ids: Optional[list[str]] = None


class ProfileGroupsReplacePayload(BaseModel):
    # Replace hoÃ n toÃ n groups cá»§a profile. Cho phÃ©p rá»—ng Ä‘á»ƒ xoÃ¡ háº¿t.
    groups: Optional[list[str]] = None


class JoinGroupsRequest(BaseModel):
    profile_ids: list[str]


class JoinGroupsStopRequest(BaseModel):
    # náº¿u khÃ´ng truyá»n -> stop táº¥t cáº£
    profile_ids: Optional[list[str]] = None


class FeedStartRequest(BaseModel):
    profile_ids: list[str]
    mode: str = "feed"  # "feed" | "search"
    text: str = ""      # input text (Ä‘á»‹a Ä‘iá»ƒm, hoáº·c query search)
    # backward-compat: giá»¯ field cÅ© náº¿u frontend cÅ© cÃ²n gá»i
    filter_text: str = ""
    run_minutes: int = 30
    rest_minutes: int = 0


class FeedStopRequest(BaseModel):
    profile_ids: Optional[list[str]] = None


class AccountStatusPayload(BaseModel):
    profile_id: str
    status: str
    banned: bool
    reason: Optional[str] = None
    message: str
    url: Optional[str] = None
    keyword: Optional[str] = None
    title: Optional[str] = None
    checked_at: Optional[str] = None


@app.put("/settings/api-key")
def update_api_key(payload: ApiKeyPayload) -> dict:
    with _settings_lock:
        raw = _read_settings_raw()
        raw["API_KEY"] = str(payload.api_key or "").strip()
        _write_settings_raw(raw)
        return {"status": "ok"}


@app.post("/account/status")
def report_account_status(payload: AccountStatusPayload) -> dict:
    """
    Nháº­n bÃ¡o cÃ¡o tráº¡ng thÃ¡i account tá»« worker.
    âœ… Chá»©c nÄƒng dá»± phÃ²ng: KHÃ”NG dá»«ng bot, chá»‰ lÆ°u/log Ä‘á»ƒ frontend cáº£nh bÃ¡o.
    """
    pid = _norm_profile_id(payload.profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    status_file = get_data_dir() / "account_status.json"
    status_file.parent.mkdir(parents=True, exist_ok=True)

    data: Dict[str, Any] = {}
    if status_file.exists():
        try:
            with status_file.open("r", encoding="utf-8") as f:
                data = json.load(f) or {}
        except Exception:
            data = {}

    data[pid] = {
        "profile_id": pid,
        "status": payload.status,
        "banned": bool(payload.banned),
        "reason": payload.reason,
        "message": payload.message,
        "url": payload.url,
        "keyword": payload.keyword,
        "title": payload.title,
        "checked_at": payload.checked_at or datetime.utcnow().isoformat(),
    }

    try:
        with status_file.open("w", encoding="utf-8") as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
    except Exception as e:
        print(f"âš ï¸ KhÃ´ng ghi Ä‘Æ°á»£c account_status.json: {e}")

    print(f"ðŸ”” [ACCOUNT_STATUS] {pid}: {payload.message}")
    return {"status": "ok", "profile_id": pid}


@app.get("/account/status")
def get_account_status() -> dict:
    """
    Láº¥y snapshot tráº¡ng thÃ¡i account (do worker Ä‘Ã£ ghi ra file).
    Frontend chá»‰ dÃ¹ng Ä‘á»ƒ hiá»ƒn thá»‹ cáº£nh bÃ¡o, khÃ´ng Ä‘iá»u khiá»ƒn luá»“ng.
    """
    status_file = get_data_dir() / "account_status.json"
    if not status_file.exists():
        return {"accounts": {}}

    try:
        with status_file.open("r", encoding="utf-8") as f:
            data = json.load(f) or {}
        return {"accounts": data}
    except Exception as e:
        print(f"âš ï¸ KhÃ´ng Ä‘á»c Ä‘Æ°á»£c account_status.json: {e}")
        return {"accounts": {}}


@app.post("/settings/profiles")
def add_profile(payload: ProfileCreatePayload) -> dict:
    pid = _norm_profile_id(payload.profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS")
        if profiles is None or isinstance(profiles, list) or isinstance(profiles, str):
            # Náº¿u Ä‘ang format cÅ©, convert sang dict
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        # Táº¡o profile má»›i: luÃ´n cÃ³ cookie/access_token/fb_dtsg/lsd/spin_r/spin_t/groups (groups trá»‘ng)
        cur = profiles.get(pid)
        if cur is None or not isinstance(cur, dict):
            cur = {}
            profiles[pid] = cur
        cur.setdefault("cookie", "")
        cur.setdefault("access_token", "")
        cur.setdefault("fb_dtsg", "")
        cur.setdefault("lsd", "")
        cur.setdefault("spin_r", "")
        cur.setdefault("spin_t", "")
        cur.setdefault("groups", [])
        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)
        return {"status": "ok"}


@app.put("/settings/profiles/{profile_id}")
def update_profile(profile_id: str, payload: ProfileUpdatePayload) -> dict:
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if isinstance(profiles, list) or isinstance(profiles, str):
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        cur = profiles.get(pid)
        if cur is None:
            profiles[pid] = {}
            cur = profiles[pid]
        if not isinstance(cur, dict):
            cur = {}
            profiles[pid] = cur

        if payload.cookie is not None:
            cur["cookie"] = str(payload.cookie)
        if payload.access_token is not None:
            cur["access_token"] = str(payload.access_token)
        if payload.fb_dtsg is not None:
            cur["fb_dtsg"] = str(payload.fb_dtsg)
        if payload.lsd is not None:
            cur["lsd"] = str(payload.lsd)
        if payload.spin_r is not None:
            cur["spin_r"] = str(payload.spin_r)
        if payload.spin_t is not None:
            cur["spin_t"] = str(payload.spin_t)

        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)
        return {"status": "ok"}


@app.post("/settings/profiles/{profile_id}/groups")
def add_or_sync_profile_groups(profile_id: str, payload: ProfileGroupsPayload) -> dict:
    """
    Cáº­p nháº­t groups cho 1 profile:
    - hoáº·c truyá»n group_id / group_ids Ä‘á»ƒ append vÃ o PROFILE_IDS[pid].groups
    """
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    new_groups: list[str] = []
    if payload.group_ids:
        new_groups.extend([str(x or "").strip() for x in payload.group_ids])
    if payload.group_id:
        new_groups.append(str(payload.group_id or "").strip())
    new_groups = [g for g in new_groups if g]

    if not new_groups:
        raise HTTPException(status_code=400, detail="Thiáº¿u group_id/group_ids")

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if isinstance(profiles, list) or isinstance(profiles, str):
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        cur = profiles.get(pid)
        if cur is None or not isinstance(cur, dict):
            cur = {}
            profiles[pid] = cur

        merged = _merge_group_ids(cur.get("groups"), new_groups)

        cur["groups"] = merged
        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)

        return {"status": "ok", "profile_id": pid, "groups": merged}


@app.put("/settings/profiles/{profile_id}/groups")
def replace_profile_groups(profile_id: str, payload: ProfileGroupsReplacePayload) -> dict:
    """
    Ghi Ä‘Ã¨ toÃ n bá»™ groups cá»§a 1 profile (Ä‘Ãºng yÃªu cáº§u: trong textarea cÃ³ gÃ¬ thÃ¬ Ä‘Ã¨ lÃªn cÃ¡i cÅ©).
    """
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    raw_groups = payload.groups if payload and payload.groups is not None else []
    if not isinstance(raw_groups, list):
        raise HTTPException(status_code=400, detail="groups pháº£i lÃ  list")

    cleaned: list[str] = []
    seen: set[str] = set()
    for item in raw_groups:
        s = str(item or "").strip()
        if not s:
            continue
        # de-dupe Ä‘á»ƒ trÃ¡nh spam
        if s in seen:
            continue
        seen.add(s)
        cleaned.append(s)

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if isinstance(profiles, list) or isinstance(profiles, str):
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        cur = profiles.get(pid)
        if cur is None or not isinstance(cur, dict):
            cur = {}
            profiles[pid] = cur

        cur["groups"] = cleaned
        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)
        return {"status": "ok", "profile_id": pid, "groups": cleaned}


def _prune_join_group_processes() -> None:
    """Dá»n cÃ¡c process Ä‘Ã£ cháº¡y xong khá»i map."""
    dead = []
    for pid, proc in list(_join_groups_processes.items()):
        try:
            if not proc.is_alive():
                dead.append(pid)
        except Exception:
            dead.append(pid)
    for pid in dead:
        _join_groups_processes.pop(pid, None)


def _prune_feed_processes() -> None:
    dead = []
    for pid, proc in list(_feed_processes.items()):
        try:
            if not proc.is_alive():
                dead.append(pid)
        except Exception:
            dead.append(pid)
    for pid in dead:
        _feed_processes.pop(pid, None)


@app.post("/groups/join")
def auto_join_groups(payload: JoinGroupsRequest) -> dict:
    """
    Cháº¡y auto join group cho cÃ¡c profile Ä‘Ã£ chá»n (má»—i profile 1 process â†’ cháº¡y song song).
    Groups láº¥y tá»« settings.json: PROFILE_IDS[pid].groups
    """
    # Náº¿u user báº¥m JOIN mÃ  trÆ°á»›c Ä‘Ã³ Ä‘Ã£ STOP/PAUSE, auto reset Ä‘á»ƒ job cháº¡y Ä‘Æ°á»£c.
    try:
        # Clear global_pause khi báº¥m JOIN
        control_state.set_global_pause(False)

        stop, _paused, reason = control_state.check_flags(None)
        if stop:
            print(f"ðŸŸ¡ [/groups/join] GLOBAL_EMERGENCY_STOP Ä‘ang báº­t ({reason}) -> auto reset Ä‘á»ƒ join")
            control_state.reset_emergency_stop(clear_stopped_profiles=False)
    except Exception:
        pass

    if not payload.profile_ids:
        raise HTTPException(status_code=400, detail="profile_ids rá»—ng")

    pids = [_norm_profile_id(x) for x in payload.profile_ids]
    pids = [p for p in pids if p]
    if not pids:
        raise HTTPException(status_code=400, detail="profile_ids khÃ´ng há»£p lá»‡")

    # Clear STOPPED cho Ä‘Ãºng cÃ¡c profile Ä‘Æ°á»£c yÃªu cáº§u join
    try:
        control_state.resume_profiles(pids)
    except Exception:
        pass

    # âœ… Join group chá»‰ cáº§n cookie (khÃ´ng báº¯t access_token)
    _validate_profiles_requirements(pids, require_cookie=True, require_access_token=False)

    started: list[str] = []
    skipped: list[dict] = []

    with _join_groups_lock:
        _prune_join_group_processes()

        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if not isinstance(profiles, dict):
            profiles = {}

        for pid in pids:
            # skip náº¿u Ä‘ang cháº¡y
            existing = _join_groups_processes.get(pid)
            if existing and existing.is_alive():
                skipped.append({"profile_id": pid, "reason": "already_running"})
                continue

            cfg = profiles.get(pid)
            if not isinstance(cfg, dict):
                skipped.append({"profile_id": pid, "reason": "profile_not_found"})
                continue

            groups = cfg.get("groups")
            if not isinstance(groups, list):
                groups = []
            groups = [str(g or "").strip() for g in groups if str(g or "").strip()]

            if len(groups) == 0:
                skipped.append({"profile_id": pid, "reason": "no_groups"})
                continue

            proc = Process(
                target=_run_join_groups_worker,
                args=(pid, groups),
                daemon=True,
            )
            proc.start()
            _join_groups_processes[pid] = proc
            started.append(pid)

    return {
        "status": "ok",
        "started": started,
        "skipped": skipped,
        "running": list(_join_groups_processes.keys()),
    }


@app.post("/groups/join/stop")
def stop_auto_join_groups(payload: Optional[JoinGroupsStopRequest] = Body(None)) -> dict:
    """
    Dá»«ng auto join group:
    - KhÃ´ng truyá»n payload -> dá»«ng táº¥t cáº£
    - CÃ³ profile_ids -> dá»«ng theo danh sÃ¡ch
    """
    target: Optional[list[str]] = None
    if payload and payload.profile_ids is not None:
        target = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
        target = [p for p in target if p]

    stopped: list[str] = []
    not_running: list[str] = []

    with _join_groups_lock:
        _prune_join_group_processes()
        keys = list(_join_groups_processes.keys())
        to_stop = keys if target is None else [p for p in target if p in _join_groups_processes]

        # terminate processes
        for pid in to_stop:
            proc = _join_groups_processes.get(pid)
            if not proc:
                continue
            try:
                if proc.is_alive():
                    proc.terminate()
                    proc.join(timeout=5)
            except Exception:
                pass
            _join_groups_processes.pop(pid, None)
            stopped.append(pid)

        if target is not None:
            for pid in target:
                if pid not in stopped:
                    not_running.append(pid)

    # Best-effort: yÃªu cáº§u NST stop/close browser instance cá»§a profile (giá»‘ng luá»“ng láº¥y cookie)
    for pid in stopped:
        try:
            stop_profile(pid)
        except Exception:
            pass

    return {"status": "ok", "stopped": stopped, "not_running": not_running}


@app.get("/groups/join/status")
def join_groups_status() -> dict:
    """Tráº¡ng thÃ¡i join-groups Ä‘ang cháº¡y."""
    with _join_groups_lock:
        _prune_join_group_processes()
        running = []
        for pid, proc in _join_groups_processes.items():
            try:
                if proc.is_alive():
                    running.append(pid)
            except Exception:
                pass
    return {"running": running}


@app.get("/feed/status")
def feed_status() -> dict:
    """Tráº¡ng thÃ¡i nuÃ´i acc (feed) Ä‘ang cháº¡y."""
    with _feed_lock:
        _prune_feed_processes()
        running: list[str] = []
        for pid, proc in _feed_processes.items():
            try:
                if proc.is_alive():
                    running.append(pid)
            except Exception:
                pass
    return {"running": running}


@app.post("/feed/start")
def feed_start(payload: FeedStartRequest) -> dict:
    """Cháº¡y nuÃ´i acc (feed & like) cho cÃ¡c profile Ä‘Ã£ chá»n (má»—i profile 1 process)."""
    if not payload.profile_ids:
        raise HTTPException(status_code=400, detail="profile_ids rá»—ng")

    pids = [_norm_profile_id(x) for x in payload.profile_ids]
    pids = [p for p in pids if p]
    if not pids:
        raise HTTPException(status_code=400, detail="profile_ids khÃ´ng há»£p lá»‡")

    # Náº¿u user báº¥m NUÃ”I ACC mÃ  trÆ°á»›c Ä‘Ã³ Ä‘Ã£ STOP/PAUSE, auto reset STOP/PAUSE Ä‘á»ƒ job cháº¡y Ä‘Æ°á»£c.
    try:
        # Clear global_pause khi báº¥m NUÃ”I ACC
        control_state.set_global_pause(False)

        stop, _paused, reason = control_state.check_flags(None)
        if stop:
            print(f"ðŸŸ¡ [/feed/start] GLOBAL_EMERGENCY_STOP Ä‘ang báº­t ({reason}) -> auto reset Ä‘á»ƒ cháº¡y")
            control_state.reset_emergency_stop(clear_stopped_profiles=False)
        control_state.resume_profiles(pids)
    except Exception:
        pass

    # âœ… Cháº·n cháº¡y náº¿u báº¥t ká»³ profile nÃ o thiáº¿u cookie/access_token
    _validate_profiles_requirements(pids, require_cookie=True, require_access_token=True)

    run_minutes = int(payload.run_minutes or 0)
    if run_minutes <= 0:
        raise HTTPException(status_code=400, detail="run_minutes pháº£i > 0")
    rest_minutes = int(payload.rest_minutes or 0)
    if rest_minutes < 0:
        raise HTTPException(status_code=400, detail="rest_minutes pháº£i >= 0")

    started: list[str] = []
    skipped: list[dict] = []
    mode = str(payload.mode or "feed").strip().lower()
    text = str(payload.text or "").strip()
    # backward-compat
    if not text and getattr(payload, "filter_text", None):
        text = str(payload.filter_text or "").strip()
    # Cho phÃ©p text rá»—ng náº¿u mode=feed (sáº½ chá»‰ filter theo keyword máº·c Ä‘á»‹nh)
    if not text and mode == "search":
        raise HTTPException(status_code=400, detail="text rá»—ng (search cáº§n text)")

    with _feed_lock:
        _prune_feed_processes()
        for pid in pids:
            existing = _feed_processes.get(pid)
            if existing and existing.is_alive():
                skipped.append({"profile_id": pid, "reason": "already_running"})
                continue

            proc = Process(
                target=_run_feed_worker,
                args=(pid, mode, text, run_minutes, rest_minutes, pids),
                daemon=True,
            )
            proc.start()
            _feed_processes[pid] = proc
            started.append(pid)

    return {"status": "ok", "started": started, "skipped": skipped, "running": list(_feed_processes.keys())}


@app.post("/feed/stop")
def feed_stop(payload: Optional[FeedStopRequest] = Body(None)) -> dict:
    """Dá»«ng nuÃ´i acc (feed) theo list profile_ids hoáº·c dá»«ng táº¥t cáº£ náº¿u khÃ´ng truyá»n."""
    target: Optional[list[str]] = None
    if payload and payload.profile_ids is not None:
        target = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
        target = [p for p in target if p]

    stopped: list[str] = []
    with _feed_lock:
        _prune_feed_processes()
        keys = list(_feed_processes.keys())
        to_stop = keys if target is None else [p for p in target if p in _feed_processes]
        for pid in to_stop:
            proc = _feed_processes.get(pid)
            try:
                if proc and proc.is_alive():
                    proc.terminate()
                    proc.join(timeout=5)
            except Exception:
                pass
            _feed_processes.pop(pid, None)
            stopped.append(pid)

    for pid in stopped:
        try:
            stop_profile(pid)
        except Exception:
            pass

    return {"status": "ok", "stopped": stopped}


@app.get("/jobs/status")
def jobs_status() -> dict:
    """Tráº¡ng thÃ¡i chung (Ä‘á»ƒ UI hiá»ƒn thá»‹/diagnose)."""
    with _bot_lock:
        _prune_bot_processes()
        bot_running_pids = []
        for pid, proc in _bot_processes.items():
            try:
                if proc.is_alive():
                    bot_running_pids.append(pid)
            except Exception:
                pass
    is_bot_running = len(bot_running_pids) > 0
    with _join_groups_lock:
        _prune_join_group_processes()
        join_running = []
        for pid, proc in _join_groups_processes.items():
            try:
                if proc.is_alive():
                    join_running.append(pid)
            except Exception:
                pass
    with _feed_lock:
        _prune_feed_processes()
        feed_running = []
        for pid, proc in _feed_processes.items():
            try:
                if proc.is_alive():
                    feed_running.append(pid)
            except Exception:
                pass
    return {
        "bot_running": is_bot_running,
        "bot_pid": None,
        "bot_profile_ids": bot_running_pids,
        "join_groups_running": join_running,
        "feed_running": feed_running,
    }


@app.post("/jobs/stop-all")
def stop_all_jobs() -> dict:
    """
    Dá»«ng táº¥t cáº£ tÃ¡c vá»¥ ná»n (dÃ¹ng chung cho auto join group + sau nÃ y nuÃ´i acc).
    """
    # Legacy endpoint: váº«n map vá» hard stop (fresh start) cho Ä‘Ãºng spec má»›i
    return _hard_stop_everything(reason="/jobs/stop-all")


# ==============================================================================
# INFO COLLECTOR (get_all_info_from_post_ids_dir)
# ==============================================================================

@app.post("/info/run")
async def run_info_collector(payload: InfoRunRequest = Body(...)) -> dict:
    """
    Trigger láº¥y thÃ´ng tin reactions/comments:
      - mode="all": cháº¡y toÃ n bá»™ post_ids dir (giá»‘ng CLI hiá»‡n táº¡i)
      - mode="selected": chá»‰ cháº¡y cÃ¡c profile_id truyá»n trong payload.profiles
    """
    mode = (payload.mode or "all").lower()
    # Khi báº¥m Láº¥y thÃ´ng tin, auto clear global_pause + emergency_stop
    try:
        control_state.set_global_pause(False)
        stop, _paused, reason = control_state.check_flags(None)
        if stop:
            print(f"ðŸŸ¡ [/info/run] GLOBAL_EMERGENCY_STOP Ä‘ang báº­t ({reason}) -> auto reset Ä‘á»ƒ cháº¡y")
            control_state.reset_emergency_stop(clear_stopped_profiles=False)
    except Exception:
        pass
    try:
        if mode == "selected":
            profiles = payload.profiles or []
            if not profiles:
                raise HTTPException(status_code=400, detail="profiles is required when mode=selected")
            summary = await run_in_threadpool(get_info_for_profile_ids, profiles)
        else:
            summary = await run_in_threadpool(get_all_info_from_post_ids_dir)
        return {"status": "ok", "mode": mode, "summary": summary}
    except ValueError as e:
        # Náº¿u khÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t thÃ¬ tráº£ vá» message rÃµ rÃ ng
        error_msg = str(e)
        if "khÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t" in error_msg.lower():
            raise HTTPException(status_code=400, detail="KhÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t Ä‘á»ƒ xá»­ lÃ½")
        raise HTTPException(status_code=400, detail=error_msg)
    except HTTPException:
        raise
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))


@app.get("/info/scan-stats")
def get_scan_stats() -> dict:
    """
    Láº¥y sá»‘ bÃ i Ä‘Ã£ quÃ©t Ä‘Æ°á»£c cho tá»«ng profile_id tá»« cÃ¡c file JSON trong data/post_ids/
    """
    from pathlib import Path
    import json
    import os
    
    POST_IDS_DIR = get_data_dir() / "post_ids"
    
    stats = {}
    
    if not POST_IDS_DIR.exists():
        return {"stats": stats}
    
    json_files = list(POST_IDS_DIR.glob("*.json"))
    for file_path in json_files:
        profile_id = file_path.stem  # Láº¥y tÃªn file khÃ´ng cÃ³ extension
        try:
            with file_path.open("r", encoding="utf-8") as f:
                data = json.load(f)
                if isinstance(data, list):
                    count = len(data)
                else:
                    count = 0
                stats[profile_id] = count
        except Exception:
            stats[profile_id] = 0
    
    return {"stats": stats}


@app.get("/info/progress")
def get_info_progress() -> dict:
    """
    Láº¥y tiáº¿n trÃ¬nh khi Ä‘ang láº¥y thÃ´ng tin (sá»‘ bÃ i Ä‘Ã£ xá»­ lÃ½ / tá»•ng sá»‘ bÃ i)
    """
    try:
        from worker.get_all_info import INFO_PROGRESS
    except ImportError:
        try:
            from backend.worker.get_all_info import INFO_PROGRESS
        except ImportError:
            # Fallback náº¿u khÃ´ng import Ä‘Æ°á»£c
            INFO_PROGRESS = {
                "is_running": False,
                "current": 0,
                "total": 0,
                "current_file": "",
            }
    
    return {
        "is_running": INFO_PROGRESS.get("is_running", False),
        "current": INFO_PROGRESS.get("current", 0),
        "total": INFO_PROGRESS.get("total", 0),
        "current_file": INFO_PROGRESS.get("current_file", ""),
    }


# ==============================================================================
# CONTROL API (STOP / PAUSE / RESUME) - theo spec Boss
# ==============================================================================

class ProfileControlPayload(BaseModel):
    profile_id: str


class ProfilesControlPayload(BaseModel):
    profile_ids: list[str]


class ResetStopPayload(BaseModel):
    clear_stopped_profiles: bool = False


@app.get("/control/state")
def control_get_state() -> dict:
    return control_state.get_state()


@app.post("/control/stop-all")
def control_stop_all() -> dict:
    """
    STOP ALL = dá»«ng kháº©n cáº¥p.
    - set GLOBAL_EMERGENCY_STOP=true (Æ°u tiÃªn cao nháº¥t)
    - best-effort: Ä‘Ã³ng toÃ n bá»™ NST browser
    - KHÃ”NG há»i confirm, KHÃ”NG delay
    """
    return _hard_stop_everything(reason="/control/stop-all")


@app.post("/control/pause-all")
def control_pause_all() -> dict:
    print("[UI] PAUSE ALL triggered")
    st = control_state.set_global_pause(True)
    return {"status": "ok", "state": st}


@app.post("/control/resume-all")
def control_resume_all() -> dict:
    print("[UI] RESUME ALL triggered")
    st = control_state.set_global_pause(False)
    return {"status": "ok", "state": st}


@app.post("/control/pause-profile")
def control_pause_profile(payload: ProfileControlPayload) -> dict:
    pid = _norm_profile_id(payload.profile_id)
    print(f"[UI] PAUSE profile_id={pid}")
    st = control_state.pause_profile(pid)
    return {"status": "ok", "state": st, "profile_id": pid}


@app.post("/control/resume-profile")
def control_resume_profile(payload: ProfileControlPayload) -> dict:
    pid = _norm_profile_id(payload.profile_id)
    print(f"[UI] RESUME profile_id={pid}")
    st = control_state.resume_profile(pid)
    return {"status": "ok", "state": st, "profile_id": pid}


@app.post("/control/stop-profiles")
def control_stop_profiles(payload: ProfilesControlPayload) -> dict:
    """
    STOP theo danh sÃ¡ch profile (dÃ¹ng cho UI: tick profile -> báº¥m dá»«ng).
    - Set stopped_profiles cho tá»«ng pid
    - Best-effort: Ä‘Ã³ng NST browser cho Ä‘Ãºng cÃ¡c pid Ä‘Ã³
    """
    global _bot_processes
    pids = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
    pids = [p for p in pids if p]
    print(f"[UI] STOP profiles={pids}")

    st = control_state.stop_profiles(pids)

    # Terminate bot process Ä‘Ãºng profile (Ä‘á»™c láº­p), khÃ´ng áº£nh hÆ°á»Ÿng profile khÃ¡c
    try:
        with _bot_lock:
            _prune_bot_processes()
            for pid in pids:
                proc = _bot_processes.get(pid)
                try:
                    if proc and proc.is_alive():
                        proc.terminate()
                        proc.join(timeout=3)
                except Exception:
                    pass
                _bot_processes.pop(pid, None)
    except Exception:
        pass

    nst_ok: list[str] = []
    nst_fail: list[dict] = []
    for pid in pids:
        try:
            ok = bool(stop_profile(pid))
            if ok:
                nst_ok.append(pid)
            else:
                nst_fail.append({"profile_id": pid, "reason": "stop_profile_returned_false"})
        except Exception as e:
            nst_fail.append({"profile_id": pid, "reason": str(e)})

    return {"status": "ok", "state": st, "stopped_profiles": pids, "nst_ok": nst_ok, "nst_fail": nst_fail}


@app.post("/control/pause-profiles")
def control_pause_profiles(payload: ProfilesControlPayload) -> dict:
    pids = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
    pids = [p for p in pids if p]
    print(f"[UI] PAUSE profiles={pids}")
    st = control_state.pause_profiles(pids)
    return {"status": "ok", "state": st, "paused_profiles": pids}


@app.post("/control/resume-profiles")
def control_resume_profiles(payload: ProfilesControlPayload) -> dict:
    pids = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
    pids = [p for p in pids if p]
    print(f"[UI] RESUME profiles={pids}")
    st = control_state.resume_profiles(pids)
    return {"status": "ok", "state": st, "resumed_profiles": pids}


@app.post("/control/reset-stop")
def control_reset_stop(payload: Optional[ResetStopPayload] = Body(None)) -> dict:
    """
    Reset emergency stop Ä‘á»ƒ há»‡ thá»‘ng cháº¡y láº¡i Ä‘Æ°á»£c.
    - clear_stopped_profiles=true: xoÃ¡ luÃ´n stopped_profiles (Ä‘á»ƒ profile khÃ´ng bá»‹ giá»¯ STOPPED)
    """
    clear_stopped = bool(payload.clear_stopped_profiles) if payload else False
    print(f"[UI] RESET STOP (clear_stopped_profiles={clear_stopped})")
    st = control_state.reset_emergency_stop(clear_stopped_profiles=clear_stopped)
    return {"status": "ok", "state": st}

@app.delete("/settings/profiles/{profile_id}")
def delete_profile(profile_id: str) -> dict:
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if isinstance(profiles, list) or isinstance(profiles, str):
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        if pid in profiles:
            del profiles[pid]
        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)
        return {"status": "ok"}


@app.post("/settings/profiles/{profile_id}/cookie/fetch")
def fetch_and_save_cookie(profile_id: str) -> dict:
    """
    Káº¿t ná»‘i NST profile -> láº¥y cookie tá»« browser context -> lÆ°u vÃ o settings.json.
    """
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    try:
        ws = connect_profile(pid)
    except Exception as exc:
        # NST chÆ°a cháº¡y / API key sai / profile_id sai
        raise HTTPException(status_code=502, detail=str(exc)) from exc
    fb = FBController(ws)
    fb.profile_id = pid
    fb.connect()
    try:
        # Ä‘áº£m báº£o context Ä‘Ã£ cÃ³ session/cookie
        try:
            fb.goto("https://www.facebook.com/")
            fb.page.wait_for_timeout(1200)
        except Exception:
            pass

        cookie_string = fb.save_cookies()
        if not cookie_string:
            raise HTTPException(status_code=400, detail="KhÃ´ng láº¥y Ä‘Æ°á»£c cookie (cÃ³ thá»ƒ chÆ°a Ä‘Äƒng nháº­p)")
        return {"status": "ok", "profile_id": pid, "cookie": cookie_string}
    finally:
        # ÄÃ³ng sáº¡ch tab/context playwright
        try:
            if fb.page:
                try:
                    fb.page.close()
                except Exception:
                    pass
        except Exception:
            pass
        try:
            if fb.browser and getattr(fb.browser, "contexts", None):
                for ctx in list(fb.browser.contexts):
                    try:
                        ctx.close()
                    except Exception:
                        pass
        except Exception:
            pass
        try:
            if fb.browser:
                fb.browser.close()
        except Exception:
            pass
        try:
            if fb.play:
                fb.play.stop()
        except Exception:
            pass

        # Best-effort: yÃªu cáº§u NST stop/close browser instance cá»§a profile
        try:
            stop_profile(pid)
        except Exception:
            pass


def _get_latest_results_file_logic(filename_param: Optional[str] = None) -> dict:
    """
    Logic chung Ä‘á»ƒ láº¥y file results (dÃ¹ng cho cáº£ GET vÃ  POST).
    """
    from pathlib import Path
    import re

    RESULTS_DIR = get_data_dir() / "results"

    # Náº¿u cÃ³ filename, load file Ä‘Ã³
    if filename_param:
        file_path = RESULTS_DIR / filename_param
        if not file_path.exists():
            raise HTTPException(status_code=404, detail=f"File {filename_param} khÃ´ng tá»“n táº¡i")

        # Parse timestamp tá»« filename
        pattern = re.compile(r'all_results_(\d{8})_(\d{6})\.json$')
        match = pattern.match(filename_param)
        if not match:
            raise HTTPException(status_code=400, detail=f"TÃªn file {filename_param} khÃ´ng há»£p lá»‡")

        date_str, time_str = match.groups()
        try:
            from datetime import datetime
            dt = datetime.strptime(f"{date_str} {time_str}", "%Y%m%d %H%M%S")
            timestamp = dt.timestamp()
        except ValueError:
            raise HTTPException(status_code=400, detail=f"KhÃ´ng thá»ƒ parse timestamp tá»« {filename_param}")

        try:
            with file_path.open("r", encoding="utf-8") as f:
                content = f.read().strip()

            # Thá»­ parse JSON
            try:
                data = json.loads(content)
            except json.JSONDecodeError:
                # Thá»­ tÃ¬m object JSON chÃ­nh
                last_brace = content.rfind('}')
                if last_brace > 0:
                    try:
                        data = json.loads(content[:last_brace + 1])
                    except json.JSONDecodeError as exc:
                        raise HTTPException(status_code=400, detail=f"File {filename_param} khÃ´ng pháº£i JSON há»£p lá»‡: {exc}") from exc
                else:
                    raise HTTPException(status_code=400, detail=f"File {filename_param} khÃ´ng pháº£i JSON há»£p lá»‡")
        except Exception as exc:
            raise HTTPException(status_code=500, detail=f"KhÃ´ng Ä‘á»c Ä‘Æ°á»£c file {filename_param}: {exc}")

        return {
            "filename": filename_param,
            "timestamp": int(timestamp),
            "data": data
        }

    # Náº¿u khÃ´ng cÃ³ filename, tÃ¬m file gáº§n nháº¥t nhÆ° cÅ©
    if not RESULTS_DIR.exists():
        raise HTTPException(status_code=404, detail=f"ThÆ° má»¥c results khÃ´ng tá»“n táº¡i: {RESULTS_DIR}")

    # Pattern Ä‘á»ƒ parse timestamp tá»« tÃªn file: all_results_YYYYMMDD_HHMMSS.json
    pattern = re.compile(r'all_results_(\d{8})_(\d{6})\.json$')

    # TÃ¬m táº¥t cáº£ file JSON vÃ  parse timestamp
    json_files = []
    all_files = list(RESULTS_DIR.glob("*.json"))

    for file_path in all_files:
        match = pattern.match(file_path.name)
        if match:
            date_str, time_str = match.groups()
            # Parse thÃ nh datetime Ä‘á»ƒ so sÃ¡nh chÃ­nh xÃ¡c
            try:
                from datetime import datetime
                # Parse YYYYMMDD HHMMSS
                dt = datetime.strptime(f"{date_str} {time_str}", "%Y%m%d %H%M%S")
                timestamp = dt.timestamp()  # Unix timestamp
                json_files.append((file_path, timestamp, file_path.name))
            except ValueError:
                continue

    if not json_files:
        file_names = [f.name for f in all_files]
        raise HTTPException(status_code=404, detail=f"KhÃ´ng tÃ¬m tháº¥y file JSON nÃ o match pattern. Files found: {file_names}")

    # Sáº¯p xáº¿p theo timestamp giáº£m dáº§n (má»›i nháº¥t trÆ°á»›c)
    json_files.sort(key=lambda x: x[1], reverse=True)

    # Láº¥y file gáº§n nháº¥t
    latest_file, timestamp, filename = json_files[0]

    try:
        with latest_file.open("r", encoding="utf-8") as f:
            content = f.read().strip()

        # Thá»­ parse JSON bÃ¬nh thÆ°á»ng trÆ°á»›c
        try:
            data = json.loads(content)
        except json.JSONDecodeError:
            # Náº¿u tháº¥t báº¡i, thá»­ tÃ¬m object JSON chÃ­nh (bá» dá»¯ liá»‡u thá»«a á»Ÿ cuá»‘i)
            # TÃ¬m vá»‹ trÃ­ cuá»‘i cÃ¹ng cá»§a closing brace
            last_brace = content.rfind('}')
            if last_brace > 0:
                # Thá»­ parse tá»« Ä‘áº§u Ä‘áº¿n closing brace
                try:
                    data = json.loads(content[:last_brace + 1])
                except json.JSONDecodeError as exc:
                    raise HTTPException(status_code=400, detail=f"File {filename} khÃ´ng pháº£i JSON há»£p lá»‡: {exc}") from exc
            else:
                raise HTTPException(status_code=400, detail=f"File {filename} khÃ´ng pháº£i JSON há»£p lá»‡")
    except Exception as exc:
        raise HTTPException(status_code=500, detail=f"KhÃ´ng Ä‘á»c Ä‘Æ°á»£c file {filename}: {exc}") from exc

    return {
        "filename": filename,
        "timestamp": int(timestamp),
        "data": data
    }


@app.get("/data/latest-results")
def get_latest_results_file_get(filename: Optional[str] = Query(None)) -> dict:
    """
    GET endpoint: TÃ¬m vÃ  tráº£ vá» ná»™i dung file JSON theo filename hoáº·c gáº§n nháº¥t.
    """
    return _get_latest_results_file_logic(filename)


@app.get("/data/post-ids")
def get_post_ids_list() -> dict:
    """
    Láº¥y danh sÃ¡ch táº¥t cáº£ file post_ids vÃ  ná»™i dung cá»§a chÃºng.
    """
    from pathlib import Path
    import json

    POST_IDS_DIR = get_data_dir() / "post_ids"

    if not POST_IDS_DIR.exists():
        return {"files": [], "total": 0}

    files_data = []
    json_files = list(POST_IDS_DIR.glob("*.json"))

    for file_path in json_files:
        try:
            with file_path.open("r", encoding="utf-8") as f:
                content = f.read().strip()

            # Parse JSON
            data = json.loads(content)

            # Xá»­ lÃ½ cáº£ trÆ°á»ng há»£p array hoáº·c object
            if isinstance(data, list):
                posts = data
            elif isinstance(data, dict):
                posts = [data]
            else:
                continue

            # Láº¥y thÃ´ng tin tá»« posts
            for post in posts:
                if isinstance(post, dict) and "id" in post:
                    files_data.append({
                        "filename": file_path.name,
                        "post_id": post.get("id"),
                        "flag": post.get("flag", ""),
                        "text": post.get("text", ""),
                        "owning_profile": post.get("owning_profile", {})
                    })

        except Exception as e:
            # Náº¿u khÃ´ng Ä‘á»c Ä‘Æ°á»£c file, bá» qua
            continue

    return {
        "files": files_data,
        "total": len(files_data)
    }


@app.post("/cleanup/old-files")
def cleanup_old_files(max_days: int = 3) -> dict:
    """
    Dá»n dáº¹p cÃ¡c file all_results cÅ© quÃ¡ max_days ngÃ y.
    """
    from pathlib import Path
    import re
    from datetime import datetime, timedelta

    RESULTS_DIR = get_data_dir() / "results"

    if not RESULTS_DIR.exists():
        return {"deleted_count": 0, "message": "ThÆ° má»¥c results khÃ´ng tá»“n táº¡i"}

    # Pattern Ä‘á»ƒ parse timestamp tá»« tÃªn file: all_results_YYYYMMDD_HHMMSS.json
    pattern = re.compile(r'all_results_(\d{8})_(\d{6})\.json$')

    current_time = datetime.now()
    max_age = timedelta(days=max_days)
    deleted_count = 0
    deleted_files = []

    # Duyá»‡t qua táº¥t cáº£ file trong thÆ° má»¥c
    for file_path in RESULTS_DIR.glob("*.json"):
        if not file_path.is_file():
            continue

        match = pattern.match(file_path.name)
        if not match:
            continue

        date_str, time_str = match.groups()
        try:
            # Parse thÃ nh datetime
            file_datetime = datetime.strptime(f"{date_str} {time_str}", "%Y%m%d %H%M%S")

            # Kiá»ƒm tra tuá»•i file
            if current_time - file_datetime > max_age:
                try:
                    file_path.unlink()  # XÃ³a file
                    deleted_count += 1
                    deleted_files.append(file_path.name)
                    print(f"ÄÃ£ xÃ³a file cÅ©: {file_path.name}")
                except Exception as e:
                    print(f"Lá»—i khi xÃ³a file {file_path.name}: {e}")

        except ValueError:
            # Náº¿u khÃ´ng parse Ä‘Æ°á»£c timestamp, bá» qua
            continue

    return {
        "deleted_count": deleted_count,
        "deleted_files": deleted_files,
        "message": f"ÄÃ£ xÃ³a {deleted_count} file cÅ© quÃ¡ {max_days} ngÃ y"
    }


@app.post("/data/latest-results")
def get_latest_results_file_post(request: Optional[dict] = Body(None)) -> dict:
    """
    POST endpoint: TÃ¬m vÃ  tráº£ vá» ná»™i dung file JSON theo filename hoáº·c gáº§n nháº¥t (tÆ°Æ¡ng thÃ­ch ngÆ°á»£c).
    """
    filename_param = None
    if request and isinstance(request, dict):
        filename_param = request.get("filename")
    return _get_latest_results_file_logic(filename_param)


@app.post("/data/by-date-range")
def get_results_by_date_range(request: dict) -> dict:
    """
    TÃ¬m vÃ  tráº£ vá» file JSON cÃ³ timestamp náº±m trong khoáº£ng thá»i gian Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh
    """
    from pathlib import Path
    import re

    RESULTS_DIR = get_data_dir() / "results"

    from_timestamp = request.get("from_timestamp")
    to_timestamp = request.get("to_timestamp")

    if not from_timestamp or not to_timestamp:
        raise HTTPException(status_code=400, detail="Thiáº¿u from_timestamp hoáº·c to_timestamp")

    try:
        from_timestamp = int(from_timestamp)
        to_timestamp = int(to_timestamp)
    except ValueError:
        raise HTTPException(status_code=400, detail="Timestamp pháº£i lÃ  sá»‘ nguyÃªn")

    if not RESULTS_DIR.exists():
        raise HTTPException(status_code=404, detail=f"ThÆ° má»¥c results khÃ´ng tá»“n táº¡i: {RESULTS_DIR}")

    # Pattern Ä‘á»ƒ parse timestamp tá»« tÃªn file
    pattern = re.compile(r'all_results_(\d{8})_(\d{6})\.json$')

    # TÃ¬m táº¥t cáº£ file JSON vÃ  parse timestamp
    matching_files = []
    all_files = list(RESULTS_DIR.glob("*.json"))

    for file_path in all_files:
        match = pattern.match(file_path.name)
        if match:
            date_str, time_str = match.groups()
            try:
                from datetime import datetime
                dt = datetime.strptime(f"{date_str} {time_str}", "%Y%m%d %H%M%S")
                timestamp = dt.timestamp()

                # Kiá»ƒm tra xem timestamp cÃ³ náº±m trong khoáº£ng khÃ´ng
                if from_timestamp <= timestamp <= to_timestamp:
                    matching_files.append((file_path, timestamp, file_path.name))
            except ValueError:
                continue

    if not matching_files:
        raise HTTPException(status_code=404, detail=f"KhÃ´ng tÃ¬m tháº¥y file JSON nÃ o trong khoáº£ng thá»i gian tá»« {from_timestamp} Ä‘áº¿n {to_timestamp}")

    # Sáº¯p xáº¿p theo timestamp giáº£m dáº§n (má»›i nháº¥t trÆ°á»›c)
    matching_files.sort(key=lambda x: x[1], reverse=True)

    # Láº¥y file gáº§n nháº¥t trong khoáº£ng
    latest_file, timestamp, filename = matching_files[0]

    try:
        with latest_file.open("r", encoding="utf-8") as f:
            content = f.read().strip()

        # Thá»­ parse JSON
        try:
            data = json.loads(content)
        except json.JSONDecodeError:
            # Thá»­ tÃ¬m object JSON chÃ­nh
            last_brace = content.rfind('}')
            if last_brace > 0:
                try:
                    data = json.loads(content[:last_brace + 1])
                except json.JSONDecodeError as exc:
                    raise HTTPException(status_code=400, detail=f"File {filename} khÃ´ng pháº£i JSON há»£p lá»‡: {exc}") from exc
            else:
                raise HTTPException(status_code=400, detail=f"File {filename} khÃ´ng pháº£i JSON há»£p lá»‡")
    except Exception as exc:
        raise HTTPException(status_code=500, detail=f"KhÃ´ng Ä‘á»c Ä‘Æ°á»£c file {filename}: {exc}")

    return {
        "filename": filename,
        "timestamp": int(timestamp),
        "data": data
    }

@app.post("/data/files-in-range")
def get_files_in_date_range(request: dict) -> dict:
    """
    Tráº£ vá» danh sÃ¡ch cÃ¡c file JSON cÃ³ timestamp trong khoáº£ng thá»i gian Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh
    """
    from pathlib import Path
    import re

    RESULTS_DIR = get_data_dir() / "results"

    from_timestamp = request.get("from_timestamp")
    to_timestamp = request.get("to_timestamp")

    if not from_timestamp or not to_timestamp:
        raise HTTPException(status_code=400, detail="Thiáº¿u from_timestamp hoáº·c to_timestamp")

    try:
        from_timestamp = int(from_timestamp)
        to_timestamp = int(to_timestamp)
    except ValueError:
        raise HTTPException(status_code=400, detail="Timestamp pháº£i lÃ  sá»‘ nguyÃªn")

    if not RESULTS_DIR.exists():
        raise HTTPException(status_code=404, detail=f"ThÆ° má»¥c results khÃ´ng tá»“n táº¡i: {RESULTS_DIR}")

    # Pattern Ä‘á»ƒ parse timestamp tá»« tÃªn file
    pattern = re.compile(r'all_results_(\d{8})_(\d{6})\.json$')

    # TÃ¬m táº¥t cáº£ file JSON vÃ  parse timestamp
    matching_files = []
    all_files = list(RESULTS_DIR.glob("*.json"))

    for file_path in all_files:
        match = pattern.match(file_path.name)
        if match:
            date_str, time_str = match.groups()
            try:
                from datetime import datetime
                dt = datetime.strptime(f"{date_str} {time_str}", "%Y%m%d %H%M%S")
                timestamp = dt.timestamp()

                # Kiá»ƒm tra xem timestamp cÃ³ náº±m trong khoáº£ng khÃ´ng
                if from_timestamp <= timestamp <= to_timestamp:
                    matching_files.append({
                        "filename": file_path.name,
                        "timestamp": int(timestamp),
                        "filepath": str(file_path),
                        "date_formatted": dt.strftime("%d/%m/%Y %H:%M:%S")
                    })
            except ValueError:
                continue

    # Sáº¯p xáº¿p theo timestamp giáº£m dáº§n (má»›i nháº¥t trÆ°á»›c)
    matching_files.sort(key=lambda x: x["timestamp"], reverse=True)

    return {
        "files": matching_files,
        "total_files": len(matching_files),
        "range": {
            "from_timestamp": from_timestamp,
            "to_timestamp": to_timestamp
        }
    }

--- END FILE: backend\app\api.py ---

--- START FILE: backend\app\__init__.py ---
"""
App package cho FastAPI endpoints.
"""

--- END FILE: backend\app\__init__.py ---

--- START FILE: backend\config\groups.json ---
{
  "b77da63d-af55-43c2-ab7f-364250b20e30": [
    {
      "page_id": "988098777982558",
      "url_page": "https://www.facebook.com/groups/tuyendungkisuIT"
    }
  ]
}




--- END FILE: backend\config\groups.json ---

--- START FILE: backend\config\settings.json ---
{
  "API_KEY": "0709698d-8d3b-4756-8ddb-db6e2b389442",
  "HEADLESS": false,
  "TARGET_URL": "https://facebook.com",
  "PROFILE_IDS": {
    "b77da63d-af55-43c2-ab7f-364250b20e30": {
      "cookie": "sb=acBIaQQgqAGBTmbz93PPTcnU; ps_l=1; ps_n=1; datr=acBIabhUTCuJxOkmdTYz8XW-; c_user=100044138143352; fr=1VMWQQuenYceehdsZ.AWfGfB9qmBtvmuDdeO81J0dTos4jVxL0x5pHYhV1thuLhAjmW7E.BpSUdY..AAA.0.0.BpSUeS.AWfu06UAzWOUNEhJL1ZIELO2A04; xs=44%3Aaj597WlM7O7beg%3A2%3A1766410069%3A-1%3A-1%3A%3AAcx_3Kz36a3z318o8wuDUtGUsdWuBNAFeGxishIR9g; wd=929x883;",
      "access_token": "EAAGNO4a7r2wBQbl2ozjrGQSIzSGOVgZAcoj86vjZCqZC1FCurCX5PaGbzqHdRMUFgJ6CGBhlGusZAOXm4gGxpm5q80y89Y1MNzNYOttxin0b3DhBZCCuZBLqsxjaeltCjsDBPTEP29ZAzz7oKp5Lk6yVVFZAlhBiP4p3JFcEE125EyZAPHaAEdH0JjZA3LkhtbpLWA0AZDZD",
      "fb_dtsg": "NAfu29YJvi_1RzbzZWrSlZ3JOPAtlb2YrVQWjwmitp5kE0FtpiCo0gg:44:1766410069",
      "lsd": "JxUArcF13Kgs6kRC1Z8iwU",
      "spin_r": "1031381813",
      "spin_t": "1766339451",
      "groups": [
        "https://www.facebook.com/groups/tuyendungkisuIT"
      ]
    },
    "ed3bd3bf-d906-42cf-9503-b73dfcfce117": {
      "cookie": "sb=acBIaQQgqAGBTmbz93PPTcnU; ps_l=1; ps_n=1; datr=acBIabhUTCuJxOkmdTYz8XW-; c_user=100044138143352; fr=1VMWQQuenYceehdsZ.AWfGfB9qmBtvmuDdeO81J0dTos4jVxL0x5pHYhV1thuLhAjmW7E.BpSUdY..AAA.0.0.BpSUeS.AWfu06UAzWOUNEhJL1ZIELO2A04; xs=44%3Aaj597WlM7O7beg%3A2%3A1766410069%3A-1%3A-1%3A%3AAcx_3Kz36a3z318o8wuDUtGUsdWuBNAFeGxishIR9g; wd=929x883;",
      "access_token": "EAAGNO4a7r2wBQbl2ozjrGQSIzSGOVgZAcoj86vjZCqZC1FCurCX5PaGbzqHdRMUFgJ6CGBhlGusZAOXm4gGxpm5q80y89Y1MNzNYOttxin0b3DhBZCCuZBLqsxjaeltCjsDBPTEP29ZAzz7oKp5Lk6yVVFZAlhBiP4p3JFcEE125EyZAPHaAEdH0JjZA3LkhtbpLWA0AZDZD",
      "fb_dtsg": "NAfu29YJvi_1RzbzZWrSlZ3JOPAtlb2YrVQWjwmitp5kE0FtpiCo0gg:44:1766410069",
      "lsd": "JxUArcF13Kgs6kRC1Z8iwU",
      "spin_r": "1031381813",
      "spin_t": "1766339451",
      "groups": [
        "https://www.facebook.com/groups/tuyendungkisuIT"
      ]
    }
  },
  "RUN_MINUTES": 30,
  "REST_MINUTES": 120
}

--- END FILE: backend\config\settings.json ---

--- START FILE: backend\core\account_status.py ---
from typing import Dict, Any
from pathlib import Path
import json

from core.browser import FBController


from core.paths import get_data_dir
STATUS_FILE = get_data_dir() / "account_status.json"


def check_account_status_brutal(fb: FBController) -> Dict[str, Any]:
    """
    CHECK BRUTAL MODE
    - Má»¥c tiÃªu: khÃ´ng bá» sÃ³t account lá»—i
    - Cháº¥p nháº­n false-positive nháº¹
    - KhÃ´ng tá»± dá»«ng bot, chá»‰ tráº£ vá» tráº¡ng thÃ¡i Ä‘á»ƒ caller tá»± quyáº¿t Ä‘á»‹nh.
    """

    if not fb or not getattr(fb, "page", None):
        return {
            "status": "UNKNOWN",
            "banned": True,
            "reason": "no_browser",
            "message": "âŒ KhÃ´ng cÃ³ browser/page",
        }

    page = fb.page

    try:
        url = page.url.lower()
    except Exception:
        return {
            "status": "UNKNOWN",
            "banned": True,
            "reason": "cannot_get_url",
            "message": "âŒ KhÃ´ng láº¥y Ä‘Æ°á»£c URL",
        }

    # =========================
    # 1. URL CHECK (CHáº®C NHáº¤T)
    # =========================
    HARD_URL_KEYWORDS = [
        "checkpoint",
        "disabled",
        "account_recovery",
        "confirmidentity",
        "recover",
        "login.php",
        "login/",
        "two_step_verification",
        "security_checkup",
    ]

    for k in HARD_URL_KEYWORDS:
        if k in url:
            return {
                "status": "BANNED",
                "banned": True,
                "reason": "url_detected",
                "keyword": k,
                "url": url,
                "message": f"â›” URL dÃ­nh keyword khÃ³a: {k}",
            }

    # =========================
    # 2. TITLE CHECK
    # =========================
    try:
        title = page.title().lower()
    except Exception:
        title = ""

    TITLE_KEYWORDS = [
        "log in or sign up",
        "Ä‘Äƒng nháº­p",
        "your account has been disabled",
        "account disabled",
        "confirm your identity",
        "security check",
    ]

    for k in TITLE_KEYWORDS:
        if k in title:
            return {
                "status": "BANNED",
                "banned": True,
                "reason": "title_detected",
                "keyword": k,
                "title": title,
                "message": f"â›” Title dÃ­nh keyword khÃ³a: {k}",
            }

    # =========================
    # 3. BODY TEXT SCAN (CÃ€N QUÃ‰T)
    # =========================
    try:
        body_text = page.evaluate(
            """
            () => document.body ? document.body.innerText.toLowerCase() : ""
        """
        )
    except Exception:
        body_text = ""

    TEXT_KEYWORDS = [
        "your account has been disabled",
        "account disabled",
        "weâ€™ve temporarily locked your account",
        "temporarily locked",
        "confirm your identity",
        "confirm itâ€™s you",
        "tÃ i khoáº£n cá»§a báº¡n Ä‘Ã£ bá»‹ vÃ´ hiá»‡u hÃ³a",
        "tÃ i khoáº£n bá»‹ khÃ³a",
        "tÃ i khoáº£n cá»§a báº¡n Ä‘Ã£ bá»‹ khÃ³a",
        "xÃ¡c minh danh tÃ­nh",
        "báº£o máº­t tÃ i khoáº£n",
        "security check",
        "phiÃªn Ä‘Äƒng nháº­p Ä‘Ã£ háº¿t háº¡n",
    ]

    for k in TEXT_KEYWORDS:
        if k in body_text:
            return {
                "status": "BANNED",
                "banned": True,
                "reason": "text_detected",
                "keyword": k,
                "message": f"â›” Text phÃ¡t hiá»‡n tráº¡ng thÃ¡i khÃ³a: {k}",
            }

    # =========================
    # 4. FEED / MAIN CONTENT CHECK
    # =========================
    try:
        feed = page.query_selector(
            'div[role="feed"], div[aria-label*="Feed"], div[role="main"]'
        )
    except Exception:
        feed = None

    if "facebook.com" in url and not feed:
        return {
            "status": "BANNED",
            "banned": True,
            "reason": "no_feed",
            "url": url,
            "message": "â›” KhÃ´ng tÃ¬m tháº¥y feed / main content",
        }

    # =========================
    # 5. BASIC ACTION CHECK (SESSION DIE)
    # =========================
    try:
        page.evaluate("() => document.cookie")
    except Exception:
        return {
            "status": "BANNED",
            "banned": True,
            "reason": "session_invalid",
            "message": "â›” Session/cookie khÃ´ng há»£p lá»‡",
        }

    # =========================
    # OK
    # =========================
    return {
        "status": "OK",
        "banned": False,
        "url": url,
        "message": "âœ… Account sá»‘ng, chÆ°a phÃ¡t hiá»‡n dáº¥u hiá»‡u khÃ³a",
    }


def save_account_status(profile_id: str, result: Dict[str, Any]) -> None:
    """
    LÆ°u tráº¡ng thÃ¡i account vÃ o file JSON Ä‘á»ƒ backend/frontend cÃ³ thá»ƒ Ä‘á»c.
    KhÃ´ng raise lá»—i Ä‘á»ƒ trÃ¡nh áº£nh hÆ°á»Ÿng luá»“ng chÃ­nh.
    """
    try:
        STATUS_FILE.parent.mkdir(parents=True, exist_ok=True)
        data: Dict[str, Any] = {}
        if STATUS_FILE.exists():
            try:
                with STATUS_FILE.open("r", encoding="utf-8") as f:
                    data = json.load(f) or {}
            except Exception:
                data = {}

        data[str(profile_id)] = result

        with STATUS_FILE.open("w", encoding="utf-8") as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
    except Exception:
        # KhÃ´ng Ä‘á»ƒ báº¥t ká»³ lá»—i ghi file nÃ o lÃ m vá»¡ luá»“ng chÃ­nh.
        pass






--- END FILE: backend\core\account_status.py ---

--- START FILE: backend\core\browser.py ---
import time
import random
from playwright.sync_api import sync_playwright
import json
import re
from urllib.parse import urlparse, parse_qs, unquote
import os
import sys
from core.settings import get_settings, SETTINGS_PATH
from core import control as control_state
from core.control import smart_sleep
from core.paths import get_data_dir
# ==============================================================================
# JS TOOLS & HELPER FUNCTIONS
# ==============================================================================
current_dir = os.path.dirname(os.path.abspath(__file__))
parent_dir = os.path.dirname(current_dir)
worker_path = os.path.join(parent_dir, 'worker')

if worker_path not in sys.path:
    sys.path.append(worker_path)

# Import hÃ m láº¥y thÃ´ng tin an toÃ n
try:
    from get_id import get_id_from_url
except ImportError:
    try:
        from worker.get_id import get_id_from_url
    except:
        print("âš ï¸ Cáº£nh bÃ¡o: KhÃ´ng import Ä‘Æ°á»£c worker/get_id.py")
        get_id_from_url = None


JS_EXPAND_SCRIPT = """
(node) => {
    if (!node) return 0;

    const keywords = ["Xem thÃªm", "See more"];
    let clickedCount = 0;

    // ðŸ”’ Chá»‰ tÃ¬m trong ná»™i dung bÃ i viáº¿t
    const scopes = [
        '[data-ad-preview="message"]',
        '[data-ad-rendering-role="story_message"]',
        '.userContent'
    ];

    let target = null;
    for (const sel of scopes) {
        const found = node.querySelector(sel);
        if (found) {
            target = found;
            break;
        }
    }

    if (!target) return 0;

    const buttons = Array.from(
        target.querySelectorAll('[role="button"]')
    );

    for (const btn of buttons) {
        const text = btn.innerText ? btn.innerText.trim() : "";
        if (!keywords.includes(text)) continue;

        const rect = btn.getBoundingClientRect();

        // â— Chá»‰ click náº¿u nÃºt Ä‘ang náº±m trong viewport
        if (rect.top < 0 || rect.bottom > window.innerHeight) continue;

        if (btn.offsetWidth > 0 && btn.offsetHeight > 0) {
            btn.click();
            btn.style.border = "2px solid red";
            clickedCount++;
        }
    }

    return clickedCount;
}
"""

JS_CHECK_AND_HIGHLIGHT_SCOPED = """
([node, keywords]) => { 
    if (!node || !keywords || keywords.length === 0) return false;
    
    // [Cá»°C Ká»² QUAN TRá»ŒNG] 
    // Chá»‰ Ä‘á»‹nh chÃ­nh xÃ¡c cÃ¡c selector bao bá»c ná»™i dung bÃ i viáº¿t mÃ  Sáº¿p Ä‘Ã£ cung cáº¥p.
    // Bot sáº½ chá»‰ hoáº¡t Ä‘á»™ng bÃªn trong cÃ¡c tháº» nÃ y.
    const strictSelectors = [
        '[data-ad-preview="message"]',              // Æ¯u tiÃªn 1: Chuáº©n Ads
        '[data-ad-rendering-role="story_message"]', // Æ¯u tiÃªn 2: Wrapper cá»§a message
        '.userContent'                              // Æ¯u tiÃªn 3: CÃ¡c dáº¡ng bÃ i cÅ©
    ];

    let targetScope = null;

    // 1. TÃ¬m Ä‘Ãºng cÃ¡i há»™p ná»™i dung
    for (const selector of strictSelectors) {
        const found = node.querySelector(selector);
        if (found) {
            targetScope = found;
            break;
        }
    }

    // [CHá»T CHáº¶N]
    // Náº¿u khÃ´ng tÃ¬m tháº¥y cÃ¡i há»™p ná»™i dung nÃ y -> Coi nhÆ° khÃ´ng pháº£i bÃ i viáº¿t há»£p lá»‡ -> RETURN FALSE NGAY.
    // Äiá»u nÃ y Ä‘áº£m báº£o khÃ´ng bao giá» quÃ©t nháº§m tÃªn Page hay Header bÃªn ngoÃ i.
    if (!targetScope) return false;

    // 2. Logic quÃ©t vÃ  highlight (Chá»‰ cháº¡y trong targetScope)
    const sortedKeywords = keywords.sort((a, b) => b.length - a.length);
    const pattern = new RegExp(`(${sortedKeywords.join('|')})`, 'gi');
    let foundCount = 0;

    function highlightTextNode(textNode) {
        const text = textNode.nodeValue;
        if (!pattern.test(text)) return;
        
        const fragment = document.createDocumentFragment();
        const parts = text.split(pattern);
        parts.forEach(part => {
            if (pattern.test(part)) {
                const span = document.createElement('span');
                // Style cho dá»… nhÃ¬n khi debug
                Object.assign(span.style, {
                    backgroundColor: 'yellow', color: 'red', fontWeight: 'bold',
                    border: '2px solid red', padding: '2px', zIndex: '9999'
                });
                span.innerText = part;
                fragment.appendChild(span);
                foundCount++;
            } else {
                fragment.appendChild(document.createTextNode(part));
            }
            pattern.lastIndex = 0; 
        });
        textNode.parentNode.replaceChild(fragment, textNode);
    }

    const walker = document.createTreeWalker(targetScope, NodeFilter.SHOW_TEXT, {
        acceptNode: n => {
            // Váº«n giá»¯ bá»™ lá»c tháº» rÃ¡c Ä‘á»ƒ sáº¡ch sáº½ nháº¥t cÃ³ thá»ƒ
            if (['SCRIPT', 'STYLE', 'NOSCRIPT', 'BUTTON', 'INPUT'].includes(n.parentNode.nodeName)) {
                return NodeFilter.FILTER_REJECT;
            }
            if (n.parentNode.isContentEditable) return NodeFilter.FILTER_REJECT;
            return NodeFilter.FILTER_ACCEPT;
        }
    });

    const textNodes = [];
    while (walker.nextNode()) textNodes.push(walker.currentNode);
    textNodes.forEach(highlightTextNode);
    
    return foundCount > 0;
}
"""

def extract_facebook_post_id(url: str):
    if not url: return None
    try: url = unquote(url)
    except: pass
    
    patterns = [
        r"(pfbid[A-Za-z0-9]+)", 
        r"/posts/(\d+)", 
        r"/videos/(\d+)", 
        r"/reel/(\d+)",
        r"story_fbid=(\d+)", 
        r"fbid=(\d+)",
        r"id=(\d+)"
    ]
    for p in patterns:
        m = re.search(p, url)
        if m: return m.group(1)
        
    qs = parse_qs(urlparse(url).query)
    for k in ["story_fbid", "fbid", "id"]:
        if k in qs: return qs[k][0]
    return None

def parse_graphql_payload(post_data):
    """PhÃ¢n tÃ­ch data gá»­i Ä‘i Ä‘á»ƒ tÃ¬m biáº¿n 'url'."""
    if not post_data: return None
    variables_str = None
    
    try:
        if isinstance(post_data, str):
            json_body = json.loads(post_data)
        else:
            json_body = post_data
        variables_str = json.dumps(json_body.get("variables", {}))
    except:
        try:
            qs = parse_qs(post_data)
            if "variables" in qs:
                variables_str = qs["variables"][0]
        except: pass

    if variables_str and '"url":' in variables_str:
        match = re.search(r'"url"\s*:\s*"([^"]+)"', variables_str)
        if match:
            raw_url = match.group(1)
            return raw_url.replace(r"\/", "/")
            
    return None


class FBController:
    def __init__(self, ws_url):
        self.ws_url = ws_url
        self.browser = None
        self.page = None
        self.play = None
        self.profile_id = "unknown"
        # keyword filter thÃªm tá»« UI (Setting profile -> QuÃ©t bÃ i viáº¿t)
        # náº¿u rá»—ng => chá»‰ lá»c theo job_keywords máº·c Ä‘á»‹nh
        self.user_keywords = []
        cfg = get_settings()
        self.all_profile_ids = cfg.profile_ids
        # Chá»‰ báº¯t URL payload tá»« request
        self.captured_payload_url = None
        
        self.job_keywords = [
            "tuyá»ƒn dá»¥ng", "tuyá»ƒn nhÃ¢n viÃªn", "tuyá»ƒn gáº¥p", "viá»‡c lÃ m", "tuyá»ƒn",
            "lÆ°Æ¡ng", "phá»ng váº¥n", "há»“ sÆ¡",
            "full-time", "part-time", "thá»±c táº­p", "káº¿ toÃ¡n", "may máº·c", "kcn" ,"á»¨ng viÃªn " , "á»¨ng tuyá»ƒn"
        ]
        # cache nháº¹ Ä‘á»ƒ trÃ¡nh spam IO khi check control liÃªn tá»¥c
        self._last_control_check_ts = 0.0
        self._last_control_snapshot = (False, False, "")

    def control_checkpoint(self, where: str = "") -> None:
        """
        Æ¯u tiÃªn flag theo spec:
          1) GLOBAL_EMERGENCY_STOP -> STOP NGAY
          2) GLOBAL_PAUSE -> SLEEP
          3) PAUSED_PROFILES[pid] -> SLEEP
        """
        now = time.time()
        if now - float(getattr(self, "_last_control_check_ts", 0.0)) > 0.35:
            self._last_control_check_ts = now
            self._last_control_snapshot = control_state.check_flags(getattr(self, "profile_id", None))

        stop, paused, reason = self._last_control_snapshot

        if stop:
            try:
                control_state.set_profile_state(self.profile_id, "STOPPED")
            except Exception:
                pass
            print(f"ðŸ›‘ [STOP] {self.profile_id} @ {where} ({reason})")
            raise RuntimeError("EMERGENCY_STOP")

        if paused:
            try:
                control_state.set_profile_state(self.profile_id, "PAUSED")
            except Exception:
                pass
            if where:
                print(f"â¸ï¸ [PAUSE] {self.profile_id} @ {where} ({reason})")
            # chá» Ä‘áº¿n khi háº¿t pause hoáº·c emergency stop
            control_state.wait_if_paused(self.profile_id, sleep_seconds=0.5)
            try:
                control_state.set_profile_state(self.profile_id, "RUNNING")
            except Exception:
                pass

    def connect(self):
        self.play = sync_playwright().start()
        self.browser = self.play.chromium.connect_over_cdp(self.ws_url)
        context = self.browser.contexts[0]
        self.page = context.pages[0]
        
        self.start_network_sniffer()
        
        try:
            viewport = self.page.viewport_size
            self.page.mouse.click(viewport['width']/2, viewport['height']/2)
        except: pass

    def goto(self, url):
        self.page.goto(url, timeout=0)

    # ===================== [CORE] NETWORK SNIFFER =====================
    def start_network_sniffer(self):
        print("ðŸ›°  ÄÃ£ kÃ­ch hoáº¡t Sniffer: Cháº¿ Ä‘á»™ báº¯t Payload URL...")

        # Báº®T URL Tá»ª REQUEST (chá»‰ báº¯t URL cÃ³ chá»©a "share")
        def on_request(request):
            if "facebook.com/api/graphql" in request.url and request.method == "POST":
                try:
                    raw_url = parse_graphql_payload(request.post_data)
                    if raw_url:
                        # Chá»‰ lÆ°u náº¿u URL cÃ³ chá»©a "share" (vÃ­ dá»¥: https://www.facebook.com/share/p/1HYNUE6FzL/)
                        if "/share/" in raw_url:
                            self.captured_payload_url = raw_url
                            print(f"ðŸ”— [DEBUG] Báº¯t Ä‘Æ°á»£c Share URL: {raw_url}")
                except: pass

        self.page.on("request", on_request)

    # ===================== SHARE & CHá»œ ID (LOGIC Má»šI) =====================
    def share_center_ad(self, post_handle, post_type):
            
        try:
            self.control_checkpoint("before_share")
            viewport = self.page.viewport_size
            height = viewport['height'] if viewport else 800
            escape_step = height * 0.35  # ðŸ‘ˆ THOÃT MODULE RÃC
            print("ðŸš€ Share â†’ báº¯t Payload URL â†’ gá»i get_id_from_url")

            self.captured_payload_url = None

            share_btn = post_handle.query_selector(
                'xpath=.//div[@data-ad-rendering-role="share_button"]/ancestor::div[@role="button"]'
            )
            if not share_btn:
                print("âš ï¸ KhÃ´ng tÃ¬m tháº¥y nÃºt Share")
                self.scroll_past_post(post_handle)
                time.sleep(random.uniform(0.12, 0.13))
                return False

            self.bring_element_into_view_smooth(share_btn)
            self.page.wait_for_timeout(300)
            share_btn.click()

            # Äá»£i báº¯t Ä‘Æ°á»£c payload URL
            for _ in range(50):
                self.control_checkpoint("after_share_click_wait_payload")
                if self.captured_payload_url:
                    # Gá»i get_id_from_url trá»±c tiáº¿p tá»« URL payload
                    if get_id_from_url:
                        try:
                            self.control_checkpoint("before_get_id_from_url")
                            print(f"ðŸ“¥ Äang gá»i get_id_from_url vá»›i URL: {self.captured_payload_url}")
                            details = get_id_from_url(self.captured_payload_url, self.profile_id)
                            if details and details.get("post_id"):
                                self.save_post_id_from_details(details, post_type)
                                self.page.keyboard.press("Escape")
                                return True
                            else:
                                print("âš ï¸ KhÃ´ng láº¥y Ä‘Æ°á»£c post_id tá»« get_id_from_url")
                        except Exception as e:
                            # KhÃ´ng Ä‘Æ°á»£c nuá»‘t STOP/PAUSE
                            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                                raise
                            print(f"âŒ Lá»—i khi gá»i get_id_from_url: {e}")
                    break
                self.page.wait_for_timeout(150)

            print("âš ï¸ KhÃ´ng láº¥y Ä‘Æ°á»£c Payload URL")
            self.page.keyboard.press("Escape")
            return False

        except Exception as e:
            # KhÃ´ng Ä‘Æ°á»£c nuá»‘t STOP/PAUSE
            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                raise
            print(f"âŒ share_center_ad lá»—i: {e}")
            self.page.keyboard.press("Escape")
            return False

    # ===================== CÃC HÃ€M KHÃC GIá»® NGUYÃŠN =====================
    def save_post_id_from_details(self, details, post_type):
        """
        LÆ°u post tá»« dict details tráº£ vá» tá»« get_id_from_url
        details chá»©a: post_id, owning_profile, post_text
        """
        try:
            post_id = details.get("post_id")
            if not post_id:
                print("âš ï¸ KhÃ´ng cÃ³ post_id trong details")
                return False
                
            folder = get_data_dir() / "post_ids"
            folder.mkdir(parents=True, exist_ok=True)
            filepath = folder / f"{self.profile_id}.json"

            data = []
            if filepath.exists():
                try:
                    with filepath.open("r", encoding="utf8") as f:
                        data = json.load(f)
                except:
                    data = []

            # 1. TrÃ¡nh trÃ¹ng ID (Check cáº£ format cÅ© post_id vÃ  má»›i id)
            for item in data:
                existing_id = item.get("id") or item.get("post_id")
                if existing_id == post_id:
                    print(f"ðŸ” ID {post_id} Ä‘Ã£ tá»“n táº¡i -> bá» qua.")
                    return False

            # 2. Format dá»¯ liá»‡u JSON theo yÃªu cáº§u
            # Map flag: green -> xanh, yellow -> vÃ ng
            flag_vn = "xanh" if post_type == "green" else "vÃ ng" if post_type == "yellow" else post_type
            
            # Láº¥y thÃ´ng tin tá»« káº¿t quáº£ worker tráº£ vá»
            post_text = details.get("post_text", "")
            owning_profile = details.get("owning_profile", {})

            record = {
                "id": post_id,
                "flag": flag_vn,
                "text": post_text,
                "owning_profile": owning_profile
            }

            data.append(record)

            with filepath.open("w", encoding="utf8") as f:
                json.dump(data, f, indent=2, ensure_ascii=False)

            print(f"ðŸ’¾ ÄÃ£ lÆ°u Post {post_id} | Chá»§ bÃ i: {owning_profile.get('name', 'N/A')}")
            
            return True
        except Exception as e:
            print(f"âŒ Lá»—i save_post_id_from_details: {e}")
            return False


    def scan_while_scrolling(self):
        try:
            viewport = self.page.viewport_size
            height = viewport['height'] if viewport else 800

            normal_step = height * 0.12
            escape_step = height * 0.35  # ðŸ‘ˆ THOÃT MODULE RÃC

            print("â¬‡ï¸ Scan theo center-post (LOCK khi tháº¥y xanh)")

            while True:
                self.control_checkpoint("before_scroll_loop")
                post = self.get_center_post()

                # =========================
                # âŒ KHÃ”NG PHáº¢I POST â†’ THOÃT NGAY
                # =========================
                if not post:
                    # Ä‘ang Ä‘á»©ng trÃªn ref / káº¿t báº¡n / module rÃ¡c
                    self.control_checkpoint("before_escape_wheel")
                    self.smooth_scroll(escape_step)
                    # Äá»£i má»™t chÃºt Ä‘á»ƒ trang render láº¡i sau khi scroll
                    time.sleep(random.uniform(0.12, 0.15))
                    continue

                # =========================
                # POST ÄÃƒ Xá»¬ LÃ â†’ Äáº¨Y RA KHá»ŽI VIEW
                # =========================
                if self.check_post_is_processed(post):
                    try:
                        self.control_checkpoint("before_normal_wheel")
                        self.smooth_scroll(normal_step)
                        # Äá»£i má»™t chÃºt Ä‘á»ƒ trang render láº¡i sau khi scroll
                        time.sleep(random.uniform(0.08, 0.12))
                    except Exception as e:
                        error_msg = str(e).lower()
                        if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                            raise RuntimeError("BROWSER_CLOSED") from e
                        raise
                    continue

                # =========================
                # LOCK POST Há»¢P Lá»†
                # =========================
                is_ad = self.check_current_post_is_ad(post)

                if is_ad:
                    print("ðŸŸ¥ ADS detected (center-post)")
                    return post, "green"
                else:
                    print("ðŸŸ¨ BÃ i thÆ°á»ng detected (center-post)")
                    return post, "yellow"

        except Exception as e:
            error_msg = str(e).lower()
            # Náº¿u browser/page Ä‘Ã£ bá»‹ Ä‘Ã³ng thÃ¬ raise exception Ä‘áº·c biá»‡t Ä‘á»ƒ bot dá»«ng
            if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                print(f"ðŸ›‘ Browser Ä‘Ã£ bá»‹ Ä‘Ã³ng trong scan_while_scrolling -> Raise exception")
                raise RuntimeError("BROWSER_CLOSED") from e
            print(f"âš ï¸ Lá»—i scan: {e}")
            return None, None

    def like_current_post(self, post_handle):
        print("â¤ï¸ Äang thá»±c hiá»‡n Like bÃ i viáº¿t nÃ y...")
        try:
            self.control_checkpoint("before_like")
            element = post_handle.as_element()
            if not element: return False
            already_liked = element.query_selector('div[role="button"][aria-label="Gá»¡ ThÃ­ch"], div[role="button"][aria-label="Remove Like"]')
            if already_liked:
                print("âš ï¸ BÃ i nÃ y Ä‘Ã£ Like rá»“i -> Bá» qua.")
                return False
            
            # Like theo xÃ¡c suáº¥t Ä‘á»ƒ Ä‘áº£m báº£o khoáº£ng cÃ¡ch 45-90 giÃ¢y giá»¯a cÃ¡c láº§n like:
            # - Vá»›i nghá»‰ 12-20s sau má»—i bÃ i, Ä‘á»ƒ cÃ³ khoáº£ng cÃ¡ch 45-90s cáº§n like 20-30% bÃ i
            # - Sau Ä‘Ã³ roll Ä‘á»ƒ quyáº¿t Ä‘á»‹nh cÃ³ Like hay khÃ´ng
            p = random.uniform(0.3, 0.4)
            roll = random.random()
            should_like = roll < p
            print(f"ðŸŽ² [LikeProb] p={p:.2f} roll={roll:.2f} -> {'LIKE' if should_like else 'SKIP'}")
            
            if not should_like:
                print("â­ï¸ Skip Like theo xÃ¡c suáº¥t random")
                return False
            
            selector = 'div[role="button"][aria-label="ThÃ­ch"], div[role="button"][aria-label="Like"]'
            like_btn = element.query_selector(selector)
            if like_btn:
                self.bring_element_into_view_smooth(like_btn)
                smart_sleep(0.5, self.profile_id)
                self.control_checkpoint("before_like_click")
                like_btn.click()
                self.control_checkpoint("after_like_click")
                print("âœ… ÄÃ£ Báº¥m Like thÃ nh cÃ´ng!")
                return True
            else:
                print("âš ï¸ KhÃ´ng tÃ¬m tháº¥y nÃºt Like phÃ¹ há»£p.")
                return False
        except Exception as e:
            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                raise
            print(f"âŒ Lá»—i Like: {e}")
            return False

    


    def get_center_post(self):
        try:
            return self.page.evaluate_handle("""
                () => {
                    const x = window.innerWidth / 2;
                    const y = window.innerHeight * 0.45;
                    const el = document.elementFromPoint(x, y);
                    if (!el) return null;

                    // =========================
                    // 1. CHECK CONTEXT: SEARCH PAGE?
                    // =========================
                    const isSearchPage = !!document.querySelector(
                        'h1, span'
                    ) && [...document.querySelectorAll('h1, span')]
                        .some(e => e.innerText?.trim() === 'Káº¿t quáº£ tÃ¬m kiáº¿m');

                    // =========================
                    // 2. CHá»ŒN CONTAINER PHÃ™ Há»¢P
                    // =========================
                    const POST_SELECTOR = isSearchPage
                        ? 'div.x78zum5.xdt5ytf'   // search page
                        : 'div.x1lliihq';         // home / feed

                    let cur = el.closest(POST_SELECTOR);

                    while (cur) {
                        // âœ… PHáº¢I CÃ“ LIKE BUTTON â†’ má»›i lÃ  post tháº­t
                        const hasLike = cur.querySelector(
                            'div[aria-label="ThÃ­ch"], div[aria-label="Like"],' +
                            'div[aria-label="Gá»¡ ThÃ­ch"], div[aria-label="Remove Like"]'
                        );

                        if (hasLike) {
                            cur.style.outline = "4px solid #00ff00";
                            cur.setAttribute('data-center-post', 'true'); // ðŸ”’ MARK
                            return cur;
                        }

                        cur = cur.parentElement?.closest(POST_SELECTOR);
                    }

                    return null;
                }
            """)
        except:
            return None

    def check_current_post_is_ad(self, post_handle):
        if not post_handle or not post_handle.as_element(): return False
        return post_handle.evaluate("""
            (post) => {
                if (post.getAttribute('data-bot-processed') === 'true') return false;
                const checkAnchors = (element) => {
                    if (!element) return false;
                    const anchors = Array.from(element.querySelectorAll('a[href*="__cft__"]'));
                    for (const a of anchors) {
                        const href = a.getAttribute('href');
                        if (!href) continue;
                        if (href.includes('__tn__')) continue;
                        let m = href.match(/__cft__\\[0\\]=([^&#]+)/) || href.match(/__cft__%5B0%5D=([^&#]+)/);
                        if (m && m[1]) return true; 
                    }
                    return false;
                };
                if (checkAnchors(post)) { post.style.outline = "5px solid red"; return true; }
                if (post.parentElement && checkAnchors(post.parentElement)) { post.style.outline = "5px solid red"; return true; }
                if (post.parentElement && post.parentElement.parentElement && checkAnchors(post.parentElement.parentElement)) { post.style.outline = "5px solid red"; return true; }
                return false;
            }
        """)

    def mark_post_as_processed(self, post_handle):
        try:
            post_handle.evaluate("""(post) => {
                post.setAttribute('data-bot-processed', 'true');
                post.style.outline = "5px solid gray"; 
                post.style.opacity = "0.7";
            }""")
            print("ðŸ ÄÃ£ Ä‘Ã¡nh dáº¥u bÃ i viáº¿t: DONE.")
        except: pass
        
    def save_cookies(self):
        """
        Láº¥y cookie tá»« browser context vÃ  lÆ°u tháº³ng vÃ o:
        backend/config/settings.json -> PROFILE_IDS[profile_id]["cookie"]
        Tráº£ vá» cookie_string.
        """
        try:
            print("ðŸª Äang trÃ­ch xuáº¥t Cookie (Key=ID, Value=String)...")
            
            # 1. Láº¥y toÃ n bá»™ cookies
            all_cookies = self.page.context.cookies()
            if not all_cookies:
                print("âš ï¸ ChÆ°a Ä‘Äƒng nháº­p.")
                return None

            # 2. Danh sÃ¡ch cÃ¡c trÆ°á»ng cáº§n láº¥y (ÄÃºng thá»© tá»± Sáº¿p gá»­i)
            target_keys = [
                "sb", "ps_l", "ps_n", "datr", "c_user", 
                "ar_debug", "fr", "xs", "wd"
            ]
            
            # Táº¡o map Ä‘á»ƒ tra cá»©u
            cookie_map = {c['name']: c['value'] for c in all_cookies}
            
            # 3. GhÃ©p chuá»—i string
            cookie_parts = []
            for key in target_keys:
                if key in cookie_map:
                    cookie_parts.append(f"{key}={cookie_map[key]}")
            
            # Táº¡o chuá»—i káº¿t quáº£ (náº¿u cÃ³ dá»¯ liá»‡u)
            if cookie_parts:
                cookie_string = "; ".join(cookie_parts) + ";"
            else:
                cookie_string = ""

            # 4. LÆ°u vÃ o settings.json theo Ä‘Ãºng profile_id
            try:
                if not SETTINGS_PATH.exists():
                    print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y settings.json: {SETTINGS_PATH}")
                    return cookie_string

                with SETTINGS_PATH.open("r", encoding="utf-8") as f:
                    raw = json.load(f)

                if not isinstance(raw, dict):
                    raw = {}

                profiles = raw.get("PROFILE_IDS")
                if profiles is None or isinstance(profiles, (list, str)):
                    profiles = {}
                if not isinstance(profiles, dict):
                    profiles = {}

                pid = str(self.profile_id or "").strip()
                if not pid:
                    print("âš ï¸ profile_id rá»—ng, khÃ´ng ghi vÃ o settings.json")
                    return cookie_string

                cfg = profiles.get(pid)
                if not isinstance(cfg, dict):
                    cfg = {}
                cfg["cookie"] = cookie_string
                profiles[pid] = cfg
                raw["PROFILE_IDS"] = profiles

                # ghi file
                with SETTINGS_PATH.open("w", encoding="utf-8") as f:
                    json.dump(raw, f, indent=2, ensure_ascii=False)
                    f.write("\n")

                print(f"âœ… ÄÃ£ cáº­p nháº­t cookie vÃ o settings.json cho profile_id={pid}")
            except Exception as e:
                print(f"âš ï¸ KhÃ´ng ghi Ä‘Æ°á»£c cookie vÃ o settings.json: {e}")

            return cookie_string
            
        except Exception as e:
            print(f"âŒ Lá»—i lÆ°u cookies: {e}")
            return None
        
    def process_post(self, post_handle, post_type):
        """
        post_type: 'green' (ads) | 'yellow' (normal)
        """
        viewport = self.page.viewport_size
        if viewport: height = viewport['height']
        else: height = 800 
        try:
            self.control_checkpoint("before_process_post")
            print(f"ðŸ§  Xá»­ lÃ½ bÃ i viáº¿t type={post_type}")

            # 1. Expand ná»™i dung
            expanded = self.page.evaluate(JS_EXPAND_SCRIPT, post_handle)
            if expanded > 0:
                print(f"ðŸ“– ÄÃ£ má»Ÿ {expanded} 'Xem thÃªm'")
                smart_sleep(1.2, self.profile_id)

            # 2. Check keyword (chung cho cáº£ ads & thÆ°á»ng)
            has_keyword = self.page.evaluate(
                JS_CHECK_AND_HIGHLIGHT_SCOPED,
                [post_handle, self.job_keywords]
            )

            if not has_keyword:
                print("âŒ KhÃ´ng cÃ³ keyword -> skip bÃ i")

                # 1. ÄÃ¡nh dáº¥u Ä‘Ã£ xá»­ lÃ½
                self.mark_post_as_processed(post_handle)

                # 2. ðŸš¨ Äáº¨Y POST RA KHá»ŽI VIEWPORT (QUAN TRá»ŒNG)
                try:
                    viewport = self.page.viewport_size
                    height = viewport['height'] if viewport else 800
                    self.smooth_scroll(height * 0.4)
                except Exception as e:
                    error_msg = str(e).lower()
                    if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                        raise RuntimeError("BROWSER_CLOSED") from e
                    pass

                return False

            print("âœ… CÃ³ keyword")

            # 2b. Náº¿u user nháº­p text (Setting profile -> QuÃ©t bÃ i viáº¿t) thÃ¬ báº¯t buá»™c
            # bÃ i pháº£i cÃ³ Ã­t nháº¥t 1 trong cÃ¡c tá»«/cá»¥m tá»« Ä‘Ã³ (lá»c giá»‘ng NuÃ´i acc).
            if getattr(self, "user_keywords", None):
                try:
                    has_user_text = self.page.evaluate(
                        JS_CHECK_AND_HIGHLIGHT_SCOPED,
                        [post_handle, self.user_keywords]
                    )
                except Exception:
                    has_user_text = False
                if not has_user_text:
                    print("âŒ KhÃ´ng Ä‘áº¡t text nháº­p -> skip bÃ i")

                    # ÄÃ¡nh dáº¥u Ä‘Ã£ xá»­ lÃ½ + Ä‘áº©y ra khá»i view
                    self.mark_post_as_processed(post_handle)
                    try:
                        viewport = self.page.viewport_size
                        height = viewport['height'] if viewport else 800
                        self.smooth_scroll(height * 0.4)
                    except Exception as e:
                        error_msg = str(e).lower()
                        if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                            raise RuntimeError("BROWSER_CLOSED") from e
                        pass
                    return False

            # 3. Like
            self.like_current_post(post_handle)
            self.control_checkpoint("after_like")

            # 4. Share Ä‘á»ƒ báº¯t ID
            ok = self.share_center_ad(post_handle, post_type)
            self.control_checkpoint("after_share")
            
            # Náº¿u share_center_ad return False, Ä‘á»£i thÃªm má»™t chÃºt vÃ  kiá»ƒm tra láº¡i URL
            # (vÃ¬ URL cÃ³ thá»ƒ Ä‘Æ°á»£c báº¯t báº¥t Ä‘á»“ng bá»™ sau khi hÃ m Ä‘Ã£ return)
            if not ok:
                print("â³ Äá»£i thÃªm 2 giÃ¢y Ä‘á»ƒ kiá»ƒm tra láº¡i URL...")
                for _ in range(20):  # 20 láº§n x 0.1s = 2 giÃ¢y
                    self.control_checkpoint("wait_for_url_after_share")
                    if self.captured_payload_url:
                        print(f"âœ… PhÃ¡t hiá»‡n URL sau khi share_center_ad return: {self.captured_payload_url}")
                        if get_id_from_url:
                            try:
                                print(f"ðŸ“¥ Äang gá»i get_id_from_url vá»›i URL: {self.captured_payload_url}")
                                details = get_id_from_url(self.captured_payload_url, self.profile_id)
                                if details and details.get("post_id"):
                                    self.save_post_id_from_details(details, post_type)
                                    # Äáº£m báº£o Ä‘Ã³ng modal náº¿u chÆ°a Ä‘Ã³ng
                                    try:
                                        self.page.keyboard.press("Escape")
                                    except:
                                        pass
                                    ok = True
                                    break
                                else:
                                    print("âš ï¸ KhÃ´ng láº¥y Ä‘Æ°á»£c post_id tá»« get_id_from_url")
                            except Exception as e:
                                if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                                    raise
                                print(f"âŒ Lá»—i khi gá»i get_id_from_url: {e}")
                        else:
                            print("âš ï¸ get_id_from_url khÃ´ng kháº£ dá»¥ng (import failed)")
                    self.page.wait_for_timeout(100)
                
                if not ok:
                    self.mark_post_as_processed(post_handle)
                    print("âš ï¸ KhÃ´ng báº¯t Ä‘Æ°á»£c ID -> skip")
                    return False
            # 5. LÆ°u ID + flag

            # 6. Mark processed
            self.mark_post_as_processed(post_handle)
            

            return True

        except Exception as e:
            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                raise
            print(f"âŒ Lá»—i process_post: {e}")
            return False

    def check_post_is_processed(self, post_handle):
        """Kiá»ƒm tra attribute data-bot-processed Ä‘á»ƒ trÃ¡nh quÃ©t láº¡i"""
        try:
            return post_handle.evaluate("(post) => post.getAttribute('data-bot-processed') === 'true'")
        except:
            return False
    
    def smooth_scroll(self, distance):
        """
        Cuá»™n mÆ°á»£t mÃ  vá»›i nhiá»u step nhá» Ä‘á»ƒ giá»‘ng ngÆ°á»i dÃ¹ng tháº­t.
        - Chia thÃ nh 15-25 step ngáº«u nhiÃªn
        - Má»—i step nghá»‰ 0.01-0.05s
        """
        try:
            num_steps = random.randint(15, 25)
            step_distance = distance / num_steps
            
            for _ in range(num_steps):
                self.page.mouse.wheel(0, step_distance)
                sleep_time = random.uniform(0.01, 0.03)
                self.page.wait_for_timeout(int(sleep_time * 1000))
        except Exception as e:
            # Fallback: scroll má»™t láº§n náº¿u lá»—i
            try:
                self.page.mouse.wheel(0, distance)
            except:
                pass
    
    def bring_element_into_view_smooth(self, element):
        """
        Kiá»ƒm tra element (nÃºt Share) cÃ³ trong mÃ n hÃ¬nh khÃ´ng.
        Náº¿u khÃ´ng, cuá»™n chuá»™t nháº¹ nhÃ ng tá»›i nÃ³ (KhÃ´ng dÃ¹ng scroll_into_view gÃ¢y giáº­t).
        """
        try:
            box = element.bounding_box()
            if not box: return False # Element chÆ°a render

            viewport = self.page.viewport_size
            vh = None
            try:
                if viewport and isinstance(viewport, dict):
                    vh = viewport.get('height')
            except Exception:
                vh = None

            # Fallback: Ä‘Ã´i khi connect qua CDP => viewport_size = None
            if not vh:
                try:
                    vh = self.page.evaluate("() => window.innerHeight") or 800
                except Exception:
                    vh = 800
            
            # Tá»a Ä‘á»™ Y cá»§a element so vá»›i Ä‘á»‰nh mÃ n hÃ¬nh hiá»‡n táº¡i
            element_y = box['y']
            element_height = box['height']

            # Kiá»ƒm tra: NÃºt cÃ³ náº±m lá»t thá»m trong mÃ n hÃ¬nh khÃ´ng?
            # (Cho phÃ©p lá» trÃªn 100px, lá» dÆ°á»›i 100px Ä‘á»ƒ cháº¯c cháº¯n click Ä‘Æ°á»£c)
            is_in_view = (element_y > 100) and (element_y + element_height < vh - 100)

            if is_in_view:
                return True # Äang Ä‘áº¹p rá»“i, khÃ´ng cáº§n cuá»™n

            # Náº¿u nÃºt náº±m dÆ°á»›i Ä‘Ã¡y mÃ n hÃ¬nh -> Cáº§n cuá»™n xuá»‘ng
            if element_y > vh - 100:
                # TÃ­nh khoáº£ng cÃ¡ch cáº§n cuá»™n: ÄÆ°a nÃºt lÃªn vá»‹ trÃ­ khoáº£ng 70% mÃ n hÃ¬nh
                scroll_distance = element_y - (vh * 0.7)
                print(f"    -> ðŸ”½ NÃºt Share bá»‹ che, cuá»™n xuá»‘ng {int(scroll_distance)}px")
                
                # Cuá»™n mÆ°á»£t
                self.smooth_scroll(scroll_distance)
                return True
            
            return True
        except Exception as e:
            # Log nháº¹ Ä‘á»ƒ khÃ´ng spam, lá»—i thÆ°á»ng do viewport null / element detach
            print(f"âš ï¸ Lá»—i tÃ­nh toÃ¡n cuá»™n: {e}")
            return False

    def scroll_past_post(self, post_handle):
        """
        Cuá»™n qua bÃ i viáº¿t hiá»‡n táº¡i má»™t cÃ¡ch thÃ´ng minh.
        - BÃ i ngáº¯n: Cuá»™n Ã­t.
        - BÃ i dÃ i: Cuá»™n nhiá»u.
        -> TrÃ¡nh viá»‡c dÃ¹ng PageDown bá»‹ trÃ´i bÃ i.
        """
        try:
            box = post_handle.bounding_box()
            if not box:
                # Fallback náº¿u khÃ´ng láº¥y Ä‘Æ°á»£c kÃ­ch thÆ°á»›c -> DÃ¹ng PageDown
                self.page.keyboard.press("PageDown")
                return

            post_height = box['height']
            post_y = box['y']
            
            # Chiáº¿n thuáº­t: Cuá»™n sao cho ÄÃY bÃ i viáº¿t hiá»‡n táº¡i trÃ´i lÃªn mÃ©p trÃªn mÃ n hÃ¬nh
            # Cá»™ng thÃªm 50px padding Ä‘á»ƒ tÃ¡ch biá»‡t bÃ i sau
            scroll_distance = post_y + post_height + 50
            
            # Cuá»™n mÆ°á»£t vá»›i nhiá»u step
            self.smooth_scroll(scroll_distance)
                
            print(f"    -> ðŸ“‰ ÄÃ£ cuá»™n qua bÃ i (height={int(post_height)}px)")

        except Exception as e:
            print(f"âš ï¸ Lá»—i scroll_past_post: {e}")
            self.page.keyboard.press("PageDown")
--- END FILE: backend\core\browser.py ---

--- START FILE: backend\core\control.py ---
import json
import threading
import time
from dataclasses import dataclass
from datetime import datetime, timezone
from pathlib import Path
from typing import Any, Dict, Optional, Tuple

from core.paths import get_data_dir

# Thay vÃ¬ tá»± tÃ­nh path, hÃ£y dÃ¹ng hÃ m chuáº©n
CONTROL_STATE_PATH = get_data_dir() / "runtime_control.json"



_lock = threading.Lock()


def _now_iso() -> str:
    return datetime.now(timezone.utc).isoformat()


def _atomic_write_json(path: Path, data: Dict[str, Any]) -> None:
    path.parent.mkdir(parents=True, exist_ok=True)
    tmp = path.with_suffix(".tmp")
    with tmp.open("w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
        f.write("\n")
    tmp.replace(path)


def _default_state() -> Dict[str, Any]:
    return {
        "global_emergency_stop": False,
        "global_pause": False,
        "paused_profiles": [],
        "stopped_profiles": [],  # STOP theo profile (dá»«ng ngay profile Ä‘Ã³)
        "profile_states": {},  # {profile_id: RUNNING|PAUSED|STOPPED|ERROR}
        "updated_at": _now_iso(),
    }


def load_state() -> Dict[str, Any]:
    """
    Äá»c state tá»« file runtime_control.json.
    Best-effort: náº¿u file lá»—i/khÃ´ng tá»“n táº¡i -> tráº£ default.
    """
    try:
        if not CONTROL_STATE_PATH.exists():
            return _default_state()
        with CONTROL_STATE_PATH.open("r", encoding="utf-8") as f:
            raw = json.load(f)
        if not isinstance(raw, dict):
            return _default_state()
        # Merge default keys Ä‘á»ƒ trÃ¡nh thiáº¿u field
        base = _default_state()
        base.update(raw)
        # normalize
        if not isinstance(base.get("paused_profiles"), list):
            base["paused_profiles"] = []
        if not isinstance(base.get("stopped_profiles"), list):
            base["stopped_profiles"] = []
        if not isinstance(base.get("profile_states"), dict):
            base["profile_states"] = {}
        base["updated_at"] = _now_iso()
        return base
    except Exception:
        return _default_state()


def save_state(state: Dict[str, Any]) -> None:
    state = dict(state or {})
    state.setdefault("paused_profiles", [])
    state.setdefault("stopped_profiles", [])
    state.setdefault("profile_states", {})
    state["updated_at"] = _now_iso()
    _atomic_write_json(CONTROL_STATE_PATH, state)


def get_state() -> Dict[str, Any]:
    with _lock:
        return load_state()


def _update(mutator) -> Dict[str, Any]:
    with _lock:
        st = load_state()
        mutator(st)
        save_state(st)
        return st


def reset_all_state() -> Dict[str, Any]:
    """
    Reset toÃ n bá»™ runtime state vá» máº·c Ä‘á»‹nh (Sáº´N SÃ€NG).
    DÃ¹ng cho STOP kiá»ƒu "fresh start".
    """
    def _m(st: Dict[str, Any]) -> None:
        st.clear()
        st.update(_default_state())
    return _update(_m)


def set_global_emergency_stop(value: bool) -> Dict[str, Any]:
    def _m(st: Dict[str, Any]) -> None:
        st["global_emergency_stop"] = bool(value)
        if value:
            # Khi STOP ALL: clear pause + Ä‘Æ°a táº¥t cáº£ profile_states vá» STOPPED Ä‘á»ƒ trÃ¡nh "RUNNING" rÃ¡c
            st["global_pause"] = False
            st["paused_profiles"] = []
            ps = st.get("profile_states")
            if not isinstance(ps, dict):
                ps = {}
            for k in list(ps.keys()):
                ps[k] = "STOPPED"
            st["profile_states"] = ps

    return _update(_m)


def set_global_pause(value: bool) -> Dict[str, Any]:
    def _m(st: Dict[str, Any]) -> None:
        st["global_pause"] = bool(value)

    return _update(_m)


def reset_emergency_stop(*, clear_stopped_profiles: bool = False) -> Dict[str, Any]:
    """
    Reset GLOBAL_EMERGENCY_STOP vá» false Ä‘á»ƒ há»‡ thá»‘ng cháº¡y láº¡i Ä‘Æ°á»£c.
    Optionally clear stopped_profiles (Ä‘á»ƒ profile khÃ´ng bá»‹ giá»¯ STOPPED).
    """
    def _m(st: Dict[str, Any]) -> None:
        st["global_emergency_stop"] = False
        if clear_stopped_profiles:
            st["stopped_profiles"] = []
            # khÃ´ng force Ä‘á»•i profile_states náº¿u caller muá»‘n giá»¯ audit;
            # nhÆ°ng náº¿u Ä‘ang STOPPED mÃ  clear_stopped_profiles thÃ¬ set RUNNING Ä‘á»ƒ dá»… hiá»ƒu.
            ps = st.get("profile_states")
            if isinstance(ps, dict):
                for k in list(ps.keys()):
                    if str(ps.get(k) or "").upper() == "STOPPED":
                        ps[k] = "RUNNING"

    return _update(_m)


def pause_profile(profile_id: str) -> Dict[str, Any]:
    pid = str(profile_id or "").strip()
    if not pid:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        paused = set([str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()])
        paused.add(pid)
        st["paused_profiles"] = sorted(paused)
        # pause khÃ´ng tá»± clear STOP; náº¿u Ä‘ang STOP thÃ¬ váº«n STOP
        # state chá»‰ lÃ  "Ä‘á»‹nh danh", process tháº­t sá»± sáº½ tá»± update theo loop
        st.setdefault("profile_states", {})
        st["profile_states"][pid] = "PAUSED"

    return _update(_m)


def resume_profile(profile_id: str) -> Dict[str, Any]:
    pid = str(profile_id or "").strip()
    if not pid:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        paused = [str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()]
        paused = [x for x in paused if x != pid]
        st["paused_profiles"] = paused
        # resume sáº½ clear STOP theo profile (Ä‘á»ƒ cháº¡y láº¡i Ä‘Æ°á»£c)
        stopped = [str(x).strip() for x in (st.get("stopped_profiles") or []) if str(x).strip()]
        stopped = [x for x in stopped if x != pid]
        st["stopped_profiles"] = stopped
        st.setdefault("profile_states", {})
        st["profile_states"][pid] = "RUNNING"

    return _update(_m)


def stop_profiles(profile_ids: list[str]) -> Dict[str, Any]:
    """
    STOP theo profile: add vÃ o stopped_profiles + set state STOPPED.
    """
    ids = []
    for x in (profile_ids or []):
        s = str(x or "").strip()
        if s:
            ids.append(s)

    if not ids:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        stopped = set([str(x).strip() for x in (st.get("stopped_profiles") or []) if str(x).strip()])
        for pid in ids:
            stopped.add(pid)
        st["stopped_profiles"] = sorted(stopped)
        # remove khá»i paused Ä‘á»ƒ trÃ¡nh state mÃ¢u thuáº«n
        paused = [str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()]
        paused = [p for p in paused if p not in stopped]
        st["paused_profiles"] = paused
        st.setdefault("profile_states", {})
        for pid in ids:
            st["profile_states"][pid] = "STOPPED"

    return _update(_m)


def pause_profiles(profile_ids: list[str]) -> Dict[str, Any]:
    ids = []
    for x in (profile_ids or []):
        s = str(x or "").strip()
        if s:
            ids.append(s)
    if not ids:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        paused = set([str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()])
        for pid in ids:
            paused.add(pid)
        st["paused_profiles"] = sorted(paused)
        st.setdefault("profile_states", {})
        for pid in ids:
            # náº¿u profile Ä‘ang STOPPED thÃ¬ giá»¯ STOPPED
            cur = str(st["profile_states"].get(pid) or "").upper()
            if cur != "STOPPED":
                st["profile_states"][pid] = "PAUSED"

    return _update(_m)


def resume_profiles(profile_ids: list[str]) -> Dict[str, Any]:
    ids = []
    for x in (profile_ids or []):
        s = str(x or "").strip()
        if s:
            ids.append(s)
    if not ids:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        paused = [str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()]
        paused = [p for p in paused if p not in set(ids)]
        st["paused_profiles"] = paused
        # resume cÅ©ng clear STOP theo profile (Ä‘á»ƒ profile cháº¡y láº¡i Ä‘Æ°á»£c)
        stopped = [str(x).strip() for x in (st.get("stopped_profiles") or []) if str(x).strip()]
        stopped = [p for p in stopped if p not in set(ids)]
        st["stopped_profiles"] = stopped
        st.setdefault("profile_states", {})
        for pid in ids:
            st["profile_states"][pid] = "RUNNING"

    return _update(_m)


def set_profile_state(profile_id: str, state: str) -> Dict[str, Any]:
    pid = str(profile_id or "").strip()
    if not pid:
        return get_state()
    s = str(state or "").strip().upper()
    if s not in {"RUNNING", "PAUSED", "STOPPED", "ERROR"}:
        s = "ERROR"

    def _m(st: Dict[str, Any]) -> None:
        st.setdefault("profile_states", {})
        st["profile_states"][pid] = s

    return _update(_m)


def check_flags(profile_id: Optional[str] = None) -> Tuple[bool, bool, str]:
    """
    Return: (emergency_stop, paused, pause_reason)
    Priority:
      1) emergency_stop
      2) global_pause
      3) paused_profiles[pid]
    """
    st = get_state()
    if bool(st.get("global_emergency_stop")):
        return True, False, "GLOBAL_EMERGENCY_STOP"

    pid = str(profile_id or "").strip()

    # STOP theo profile (Æ°u tiÃªn hÆ¡n pause)
    stopped_set = set([str(x).strip() for x in (st.get("stopped_profiles") or []) if str(x).strip()])
    if pid and pid in stopped_set:
        return True, False, "STOPPED_PROFILE"

    if bool(st.get("global_pause")):
        return False, True, "GLOBAL_PAUSE"

    paused_set = set([str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()])
    if pid and pid in paused_set:
        return False, True, "PAUSED_PROFILE"

    return False, False, ""


def wait_if_paused(profile_id: Optional[str], sleep_seconds: float = 0.5) -> None:
    """
    Náº¿u PAUSE -> sleep + check flag liÃªn tá»¥c.
    Náº¿u emergency_stop -> raise RuntimeError Ä‘á»ƒ caller thoÃ¡t ngay.
    """
    pid = str(profile_id or "").strip()
    while True:
        stop, paused, _reason = check_flags(pid)
        if stop:
            raise RuntimeError("EMERGENCY_STOP")
        if not paused:
            return
        time.sleep(max(0.2, float(sleep_seconds)))


def smart_sleep(seconds: float, profile_id: Optional[str] = None) -> None:
    """
    Sleep thÃ´ng minh vá»›i kháº£ nÄƒng STOP/PAUSE:
    - Sleep theo chunk 0.5s
    - Check STOP/PAUSE má»—i chunk
    - Náº¿u STOP: raise RuntimeError("EMERGENCY_STOP") ngay láº­p tá»©c
    - Náº¿u PAUSE: block trong wait_if_paused vÃ  KHÃ”NG giáº£m remaining time
    - Náº¿u NORMAL: sleep chunk vÃ  giáº£m remaining time
    
    Args:
        seconds: Tá»•ng sá»‘ giÃ¢y cáº§n sleep
        profile_id: Profile ID Ä‘á»ƒ check STOP/PAUSE (optional)
    
    Raises:
        RuntimeError: Náº¿u bá»‹ STOP (message = "EMERGENCY_STOP")
    """
    remaining = float(seconds)
    chunk = 0.5
    pid = str(profile_id or "").strip() if profile_id else None
    
    while remaining > 0:
        stop, paused, _reason = check_flags(pid)
        
        if stop:
            raise RuntimeError("EMERGENCY_STOP")
        
        if paused:
            # PAUSE: block trong wait_if_paused, KHÃ”NG giáº£m remaining time
            wait_if_paused(pid, sleep_seconds=chunk)
            continue
        
        # NORMAL: sleep chunk vÃ  giáº£m remaining time
        sleep_time = min(chunk, remaining)
        time.sleep(sleep_time)
        remaining -= sleep_time



--- END FILE: backend\core\control.py ---

--- START FILE: backend\core\join_groups.py ---
import sys
import os
import json
import time
import random
import re
from pathlib import Path

# --- SETUP ÄÆ¯á»œNG DáºªN Äá»‚ IMPORT CORE ---
current_dir = os.path.dirname(os.path.abspath(__file__))
parent_dir = os.path.dirname(current_dir)
sys.path.append(parent_dir)

from core.nst import connect_profile
from core.nst import stop_profile
from core.browser import FBController
from core import control as control_state
from core.control import smart_sleep
from core.paths import get_config_dir, get_data_dir
GROUPS_JSON_PATH = get_config_dir() / "groups.json"
# Worker láº¥y page_id/post_id tá»« URL (dÃ¹ng cookie theo profile_id trong settings.json)
try:
    from worker.get_id import get_id_from_url
except Exception:
    try:
        from get_id import get_id_from_url
    except Exception:
        get_id_from_url = None

# LÆ°u mapping group -> page_id theo profile_id

GROUPS_LOCK_PATH = Path(str(GROUPS_JSON_PATH) + ".lock")


def _normalize_group_url(raw: str) -> str:
    s = str(raw or "").strip()
    if not s:
        return ""
    if re.match(r"^https?://", s, flags=re.IGNORECASE):
        return s
    if s.lower().startswith("facebook.com/") or s.lower().startswith("www.facebook.com/"):
        return "https://" + s
    if "/groups/" in s:
        if s.startswith("/"):
            return "https://www.facebook.com" + s
        return "https://www.facebook.com/" + s.lstrip("/")
    return f"https://www.facebook.com/groups/{s}"


def _acquire_groups_lock(timeout_seconds: float = 60.0, poll: float = 0.1):
    """
    Lock file Ä‘Æ¡n giáº£n (cross-platform): táº¡o file .lock báº±ng O_EXCL Ä‘á»ƒ chá»‘ng ghi Ä‘Ã¨ khi nhiá»u process cÃ¹ng ghi.
    """
    start = time.time()
    while True:
        try:
            fd = os.open(str(GROUPS_LOCK_PATH), os.O_CREAT | os.O_EXCL | os.O_RDWR)
            return fd
        except FileExistsError:
            # timeout_seconds <= 0 => chá» vÃ´ háº¡n
            if timeout_seconds and timeout_seconds > 0 and (time.time() - start >= timeout_seconds):
                return None
            time.sleep(poll)
        except Exception:
            return None


def _release_groups_lock(fd) -> None:
    try:
        if fd is not None:
            try:
                os.close(fd)
            except Exception:
                pass
        try:
            if GROUPS_LOCK_PATH.exists():
                GROUPS_LOCK_PATH.unlink()
        except Exception:
            pass
    except Exception:
        pass


def _read_groups_json() -> dict:
    try:
        if not GROUPS_JSON_PATH.exists():
            return {}
        raw = GROUPS_JSON_PATH.read_text(encoding="utf-8").strip()
        if not raw:
            return {}
        data = json.loads(raw)
        return data if isinstance(data, dict) else {}
    except Exception:
        return {}


def _write_groups_json(data: dict) -> None:
    GROUPS_JSON_PATH.parent.mkdir(parents=True, exist_ok=True)
    tmp = Path(str(GROUPS_JSON_PATH) + ".tmp")
    tmp.write_text(json.dumps(data, indent=2, ensure_ascii=False) + "\n", encoding="utf-8")
    os.replace(str(tmp), str(GROUPS_JSON_PATH))


def save_group_page_id(profile_id: str, page_id: str, url_page: str) -> bool:
    """
    LÆ°u vÃ o backend/config/groups.json theo format:
    {
      "<profile_id>": [
        {"page_id": "...", "url_page": "..."}
      ]
    }
    """
    pid = str(profile_id or "").strip()
    pg = str(page_id or "").strip()
    urlp = str(url_page or "").strip()
    if not pid or not pg or not urlp:
        return False

    fd = _acquire_groups_lock()
    if fd is None:
        # KhÃ´ng cÃ³ lock => khÃ´ng ghi Ä‘á»ƒ trÃ¡nh race condition khi cháº¡y Ä‘a process
        print(f"âš ï¸ [groups.json] KhÃ´ng láº¥y Ä‘Æ°á»£c lock trong thá»i gian chá» -> bá» qua ghi (profile_id={pid})")
        return False
    try:
        data = _read_groups_json()
        arr = data.get(pid)
        if not isinstance(arr, list):
            arr = []

        # chá»‘ng trÃ¹ng theo page_id
        updated = False
        for item in arr:
            if isinstance(item, dict) and str(item.get("page_id") or "").strip() == pg:
                item["url_page"] = urlp
                updated = True
                break

        if not updated:
            arr.append({"page_id": pg, "url_page": urlp})

        data[pid] = arr
        _write_groups_json(data)
        return True
    finally:
        _release_groups_lock(fd)

class GroupJoiner(FBController):
    """
    Class chuyÃªn dá»¥ng Ä‘á»ƒ Ä‘i xin vÃ o nhÃ³m
    """
    def join_group(self, group_id):
        # STOP/PAUSE checkpoint
        try:
            self.control_checkpoint("join_group_start")
        except RuntimeError:
            raise
        raw = str(group_id or "").strip()
        if not raw:
            print("âš ï¸ group rá»—ng, bá» qua")
            return False

        url = _normalize_group_url(raw)
        print(f"\nðŸš€ Äang truy cáº­p nhÃ³m: {group_id}")
        print(f"ðŸ”— Link: {url}")
        
        try:
            self.control_checkpoint("before_goto_group")
            self.goto(url)
            smart_sleep(random.uniform(3, 5), self.profile_id)  # Chá» load trang

            # 1. Kiá»ƒm tra xem Ä‘Ã£ tham gia chÆ°a
            is_joined = self.page.query_selector('div[aria-label="ÄÃ£ tham gia"], div[aria-label="Má»i"]')
            if is_joined:
                print(f"âœ… [SKIP] ÄÃ£ lÃ  thÃ nh viÃªn cá»§a nhÃ³m {group_id}")
                # coi nhÆ° "thÃ nh cÃ´ng" Ä‘á»ƒ váº«n láº¥y page_id vÃ  lÆ°u groups.json
                return True

            # 2. TÃ¬m nÃºt "Tham gia nhÃ³m"
            join_btn_selector = 'div[aria-label="Tham gia nhÃ³m"][role="button"]'
            join_btn = self.page.query_selector(join_btn_selector)

            if not join_btn:
                join_btn = self.page.get_by_text("Tham gia nhÃ³m", exact=True).first
            
            if join_btn:
                print("point ðŸ‘‰ TÃ¬m tháº¥y nÃºt 'Tham gia nhÃ³m'. Äang click...")
                self.control_checkpoint("before_click_join_group")
                join_btn.click()
                
                # ======================================================
                # [Má»šI] áº¤N ESC 2 Láº¦N Äá»‚ Táº®T POPUP CÃ‚U Há»ŽI / Ná»˜I QUY
                # ======================================================
                # Thay sleep cá»©ng báº±ng auto-wait popup/dialog
                # ======================================================
                try:
                    # Chá» popup dialog (náº¿u cÃ³) rá»“i Ä‘Ã³ng
                    self.page.wait_for_selector('div[role="dialog"]', timeout=3000)
                    self.page.keyboard.press("Escape")
                except:
                    pass
                
                try:
                    # Chá» UI cáº­p nháº­t sau khi Ä‘Ã³ng popup (khÃ´ng sleep cá»©ng)
                    self.page.wait_for_timeout(800)
                except:
                    pass
                
                # 3. Kiá»ƒm tra láº¡i tráº¡ng thÃ¡i
                # Náº¿u nÃºt chuyá»ƒn thÃ nh "Há»§y yÃªu cáº§u" hoáº·c "ÄÃ£ tham gia" -> ThÃ nh cÃ´ng
                check_success = None
                try:
                    # chá» UI cáº­p nháº­t tá»‘i Ä‘a 6s (Ä‘á»¡ sai do load cháº­m)
                    self.page.wait_for_selector('div[aria-label="Há»§y yÃªu cáº§u"], div[aria-label="ÄÃ£ tham gia"]', timeout=6000)
                    check_success = self.page.query_selector('div[aria-label="Há»§y yÃªu cáº§u"], div[aria-label="ÄÃ£ tham gia"]')
                except Exception:
                    check_success = self.page.query_selector('div[aria-label="Há»§y yÃªu cáº§u"], div[aria-label="ÄÃ£ tham gia"]')

                if check_success:
                    print(f"âœ… ÄÃ£ gá»­i yÃªu cáº§u tham gia / Ä‘Ã£ tham gia: {group_id}")
                    return True

                # Náº¿u váº«n chÆ°a tháº¥y Ä‘á»•i tráº¡ng thÃ¡i -> coi lÃ  chÆ°a join thÃ nh cÃ´ng (thÆ°á»ng do cÃ¢u há»i báº¯t buá»™c)
                print(f"âš ï¸ Click join nhÆ°ng chÆ°a tháº¥y Ä‘á»•i tráº¡ng thÃ¡i (cÃ³ thá»ƒ cáº§n tráº£ lá»i cÃ¢u há»i): {group_id}")
                return False
            else:
                print(f"âŒ KhÃ´ng tÃ¬m tháº¥y nÃºt tham gia (CÃ³ thá»ƒ nhÃ³m kÃ­n, bá»‹ cháº·n, hoáº·c layout khÃ¡c).")
                return False

        except Exception as e:
            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                raise
            print(f"âŒ Lá»—i khi xá»­ lÃ½ nhÃ³m {group_id}: {e}")
            return False

def run_batch_join_from_list(profile_id, group_ids):
    """
    Cháº¡y join group cho 1 profile vá»›i danh sÃ¡ch group truyá»n trá»±c tiáº¿p (list).
    DÃ¹ng cho API (Ä‘a luá»“ng/Ä‘a process).
    """
    try:
        items = list(group_ids or [])
    except Exception:
        items = []

    # Clean
    cleaned = []
    for gid in items:
        s = str(gid or "").strip()
        if s:
            cleaned.append(s)

    if not cleaned:
        print("âš ï¸ Danh sÃ¡ch group rá»—ng.")
        return

    print(f"ðŸ“‹ TÃ¬m tháº¥y {len(cleaned)} nhÃ³m cáº§n tham gia.")

    # 2. Káº¿t ná»‘i Profile
    try:
        # STOP/PAUSE checkpoint trÆ°á»›c connect
        stop, paused, reason = control_state.check_flags(profile_id)
        if stop:
            print(f"ðŸ›‘ [JOIN] EMERGENCY_STOP trÆ°á»›c khi connect ({reason})")
            return
        if paused:
            print(f"â¸ï¸ [JOIN] PAUSED trÆ°á»›c khi connect ({reason})")
            control_state.wait_if_paused(profile_id, sleep_seconds=0.5)

        print(f"ðŸ”Œ Äang káº¿t ná»‘i profile {profile_id}...")
        ws_url = connect_profile(profile_id)
        fb = GroupJoiner(ws_url)
        fb.profile_id = profile_id
        fb.connect()
        
        # 3. Cháº¡y vÃ²ng láº·p
        for idx, gid in enumerate(cleaned):
            # STOP/PAUSE checkpoint trÆ°á»›c má»—i group
            stop, paused, reason = control_state.check_flags(profile_id)
            if stop:
                print(f"ðŸ›‘ [JOIN] {profile_id} EMERGENCY_STOP ({reason}) -> dá»«ng")
                break
            if paused:
                print(f"â¸ï¸ [JOIN] {profile_id} PAUSED ({reason}) -> sleep")
                control_state.wait_if_paused(profile_id, sleep_seconds=0.5)

            # 3a) Join group (hoáº·c skip náº¿u Ä‘Ã£ join)
            url = _normalize_group_url(gid)
            joined_ok = False
            try:
                joined_ok = bool(fb.join_group(url))
            except Exception as e:
                if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                    raise
                print(f"âš ï¸ Lá»—i join_group: {e}")
                joined_ok = False

            # 3b) Chá»‰ khi join thÃ nh cÃ´ng/Ä‘Ã£ lÃ  member -> láº¥y page_id vÃ  lÆ°u groups.json
            if joined_ok and get_id_from_url and url:
                try:
                    fb.control_checkpoint("before_get_id_from_url_group")
                    res = get_id_from_url(url, profile_id)
                    if isinstance(res, dict) and res.get("url_type") == "group":
                        page_id = str(res.get("page_id") or "").strip()
                        if page_id:
                            ok = save_group_page_id(profile_id, page_id, url)
                            if ok:
                                print(f"ðŸ’¾ ÄÃ£ lÆ°u group: profile_id={profile_id} page_id={page_id}")
                            else:
                                print(f"âš ï¸ KhÃ´ng lÆ°u Ä‘Æ°á»£c groups.json (profile_id={profile_id}, page_id={page_id})")
                except Exception as e:
                    if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                        raise
                    print(f"âš ï¸ Lá»—i get_id_from_url khi join group: {e}")
            
            # Nghá»‰ ngáº«u nhiÃªn (trá»« khi lÃ  group cuá»‘i)
            if idx < len(cleaned) - 1:
                sleep_time = random.uniform(10, 20) 
                print(f"ðŸ’¤ Nghá»‰ {sleep_time:.1f}s trÆ°á»›c khi qua nhÃ³m tiáº¿p theo...")
                try:
                    smart_sleep(sleep_time, profile_id)
                except RuntimeError as e:
                    if "EMERGENCY_STOP" in str(e):
                        print(f"ðŸ›‘ [JOIN] {profile_id} EMERGENCY_STOP trong sleep -> dá»«ng")
                        raise
                    raise
            
    except Exception as e:
        print(f"âŒ Lá»—i káº¿t ná»‘i/browser: {e}")
    finally:
        print("ðŸ HoÃ n táº¥t danh sÃ¡ch.")
        # ÄÃ³ng sáº¡ch tab/context playwright + stop NST profile (best-effort)
        try:
            if 'fb' in locals() and fb:
                try:
                    if getattr(fb, "page", None):
                        try:
                            fb.page.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "browser", None) and getattr(fb.browser, "contexts", None):
                        for ctx in list(fb.browser.contexts):
                            try:
                                ctx.close()
                            except Exception:
                                pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "browser", None):
                        try:
                            fb.browser.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "play", None):
                        try:
                            fb.play.stop()
                        except Exception:
                            pass
                except Exception:
                    pass
        finally:
            try:
                stop_profile(profile_id)
            except Exception:
                pass

def run_batch_join(profile_id, json_file_path):
    # 1. Äá»c file JSON
    # Chuyá»ƒn Ä‘á»•i thÃ nh Path náº¿u lÃ  string
    json_file_path = Path(json_file_path) if not isinstance(json_file_path, Path) else json_file_path
    try:
        with json_file_path.open("r", encoding="utf-8") as f:
            group_ids = json.load(f)
        
        if not group_ids:
            print("âš ï¸ File JSON rá»—ng.")
            return
            
        print(f"ðŸ“‹ TÃ¬m tháº¥y {len(group_ids)} nhÃ³m cáº§n tham gia.")
        
    except Exception as e:
        print(f"âŒ Lá»—i Ä‘á»c file JSON: {e}")
        return

    run_batch_join_from_list(profile_id, group_ids)

if __name__ == "__main__":
    # --- Cáº¤U HÃŒNH ---
    MY_PROFILE_ID = "621e1f5d-0c42-481e-9ddd-7abaafce68ed" 
    JSON_PATH = get_config_dir() / "groups.json"
    
    run_batch_join(MY_PROFILE_ID, str(JSON_PATH))
--- END FILE: backend\core\join_groups.py ---

--- START FILE: backend\core\nst.py ---
import requests
import json
import urllib.parse  # Cáº§n cÃ¡i nÃ y Ä‘á»ƒ mÃ£ hÃ³a User-Agent cÃ³ dáº¥u cÃ¡ch
from typing import Optional, Any

from core.settings import reload_settings

def _get_runtime_settings():
    """
    NST API key/headless cÃ³ thá»ƒ Ä‘á»•i trong lÃºc backend Ä‘ang cháº¡y.
    VÃ¬ get_settings() cÃ³ cache, dÃ¹ng reload_settings() Ä‘á»ƒ láº¥y giÃ¡ trá»‹ má»›i nháº¥t.
    """
    try:
        return reload_settings()
    except Exception:
        # fallback: váº«n cá»‘ Ä‘á»c cache náº¿u reload lá»—i
        from core.settings import get_settings
        return get_settings()
NST_BASE_URLS = [
    "http://127.0.0.1:8848/api/v2",
    "http://127.0.0.1:8848/api/v1",
    "http://127.0.0.1:8848/api",
]


def _nst_request(method: str, path: str, timeout: int = 15, headers: Optional[dict] = None, data: Optional[Any] = None) -> Optional[Any]:
    """
    Gá»i NST local API. Tráº£ vá» JSON náº¿u parse Ä‘Æ°á»£c, None náº¿u lá»—i.
    """
    for base in NST_BASE_URLS:
        url = f"{base}{path}"
        try:
            print(f"      ðŸ”— Thá»­: {method} {url}")
            if data is not None:
                print(f"         â†’ Body: {data}")
            resp = requests.request(method, url, timeout=timeout, headers=headers, json=data if data is not None else None)
            print(f"         â†’ Status: {resp.status_code}")
            try:
                json_data = resp.json()
                print(f"         â†’ Response: {json_data}")
                return json_data
            except Exception as json_err:
                text_data = {"status_code": resp.status_code, "text": resp.text[:200]}
                print(f"         â†’ Response (khÃ´ng pháº£i JSON): {text_data}")
                return text_data
        except Exception as req_err:
            print(f"         âŒ Lá»—i request: {req_err}")
            continue
    print(f"      âš ï¸ KhÃ´ng endpoint nÃ o thÃ nh cÃ´ng cho {method} {path}")
    return None


def stop_profile(profile_id: str) -> bool:
    """
    Dá»«ng browser instance cá»§a profile báº±ng DELETE /api/v2/browsers/{profile_id}
    """
    pid = str(profile_id or "").strip()
    if not pid:
        print(f"   âš ï¸ [stop_profile] profile_id rá»—ng")
        return False

    print(f"   ðŸ” [stop_profile] Äang dá»«ng profile: {pid}")
    
    cfg = _get_runtime_settings()
    api_key = str(getattr(cfg, "api_key", "") or "").strip()
    hdr = {
        "x-api-key": api_key,
        "Content-Type": "application/json"
    } if api_key else {"Content-Type": "application/json"}
    
    # DÃ¹ng DELETE /browsers/{profile_id} (base URL Ä‘Ã£ cÃ³ /api/v2)
    path = f"/browsers/{pid}"
    
    print(f"   ðŸ“‹ API Key: {'CÃ³' if api_key else 'KhÃ´ng cÃ³'}")
    print(f"   ðŸ“‹ Endpoint: DELETE {path}")
    
    data = _nst_request("DELETE", path, headers=hdr)
    if not data:
        print(f"   âŒ [stop_profile] KhÃ´ng cÃ³ response tá»« NST")
        return False
    
    # Kiá»ƒm tra káº¿t quáº£
    if isinstance(data, dict):
        # Idempotent: náº¿u browser instance khÃ´ng tá»“n táº¡i thÃ¬ coi nhÆ° Ä‘Ã£ dá»«ng rá»“i
        msg_lower = str(data.get("msg") or data.get("message") or "").lower()
        if data.get("code") == 400 and "browser instance not found" in msg_lower:
            print(f"   âœ… [stop_profile] Browser Ä‘Ã£ Ä‘Ã³ng sáºµn / khÃ´ng tá»“n táº¡i (code=400). Coi nhÆ° thÃ nh cÃ´ng.")
            return True

        if data.get("err") is False:
            print(f"   âœ… [stop_profile] THÃ€NH CÃ”NG! err=False")
            return True
        status_lower = str(data.get("status", "")).lower()
        if status_lower in {"ok", "success", "stopped", "closed"}:
            print(f"   âœ… [stop_profile] THÃ€NH CÃ”NG! status={status_lower}")
            return True
        if data.get("code") in (0, 200):
            print(f"   âœ… [stop_profile] THÃ€NH CÃ”NG! code={data.get('code')}")
            return True
        print(f"   âš ï¸ [stop_profile] KhÃ´ng match Ä‘iá»u kiá»‡n thÃ nh cÃ´ng (err={data.get('err')}, status={data.get('status')}, code={data.get('code')})")
    else:
        print(f"   âš ï¸ [stop_profile] Response khÃ´ng pháº£i dict: {type(data)}")
    
    return False


def stop_all_browsers() -> bool:
    """
    ÄÃ³ng toÃ n bá»™ browser NST báº±ng DELETE /api/v2/browsers vá»›i body lÃ  array cÃ¡c profile_id.
    """
    print("   ðŸ” [stop_all_browsers] Báº¯t Ä‘áº§u Ä‘Ã³ng toÃ n bá»™ NST browser...")
    
    cfg = _get_runtime_settings()
    api_key = str(getattr(cfg, "api_key", "") or "").strip()
    hdr = {
        "x-api-key": api_key,
        "Content-Type": "application/json"
    } if api_key else {"Content-Type": "application/json"}
    
    print(f"   ðŸ“‹ API Key: {'CÃ³' if api_key else 'KhÃ´ng cÃ³'}")
    
    # Láº¥y danh sÃ¡ch profile_id tá»« settings
    try:
        from core.settings import get_settings
        settings = get_settings()
        profile_ids = []
        
        # Láº¥y tá»« PROFILE_IDS (cÃ³ thá»ƒ lÃ  dict hoáº·c list)
        profile_data = getattr(settings, "profile_ids", None)
        if isinstance(profile_data, dict):
            profile_ids = list(profile_data.keys())
        elif isinstance(profile_data, list):
            profile_ids = profile_data
        elif isinstance(profile_data, str):
            profile_ids = [p.strip() for p in profile_data.split(",") if p.strip()]
        
        profile_ids = [str(pid).strip() for pid in profile_ids if str(pid).strip()]
        
        if not profile_ids:
            print(f"   âš ï¸ [stop_all_browsers] KhÃ´ng tÃ¬m tháº¥y profile_id nÃ o trong settings")
            # Váº«n thá»­ gá»i vá»›i array rá»—ng
            profile_ids = []
    except Exception as e:
        print(f"   âš ï¸ [stop_all_browsers] Lá»—i khi láº¥y profile_ids: {e}")
        profile_ids = []
    
    print(f"   ðŸ“‹ Sá»‘ profile sáº½ Ä‘Ã³ng: {len(profile_ids)}")
    if profile_ids:
        print(f"   ðŸ“‹ Profile IDs: {profile_ids}")
    
    # DÃ¹ng DELETE /browsers vá»›i body lÃ  JSON array cÃ¡c profile_id (base URL Ä‘Ã£ cÃ³ /api/v2)
    path = "/browsers"
    payload = profile_ids  # requests sáº½ tá»± Ä‘á»™ng convert list thÃ nh JSON array
    
    print(f"   ðŸ“‹ Endpoint: DELETE {path}")
    print(f"   ðŸ“‹ Body: {payload}")
    
    data = _nst_request("DELETE", path, headers=hdr, data=payload)
    if not data:
        print(f"   âŒ [stop_all_browsers] KhÃ´ng cÃ³ response tá»« NST")
        return False
    
    # Kiá»ƒm tra káº¿t quáº£
    if isinstance(data, dict):
        # Idempotent: náº¿u khÃ´ng cÃ³ browser instance nÃ o thÃ¬ coi nhÆ° Ä‘Ã£ Ä‘Ã³ng háº¿t
        msg_lower = str(data.get("msg") or data.get("message") or "").lower()
        if data.get("code") == 400 and "browser instance not found" in msg_lower:
            print(f"   âœ… [stop_all_browsers] Browser Ä‘Ã£ Ä‘Ã³ng sáºµn / khÃ´ng tá»“n táº¡i (code=400). Coi nhÆ° thÃ nh cÃ´ng.")
            return True

        if data.get("err") is False:
            print(f"   âœ… [stop_all_browsers] THÃ€NH CÃ”NG! err=False")
            return True
        status_lower = str(data.get("status", "")).lower()
        if status_lower in {"ok", "success", "stopped", "closed"}:
            print(f"   âœ… [stop_all_browsers] THÃ€NH CÃ”NG! status={status_lower}")
            return True
        if data.get("code") in (0, 200):
            print(f"   âœ… [stop_all_browsers] THÃ€NH CÃ”NG! code={data.get('code')}")
            return True
        print(f"   âš ï¸ [stop_all_browsers] KhÃ´ng match Ä‘iá»u kiá»‡n thÃ nh cÃ´ng (err={data.get('err')}, status={data.get('status')}, code={data.get('code')})")
    else:
        print(f"   âš ï¸ [stop_all_browsers] Response khÃ´ng pháº£i dict: {type(data)}")
    
    return False

def connect_profile(profile_id: str):
    """
    HÃ m nÃ y "trÃ¡ hÃ¬nh": 
    BÃªn ngoÃ i váº«n gá»i lÃ  connect_profile nhÆ° cÅ©.
    NhÆ°ng bÃªn trong dÃ¹ng POST /api/v2/browsers (CÃ¡ch 1 - CÃ¡ch Sáº¿p xÃ¡c nháº­n cháº¡y ngon) 
    thay vÃ¬ dÃ¹ng GET connect (Ä‘ang bá»‹ lá»—i).
    """
    cfg = _get_runtime_settings()
    api_key = str(getattr(cfg, "api_key", "") or "").strip()
    headless = bool(getattr(cfg, "headless", False))
    
    # DÃ¹ng Endpoint POST (CÃ¡ch 1)
    url = "http://127.0.0.1:8848/api/v2/browsers"
    
    headers = {
        "x-api-key": api_key,
        "Content-Type": "application/json"
    }

    # Body chuáº©n cho POST: Array cÃ¡c ID
    payload = [profile_id]

    print(f"ðŸš€ [POST Wrapper] Äang má»Ÿ profile {profile_id}...")

    try:
        # 1. Gá»i lá»‡nh Má»ž (Start)
        resp = requests.post(url, headers=headers, json=payload, timeout=45)
        data = resp.json()
        
        # 2. Kiá»ƒm tra xem lá»‡nh Má»Ÿ cÃ³ thÃ nh cÃ´ng khÃ´ng
        # LÆ°u Ã½: NST cÃ³ thá»ƒ tráº£ vá» code 200 nhÆ°ng bÃ¡o lá»—i trong body náº¿u profile Ä‘ang cháº¡y rá»“i
        # ChÃºng ta bá» qua lá»—i "already running" Ä‘á»ƒ tiáº¿p tá»¥c láº¥y WS
        if resp.status_code != 200:
             if data.get("err") and "running" not in str(data.get("msg", "")).lower():
                 msg = data.get("msg") or data.get("message") or "Unknown Error"
                 raise Exception(f"NST Start Failed: {msg}")

        # 3. Láº¤Y WEBSOCKET URL
        ws_url = None
        
        # Parse data tráº£ vá» tá»« POST (náº¿u nÃ³ tráº£ vá» danh sÃ¡ch vá»«a start)
        started_browsers = data.get("data")
        if isinstance(started_browsers, list):
            for b in started_browsers:
                if b.get("profileId") == profile_id:
                    ws_url = b.get("webSocketDebuggerUrl")
                    break
        
        # 4. Fallback: Náº¿u response POST khÃ´ng tráº£ WS (hoáº·c do profile Ä‘Ã£ cháº¡y tá»« trÆ°á»›c)
        # ThÃ¬ gá»i GET /browsers Ä‘á»ƒ quÃ©t danh sÃ¡ch Ä‘ang cháº¡y
        if not ws_url:
            print(" âš ï¸ Profile Ä‘Ã£ cháº¡y hoáº·c khÃ´ng tháº¥y WS trong response, Ä‘ang quÃ©t láº¡i danh sÃ¡ch...")
            list_resp = requests.get(url, headers=headers, timeout=15)
            list_data = list_resp.json()
            
            running_browsers = list_data.get("data", [])
            for b in running_browsers:
                if b.get("profileId") == profile_id:
                    ws_url = b.get("webSocketDebuggerUrl")
                    break
        
        if ws_url:
            print(f"ðŸ”Œ WebSocket: {ws_url}")
            return ws_url
        else:
            raise Exception(f"ÄÃ£ má»Ÿ profile {profile_id} nhÆ°ng khÃ´ng tÃ¬m tháº¥y WebSocket URL.")

    except Exception as e:
        print(f"âŒ Lá»—i connect_profile (POST Wrapper): {e}")
        raise e
--- END FILE: backend\core\nst.py ---

--- START FILE: backend\core\paths.py ---
# backend/core/paths.py
import sys
import os
from pathlib import Path

def get_base_dir() -> Path:
    """
    Tráº£ vá» thÆ° má»¥c gá»‘c:
    - Náº¿u cháº¡y .exe: lÃ  thÆ° má»¥c chá»©a file .exe (Ä‘á»ƒ load config/data bÃªn ngoÃ i)
    - Náº¿u cháº¡y code: lÃ  thÆ° má»¥c backend
    """
    if getattr(sys, 'frozen', False):
        # Äang cháº¡y tá»« file .exe -> Láº¥y thÆ° má»¥c chá»©a file exe
        return Path(sys.executable).parent
    else:
        # Äang cháº¡y code python -> Láº¥y thÆ° má»¥c chá»©a file hiá»‡n táº¡i (core) rá»“i ra ngoÃ i 2 cáº¥p
        return Path(__file__).resolve().parent.parent

def get_config_dir() -> Path:
    """Folder config náº±m cÃ¹ng cáº¥p file exe"""
    return get_base_dir() / "config"

def get_data_dir() -> Path:
    """Folder data náº±m cÃ¹ng cáº¥p file exe"""
    return get_base_dir() / "data"

def get_frontend_dir() -> Path:
    """Folder frontend náº±m cÃ¹ng cáº¥p file exe"""
    base = get_base_dir()
    if getattr(sys, 'frozen', False):
        return base / "frontend"
    else:
        # Náº¿u cháº¡y code thÃ¬ frontend náº±m ngang hÃ ng vá»›i backend
        return base.parent / "frontend"

def get_settings_path() -> Path:
    return get_config_dir() / "settings.json"
--- END FILE: backend\core\paths.py ---

--- START FILE: backend\core\runner.py ---
import time  # [Cáº§n thÃªm thÆ° viá»‡n nÃ y Ä‘á»ƒ Ä‘áº¿m giá»]
from multiprocessing import Process
from typing import Optional, Sequence
from urllib.parse import quote_plus

from core.browser import FBController
from core.nst import connect_profile
from core.scraper import SimpleBot
from core.settings import get_settings
from core.utils import clean_profile_list
from core import control as control_state


class AppRunner:
    def __init__(
        self,
        run_minutes: Optional[int] = None,
        rest_minutes: Optional[int] = None,
        profile_ids: Optional[Sequence[str]] = None,
        text: Optional[str] = None,
        mode: Optional[str] = None,
    ):
        cfg = get_settings()
        self.target_url = cfg.target_url
        # Cho phÃ©p override danh sÃ¡ch profile tá»« API (/run) Ä‘á»ƒ khÃ´ng cháº¡y háº¿t.
        base_profiles = profile_ids if profile_ids is not None else cfg.profile_ids
        self.profiles = clean_profile_list(base_profiles)
        self.text = str(text or "").strip()
        self.mode = str(mode or "feed").strip().lower()
        if self.mode not in ("feed", "search"):
            self.mode = "feed"

        # Náº¿u lÃ  search => target_url sáº½ lÃ  trang search posts.
        # Váº«n dÃ¹ng core/browser.py Ä‘á»ƒ scan/like/share/báº¯t id.
        if self.mode == "search" and self.text:
            q = quote_plus(self.text)
            self.target_url = f"https://www.facebook.com/search/posts/?q={q}"

        # Æ¯u tiÃªn giÃ¡ trá»‹ truyá»n tá»« API; fallback cáº¥u hÃ¬nh; cuá»‘i cÃ¹ng lÃ  default.
        self.RUN_MINUTES = self._coerce_positive_int(
            run_minutes,
            cfg.run_minutes,
            default=30,
        )
        # REST_MINUTES máº·c Ä‘á»‹nh 120p (tÆ°Æ¡ng Ä‘Æ°Æ¡ng 2h nhÆ° cáº¥u hÃ¬nh cÅ©)
        self.REST_MINUTES = self._coerce_positive_int(
            rest_minutes,
            cfg.rest_minutes,
            default=120,
        )

    @staticmethod
    def _coerce_positive_int(value, fallback=None, default=0):
        """
        Tráº£ vá» sá»‘ nguyÃªn dÆ°Æ¡ng; náº¿u khÃ´ng há»£p lá»‡ dÃ¹ng fallback, cuá»‘i cÃ¹ng dÃ¹ng default.
        """
        for candidate in (value, fallback, default):
            try:
                num = int(candidate)
                if num > 0:
                    return num
            except (TypeError, ValueError):
                continue
        return default

    def worker(self, profile_id):
        """HÃ m xá»­ lÃ½ cho tá»«ng profile (Process con)"""
        # tráº¡ng thÃ¡i profile
        try:
            control_state.set_profile_state(profile_id, "RUNNING")
        except Exception:
            pass
        try:
            # STOP/PAUSE check trÆ°á»›c khi connect
            stop, paused, reason = control_state.check_flags(profile_id)
            if stop:
                print(f"ðŸ›‘ [{profile_id}] EMERGENCY_STOP trÆ°á»›c khi connect ({reason})")
                try:
                    control_state.set_profile_state(profile_id, "STOPPED")
                except Exception:
                    pass
                return
            if paused:
                print(f"â¸ï¸ [{profile_id}] PAUSED trÆ°á»›c khi connect ({reason})")
                control_state.wait_if_paused(profile_id, sleep_seconds=0.5)

            # 1. Káº¿t ná»‘i NST
            ws = connect_profile(profile_id)

            # 2. Khá»Ÿi táº¡o trÃ¬nh duyá»‡t
            fb = FBController(ws)
            fb.profile_id = profile_id
            # âœ… Chá»‰ dispatch/get_id trong pháº¡m vi cÃ¡c profile Ä‘ang cháº¡y (Ä‘Ã£ chá»n),
            # trÃ¡nh loop toÃ n bá»™ PROFILE_IDS trong settings.json gÃ¢y log "thiáº¿u cookie".
            try:
                fb.all_profile_ids = list(self.profiles or [])
            except Exception:
                fb.all_profile_ids = [profile_id]
            # Filter thÃªm theo text nháº­p tá»« UI (náº¿u cÃ³)
            try:
                raw = self.text
                if raw:
                    # TÃ¡ch theo dáº¥u pháº©y / xuá»‘ng dÃ²ng, giá»¯ nguyÃªn cá»¥m tá»« (VD "hÃ  ná»™i")
                    parts = []
                    for chunk in raw.replace("\n", ",").split(","):
                        s = " ".join(str(chunk).strip().split())
                        if s:
                            parts.append(s)
                    # unique giá»¯ thá»© tá»±
                    seen = set()
                    user_keywords = []
                    for x in parts:
                        k = x.lower()
                        if k in seen:
                            continue
                        seen.add(k)
                        user_keywords.append(x)
                    fb.user_keywords = user_keywords
                    if user_keywords:
                        print(f"ðŸ”Ž [{profile_id}] Scan filter text: {user_keywords}")
            except Exception:
                pass
            fb.connect()

            # 3. Cháº¡y bot tÆ°Æ¡ng tÃ¡c
            bot = SimpleBot(fb)
            
            # Äá»•i thá»i gian cháº¡y sang giÃ¢y
            duration_seconds = self.RUN_MINUTES * 60
            
            # Bot sáº½ tá»± thoÃ¡t vÃ²ng láº·p sau khi Ä‘á»§ thá»i gian
            bot.run(self.target_url, duration=duration_seconds) 

            print(f"âœ… [{profile_id}] ÄÃ£ cháº¡y Ä‘á»§ {self.RUN_MINUTES} phÃºt. Äang táº¯t trÃ¬nh duyá»‡t...")
            
            # [Quan trá»ng] ÄÃ³ng trÃ¬nh duyá»‡t sáº¡ch sáº½ Ä‘á»ƒ giáº£i phÃ³ng RAM
            try:
                if fb.browser: fb.browser.close()
                if fb.play: fb.play.stop()
            except: pass
            
        except Exception as e:
            print(f"âŒ Lá»—i á»Ÿ profile {profile_id}: {e}")
            try:
                control_state.set_profile_state(profile_id, "ERROR")
            except Exception:
                pass
        finally:
            # náº¿u Ä‘ang emergency stop thÃ¬ set STOPPED
            try:
                stop, _paused, _reason = control_state.check_flags(profile_id)
                if stop:
                    control_state.set_profile_state(profile_id, "STOPPED")
            except Exception:
                pass

    def run(self):
        """HÃ m Ä‘iá»u phá»‘i chÃ­nh (VÃ²ng láº·p vÄ©nh cá»­u)"""
        
        # Äá»•i thá»i gian nghá»‰ sang giÃ¢y
        rest_seconds = self.REST_MINUTES * 60
        
        print(f"âˆž KÃ­ch hoáº¡t cháº¿ Ä‘á»™ nuÃ´i tuáº§n hoÃ n: Cháº¡y {self.RUN_MINUTES}p -> Nghá»‰ {self.REST_MINUTES}p")

        while True:
            # STOP ALL: thoÃ¡t ngay
            stop, _paused, _reason = control_state.check_flags(None)
            if stop:
                print("ðŸ›‘ [RUNNER] EMERGENCY_STOP -> thoÃ¡t vÃ²ng láº·p AppRunner")
                break

            print("="*60)
            print(f"â–¶ï¸ [START] Báº¯t Ä‘áº§u phiÃªn cháº¡y má»›i lÃºc {time.strftime('%H:%M:%S')}")
            print("="*60)

            # 1. Khá»Ÿi cháº¡y dÃ n profile
            processes = []
            for pid in self.profiles:
                # Náº¿u profile Ä‘Ã£ bá»‹ STOP theo profile_id thÃ¬ skip luÃ´n Ä‘á»ƒ trÃ¡nh â€œcháº¡y xong rá»“i ngá»§â€
                # (trÆ°á»ng há»£p user cháº¡y báº±ng CLI main.py).
                try:
                    p_stop, p_paused, p_reason = control_state.check_flags(pid)
                except Exception:
                    p_stop, p_paused, p_reason = False, False, ""

                if p_stop:
                    print(f"ðŸ›‘ [{pid}] Bá»‹ STOP, bá» qua profile ({p_reason})")
                    try:
                        control_state.set_profile_state(pid, "STOPPED")
                    except Exception:
                        pass
                    continue

                p = Process(target=self.worker, args=(pid,))
                p.start()
                processes.append(p)

            # Náº¿u khÃ´ng cÃ³ profile nÃ o cháº¡y Ä‘Æ°á»£c thÃ¬ thoÃ¡t luÃ´n (trÃ¡nh sleep vÃ´ nghÄ©a)
            if len(processes) == 0:
                print("\n" + "=" * 60)
                print("ðŸ›‘ [RUNNER] KhÃ´ng cÃ³ profile nÃ o Ä‘Æ°á»£c cháº¡y (táº¥t cáº£ Ä‘ang STOPPED?).")
                print("ðŸ‘‰ Gá»£i Ã½: má»Ÿ backend/data/runtime_control.json Ä‘á»ƒ xoÃ¡ stopped_profiles hoáº·c gá»i RESUME.")
                print("=" * 60 + "\n")
                return

            # 2. Chá» táº¥t cáº£ cÃ¡c profile cháº¡y xong (Háº¿t 30 phÃºt tá»¥i nÃ³ sáº½ tá»± dá»«ng)
            for p in processes:
                p.join()

            # 3. TÃ­nh toÃ¡n thá»i gian thá»©c dáº­y
            wake_up_time = time.time() + rest_seconds
            wake_up_str = time.strftime('%H:%M:%S', time.localtime(wake_up_time))

            print("\n" + "="*60)
            print(f"ðŸ’¤ [SLEEP] Xong phiÃªn nÃ y. Bot sáº½ ngá»§ {self.REST_MINUTES} phÃºt.")
            print(f"â° Dá»± kiáº¿n cháº¡y láº¡i vÃ o lÃºc: {wake_up_str}")
            print("="*60 + "\n")
            
            # 4. Bot Ä‘i ngá»§
            # sleep theo chunk Ä‘á»ƒ váº«n check Ä‘Æ°á»£c STOP/PAUSE
            slept = 0
            while slept < rest_seconds:
                stop, paused, _reason = control_state.check_flags(None)
                if stop:
                    print("ðŸ›‘ [RUNNER] EMERGENCY_STOP trong lÃºc sleep -> thoÃ¡t")
                    return
                # pause all: váº«n cho runner sá»‘ng nhÆ°ng khÃ´ng cháº¡y phiÃªn má»›i
                if paused:
                    time.sleep(1)
                    continue
                time.sleep(1)
                slept += 1
--- END FILE: backend\core\runner.py ---

--- START FILE: backend\core\scraper.py ---
import time
import random
import os
from core import control as control_state
from core.control import smart_sleep
from core.account_status import check_account_status_brutal, save_account_status

class SimpleBot:
    def __init__(self, fb):
        self.fb = fb 

    def _sleep_with_pause_check(self, total_seconds, profile_id, active_time_list, last_check_time_list):
        """
        Sleep nhÆ°ng check pause: chá»‰ tÃ­nh thá»i gian khÃ´ng pause vÃ o active_time.
        active_time_list vÃ  last_check_time_list lÃ  list Ä‘á»ƒ pass by reference.
        Sá»­ dá»¥ng smart_sleep Ä‘á»ƒ handle STOP/PAUSE.
        """
        start_time = time.time()
        try:
            smart_sleep(total_seconds, profile_id)
            # Náº¿u smart_sleep return bÃ¬nh thÆ°á»ng (khÃ´ng pause), tÃ­nh vÃ o active_time
            end_time = time.time()
            elapsed = end_time - start_time
            active_time_list[0] += elapsed
            last_check_time_list[0] = end_time
        except RuntimeError as e:
            if "EMERGENCY_STOP" in str(e):
                raise
            # Náº¿u pause thÃ¬ khÃ´ng tÃ­nh vÃ o active_time
            last_check_time_list[0] = time.time()

    def run(self, url, duration=None):
        print(f"ðŸš€ Äang truy cáº­p: {url}")
        # Äiá»u hÆ°á»›ng trá»±c tiáº¿p tá»›i URL má»¥c tiÃªu (trang quÃ©t bÃ i viáº¿t)
        self.fb.goto(url)

        # ==== CHECK ACCOUNT STATUS Má»˜T Láº¦N SAU KHI VÃ€O TRANG Má»¤C TIÃŠU ====
        profile_id = getattr(self.fb, 'profile_id', None)
        if profile_id:
            try:
                print(f"ðŸ” [ACCOUNT_STATUS] Kiá»ƒm tra tráº¡ng thÃ¡i account cho profile {profile_id} (scraper)...")
                status = check_account_status_brutal(self.fb)
                status["profile_id"] = profile_id
                status["checked_at"] = time.strftime("%Y-%m-%d %H:%M:%S")
                save_account_status(profile_id, status)

                if status.get("banned"):
                    error_msg = f"â›” [ACCOUNT_BANNED] Profile {profile_id} bá»‹ khÃ³a/bá»‹ ban: {status.get('message')}"
                    print(error_msg)
                    # Dá»ªNG BOT cho profile nÃ y, Ä‘á»ƒ caller xá»­ lÃ½/log vÃ  khÃ´ng quÃ©t tiáº¿p
                    raise RuntimeError(f"ACCOUNT_BANNED: {status.get('message')}")
                else:
                    print(f"âœ… [ACCOUNT_STATUS] Profile {profile_id} OK: {status.get('message')}")
            except RuntimeError:
                # ACCOUNT_BANNED / EMERGENCY_STOP sáº½ Ä‘Æ°á»£c xá»­ lÃ½ á»Ÿ táº§ng caller
                raise
            except Exception as e:
                # KhÃ´ng cho phÃ©p lá»—i check account lÃ m vá»¡ luá»“ng cÅ©
                print(f"âš ï¸ [ACCOUNT_STATUS] KhÃ´ng kiá»ƒm tra Ä‘Æ°á»£c tráº¡ng thÃ¡i account (scraper): {e}")
        
        # Track "active time" (chá»‰ tÄƒng khi khÃ´ng pause) thay vÃ¬ wall clock time
        # DÃ¹ng list Ä‘á»ƒ pass by reference cho helper function
        active_time_list = [0.0]
        last_check_time_list = [time.time()]
        profile_id = getattr(self.fb, 'profile_id', None)
        
        while True:
            try:
                # STOP/PAUSE checkpoint (Æ°u tiÃªn STOP ALL)
                try:
                    if hasattr(self.fb, "control_checkpoint"):
                        self.fb.control_checkpoint("before_loop")
                except RuntimeError as ce:
                    if "EMERGENCY_STOP" in str(ce) or "BROWSER_CLOSED" in str(ce):
                        print("ðŸ›‘ Dá»«ng bot do control flag / browser closed")
                        break
                    raise

                # Chá»‰ báº¯t Ä‘áº§u Ä‘o elapsed SAU checkpoint (vÃ¬ checkpoint cÃ³ thá»ƒ wait khi pause)
                now = time.time()
                elapsed_since_last_check = now - last_check_time_list[0]
                last_check_time_list[0] = now

                # Check pause: náº¿u khÃ´ng pause thÃ¬ cá»™ng thá»i gian Ä‘Ã£ trÃ´i qua vÃ o active_time
                stop, paused, _reason = control_state.check_flags(profile_id)
                if stop:
                    print("ðŸ›‘ Dá»«ng bot do STOP flag")
                    break
                
                # Chá»‰ tÄƒng active_time khi KHÃ”NG pause (Ä‘Ã³ng bÄƒng timer khi pause)
                if paused:
                    # Náº¿u váº«n Ä‘ang pause (hiáº¿m), reset má»‘c thá»i gian Ä‘á»ƒ khÃ´ng cá»™ng dá»“n
                    last_check_time_list[0] = time.time()
                    continue
                active_time_list[0] += elapsed_since_last_check
                
                # 1. Kiá»ƒm tra thá»i gian cháº¡y (dÃ¹ng active_time thay vÃ¬ wall clock)
                if duration and active_time_list[0] >= duration:
                    print(f"â³ Háº¿t giá» cháº¡y (Ä‘Ã£ cháº¡y {active_time_list[0]:.1f}s / {duration}s).")
                    break
                
                # ============================================================
                # CHIáº¾N THUáº¬T: SCAN & SCROLL (Äá»’NG Bá»˜)
                # ============================================================
                
                # Bot cuá»™n vÃ  tráº£ vá» bÃ i viáº¿t (náº¿u cÃ³) cÃ¹ng loáº¡i (green/yellow)
                post, post_type = self.fb.scan_while_scrolling()

                if post:
                    self.fb.process_post(post, post_type)

                    delay = random.uniform(12.0, 20.0)
                    print(f"ðŸ˜´ Nghá»‰ sau khi xá»­ lÃ½ bÃ i {delay:.1f}s")
                    # Sleep vá»›i pause check: chá»‰ tÃ­nh thá»i gian khÃ´ng pause vÃ o active_time
                    self._sleep_with_pause_check(delay, profile_id, active_time_list, last_check_time_list)
                else:
                    delay = random.uniform(3.0, 5.0)
                    print(f"ðŸ˜´ KhÃ´ng cÃ³ bÃ i â€“ nghá»‰ {delay:.1f}s")
                    # Sleep vá»›i pause check
                    self._sleep_with_pause_check(delay, profile_id, active_time_list, last_check_time_list)



                # Random mouse move nháº¹ cho Ä‘á»¡ bá»‹ check bot
                
            
            except RuntimeError as e:
                # Náº¿u lÃ  exception Ä‘áº·c biá»‡t BROWSER_CLOSED thÃ¬ dá»«ng ngay
                if "BROWSER_CLOSED" in str(e) or "EMERGENCY_STOP" in str(e):
                    print(f"ðŸ›‘ Dá»«ng bot ngay láº­p tá»©c ({e})")
                    break
                raise  # Re-raise náº¿u khÃ´ng pháº£i BROWSER_CLOSED
            except Exception as e:
                error_msg = str(e).lower()
                # Náº¿u browser/page Ä‘Ã£ bá»‹ Ä‘Ã³ng thÃ¬ dá»«ng luÃ´n
                if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                    print(f"ðŸ›‘ Browser Ä‘Ã£ bá»‹ Ä‘Ã³ng -> Dá»«ng bot")
                    break
                print(f"âš ï¸ Lá»—i scan: {e}")
                # Sleep vá»›i pause check cho lá»—i
                self._sleep_with_pause_check(2.0, profile_id, active_time_list, last_check_time_list)
--- END FILE: backend\core\scraper.py ---

--- START FILE: backend\core\search_worker.py ---
import sys
import os
import urllib.parse
import time
import re
import random
from typing import Optional

# --- SETUP ÄÆ¯á»œNG DáºªN Äá»‚ IMPORT CORE ---
current_dir = os.path.dirname(os.path.abspath(__file__))
parent_dir = os.path.dirname(current_dir)
sys.path.append(parent_dir)

from core.nst import connect_profile
from core.nst import stop_profile
from core.browser import FBController, JS_EXPAND_SCRIPT, JS_CHECK_AND_HIGHLIGHT_SCOPED
from core.scraper import SimpleBot
from core.control import smart_sleep
from core.account_status import check_account_status_brutal, save_account_status

# ==============================================================================
# "HÃ€NH VI NGÆ¯á»œI THáº¬T": thi thoáº£ng má»Ÿ ThÃ´ng bÃ¡o rá»“i Back (8â€“15 phÃºt/láº§n)
# ==============================================================================
def _random_notification_interval_seconds() -> int:
    return random.randint(12 * 60 , 15 * 60 )


def click_notifications_button(fb: FBController) -> bool:
    """
    Click nÃºt 'ThÃ´ng bÃ¡o' trÃªn Facebook (top bar).
    Æ¯u tiÃªn role + aria-label, khÃ´ng dÃ¹ng class Ä‘á»™ng.
    """
    if not fb or not getattr(fb, "page", None):
        return False

    page = fb.page

    # Æ¯u tiÃªn role=button + aria-label
    try:
        btn = page.get_by_role(
            "button",
            name=re.compile(r"(ThÃ´ng bÃ¡o|Notifications)", re.IGNORECASE),
        )
        if btn.count() > 0:
            btn.first.click(timeout=3000)
            return True
    except Exception:
        pass

    # Fallback: querySelector
    try:
        clicked = page.evaluate(
            """
            () => {
                const el = document.querySelector(
                    '[role="button"][aria-label^="ThÃ´ng bÃ¡o"], [role="button"][aria-label^="Notifications"]'
                );
                if (el) { el.click(); return true; }
                return false;
            }
            """
        )
        return bool(clicked)
    except Exception:
        return False


def get_notifications_panel(page):
    """
    Láº¥y scope panel ThÃ´ng bÃ¡o (dialog).
    Náº¿u khÃ´ng tÃ¬m Ä‘Æ°á»£c thÃ¬ fallback vá» page.
    """
    try:
        panel = page.locator(
            'div[role="dialog"][aria-label^="ThÃ´ng bÃ¡o"], div[role="dialog"][aria-label^="Notifications"]'
        )
        if panel.count() > 0:
            return panel.first
    except Exception:
        pass

    return page


def click_random_notification(fb: FBController) -> bool:
    """
    Giáº£ Ä‘á»‹nh panel ThÃ´ng bÃ¡o Ä‘Ã£ má»Ÿ.
    Click ngáº«u nhiÃªn 1 thÃ´ng bÃ¡o há»£p lá»‡.
    """
    if not fb or not getattr(fb, "page", None):
        return False

    page = fb.page
    panel = get_notifications_panel(page)

    try:
        links = panel.locator('div[role="listitem"] a[role="link"]')
        count = links.count()
        if count == 0:
            print("âš ï¸ KhÃ´ng cÃ³ thÃ´ng bÃ¡o nÃ o Ä‘á»ƒ click")
            return False

        def skip(href: Optional[str]) -> bool:
            if not href:
                return True
            h = str(href).strip()
            return (
                h == "/notifications/"
                or h.startswith("/notifications/?")
                or "facebook.com/notifications" in h
            )

        for _ in range(min(10, count)):
            idx = random.randint(0, count - 1)
            link = links.nth(idx)
            try:
                href = link.get_attribute("href")
            except Exception:
                href = None
            if skip(href):
                continue

            print(f"ðŸ”” Click thÃ´ng bÃ¡o random: {href}")
            link.click(timeout=5000)
            return True

        print("âš ï¸ KhÃ´ng tÃ¬m Ä‘Æ°á»£c thÃ´ng bÃ¡o há»£p lá»‡")
        return False

    except Exception as e:
        print(f"âŒ Lá»—i click_random_notification: {e}")
        return False


def open_notifications_random_then_back(
    fb: FBController,
    wait_seconds: Optional[int] = None,
    reload_after_back: bool = False,
) -> bool:
    """
    Flow hoÃ n chá»‰nh:
    - Má»Ÿ ThÃ´ng bÃ¡o
    - Click random 1 thÃ´ng bÃ¡o
    - Äá»£i (10â€“15s hoáº·c custom)
    - Back
    - (Tuá»³ chá»n) Reload Ä‘á»ƒ reset feed state (chá»‰ nÃªn dÃ¹ng cho Feed)
    """
    if not fb or not getattr(fb, "page", None):
        return False

    page = fb.page

    if not click_notifications_button(fb):
        print("âš ï¸ KhÃ´ng má»Ÿ Ä‘Æ°á»£c ThÃ´ng bÃ¡o")
        return False

    # Chá» panel render
    try:
        smart_sleep(5.0, fb.profile_id)
    except RuntimeError as e:
        if "EMERGENCY_STOP" in str(e):
            raise
        smart_sleep(5.0, fb.profile_id)

    if not click_random_notification(fb):
        return False

    delay = int(wait_seconds) if wait_seconds is not None else random.randint(10, 15)
    print(f"â³ Äá»£i {delay}s rá»“i back")
    try:
        smart_sleep(float(delay), fb.profile_id)
    except RuntimeError as e:
        if "EMERGENCY_STOP" in str(e):
            raise
        smart_sleep(float(delay), fb.profile_id)

    # ===== BACK =====
    try:
        page.go_back(timeout=0)
    except Exception:
        try:
            page.keyboard.press("Alt+ArrowLeft")
        except Exception:
            print("âš ï¸ go_back fail")
            return False

    # ===== RELOAD (chá»‰ cho Feed náº¿u báº­t) =====
    if not reload_after_back:
        return True

    try:
        print("ðŸ”„ Reload feed Ä‘á»ƒ reset state")
        smart_sleep(random.uniform(1.5, 3.0), fb.profile_id)  # human-like
        page.reload(wait_until="domcontentloaded")
        smart_sleep(3.0, fb.profile_id)
        return True
    except RuntimeError as e:
        if "EMERGENCY_STOP" in str(e):
            raise
        print(f"âš ï¸ Reload fail: {e}")
        return False
    except Exception as e:
        print(f"âš ï¸ Reload fail: {e}")
        return False


class HumanLikeBot(SimpleBot):
    """
    Káº¿ thá»«a SimpleBot Ä‘á»ƒ gáº¯n nhá»‹p má»Ÿ ThÃ´ng bÃ¡o 8â€“15 phÃºt/láº§n,
    CHá»ˆ trigger sau khi Ä‘Ã£ xá»­ lÃ½ xong 1 post + nghá»‰ tá»± nhiÃªn.
    Sá»­ dá»¥ng ACTIVE TIME thay vÃ¬ wall-clock time.
    """
    def run(self, url, duration=None):
        print(f"ðŸš€ Äang truy cáº­p: {url}")
        # Äiá»u hÆ°á»›ng trá»±c tiáº¿p tá»›i URL má»¥c tiÃªu (feed/search)
        self.fb.goto(url)

        # ==== CHECK ACCOUNT STATUS Má»˜T Láº¦N SAU KHI VÃ€O TRANG Má»¤C TIÃŠU ====
        # - Chá»‰ kiá»ƒm tra 1 láº§n lÃºc báº¯t Ä‘áº§u
        # - Náº¿u nghi bá»‹ khÃ³a/bá»‹ ban => dá»«ng bot cho profile nÃ y (ACCOUNT_BANNED)
        # - KhÃ´ng tá»± Ä‘iá»u hÆ°á»›ng thÃªm láº§n ná»¯a
        profile_id = getattr(self.fb, "profile_id", None)
        if profile_id:
            try:
                print(f"ðŸ” [ACCOUNT_STATUS] Kiá»ƒm tra tráº¡ng thÃ¡i account cho profile {profile_id} (sau khi vÃ o URL)...")
                status = check_account_status_brutal(self.fb)
                status["profile_id"] = profile_id
                status["checked_at"] = time.strftime("%Y-%m-%d %H:%M:%S")
                save_account_status(profile_id, status)

                if status.get("banned"):
                    error_msg = f"â›” [ACCOUNT_BANNED] Profile {profile_id} bá»‹ khÃ³a/bá»‹ ban: {status.get('message')}"
                    print(error_msg)
                    # Dá»ªNG BOT cho profile nÃ y (quÃ©t/nuÃ´i) nhÆ°ng khÃ´ng áº£nh hÆ°á»Ÿng profile khÃ¡c
                    raise RuntimeError(f"ACCOUNT_BANNED: {status.get('message')}")
                else:
                    print(f"âœ… [ACCOUNT_STATUS] Profile {profile_id} OK: {status.get('message')}")
            except RuntimeError:
                # ACCOUNT_BANNED hoáº·c STOP/PAUSE sáº½ Ä‘Æ°á»£c xá»­ lÃ½ á»Ÿ layer trÃªn
                raise
            except Exception as e:
                # KhÃ´ng cho phÃ©p lá»—i check account lÃ m vá»¡ luá»“ng cÅ©
                print(f"âš ï¸ [ACCOUNT_STATUS] KhÃ´ng kiá»ƒm tra Ä‘Æ°á»£c tráº¡ng thÃ¡i account: {e}")

        # ACTIVE TIME tracking (chá»‰ tÄƒng khi khÃ´ng pause)
        active_time = 0.0
        next_notify_active_time = _random_notification_interval_seconds()

        while True:
            try:
                # Check duration báº±ng ACTIVE TIME
                if duration and active_time >= duration:
                    print("â³ Háº¿t giá» cháº¡y.")
                    break

                post, post_type = self.fb.scan_while_scrolling()

                if post:
                    self.fb.process_post(post, post_type)

                    delay = random.uniform(12.0, 20.0)
                    print(f"ðŸ˜´ Nghá»‰ sau khi xá»­ lÃ½ bÃ i {delay:.1f}s")
                    try:
                        smart_sleep(delay, self.fb.profile_id)
                        # Chá»‰ tÄƒng active_time khi smart_sleep return bÃ¬nh thÆ°á»ng (khÃ´ng pause)
                        active_time += delay
                    except RuntimeError as e:
                        if "EMERGENCY_STOP" in str(e):
                            raise
                        # Náº¿u pause thÃ¬ khÃ´ng tÄƒng active_time

                    # ===== ÄIá»‚M CHá»T: chá»‰ má»Ÿ thÃ´ng bÃ¡o sau DONE + nghá»‰ =====
                    if active_time >= next_notify_active_time:
                        # Chá»‰ reload sau khi back náº¿u Ä‘ang cháº¡y Feed (trang chá»§).
                        is_feed = str(url or "").strip().rstrip("/") == "https://www.facebook.com"
                        try:
                            open_notifications_random_then_back(self.fb, reload_after_back=is_feed)
                            next_notify_active_time = active_time + _random_notification_interval_seconds()
                        except RuntimeError as e:
                            if "EMERGENCY_STOP" in str(e):
                                raise
                else:
                    delay = random.uniform(3.0, 5.0)
                    print(f"ðŸ˜´ KhÃ´ng cÃ³ bÃ i â€“ nghá»‰ {delay:.1f}s")
                    try:
                        smart_sleep(delay, self.fb.profile_id)
                        # Chá»‰ tÄƒng active_time khi smart_sleep return bÃ¬nh thÆ°á»ng (khÃ´ng pause)
                        active_time += delay
                    except RuntimeError as e:
                        if "EMERGENCY_STOP" in str(e):
                            raise
                        # Náº¿u pause thÃ¬ khÃ´ng tÄƒng active_time

            except RuntimeError as e:
                if "EMERGENCY_STOP" in str(e):
                    print("ðŸ›‘ Dá»«ng do EMERGENCY_STOP")
                    raise
                print(f"âŒ Lá»—i vÃ²ng láº·p: {e}")
                try:
                    smart_sleep(2.0, self.fb.profile_id)
                    active_time += 2.0
                except RuntimeError as stop_e:
                    if "EMERGENCY_STOP" in str(stop_e):
                        raise

def _parse_location_terms(raw_text: str, strip_terms: Optional[list[str]] = None) -> list[str]:
    """
    User input dáº¡ng: "báº¯c ninh , báº¯c giang" hoáº·c "tuyá»ƒn dá»¥ng báº¯c ninh , báº¯c giang"
    => tráº£ vá» ["báº¯c ninh", "báº¯c giang"]
    """
    text = str(raw_text or "").strip().lower()
    if not text:
        return []

    parts = [p.strip() for p in re.split(r"[,;\n]+", text) if p.strip()]
    out: list[str] = []
    seen: set[str] = set()
    strip_terms = strip_terms or []

    for part in parts:
        cleaned = part
        # remove "job keywords" khá»i input náº¿u user dÃ­nh vÃ o location
        for term in strip_terms:
            t = str(term or "").strip().lower()
            if not t:
                continue
            cleaned = cleaned.replace(t, " ")
        cleaned = re.sub(r"\s+", " ", cleaned).strip()
        if not cleaned:
            continue
        if cleaned in seen:
            continue
        seen.add(cleaned)
        out.append(cleaned)

    return out

# ==============================================================================
# CLASS CONTROLLER Má»šI (CHá»ˆ LIKE, KHÃ”NG SHARE/SAVE)
# ==============================================================================
class SearchBotController(FBController):
    """
    Káº¿ thá»«a FBController nhÆ°ng sá»­a láº¡i hÃ m process_post
    Ä‘á»ƒ chá»‰ thá»±c hiá»‡n hÃ nh Ä‘á»™ng Like, bá» qua Share vÃ  Save ID.
    """
    def process_post(self, post_handle, post_type):
        try:
            print(f"ðŸ§  [FilterMode] Äang soi bÃ i viáº¿t (type={post_type})...")

            # 1. Expand ná»™i dung (Ä‘á»ƒ check keyword cho chuáº©n)
            self.page.evaluate(JS_EXPAND_SCRIPT, post_handle)

            required_locations: list[str] = getattr(self, "required_locations", []) or []
            # 2) DÃ¹ng Ä‘Ãºng hÃ m cÃ³ sáºµn cá»§a browser.py (JS_CHECK_AND_HIGHLIGHT_SCOPED)
            # - has_job_keyword: cÃ³ Ã­t nháº¥t 1 keyword máº·c Ä‘á»‹nh (job_keywords) trong Ná»˜I DUNG BÃ€I
            # - has_location_term: cÃ³ Ã­t nháº¥t 1 cá»¥m text user nháº­p (required_locations) trong Ná»˜I DUNG BÃ€I
            # => CHá»ˆ LIKE KHI (job_keyword) AND (location_term)
            has_job_keyword = self.page.evaluate(
                JS_CHECK_AND_HIGHLIGHT_SCOPED,
                [post_handle, self.job_keywords]
            )
            # Náº¿u user khÃ´ng nháº­p text (feed mode), thÃ¬ bá» qua Ä‘iá»u kiá»‡n location (coi nhÆ° pass)
            has_location_term = True if not required_locations else self.page.evaluate(
                JS_CHECK_AND_HIGHLIGHT_SCOPED,
                [post_handle, required_locations]
            )

            has_keyword = bool(has_job_keyword and has_location_term)

            if not has_keyword:
                print("âŒ KhÃ´ng Ä‘áº¡t Ä‘iá»u kiá»‡n (cáº§n keyword máº·c Ä‘á»‹nh + cÃ³ 1 trong text nháº­p) -> Bá» qua")
                self.mark_post_as_processed(post_handle)
                
                # Scroll qua bÃ i viáº¿t Ä‘á»ƒ tiáº¿p tá»¥c
                try:
                    viewport = self.page.viewport_size
                    height = viewport['height'] if viewport else 800
                    self.smooth_scroll(height * 0.4)
                    time.sleep(random.uniform(0.1, 0.15))
                except Exception:
                    pass
                
                return False

            print("âœ… BÃ i Ä‘áº¡t Ä‘iá»u kiá»‡n (keyword máº·c Ä‘á»‹nh + text nháº­p)!")

            # Like theo xÃ¡c suáº¥t Ä‘á»ƒ Ä‘áº£m báº£o khoáº£ng cÃ¡ch 45-90 giÃ¢y giá»¯a cÃ¡c láº§n like:
            # - Vá»›i nghá»‰ 12-20s sau má»—i bÃ i, Ä‘á»ƒ cÃ³ khoáº£ng cÃ¡ch 45-90s cáº§n like 20-30% bÃ i
            # - Sau Ä‘Ã³ roll Ä‘á»ƒ quyáº¿t Ä‘á»‹nh cÃ³ Like hay khÃ´ng
            p = random.uniform(0.3, 0.4)
            roll = random.random()
            should_like = roll < p
            print(f"ðŸŽ² [LikeProb] p={p:.2f} roll={roll:.2f} -> {'LIKE' if should_like else 'SKIP'}")
            if should_like:
                # like_current_post tá»± bá» qua náº¿u bÃ i Ä‘Ã£ Like
                self.like_current_post(post_handle)

            # 4. ÄÃ¡nh dáº¥u Ä‘Ã£ xá»­ lÃ½ (Äá»ƒ bot lÆ°á»›t tiáº¿p bÃ i sau)
            self.mark_post_as_processed(post_handle)
            
            return True

        except Exception as e:
            print(f"âŒ Lá»—i process_post: {e}")
            return False

# ==============================================================================
# HÃ€M 1: TÃŒM KIáº¾M & LIKE (Trang Search)
# ==============================================================================
def search_and_like(profile_id: str, search_text: str, duration_minutes: int = 30, all_profile_ids=None):
    """Nháº­p tá»« khÃ³a -> VÃ o trang Search -> LÆ°á»›t & Like bÃ i cÃ³ tá»« khÃ³a"""
    try:
        # 1. Táº¡o URL TÃ¬m kiáº¿m
        encoded_query = urllib.parse.quote_plus(search_text)
        target_url = f"https://www.facebook.com/search/posts?q={encoded_query}"
        
        print(f"ðŸ” [Search] Tá»« khÃ³a: '{search_text}'")
        print(f"ðŸ”— Link: {target_url}")

        _run_bot_logic(profile_id, target_url, search_text, duration_minutes, all_profile_ids=all_profile_ids)

    except Exception as e:
        print(f"âŒ Lá»—i search_and_like: {e}")

# ==============================================================================
# HÃ€M 2: LÆ¯á»šT NEWFEED & LIKE (Trang Chá»§)
# ==============================================================================
def feed_and_like(profile_id: str, filter_text: str, duration_minutes: int = 30, all_profile_ids=None):
    """VÃ o trang chá»§ (Feed) -> LÆ°á»›t -> Chá»‰ Like bÃ i nÃ o chá»©a filter_text"""
    try:
        # 1. URL lÃ  Trang chá»§
        target_url = "https://www.facebook.com/"
        
        print(f"ðŸ  [Feed] LÆ°á»›t News Feed tÃ¬m tá»« khÃ³a: '{filter_text}'")
        
        _run_bot_logic(profile_id, target_url, filter_text, duration_minutes, all_profile_ids=all_profile_ids)

    except Exception as e:
        print(f"âŒ Lá»—i feed_and_like: {e}")

# ==============================================================================
# HÃ€M CHáº Y CHUNG (CORE LOGIC)
# ==============================================================================
def _run_bot_logic(profile_id, url, raw_text, duration_minutes, all_profile_ids=None):
    try:
        # 1. Káº¿t ná»‘i
        print(f"ðŸš€ Äang má»Ÿ profile: {profile_id}")
        ws_url = connect_profile(profile_id)
        
        # DÃ¹ng Controller Ä‘Ã£ cáº¯t bá» Share/Save
        fb = SearchBotController(ws_url)
        fb.profile_id = profile_id
        # âœ… giá»›i háº¡n dispatch/get_id chá»‰ trong cÃ¡c profile Ä‘ang cháº¡y (Ä‘Ã£ chá»n)
        try:
            if all_profile_ids:
                fb.all_profile_ids = list(all_profile_ids)
            else:
                fb.all_profile_ids = [profile_id]
        except Exception:
            fb.all_profile_ids = [profile_id]
        fb.connect()

        # 2. Setup filter rules
        # - Feed: cho phÃ©p raw_text rá»—ng => khÃ´ng lá»c location, chá»‰ dÃ¹ng job_keywords máº·c Ä‘á»‹nh
        # - Náº¿u user cÃ³ nháº­p raw_text nhÆ°ng parse ra rá»—ng (vd chá»‰ nháº­p "tuyá»ƒn dá»¥ng") thÃ¬ coi nhÆ° sai input
        raw_text_str = str(raw_text or "").strip()
        if not raw_text_str:
            locations = []
        else:
            # text nháº­p chá»‰ dÃ¹ng lÃ m "location terms" (OR), tÃ¡ch theo dáº¥u pháº©y
            locations = _parse_location_terms(raw_text_str, strip_terms=getattr(fb, "job_keywords", []))
            # Náº¿u user chá»‰ nháº­p keyword (vd: "tuyá»ƒn dá»¥ng") thÃ¬ locations cÃ³ thá»ƒ rá»—ng sau khi strip.
            # Khi Ä‘Ã³: khÃ´ng lá»c location, váº«n cháº¡y bÃ¬nh thÆ°á»ng theo job_keywords máº·c Ä‘á»‹nh.
            if not locations:
                print("â„¹ï¸ KhÃ´ng cÃ³ location tá»« input -> chá»‰ dÃ¹ng keyword máº·c Ä‘á»‹nh Ä‘á»ƒ lá»c.")

        fb.required_locations = locations
        if locations:
            print(f"âœ… Filter location (OR): {locations}")
        else:
            print("âœ… Filter location: (none) -> chá»‰ dÃ¹ng keyword máº·c Ä‘á»‹nh")
        print(f"âœ… Filter job keywords (default): {getattr(fb, 'job_keywords', [])}")
        
        # 3. Cháº¡y Bot (human-like: thá»‰nh thoáº£ng má»Ÿ thÃ´ng bÃ¡o)
        bot = HumanLikeBot(fb)
        print(f"â–¶ï¸ Báº¯t Ä‘áº§u lÆ°á»›t trong {duration_minutes} phÃºt...")
        duration_seconds = duration_minutes * 60
        
        try:
            bot.run(url, duration=duration_seconds)
        except RuntimeError as e:
            if "EMERGENCY_STOP" in str(e):
                print("ðŸ›‘ Dá»«ng bot do EMERGENCY_STOP")
                return
            if "ACCOUNT_BANNED" in str(e):
                print(f"ðŸ›‘ Dá»«ng bot do ACCOUNT_BANNED: {e}")
                return
            raise
        
    except RuntimeError as e:
        if "EMERGENCY_STOP" in str(e):
            print("ðŸ›‘ Dá»«ng runner do EMERGENCY_STOP")
            return
        if "ACCOUNT_BANNED" in str(e):
            print(f"ðŸ›‘ Dá»«ng runner do ACCOUNT_BANNED: {e}")
            return
        print(f"âŒ Lá»—i Runner: {e}")
    except Exception as e:
        print(f"âŒ Lá»—i Runner: {e}")
    finally:
        print("ðŸ›‘ Káº¿t thÃºc.")
        # ÄÃ³ng sáº¡ch tab/context playwright + stop NST (giá»‘ng join group / cookie)
        try:
            if 'fb' in locals() and fb:
                try:
                    if getattr(fb, "page", None):
                        try:
                            fb.page.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "browser", None) and getattr(fb.browser, "contexts", None):
                        for ctx in list(fb.browser.contexts):
                            try:
                                ctx.close()
                            except Exception:
                                pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "browser", None):
                        try:
                            fb.browser.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "play", None):
                        try:
                            fb.play.stop()
                        except Exception:
                            pass
                except Exception:
                    pass
        finally:
            try:
                stop_profile(profile_id)
            except Exception:
                pass

if __name__ == "__main__":
    # Module nÃ y Ä‘Æ°á»£c gá»i qua FastAPI (/feed/start). KhÃ´ng cháº¡y standalone.
    pass
--- END FILE: backend\core\search_worker.py ---

--- START FILE: backend\core\settings.py ---
import json
from dataclasses import dataclass, field
from functools import lru_cache
from pathlib import Path
from typing import List, Any, Dict
from core.paths import get_settings_path
# ÄÆ°á»ng dáº«n cá»‘ Ä‘á»‹nh Ä‘á»ƒ Ä‘á»c cáº¥u hÃ¬nh
SETTINGS_PATH = get_settings_path()


def _parse_bool(value: Any) -> bool:
    if isinstance(value, bool):
        return value
    if value is None:
        return False
    if isinstance(value, (int, float)):
        return bool(value)
    if isinstance(value, str):
        return value.strip().lower() in {"1", "true", "yes", "y", "on"}
    return False


def _coerce_positive_int(value: Any, default: int) -> int:
    try:
        num = int(value)
        return num if num > 0 else default
    except (TypeError, ValueError):
        return default


def _parse_profile_ids(value: Any) -> List[str]:
    """
    Tráº£ vá» danh sÃ¡ch profile_id.
    Há»— trá»£ cáº£ format cÅ© (list/string) vÃ  format má»›i (dict {id: {...}}).
    """
    if isinstance(value, dict):
        items = value.keys()
    elif isinstance(value, list):
        items = value
    elif isinstance(value, str):
        items = value.split(",")
    else:
        return []

    return [str(item).strip() for item in items if str(item).strip()]


def _parse_profile_configs(value: Any) -> Dict[str, Any]:
    """
    LÆ°u láº¡i toÃ n bá»™ cáº¥u hÃ¬nh profile (cookie, access_token, ...)
    Ä‘á»ƒ cÃ³ thá»ƒ dÃ¹ng vá» sau.
    """
    if isinstance(value, dict):
        return {str(k).strip(): v for k, v in value.items() if str(k).strip()}

    # Fallback cho format cÅ©: chá»‰ táº¡o map rá»—ng tá»« danh sÃ¡ch id
    ids = _parse_profile_ids(value)
    return {pid: {} for pid in ids}


@dataclass
class Settings:
    api_key: str
    headless: bool = False
    target_url: str = "https://facebook.com"
    profile_ids: List[str] = field(default_factory=list)
    profile_configs: Dict[str, Any] = field(default_factory=dict)
    run_minutes: int = 30
    rest_minutes: int = 120


@lru_cache(maxsize=1)
def get_settings() -> Settings:
    """
    Äá»c vÃ  cache cáº¥u hÃ¬nh tá»« settings.json.
    Gá»i get_settings.cache_clear() náº¿u cáº§n reload.
    """
    if not SETTINGS_PATH.exists():
        raise FileNotFoundError(f"KhÃ´ng tÃ¬m tháº¥y file cáº¥u hÃ¬nh: {SETTINGS_PATH}")

    with SETTINGS_PATH.open(encoding="utf-8") as f:
        try:
            raw = json.load(f)
        except json.JSONDecodeError as exc:
            raise ValueError(f"settings.json khÃ´ng há»£p lá»‡: {exc}") from exc

    return Settings(
        api_key=str(raw.get("API_KEY", "")),
        headless=_parse_bool(raw.get("HEADLESS", False)),
        target_url=str(raw.get("TARGET_URL", "https://facebook.com")),
        profile_ids=_parse_profile_ids(raw.get("PROFILE_IDS", [])),
        profile_configs=_parse_profile_configs(raw.get("PROFILE_IDS", {})),
        run_minutes=_coerce_positive_int(raw.get("RUN_MINUTES", 30), 30),
        rest_minutes=_coerce_positive_int(raw.get("REST_MINUTES", 120), 120),
    )


def reload_settings() -> Settings:
    """XÃ³a cache vÃ  Ä‘á»c láº¡i settings.json (dÃ¹ng khi file Ä‘á»•i ná»™i dung)."""
    get_settings.cache_clear()
    return get_settings()



--- END FILE: backend\core\settings.py ---

--- START FILE: backend\core\utils.py ---


import re

def extract_uid_from_url(url):
    """
    Chuyá»ƒn Ä‘á»•i link profile thÃ nh UID hoáº·c Username
    VÃ­ dá»¥: 
    - https://www.facebook.com/profile.php?id=10001234 -> 10001234
    - https://www.facebook.com/zuck?comment_id=... -> zuck
    """
    if not url: return None
    
    # TrÆ°á»ng há»£p 1: profile.php?id=12345
    match_id = re.search(r'profile\.php\?id=(\d+)', url)
    if match_id:
        return match_id.group(1)
        
    # TrÆ°á»ng há»£p 2: facebook.com/username
    # Loáº¡i bá» cÃ¡c tham sá»‘ rÃ¡c sau dáº¥u ? hoáº·c &
    clean_url = url.split('?')[0].split('&')[0]
    parts = clean_url.rstrip('/').split('/')
    
    # Láº¥y pháº§n cuá»‘i cÃ¹ng (username)
    if parts:
        user_part = parts[-1]
        if user_part not in ['facebook.com', 'www.facebook.com', '']:
            return user_part
            
    return None

def clean_profile_list(raw):
    """Chuáº©n hÃ³a danh sÃ¡ch profile tá»« string hoáº·c list."""
    if not raw:
        return []

    items = raw if isinstance(raw, list) else str(raw).split(",")
    return [str(p).strip() for p in items if str(p).strip()]
--- END FILE: backend\core\utils.py ---

--- START FILE: backend\core\__init__.py ---

--- END FILE: backend\core\__init__.py ---

--- START FILE: backend\data\account_status.json ---
{
  "b77da63d-af55-43c2-ab7f-364250b20e30": {
    "status": "OK",
    "banned": false,
    "url": "https://www.facebook.com/",
    "message": "âœ… Account sá»‘ng, chÆ°a phÃ¡t hiá»‡n dáº¥u hiá»‡u khÃ³a",
    "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
    "checked_at": "2025-12-26 03:21:41"
  },
  "caabaa64-f2c5-4254-a83b-7f6d57632503": {
    "status": "OK",
    "banned": false,
    "url": "https://www.facebook.com/",
    "message": "âœ… Account sá»‘ng, chÆ°a phÃ¡t hiá»‡n dáº¥u hiá»‡u khÃ³a",
    "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
    "checked_at": "2025-12-23 16:51:39"
  }
}
--- END FILE: backend\data\account_status.json ---

--- START FILE: backend\data\runtime_control.json ---
{
  "global_emergency_stop": false,
  "global_pause": false,
  "paused_profiles": [],
  "stopped_profiles": [],
  "profile_states": {
    "b77da63d-af55-43c2-ab7f-364250b20e30": "ERROR",
    "ed3bd3bf-d906-42cf-9503-b73dfcfce117": "ERROR"
  },
  "updated_at": "2025-12-26T07:38:05.799981+00:00"
}

--- END FILE: backend\data\runtime_control.json ---

--- START FILE: backend\data\post_ids\b77da63d-af55-43c2-ab7f-364250b20e30.json ---
[FILE QUÃ Lá»šN - ÄÃƒ Bá»Ž QUA Ná»˜I DUNG]: 2055296 bytes
--- END FILE: backend\data\post_ids\b77da63d-af55-43c2-ab7f-364250b20e30.json ---

--- START FILE: backend\data\post_ids\caabaa64-f2c5-4254-a83b-7f6d57632503.json ---
[
  {
    "id": "122171583440394422",
    "flag": "xanh",
    "text": "âœ¨ NHA KHOA META TUYá»‚N Dá»¤NG âœ¨ Vá»‹ trÃ­: BÃ¡c sÄ© RÄƒng Sá»© Tháº©m Má»¹ ChÃºng tÃ´i tÃ¬m kiáº¿m bÃ¡c sÄ© cÃ³ Ä‘á»‹nh hÆ°á»›ng phÃ¡t triá»ƒn lÃ¢u dÃ i trong lÄ©nh vá»±c rÄƒng sá»© tháº©m má»¹, mong muá»‘n lÃ m viá»‡c trong mÃ´i trÆ°á»ng chuáº©n chá»‰nh, tÃ´n trá»ng chuyÃªn mÃ´n vÃ  giÃ¡ trá»‹ cÃ¡ nhÃ¢n. ðŸ’° Thu nháº­p: Thá»a thuáº­n theo nÄƒng lá»±c (LÆ°Æ¡ng cá»©ng + KPI + ThÆ°á»Ÿng + Phá»¥ cáº¥p) ðŸ”¹ Há»‡ thá»‘ng mÃ¡y mÃ³c hiá»‡n Ä‘áº¡i ðŸ”¹ Nguá»“n khÃ¡ch á»•n Ä‘á»‹nh ðŸ”¹ Ekip há»— trá»£ chuyÃªn mÃ´n ðŸ”¹ Quy trÃ¬nh rÃµ rÃ ng â€“ minh báº¡ch ðŸ“ Äá»‹a chá»‰: 391 TrÆ°á»ng Chinh, Thanh XuÃ¢n, HÃ  Ná»™i ðŸ“² LiÃªn há»‡ á»©ng tuyá»ƒn: 036.903.6666",
    "owning_profile": {
      "__typename": "User",
      "name": "Tuyá»ƒn Dá»¥ng NhÃ¢n Sá»± Nha Khoa HÃ  Ná»™i",
      "id": "61561832674763"
    }
  }
]
--- END FILE: backend\data\post_ids\caabaa64-f2c5-4254-a83b-7f6d57632503.json ---

--- START FILE: backend\data\results\all_results_20251222_220621.json ---
{
  "total_files": 1,
  "results_by_file": {
    "b77da63d-af55-43c2-ab7f-364250b20e30.json": [
      {
        "post_id": "122152945058694563",
        "flag": "xanh",
        "text": "ðŸŽ‰ ðŸŒ¸ â€œTáº¿t Ä‘áº¿n xuÃ¢n vá» â€“ tÃ¬m viá»‡c Ä‘Ã¢u xa, Vingroup chÃ o Ä‘Ã³n â€“ má»Ÿ lá»‘i thÄƒng hoa!â€ ðŸŒ¸ ðŸŽ‰ ðŸ¢ VINGROUP â€“ TUYá»‚N Dá»¤NG KHá»I VÄ‚N PHÃ’NG TOÃ€N QUá»C ðŸ‡»ðŸ‡³ ðŸ‡»ðŸ‡³ Báº¡n Ä‘ang tÃ¬m kiáº¿m má»™t mÃ´i trÆ°á»ng á»•n Ä‘á»‹nh â€“ chuyÃªn nghiá»‡p â€“ cÃ³ lá»™ trÃ¬nh thÄƒng tiáº¿n rÃµ rÃ ng? ðŸ‡»ðŸ‡³ Vingroup â€“ Táº­p Ä‘oÃ n kinh táº¿ tÆ° nhÃ¢n hÃ ng Ä‘áº§u Viá»‡t Nam â€“ Ä‘ang má»Ÿ rá»™ng Ä‘á»™i ngÅ© vÄƒn phÃ²ng trÃªn toÃ n quá»‘c, sáºµn sÃ ng Ä‘á»“ng hÃ nh cÃ¹ng báº¡n bÆ°á»›c vÃ o nÄƒm má»›i vá»›i nhiá»u cÆ¡ há»™i phÃ¡t triá»ƒn Ä‘á»™t phÃ¡. ðŸ’¢ Vá»Š TRÃ ÄANG TUYá»‚N ðŸ”– NhÃ¢n ViÃªn Káº¿ ToÃ¡n ðŸ”– ChuyÃªn ViÃªn Quáº£n LÃ½ Kinh Doanh ðŸ”– NhÃ¢n ViÃªn TÆ° Váº¥n ChÄƒm SÃ³c KhÃ¡ch HÃ ng ðŸ”– TrÆ°á»Ÿng PhÃ²ng Xuáº¥t Nháº­p Kháº©u ðŸ”– TrÆ°á»Ÿng PhÃ²ng Tiáº¿p Thá»‹ ThÆ°Æ¡ng Máº¡i ðŸ”– TrÆ°á»Ÿng PhÃ²ng HÃ nh ChÃ­nh NhÃ¢n Sá»± ðŸ“ LÃ m viá»‡c táº¡i cÃ¡c vÄƒn phÃ²ng Ä‘áº¡i diá»‡n trÃªn toÃ n quá»‘c ðŸŽ¯ Táº I SAO Báº N NÃŠN á»¨NG TUYá»‚N NGAY? â–ªï¸ Thu nháº­p háº¥p dáº«n, thÆ°á»Ÿng Táº¿t rÃµ rÃ ng â–ªï¸ Báº£o hiá»ƒm Ä‘áº§y Ä‘á»§, phÃºc lá»£i á»•n Ä‘á»‹nh â–ªï¸ CÆ¡ há»™i phÃ¡t triá»ƒn sá»± nghiá»‡p, Ä‘Æ°á»£c Ä‘Ã o táº¡o chuyÃªn sÃ¢u â–ªï¸ MÃ´i trÆ°á»ng lÃ m viá»‡c minh báº¡ch, hiá»‡n Ä‘áº¡i, chuyÃªn nghiá»‡p ðŸ“¨ Ná»™p há»“ sÆ¡ trá»±c tuyáº¿n táº¡i: https://qrco.de/tuyendungVinGroup ðŸ‘‰ Tag ngÆ°á»i phÃ¹ há»£p hoáº·c chia sáº» ngay cÆ¡ há»™i tuyá»‡t vá»i nÃ y! ðŸŒŸ VINGROUP â€“ NÆ¡i tÃ i nÄƒng Ä‘Æ°á»£c phÃ¡t huy vÃ  thÃ nh cÃ´ng Ä‘Æ°á»£c ghi nháº­n. CÃ¹ng khá»Ÿi Ä‘á»™ng nÄƒm má»›i vá»›i bÆ°á»›c tiáº¿n vá»¯ng vÃ ng trong sá»± nghiá»‡p! #Vingroup #TuyenDungTet2025 #CoHoiNgheNghiep #ViecLamVanPhong #DonXuanVingroup",
        "owning_profile": {
          "__typename": "User",
          "name": "Tuyá»ƒn Dá»¥ng VinGroup",
          "id": "61570836905496"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "1002263592",
            "name": "Ran Kaori"
          },
          {
            "id": "1234976494",
            "name": "Ha Tran"
          },
          {
            "id": "1268544510",
            "name": "VÄƒn ÄÃ¬nh LÃ¢m"
          },
          {
            "id": "1277446090",
            "name": "Nguyá»…n VÄƒn Tuá»‡"
          },
          {
            "id": "1485344389",
            "name": "Hong Hanh"
          },
          {
            "id": "1572664685",
            "name": "Vu Ngoc Lan"
          },
          {
            "id": "1790504763",
            "name": "Huong Nguyen"
          },
          {
            "id": "1830492804",
            "name": "Martin Ngo"
          },
          {
            "id": "61550123255824",
            "name": "Jenny Tráº§n"
          },
          {
            "id": "61550963711871",
            "name": "ÄÃ o Quang Huáº¥n"
          },
          {
            "id": "61551494556150",
            "name": "Nguyá»…n Thá»‹ Duyá»‡t"
          },
          {
            "id": "61551798632228",
            "name": "Tuan Anh"
          },
          {
            "id": "61552652491139",
            "name": "VÃµ Ngá»c HuyÃªn"
          },
          {
            "id": "61552709622705",
            "name": "HoÃ ng Máº¡nh"
          },
          {
            "id": "61553747960696",
            "name": "Long Gia"
          },
          {
            "id": "61553761829719",
            "name": "Nam Hoang"
          },
          {
            "id": "61555731806498",
            "name": "Minh Äá»©c"
          },
          {
            "id": "61556120043116",
            "name": "Mai Tráº§n Minh"
          },
          {
            "id": "61556452044279",
            "name": "Anh Long"
          },
          {
            "id": "61556795983288",
            "name": "Bass House"
          },
          {
            "id": "61557071407694",
            "name": "DÆ°Æ¡ng Thuyáº¿t"
          },
          {
            "id": "61557775749884",
            "name": "Nguyá»…n Thá»‹ VÄƒn"
          },
          {
            "id": "61564149783940",
            "name": "Ngá»c HÃ "
          },
          {
            "id": "61564578580794",
            "name": "Nguyá»…n Khanh"
          },
          {
            "id": "61567168498234",
            "name": "Há»“ PhÆ°Æ¡ng"
          },
          {
            "id": "61569010118881",
            "name": "Elvis PhÆ°Æ¡ng"
          },
          {
            "id": "61569180890275",
            "name": "Nguyá»…n TrÆ°á»ng"
          },
          {
            "id": "61569272138269",
            "name": "HÃ¢n Sáº§u"
          },
          {
            "id": "61570253625383",
            "name": "Äinh Há»“ng Tuá»‡ Hr"
          },
          {
            "id": "61571187577749",
            "name": "Dung Nguyá»…n"
          },
          {
            "id": "61571406964597",
            "name": "LÃª Anh Háº£i"
          },
          {
            "id": "61571671900364",
            "name": "Nguyá»…n VÆ°Æ¡ng Nhi"
          },
          {
            "id": "61571840248551",
            "name": "Tráº§n Diá»‡p BÄ‘s"
          },
          {
            "id": "61571848330448",
            "name": "Há»“ PhÆ°Æ¡ng"
          },
          {
            "id": "61572490859745",
            "name": "To Lan Thinh"
          },
          {
            "id": "61572842294221",
            "name": "HÃ  Phan Thu"
          },
          {
            "id": "61573733657294",
            "name": "Há»“ Má»™c NhÃ¢n"
          },
          {
            "id": "61573734497403",
            "name": "Pháº¡m ThÃ nh An"
          },
          {
            "id": "61573744547227",
            "name": "Huá»³nh Thá»¥y Ca"
          },
          {
            "id": "61573852654944",
            "name": "VÄƒn Háº£i"
          },
          {
            "id": "61573988684453",
            "name": "VÅ© Thuá»³ Dung"
          },
          {
            "id": "61574010964642",
            "name": "Huá»³nh Há»“ng QuÃ¢n"
          },
          {
            "id": "61574110798886",
            "name": "Phan Nháº­t Mi"
          },
          {
            "id": "61574152886242",
            "name": "Phan Thu NhÃ¢n"
          },
          {
            "id": "61574175593832",
            "name": "NgÃ´ Thiá»‡n Diá»‡p"
          },
          {
            "id": "61574258109121",
            "name": "Kháº£i Tá»‹nh"
          },
          {
            "id": "61574867364927",
            "name": "Nguyá»…n VÄƒn Tráº¯ng"
          },
          {
            "id": "61574978456212",
            "name": "Bee Bee"
          },
          {
            "id": "61575737576229",
            "name": "TÃ´n Long"
          },
          {
            "id": "61576253253121",
            "name": "Le Giap"
          },
          {
            "id": "61576570737659",
            "name": "PhÃ¡p Thiá»‡n Yuuta"
          },
          {
            "id": "61577718142636",
            "name": "Nam HoÃ i LÃª"
          },
          {
            "id": "61577831266701",
            "name": "NhÃ  Phá»‘ TrÆ°á»ng Khang"
          },
          {
            "id": "61577891019065",
            "name": "Äá»— Thá»‹ Tá»‘ TrÃ¢n"
          },
          {
            "id": "61577913800061",
            "name": "Phan Tien Thai"
          },
          {
            "id": "61577966011957",
            "name": "LÃª Thá»‹ Yáº¿n Nhi"
          },
          {
            "id": "61577990310795",
            "name": "Nguyá»…n ThÃ nh Luyáº¿n"
          },
          {
            "id": "61578060900327",
            "name": "Há»“ Thá»‹ Cáº©m Giang"
          },
          {
            "id": "61578588352981",
            "name": "Anh Minh"
          },
          {
            "id": "61578920644052",
            "name": "Háº£i LuÃ¢n"
          },
          {
            "id": "61579609253307",
            "name": "LÆ°u Hiá»n"
          },
          {
            "id": "61579616184503",
            "name": "Dáº«n Nguyá»…n"
          },
          {
            "id": "61579778518833",
            "name": "Vu Huong"
          },
          {
            "id": "61579924336884",
            "name": "Thai Pham"
          },
          {
            "id": "61580075301277",
            "name": "Nguyá»…n Thá»‹ Kim Dung"
          },
          {
            "id": "61580091380494",
            "name": "Huá»³nh Diá»…m"
          },
          {
            "id": "61580652643855",
            "name": "LÃª Quang Nha"
          },
          {
            "id": "61581145032703",
            "name": "Chan Dang Quay"
          },
          {
            "id": "61581397461144",
            "name": "Tran Phuc Giáº·t LÃ "
          },
          {
            "id": "61581418713978",
            "name": "ChiÃªm Khang DÆ°Æ¡ng"
          },
          {
            "id": "61581689701972",
            "name": "Khá»•ng Báº£o Tuáº¥n"
          },
          {
            "id": "61582487331614",
            "name": "Nguyá»…n Khang Land"
          },
          {
            "id": "61582779520068",
            "name": "Thanh Äinh XuÃ¢n"
          },
          {
            "id": "61582832777139",
            "name": "Tran Phat Ngan"
          },
          {
            "id": "61582869747879",
            "name": "Anh Nguyen"
          },
          {
            "id": "61583102734016",
            "name": "Mai Linh Son"
          },
          {
            "id": "61583218533495",
            "name": "KhÃ¡nh ÄÃ o"
          },
          {
            "id": "61583648552185",
            "name": "Anh Dung LÃª"
          },
          {
            "id": "61584927061788",
            "name": "LÃª KhÃ¡nh"
          },
          {
            "id": "61585066443817",
            "name": "TÃ¢m Thiá»‡n"
          },
          {
            "id": "100000033162372",
            "name": "LÆ°Æ¡ng ThÃ¡i SÆ¡n"
          },
          {
            "id": "100000046953514",
            "name": "Nguyen Thuy Binh"
          },
          {
            "id": "100000074903034",
            "name": "Ngoc Long"
          },
          {
            "id": "100000100445450",
            "name": "Nguyen Xuan Hoang"
          },
          {
            "id": "100000110883929",
            "name": "Ha Thanh Chung"
          },
          {
            "id": "100000118488636",
            "name": "Anh Tuan Dang"
          },
          {
            "id": "100000146503895",
            "name": "Tuan Bui Duc"
          },
          {
            "id": "100000199586797",
            "name": "HoÃ ng Há»“ng"
          },
          {
            "id": "100000206390872",
            "name": "Ha Vo Ngoc"
          },
          {
            "id": "100000227057333",
            "name": "Le van Luu"
          },
          {
            "id": "100000233054222",
            "name": "Nguyá»…n Äá»©c CÃ´ng"
          },
          {
            "id": "100000233458095",
            "name": "Äá»©c Anh"
          },
          {
            "id": "100000241421870",
            "name": "CÆ°á»ng LÃ£ ÄÄƒng"
          },
          {
            "id": "100000285841717",
            "name": "Trinh Vinh"
          },
          {
            "id": "100000299911498",
            "name": "Thanh BÃ¬nh"
          },
          {
            "id": "100000335930188",
            "name": "Tien Dang"
          },
          {
            "id": "100000359003842",
            "name": "ÄÃ o Thá»‹ HÆ°Æ¡ng"
          },
          {
            "id": "100000372765424",
            "name": "Beverly Truong"
          },
          {
            "id": "100000391379114",
            "name": "ÄÄƒng Quang"
          },
          {
            "id": "100000440642840",
            "name": "Yuki Nguyen"
          },
          {
            "id": "100000465101424",
            "name": "Pham Lien"
          },
          {
            "id": "100000471456601",
            "name": "Bon Bon"
          },
          {
            "id": "100000536634518",
            "name": "VÅ© Van Thá»¥"
          },
          {
            "id": "100000574898744",
            "name": "LÃª Thu NÄƒm"
          },
          {
            "id": "100000627052981",
            "name": "Nguyá»…n XuÃ¢n HÃ²a"
          },
          {
            "id": "100000778527246",
            "name": "Nay QuyÃªn"
          },
          {
            "id": "100000941868141",
            "name": "Thoa Tran"
          },
          {
            "id": "100000980293146",
            "name": "KhÃ¡nh VÃ¢n"
          },
          {
            "id": "100000984300799",
            "name": "Tung Vu"
          },
          {
            "id": "100001022243294",
            "name": "Huyen Trieu"
          },
          {
            "id": "100001087908348",
            "name": "TÃ i. Cá»­a Tá»± Äá»™ng"
          },
          {
            "id": "100001120775721",
            "name": "LÃª Thá»‹ Minh PhÆ°á»£ng"
          },
          {
            "id": "100001342910831",
            "name": "La Hoa"
          },
          {
            "id": "100001443078158",
            "name": "Bim Lim Dim"
          },
          {
            "id": "100001508086380",
            "name": "Tháº¿ KhÆ°Æ¡ng Nguyá»…n"
          },
          {
            "id": "100001575392906",
            "name": "Huyá»n Anh Nguyá»…n"
          },
          {
            "id": "100001760897883",
            "name": "My Hieu Dao"
          },
          {
            "id": "100001812241811",
            "name": "VÅ© Thu Trang"
          },
          {
            "id": "100001911838667",
            "name": "PhÃºc Pi"
          },
          {
            "id": "100002236262875",
            "name": "DÆ°Æ¡ng TrÃ­ Thá»©c"
          },
          {
            "id": "100002239523184",
            "name": "Nguyá»…n NgÃ¢n ChÃ¢u"
          },
          {
            "id": "100002284338356",
            "name": "Phuong Vu Mai"
          },
          {
            "id": "100002380444871",
            "name": "Tráº§n TÃ¢n"
          },
          {
            "id": "100002395931625",
            "name": "Lyly Dang"
          },
          {
            "id": "100002422973147",
            "name": "Nguyá»…n ThÃ nh ÄÃ´"
          },
          {
            "id": "100002448663492",
            "name": "BÃ¹i Tuyáº¿t"
          },
          {
            "id": "100002618172780",
            "name": "Tráº§n DÅ©ng"
          },
          {
            "id": "100002654683809",
            "name": "Nguyá»…n Dung"
          },
          {
            "id": "100002768697384",
            "name": "Van Linh Nguyen"
          },
          {
            "id": "100002828608496",
            "name": "Tháº¯ng LÃª ÄÄƒng"
          },
          {
            "id": "100002894088361",
            "name": "HoÃ ng Phi HÃ¹ng"
          },
          {
            "id": "100002918321046",
            "name": "Thuá»³ Äá»—"
          },
          {
            "id": "100002946674698",
            "name": "HÃ²e Nguyá»…n VÄƒn"
          },
          {
            "id": "100002978226577",
            "name": "Le Quang Tung"
          },
          {
            "id": "100002990355280",
            "name": "Thangmatlon Cutngay"
          },
          {
            "id": "100003112959701",
            "name": "VÄƒn SÆ¡n"
          },
          {
            "id": "100003137892869",
            "name": "Phihung Hoang"
          },
          {
            "id": "100003143419391",
            "name": "Tiáº¿n DÅ©ng"
          },
          {
            "id": "100003187192760",
            "name": "Hoang Anh Ha"
          },
          {
            "id": "100003208886321",
            "name": "Nguyá»…n Huyá»n Trang"
          },
          {
            "id": "100003212128126",
            "name": "Pháº¡m VÄ©nh"
          },
          {
            "id": "100003219365046",
            "name": "HoÃ i LÃª Thá»‹"
          },
          {
            "id": "100003256625248",
            "name": "Quang Ngoc Nguyen"
          },
          {
            "id": "100003263785363",
            "name": "Thu Tráº§n"
          },
          {
            "id": "100003268721828",
            "name": "Quang TÃ¹ng"
          },
          {
            "id": "100003294388608",
            "name": "LÃª TÃ i"
          },
          {
            "id": "100003296659152",
            "name": "PhÆ°Æ¡ng Nhung"
          },
          {
            "id": "100003349716645",
            "name": "Nguyá»…n Äá»©c NvÄ‘"
          },
          {
            "id": "100003385221252",
            "name": "CÃ¢y Phong Ba"
          },
          {
            "id": "100003484607808",
            "name": "Thanh ThuÃ½"
          },
          {
            "id": "100003496539524",
            "name": "Trung TrÆ°Æ¡ng VÄƒn"
          },
          {
            "id": "100003527679379",
            "name": "Nhu Tan Nguyen"
          },
          {
            "id": "100003696053635",
            "name": "Ruby Fly"
          },
          {
            "id": "100003730111726",
            "name": "Thach Hoang Van"
          },
          {
            "id": "100003769549026",
            "name": "Tráº§n Trung NhÃ¢n"
          },
          {
            "id": "100003772078549",
            "name": "Tuoi Nguyen"
          },
          {
            "id": "100003826431405",
            "name": "Blnh Mlnh"
          },
          {
            "id": "100003826836026",
            "name": "VÅ© Linh"
          },
          {
            "id": "100003840960528",
            "name": "Ãnh Nguyá»…n"
          },
          {
            "id": "100003856208943",
            "name": "Phan HÃ²a"
          },
          {
            "id": "100003869987023",
            "name": "Nguyá»…n Thá»‹ Má»¹ Nhung"
          },
          {
            "id": "100003894536935",
            "name": "Tráº§n Há»¯u ThÃ´ng"
          },
          {
            "id": "100003911883355",
            "name": "CÆ°á»ng ThÃ nh"
          },
          {
            "id": "100003932734095",
            "name": "ThÃ nh Kyo"
          },
          {
            "id": "100003946908707",
            "name": "NguyÃªn TÃº"
          },
          {
            "id": "100003951724972",
            "name": "Nguyá»…n Thá»‹ HÃ  NgÃ¢n"
          },
          {
            "id": "100003953913292",
            "name": "DÅ©ng Nguyá»…n Minh"
          },
          {
            "id": "100004016275196",
            "name": "Há»“ VÄƒn Tuáº¥n"
          },
          {
            "id": "100004087246460",
            "name": "Nguyá»…n Há»¯u Äáº¡t"
          },
          {
            "id": "100004135123453",
            "name": "Mung Nguyen Thi"
          },
          {
            "id": "100004138992607",
            "name": "Hong Hai Vu"
          },
          {
            "id": "100004144351309",
            "name": "LÃª Trung Hiáº¿u"
          },
          {
            "id": "100004149012038",
            "name": "Huáº¿ Äáº·ng"
          },
          {
            "id": "100004174891392",
            "name": "Táº¥n TÃ i"
          },
          {
            "id": "100004256954453",
            "name": "Quá»³nh NhÆ°"
          },
          {
            "id": "100004273023294",
            "name": "Äá»— ThÃ¹y Linh"
          },
          {
            "id": "100004300397713",
            "name": "Thanh Ngo"
          },
          {
            "id": "100004304313985",
            "name": "Há»“ng PhÃºc"
          },
          {
            "id": "100004306290359",
            "name": "Hiá»n HoÃ ng"
          },
          {
            "id": "100004316522352",
            "name": "Thuá»· Pro"
          },
          {
            "id": "100004342441972",
            "name": "VÄƒn Trung"
          },
          {
            "id": "100004348142950",
            "name": "Trá»‹nh Thá»‹ Linh"
          },
          {
            "id": "100004355646949",
            "name": "VÃµ HoÃ ng Bá»­u"
          },
          {
            "id": "100004428257202",
            "name": "Äá»— Quang Dá»±"
          },
          {
            "id": "100004429086279",
            "name": "Tráº§n ThÃ¡i Äáº¡o"
          },
          {
            "id": "100004437578563",
            "name": "Sen Nháº³ng"
          },
          {
            "id": "100004463476051",
            "name": "Ngoc Anh Tran"
          },
          {
            "id": "100004560970878",
            "name": "HÃªnh Pháº¡m"
          },
          {
            "id": "100004569734453",
            "name": "Lona Cat"
          },
          {
            "id": "100004616855082",
            "name": "Triá»‡u Hiá»ƒn"
          },
          {
            "id": "100004622803079",
            "name": "Thao Ha"
          },
          {
            "id": "100004654544241",
            "name": "Nguyá»…n Thá»‹ Háº¡nh"
          },
          {
            "id": "100004746369209",
            "name": "VÄƒn Toáº£n"
          },
          {
            "id": "100004828269961",
            "name": "TrÆ°á»Ÿng Tráº§n ÄÃ¬nh"
          },
          {
            "id": "100004835741451",
            "name": "Duc Tran"
          },
          {
            "id": "100004841040407",
            "name": "Trung Thuc Hoang"
          },
          {
            "id": "100004854581771",
            "name": "Viá»‡t Nguyá»…n"
          },
          {
            "id": "100004907562634",
            "name": "VÅ© KhÃ¡nh Vy"
          },
          {
            "id": "100004933301352",
            "name": "HoÃ ng Dung"
          },
          {
            "id": "100004942956305",
            "name": "ThÃºy HoÃ ng"
          },
          {
            "id": "100005016818649",
            "name": "VÅ© Quang Hiáº¿n"
          },
          {
            "id": "100005033012757",
            "name": "Tráº§n VÃ¢n"
          },
          {
            "id": "100005060382165",
            "name": "LÃª VÄƒn Nam"
          },
          {
            "id": "100005143232807",
            "name": "Lien Nguyen"
          },
          {
            "id": "100005158926907",
            "name": "Nguyá»…n VÅ©"
          },
          {
            "id": "100005180706859",
            "name": "Thanh Binh Tran"
          },
          {
            "id": "100005198500756",
            "name": "Äiá»ƒm Nguyá»…n"
          },
          {
            "id": "100005199186637",
            "name": "Tráº§n NhÃ¢n"
          },
          {
            "id": "100005293903253",
            "name": "Viet Son"
          },
          {
            "id": "100005316904446",
            "name": "Äáº¡t Vinh ChÃ¢u"
          },
          {
            "id": "100005328273224",
            "name": "BÃ¡ch Zim"
          },
          {
            "id": "100005355072949",
            "name": "Quá»‘c Biá»ƒu"
          },
          {
            "id": "100005443655127",
            "name": "Ty Nguyen"
          },
          {
            "id": "100005476835538",
            "name": "PhÃ¹ng NghÄ©a"
          },
          {
            "id": "100005491364399",
            "name": "Nguyá»…n Thá»‹ ThÆ°"
          },
          {
            "id": "100005734712385",
            "name": "Ãnh Ãnh"
          },
          {
            "id": "100005761982763",
            "name": "TranAnh Tran"
          },
          {
            "id": "100005785600557",
            "name": "LÃª Báº£o Linh"
          },
          {
            "id": "100005987043595",
            "name": "Háº£i Äá»—"
          },
          {
            "id": "100005989327652",
            "name": "Kiet Duong Tuan"
          },
          {
            "id": "100005998215190",
            "name": "Pham Minh Chi"
          },
          {
            "id": "100006190306738",
            "name": "Vinh Nguyá»…n"
          },
          {
            "id": "100006282243357",
            "name": "TrÆ°Æ¡ng Quang Bá»•n"
          },
          {
            "id": "100006289752741",
            "name": "Pháº¡m Thuá»³"
          },
          {
            "id": "100006347823477",
            "name": "Dung Anh"
          },
          {
            "id": "100006356471950",
            "name": "LÃª Minh VÅ©"
          },
          {
            "id": "100006436550382",
            "name": "Hoang Lan"
          },
          {
            "id": "100006455468722",
            "name": "Nguyá»…n HoÃ ng"
          },
          {
            "id": "100006477952681",
            "name": "Thanh Kha"
          },
          {
            "id": "100006492082087",
            "name": "LÃ¢m VÅ©"
          },
          {
            "id": "100006527703159",
            "name": "Dung Nguyá»…n"
          },
          {
            "id": "100006534735398",
            "name": "Äáº¥t Viá»‡t"
          },
          {
            "id": "100006535210556",
            "name": "DÆ°Æ¡ng LÃª"
          },
          {
            "id": "100006564792292",
            "name": "Nguyet Duong"
          },
          {
            "id": "100006621008888",
            "name": "ChÃºc An"
          },
          {
            "id": "100006625688182",
            "name": "HoÃ ng Dung"
          },
          {
            "id": "100006629867100",
            "name": "Mai Truc"
          },
          {
            "id": "100006650558886",
            "name": "Huá»³nh Tuáº¥n Háº£i"
          },
          {
            "id": "100006652847354",
            "name": "tháº±ng khá»"
          },
          {
            "id": "100006656734334",
            "name": "Anh Tram"
          },
          {
            "id": "100006658449464",
            "name": "Pháº¡m Táº¡o"
          },
          {
            "id": "100006670560114",
            "name": "Nguyá»…n Minh TÃ¢m"
          },
          {
            "id": "100006714038802",
            "name": "Nguyá»…n Thanh Nghá»‹"
          },
          {
            "id": "100006828812149",
            "name": "Hai Con CuÃ´ng"
          },
          {
            "id": "100006870633964",
            "name": "Cuong Ha"
          },
          {
            "id": "100006910334973",
            "name": "Tra Giang"
          },
          {
            "id": "100006924643905",
            "name": "Huynh Toan"
          },
          {
            "id": "100006954573224",
            "name": "Le Hien"
          },
          {
            "id": "100007021395010",
            "name": "PhÃº SÄ©"
          },
          {
            "id": "100007141772004",
            "name": "KhÆ°Æ¡ng Tiáº¿n Tháº£o"
          },
          {
            "id": "100007147607792",
            "name": "Huy PhÆ°Æ¡ng"
          },
          {
            "id": "100007184853225",
            "name": "Phan Quá»³nh"
          },
          {
            "id": "100007210390645",
            "name": "Tran Nhat Thang"
          },
          {
            "id": "100007343377103",
            "name": "Hang Le"
          },
          {
            "id": "100007351243660",
            "name": "HoÃ ng Trá»ng"
          },
          {
            "id": "100007393903182",
            "name": "Nguyá»…n Há»“ng Háº£i"
          },
          {
            "id": "100007460525808",
            "name": "Tráº§n Minh Äá»©c"
          },
          {
            "id": "100007508854903",
            "name": "Tuyáº¿t ThÃ¡i"
          },
          {
            "id": "100007541643743",
            "name": "Thanh NgÃ "
          },
          {
            "id": "100007542781938",
            "name": "Bui Viet Vuong"
          },
          {
            "id": "100007737932763",
            "name": "Äáº·ng XuÃ¢n Quang"
          },
          {
            "id": "100007864661236",
            "name": "NgÃ¢n Tráº§n"
          },
          {
            "id": "100007882321871",
            "name": "VÄƒn Minh"
          },
          {
            "id": "100007927390679",
            "name": "Hanh Tran"
          },
          {
            "id": "100007967923641",
            "name": "Tony Tp"
          },
          {
            "id": "100008140249491",
            "name": "PÃ© Bá»±"
          },
          {
            "id": "100008221572096",
            "name": "Huyen Thu"
          },
          {
            "id": "100008234374431",
            "name": "Nguyá»…n Thanh Nga"
          },
          {
            "id": "100008248577763",
            "name": "Háº£o Äinh"
          },
          {
            "id": "100008291257535",
            "name": "Nguyá»…n Trang Linh"
          },
          {
            "id": "100008425995708",
            "name": "An Thuy"
          },
          {
            "id": "100008451288135",
            "name": "Pháº¡m HÆ°Æ¡ng"
          },
          {
            "id": "100008521248711",
            "name": "VÄƒn Tuáº¥n"
          },
          {
            "id": "100008694605147",
            "name": "Nam LE Van"
          },
          {
            "id": "100008993380043",
            "name": "ThiÃªn Sá»© BÃ´ng Há»“ng"
          },
          {
            "id": "100009041181623",
            "name": "HoÃ ng Thá»‹ Nhung"
          },
          {
            "id": "100009076064008",
            "name": "TrÆ°Æ¡ng ThiÃªn VÄƒn"
          },
          {
            "id": "100009156128207",
            "name": "Nga Nguyá»…n"
          },
          {
            "id": "100009492122316",
            "name": "Ná»™i Tpth Vinspex"
          },
          {
            "id": "100009700398050",
            "name": "Dung Dang Hong"
          },
          {
            "id": "100009710115306",
            "name": "Cao Thi Thuy Kieu"
          },
          {
            "id": "100009710402349",
            "name": "HoÃ  Mai"
          },
          {
            "id": "100009721188717",
            "name": "Nari Nguyá»…n"
          },
          {
            "id": "100009786584855",
            "name": "LÃª BÃ¡ Chiáº¿n"
          },
          {
            "id": "100009850141283",
            "name": "Há»“ CÆ°á»ng"
          },
          {
            "id": "100010045967431",
            "name": "Giang Nguyen"
          },
          {
            "id": "100010125007281",
            "name": "Nguyá»…n CÃ´ng ChÃ­nh"
          },
          {
            "id": "100010201384092",
            "name": "BÃ¹i ToÃ n"
          },
          {
            "id": "100010275101767",
            "name": "Nguyá»…n Ngá»c Phong"
          },
          {
            "id": "100010373340923",
            "name": "BÃ¡ ChÃ¢u"
          },
          {
            "id": "100010533724426",
            "name": "Quy Phi"
          },
          {
            "id": "100010608222218",
            "name": "Tráº§n Kim NgÃ¢n"
          },
          {
            "id": "100010673776672",
            "name": "HoÃ ng Tuáº¥n"
          },
          {
            "id": "100010743184484",
            "name": "Van Trung"
          },
          {
            "id": "100010888540861",
            "name": "Du Le"
          },
          {
            "id": "100010918548956",
            "name": "Thanh HoÃ ng"
          },
          {
            "id": "100010959194633",
            "name": "Pháº¡m NgÃ¢n"
          },
          {
            "id": "100011103738351",
            "name": "LÃª HÆ°á»ng"
          },
          {
            "id": "100011229511818",
            "name": "Nguyá»…n Lan PhÆ°Æ¡ngg"
          },
          {
            "id": "100011367592771",
            "name": "Nguyá»…n Mai"
          },
          {
            "id": "100011394891822",
            "name": "Nguyá»…n Hoc"
          },
          {
            "id": "100011668994702",
            "name": "Mrken 'Tráº§n'"
          },
          {
            "id": "100011798833475",
            "name": "Thanh Huyá»n Nguyá»…n"
          },
          {
            "id": "100011866704626",
            "name": "Phan Ngoan"
          },
          {
            "id": "100011931436749",
            "name": "Phan VÄƒn"
          },
          {
            "id": "100011980453016",
            "name": "Nguyá»…n HoÃ ng Minh"
          },
          {
            "id": "100012075423028",
            "name": "Nguyá»…n Minh"
          },
          {
            "id": "100012373298685",
            "name": "Nguyá»…n Há»¯u Thá»‹nh"
          },
          {
            "id": "100012594226421",
            "name": "HoÃ i BÃ¹i"
          },
          {
            "id": "100012713474153",
            "name": "Suá»‘i ÄÃ¡"
          },
          {
            "id": "100012773562115",
            "name": "Lá»c NÆ°á»›c TÃ¢y Ninh"
          },
          {
            "id": "100013065763040",
            "name": "Luong Tran"
          },
          {
            "id": "100013220139095",
            "name": "CÃ¡i GÃ¬ Cháº³ng CÃ³"
          },
          {
            "id": "100013263695559",
            "name": "Äá»©c Pháº¡m"
          },
          {
            "id": "100013358612819",
            "name": "Vansao Tran"
          },
          {
            "id": "100013379434358",
            "name": "Hoang Monaco"
          },
          {
            "id": "100013476914535",
            "name": "LÆ°u Äá»©c Duy"
          },
          {
            "id": "100013549770221",
            "name": "DÆ°Æ¡ng TÆ°á»ng Duy"
          },
          {
            "id": "100013618568123",
            "name": "Phan ÄÃ¬nh Äáº¡t"
          },
          {
            "id": "100013769500273",
            "name": "Tráº§n Äá»©c TÃ¬nh"
          },
          {
            "id": "100014470716662",
            "name": "HoÃ ng Anh BTonio Lecturer"
          },
          {
            "id": "100014518449736",
            "name": "Hanh Chu"
          },
          {
            "id": "100014736707023",
            "name": "Tuan Anh Nguyá»…n"
          },
          {
            "id": "100014744434065",
            "name": "Tráº§n TÃ¢m"
          },
          {
            "id": "100015297154167",
            "name": "Bao Hoa Nguyen"
          },
          {
            "id": "100015327542257",
            "name": "Nguyá»…n Dung"
          },
          {
            "id": "100015541562943",
            "name": "Tráº§n Hoa"
          },
          {
            "id": "100015766291522",
            "name": "ÄÃ o Gia Founder"
          },
          {
            "id": "100016384751535",
            "name": "Tráº§n PhÃº"
          },
          {
            "id": "100016569391198",
            "name": "Tooichi Kuroba"
          },
          {
            "id": "100016784174705",
            "name": "Ngá»c ToÃ n"
          },
          {
            "id": "100016807449887",
            "name": "TÃº BÃ¹i"
          },
          {
            "id": "100016858773368",
            "name": "DÆ°Æ¡ng Toáº£n Linh"
          },
          {
            "id": "100016927471613",
            "name": "ThiÃªn VÃ¢n"
          },
          {
            "id": "100017007180195",
            "name": "Xoan Tit Xoan"
          },
          {
            "id": "100017616608808",
            "name": "Nguyá»…n VÃ¢n Thá»‹nh"
          },
          {
            "id": "100017645802520",
            "name": "TrÆ°Æ¡ng TrÃ­ Äá»©c"
          },
          {
            "id": "100020736142752",
            "name": "Nguyá»…n Huy GiÃ¡p"
          },
          {
            "id": "100021702982261",
            "name": "Phan Thá»‹ Máº­n"
          },
          {
            "id": "100021719721075",
            "name": "LÃª Há»¯u HÃ "
          },
          {
            "id": "100022269277688",
            "name": "Trung CuChi"
          },
          {
            "id": "100022647950578",
            "name": "LÃª Duy Thá»"
          },
          {
            "id": "100022848772578",
            "name": "Nguyá»…n BiÃªn"
          },
          {
            "id": "100023066776436",
            "name": "Ken Ken"
          },
          {
            "id": "100023472497923",
            "name": "ÄÃ´ng MÃ¹a"
          },
          {
            "id": "100023906706671",
            "name": "Kim Dung"
          },
          {
            "id": "100024414377599",
            "name": "Hoahong Hoahong"
          },
          {
            "id": "100024616364535",
            "name": "Äinh Quang DÅ©ng"
          },
          {
            "id": "100024715094699",
            "name": "HoÃ ng Thá»‹ NgÃ n"
          },
          {
            "id": "100024755232860",
            "name": "VÄƒn ChÃ­nh"
          },
          {
            "id": "100025032575504",
            "name": "Äáº·ng VÄƒn TÃ­nh"
          },
          {
            "id": "100025033702562",
            "name": "Äá»— Diá»‡p Khanh"
          },
          {
            "id": "100025148075519",
            "name": "PhÃ¡t TrÆ°Æ¡ng"
          },
          {
            "id": "100025417395973",
            "name": "Nhung Dao"
          },
          {
            "id": "100025495093138",
            "name": "CÃ´ Äá»™c VÆ°Æ¡ng"
          },
          {
            "id": "100025667291297",
            "name": "Lyla Larry Nguyen"
          },
          {
            "id": "100026182246416",
            "name": "Pham Minh"
          },
          {
            "id": "100026300572404",
            "name": "Lan Anh Nail"
          },
          {
            "id": "100026896832330",
            "name": "Minh Quang Vu"
          },
          {
            "id": "100027140260785",
            "name": "Nguyá»…n Tháº¿ Sinh"
          },
          {
            "id": "100027447045890",
            "name": "Nguyen Háº±ng"
          },
          {
            "id": "100027773987109",
            "name": "Quan Thuáº§n"
          },
          {
            "id": "100027882458875",
            "name": "TrÆ°Æ¡ng Thanh NgÃ¢n"
          },
          {
            "id": "100027892488162",
            "name": "Há»“ Má»¹ Trang"
          },
          {
            "id": "100028057694355",
            "name": "Nguyá»…n Tháº¿ Ngá»c"
          },
          {
            "id": "100028183980483",
            "name": "Hoa Nguyen"
          },
          {
            "id": "100028499742249",
            "name": "ÄÃ o ÄÃ¬nh Luyá»‡n"
          },
          {
            "id": "100028687274030",
            "name": "Tráº§n ÄÃ¬nh VÅ©"
          },
          {
            "id": "100028696751646",
            "name": "Nga Kim VÅ© HR"
          },
          {
            "id": "100028882415709",
            "name": "Thá»§y Nguyá»…n"
          },
          {
            "id": "100029299301680",
            "name": "Vi Hoa"
          },
          {
            "id": "100029670409014",
            "name": "Huyá»n Äáº·ng"
          },
          {
            "id": "100029798453334",
            "name": "Ngá»¥y Huyá»n TrÃ¢m"
          },
          {
            "id": "100029967125807",
            "name": "LÃª HoÃ ng"
          },
          {
            "id": "100030104508772",
            "name": "Báº£o LÃ¢m"
          },
          {
            "id": "100030473134367",
            "name": "HÃ  LÃª"
          },
          {
            "id": "100030509079299",
            "name": "Tráº§n VÄƒn HÃ¹ng"
          },
          {
            "id": "100030578503940",
            "name": "Há»¯u ThÃ nh"
          },
          {
            "id": "100030659791332",
            "name": "LÆ°Æ¡ng VÄƒn TÃ¢y"
          },
          {
            "id": "100030833381157",
            "name": "Thoc Luu"
          },
          {
            "id": "100030909782658",
            "name": "VÆ°Æ¡ng XuÃ¢n Trung"
          },
          {
            "id": "100031257766967",
            "name": "Nguyá»…n Zin"
          },
          {
            "id": "100031949331540",
            "name": "Ma Tháº£o"
          },
          {
            "id": "100033158917500",
            "name": "Nhi Thá»‹"
          },
          {
            "id": "100033583038301",
            "name": "Lien Le"
          },
          {
            "id": "100034551607051",
            "name": "Kiá»u Ngá»c"
          },
          {
            "id": "100034573387118",
            "name": "Nguyá»…n Táº¥n Tháº¡nh"
          },
          {
            "id": "100035312289300",
            "name": "Pháº¡m Báº£o Vinh"
          },
          {
            "id": "100035413536551",
            "name": "Nguyá»…n Toáº£n"
          },
          {
            "id": "100035471355865",
            "name": "Pháº¡m HoÃ n Ã‚n"
          },
          {
            "id": "100035824970612",
            "name": "LÃ½ Táº§m Hoan"
          },
          {
            "id": "100035891000395",
            "name": "Nguyá»…n Kiá»u Má»µ"
          },
          {
            "id": "100036436549617",
            "name": "Äinh Thá»‹ Tuyáº¿t Mai"
          },
          {
            "id": "100037302003281",
            "name": "Äá»— Lá»¥a"
          },
          {
            "id": "100037465741341",
            "name": "Hiá»ƒu RÃ¢u"
          },
          {
            "id": "100039006110871",
            "name": "Trang TrÃ²n"
          },
          {
            "id": "100039107282206",
            "name": "Nguyá»…n Minh Phá»¥ng"
          },
          {
            "id": "100039234011717",
            "name": "ÄÃ  Chu"
          },
          {
            "id": "100039431713970",
            "name": "Äinh VÄƒn Tuáº¥n"
          },
          {
            "id": "100039791821927",
            "name": "Cuong Vu"
          },
          {
            "id": "100040344554026",
            "name": "Nguyá»…n Há»¯u ToÃ n"
          },
          {
            "id": "100040714280187",
            "name": "Khanh An Cam"
          },
          {
            "id": "100040854852044",
            "name": "Kien Nguyen"
          },
          {
            "id": "100041005845935",
            "name": "ÄoÃ n Minh Hiáº¿u"
          },
          {
            "id": "100041138773693",
            "name": "Mai Vinh"
          },
          {
            "id": "100041331110092",
            "name": "Kháº¯c Ngá»c"
          },
          {
            "id": "100041331771277",
            "name": "Há»“ PhÆ°á»›c An"
          },
          {
            "id": "100041741836664",
            "name": "Giang Má»· DuyÃªn"
          },
          {
            "id": "100042365281852",
            "name": "Trang LÃª"
          },
          {
            "id": "100042843185509",
            "name": "Huy HoÃ ng PhÃ¡t"
          },
          {
            "id": "100043083728060",
            "name": "Long Quyá»n Hino"
          },
          {
            "id": "100043837155888",
            "name": "Sunny Huá»³nh"
          },
          {
            "id": "100044217855177",
            "name": "Loan Nong"
          },
          {
            "id": "100044322856461",
            "name": "Lá»‡ Háº±ng"
          },
          {
            "id": "100044395205424",
            "name": "LÃ nh LÃª"
          },
          {
            "id": "100044750093304",
            "name": "Minh Kháº£i HÆ°ng"
          },
          {
            "id": "100044828802250",
            "name": "Tráº§n HoÃ i VÄƒn"
          },
          {
            "id": "100044982412216",
            "name": "Tuan Anh Phung Quoc"
          },
          {
            "id": "100045239104005",
            "name": "Pháº¡m Tuáº¥n"
          },
          {
            "id": "100045857166831",
            "name": "Gia Huy"
          },
          {
            "id": "100046073641870",
            "name": "Nguyá»…n Thá»‹ DuyÃªn"
          },
          {
            "id": "100046405936633",
            "name": "Há»“ XuÃ¢n Hiáº¿u"
          },
          {
            "id": "100046643683833",
            "name": "Hoang Anh Nguyen"
          },
          {
            "id": "100047608833937",
            "name": "Nguyá»…n Tháº£o Nhi"
          },
          {
            "id": "100047832253096",
            "name": "VÄƒn Táº¥n TÃ i"
          },
          {
            "id": "100048950482838",
            "name": "NgÃ´ Thanh ThÃ¹y"
          },
          {
            "id": "100049057852661",
            "name": "Gia Hung"
          },
          {
            "id": "100049137320683",
            "name": "Nguyá»…n Há»¯u TÃ¹ng"
          },
          {
            "id": "100049364013977",
            "name": "Triá»u Nguyá»…n"
          },
          {
            "id": "100049529929873",
            "name": "Trá»ng Nguyá»…n"
          },
          {
            "id": "100049933239314",
            "name": "Nguyá»…n Thanh PhÆ°Æ¡ng"
          },
          {
            "id": "100050313874375",
            "name": "Nguyá»…n KhÃ¡nh An"
          },
          {
            "id": "100050689431203",
            "name": "VÄƒn Ká»·"
          },
          {
            "id": "100050896924676",
            "name": "Chau Truong"
          },
          {
            "id": "100051580996504",
            "name": "VÆ°Æ¡ng HoÃ ng"
          },
          {
            "id": "100051631818167",
            "name": "à¸„à¸¸à¸“ à¸§à¸µà¸£à¸ à¸±à¸—à¸£"
          },
          {
            "id": "100052289653476",
            "name": "Há»“ Kim ThÃ nh Anh"
          },
          {
            "id": "100052330601510",
            "name": "Nguyá»…n XuÃ¢n Háº£i"
          },
          {
            "id": "100052797646738",
            "name": "NgÃ´ ÄÄƒng Sá»¹ Sá»¹"
          },
          {
            "id": "100053168822469",
            "name": "Khang HoÃ ng"
          },
          {
            "id": "100053385587217",
            "name": "Huá»³nh Má»¹ An"
          },
          {
            "id": "100053523216470",
            "name": "TrÆ°Æ¡ng Báº£o KhÃ¡nh"
          },
          {
            "id": "100053618811831",
            "name": "Nguyen Nghia"
          },
          {
            "id": "100053653425560",
            "name": "CÃ´ng Anh"
          },
          {
            "id": "100054118547462",
            "name": "LÆ°Æ¡ng VÄƒn GiÃ u"
          },
          {
            "id": "100055091536978",
            "name": "Nguyá»…n Thá»§y"
          },
          {
            "id": "100055456192661",
            "name": "Hai Nguyen"
          },
          {
            "id": "100056115540240",
            "name": "Vinh NguyÃªn"
          },
          {
            "id": "100056204585461",
            "name": "TÃ²ng Vinh Láº­p"
          },
          {
            "id": "100056219674828",
            "name": "Nguyá»…n ÄÄƒng Long"
          },
          {
            "id": "100056893673138",
            "name": "Pháº¡m HÆ°Æ¡ng"
          },
          {
            "id": "100056971001603",
            "name": "Äá»— Ngá»c BÃ­ch"
          },
          {
            "id": "100057218484529",
            "name": "An Dong"
          },
          {
            "id": "100057282332889",
            "name": "Äáº·ng Long"
          },
          {
            "id": "100057294213677",
            "name": "Báº¯c ChiÃªm Ks"
          },
          {
            "id": "100058695786943",
            "name": "TrÆ°Æ¡ng Ngá»c CÆ°á»ng"
          },
          {
            "id": "100059470687155",
            "name": "KiLa Kids"
          },
          {
            "id": "100061966165039",
            "name": "XuÃ¢n BÃ¹i"
          },
          {
            "id": "100063582972054",
            "name": "Nguyá»…n HÆ°Æ¡ng"
          },
          {
            "id": "100065484991136",
            "name": "Há»¯u TÄ©nh"
          },
          {
            "id": "100065755574601",
            "name": "LÃª Quang VÄƒn"
          },
          {
            "id": "100065910370542",
            "name": "Aiy Kham Ma Ny"
          },
          {
            "id": "100066564653556",
            "name": "Sen Pham"
          },
          {
            "id": "100066843591263",
            "name": "Pháº¡m Nháº­t Tiáº¿n"
          },
          {
            "id": "100067012723713",
            "name": "Pháº¡m Thanh VÃ¢n"
          },
          {
            "id": "100067050272709",
            "name": "Tráº§n ÄÃ n"
          },
          {
            "id": "100067311587908",
            "name": "Tráº§n VÄƒn TrÆ°á»ng"
          },
          {
            "id": "100067495173935",
            "name": "LÃª Ngá»c Huy"
          },
          {
            "id": "100067561286987",
            "name": "NT Bii"
          },
          {
            "id": "100067655688411",
            "name": "HoÃ ng Kim TÃ¹ng"
          },
          {
            "id": "100067783291879",
            "name": "Nguyá»…n HoÃ ng Vinh"
          },
          {
            "id": "100068319355393",
            "name": "Nguyá»…n Kháº£ Nhi"
          },
          {
            "id": "100069529777480",
            "name": "Nguyá»…n VÃµ Lá»£i"
          },
          {
            "id": "100069724183977",
            "name": "ÄÃ o Há»¯u Huá»³nh"
          },
          {
            "id": "100070643193025",
            "name": "Nguyá»…n Hoan"
          },
          {
            "id": "100070996751630",
            "name": "Thiá»u Nguyá»…n VÄƒn"
          },
          {
            "id": "100071772381887",
            "name": "Anan Anan"
          },
          {
            "id": "100071986008443",
            "name": "HoÃ ng SÆ¡n"
          },
          {
            "id": "100072577917134",
            "name": "HÃ  Moon"
          },
          {
            "id": "100072884918743",
            "name": "Äinh Ngá»c Huyá»n"
          },
          {
            "id": "100072973166250",
            "name": "LÃª Minh PhÆ°Æ¡ng"
          },
          {
            "id": "100073041764842",
            "name": "Gia An"
          },
          {
            "id": "100073288287437",
            "name": "Kim Yen"
          },
          {
            "id": "100073474667304",
            "name": "Nguyá»…n Minh Tuáº¥n"
          },
          {
            "id": "100073518842187",
            "name": "Ken Vy"
          },
          {
            "id": "100074726791534",
            "name": "Thanh Long"
          },
          {
            "id": "100074896790646",
            "name": "Nguyá»…n Äá»©c LÃ¢m"
          },
          {
            "id": "100075442416851",
            "name": "Phan Phá»¥ng Hiá»‡p"
          },
          {
            "id": "100075498409541",
            "name": "Melvin Balagan"
          },
          {
            "id": "100076228431824",
            "name": "Nguyá»…n Háº±ng BÄ‘s"
          },
          {
            "id": "100076424797674",
            "name": "Äá»— NhÆ° Quá»³nh"
          },
          {
            "id": "100076589088252",
            "name": "Tháº¡ch Äiá»n An"
          },
          {
            "id": "100076848668836",
            "name": "Tráº§n Thanh TÃ i"
          },
          {
            "id": "100076915989195",
            "name": "Pháº¡m Thá»‹ Tháº¿"
          },
          {
            "id": "100076937134966",
            "name": "Ãšt LÃª"
          },
          {
            "id": "100078537897171",
            "name": "Tráº§n Kiá»u Trinh"
          },
          {
            "id": "100078714237075",
            "name": "Pháº¡m Thanh Há»¯u"
          },
          {
            "id": "100078927330919",
            "name": "HÃ  CÃ´ng Minh"
          },
          {
            "id": "100079517160224",
            "name": "Tráº§n Minh ThÆ°"
          },
          {
            "id": "100079825482206",
            "name": "TrÆ°Æ¡ng Thá»‹ NgÃ "
          },
          {
            "id": "100080216923789",
            "name": "HoÃ ng Huy Háº£i"
          },
          {
            "id": "100080877782912",
            "name": "Nguyá»…n Quang Hiáº¿n"
          },
          {
            "id": "100081124791663",
            "name": "LÃª PhÆ°Æ¡ng Nam"
          },
          {
            "id": "100081126481372",
            "name": "Phan Thá»¥c QuyÃªn"
          },
          {
            "id": "100081183973040",
            "name": "ChÃ¢u Thu YÃªn"
          },
          {
            "id": "100081577131072",
            "name": "Nguyá»…n Huyá»n Na"
          },
          {
            "id": "100081774991139",
            "name": "Huá»³nh Trung Äá»©c"
          },
          {
            "id": "100081955574668",
            "name": "Tháº£o BÃ¹ Sab"
          },
          {
            "id": "100082844631646",
            "name": "Mo Hoang"
          },
          {
            "id": "100082951224158",
            "name": "BÃ¹i Má»¹ Háº¡nh"
          },
          {
            "id": "100082966943729",
            "name": "LÃ¢m BÃ­ch Tuyá»n"
          },
          {
            "id": "100083062064527",
            "name": "Tráº§n KhÃ¡nh Háº¡"
          },
          {
            "id": "100083671045351",
            "name": "Hung Bui"
          },
          {
            "id": "100083821880689",
            "name": "LiÃªm Tháº£o"
          },
          {
            "id": "100083933202691",
            "name": "Phan Phan VÅ©"
          },
          {
            "id": "100084120432429",
            "name": "Tráº§n Quang Minh"
          },
          {
            "id": "100084163334065",
            "name": "Nguyá»…n PhÆ°Æ¡ng Nam"
          },
          {
            "id": "100084168911187",
            "name": "Nguyá»…n Phi Long"
          },
          {
            "id": "100084280748476",
            "name": "Há»“ XuÃ¢n TiÃªn"
          },
          {
            "id": "100084396496279",
            "name": "LÃª Quá»‘c ChÆ¡n"
          },
          {
            "id": "100085008549707",
            "name": "QuÃ¡ch Diá»‡u Linh"
          },
          {
            "id": "100085712091260",
            "name": "Ly Kiet"
          },
          {
            "id": "100085914378695",
            "name": "Nguyá»…n Há»“ng Háº£i"
          },
          {
            "id": "100085951737392",
            "name": "Nguyá»…n Quang ViÃªn"
          },
          {
            "id": "100086275263199",
            "name": "Äáº·ng Äá»"
          },
          {
            "id": "100086352774017",
            "name": "Nguyá»…n Báº£o Ngá»c"
          },
          {
            "id": "100087102586087",
            "name": "Nguyá»…n Kháº¯c Háº£i"
          },
          {
            "id": "100087645018791",
            "name": "LÆ°u Ly Nguyá»…n"
          },
          {
            "id": "100088065800439",
            "name": "Lclc Mai Hoang"
          },
          {
            "id": "100088319020681",
            "name": "Mer Malate"
          },
          {
            "id": "100088442995929",
            "name": "NgÃ´ VÄƒn TÃ i"
          },
          {
            "id": "100088653865647",
            "name": "Pháº¡m Thu HiÃªn"
          },
          {
            "id": "100088820324939",
            "name": "Äá»— Tá»‘ UyÃªn"
          },
          {
            "id": "100089027143175",
            "name": "Huá»³nh Tháº£o"
          },
          {
            "id": "100089049978165",
            "name": "Phan Diá»‡u Tháº£o"
          },
          {
            "id": "100089120417250",
            "name": "Äá»— Thu PhÆ°Æ¡ng"
          },
          {
            "id": "100089417413352",
            "name": "Nguyá»…n Luáº­t"
          },
          {
            "id": "100089649075119",
            "name": "Nguyá»…n Tuáº¥n Lá»™c"
          },
          {
            "id": "100089832851412",
            "name": "HÆ°Æ¡ng LÃª"
          },
          {
            "id": "100090085357128",
            "name": "Äinh VÄƒn Hiáº¿n"
          },
          {
            "id": "100090241781437",
            "name": "BÃ¹i Ngá»c TrÃ¢n"
          },
          {
            "id": "100090303896046",
            "name": "ÄÃ¬nh Há»¯u"
          },
          {
            "id": "100090614678217",
            "name": "Duy NG"
          },
          {
            "id": "100090678280373",
            "name": "Nguyá»…n Ngá»c BÃ­ch"
          },
          {
            "id": "100090779798919",
            "name": "Jonel Sabay Ilustresimo"
          },
          {
            "id": "100090913833818",
            "name": "Huá»³nh Ngá»c Háº£i"
          },
          {
            "id": "100091399080812",
            "name": "BÃ¹i Äá»©c Viá»‡t"
          },
          {
            "id": "100091552787383",
            "name": "Ngá»c Lan"
          },
          {
            "id": "100091835664338",
            "name": "Äáº·ng Ngá»c Hiá»‡u"
          },
          {
            "id": "100092372214965",
            "name": "Trung VÅ©"
          },
          {
            "id": "100092597356876",
            "name": "VÅ© Tháº£o VÃ¢n"
          },
          {
            "id": "100092965899049",
            "name": "Khantavan Vixaisak"
          },
          {
            "id": "100093194018066",
            "name": "Nguyá»…n BÃ¡ Äá»“ng"
          },
          {
            "id": "100093227391507",
            "name": "Cuki Male"
          },
          {
            "id": "100093950400415",
            "name": "HoÃ ng Nam"
          },
          {
            "id": "100094132527257",
            "name": "LÃª Thá»‹ LÆ°Æ¡ng"
          },
          {
            "id": "100094226885826",
            "name": "ThiÃªn Ã‚n Táº¡p HoÃ¡"
          },
          {
            "id": "100094749792539",
            "name": "Pháº¡m HÆ°Æ¡ng Tháº£o"
          },
          {
            "id": "100094786226589",
            "name": "LÃª TÆ°á»ng Vy"
          },
          {
            "id": "100094996895373",
            "name": "NgÃ´ Quang ToÃ n"
          },
          {
            "id": "100095185767836",
            "name": "Nguyá»…n Tuan Tuan"
          },
          {
            "id": "100095202421179",
            "name": "Lani Äá»—"
          },
          {
            "id": "100095443894318",
            "name": "Pháº¡m CÃ´ng Huy"
          }
        ],
        "comments": [
          {
            "id": "100008502215600",
            "name": "Toan Phung",
            "text": "Ib",
            "created_time_vn": "2025-12-13 01:36:31"
          },
          {
            "id": "100008502215600",
            "name": "Toan Phung",
            "text": "ChuyÃªn viÃªn quáº£n lÃ½ KD",
            "created_time_vn": "2025-12-13 01:36:54"
          },
          {
            "id": "100000391379114",
            "name": "ÄÄƒng Quang",
            "text": "Thanh Nho chÃº lÃ m hÃ nh chÃ­nh dc",
            "created_time_vn": "2025-12-15 13:35:42"
          },
          {
            "id": "100009156433293",
            "name": "Ngá»c Linh",
            "text": "ThÆ° Thá»",
            "created_time_vn": "2025-12-15 10:18:37"
          },
          {
            "id": "100000292595738",
            "name": "Linh Pháº¡m",
            "text": "Pháº¡m KhÃ¡nh Linhnh",
            "created_time_vn": "2025-12-13 20:02:47"
          },
          {
            "id": "100005379331337",
            "name": "Ha Le",
            "text": "LÆ°u LÆ°u ThÃ¹y",
            "created_time_vn": "2025-12-14 23:03:57"
          },
          {
            "id": "100021760787632",
            "name": "NÃªn Pháº¡m",
            "text": "Cáº§n tá»‘i thiá»ƒu báº±ng cáº¥p j áº¡.",
            "created_time_vn": "2025-12-18 06:15:38"
          },
          {
            "id": "100038140512546",
            "name": "Tráº§n HÃ  Huyá»n",
            "text": "á»ž Ä‘Ã¢u",
            "created_time_vn": "2025-12-11 23:14:34"
          },
          {
            "id": "100013436617586",
            "name": "Nhung Cao",
            "text": "Kim Anh Nguyen",
            "created_time_vn": "2025-12-11 21:03:07"
          },
          {
            "id": "61576606707704",
            "name": "Pháº¡m Há»¯u ToÃ n",
            "text": "Pháº¡m Thá»‹ Ngá»c Bá»™i",
            "created_time_vn": "2025-12-05 22:25:30"
          },
          {
            "id": "100036154251433",
            "name": "Pháº¡m Tiáº¿n",
            "text": "Pháº¡m TrÃ ",
            "created_time_vn": "2025-12-14 21:15:08"
          },
          {
            "id": "100090804673944",
            "name": "Pháº¿ Giáº¥y BÃ¬a",
            "text": "CÃ³ á»Ÿ hÃ  huy táº­p gia lÃ¢m hn ko b",
            "created_time_vn": "2025-12-16 22:13:58"
          },
          {
            "id": "61572424185468",
            "name": "Nguyá»…n Äá»©c Trá»ng",
            "text": "Inbox",
            "created_time_vn": "2025-12-15 04:08:16"
          },
          {
            "id": "100005916301142",
            "name": "Tai Dao",
            "text": "BÃªn mÃ¬nh cÃ³ tuyá»ƒn tham mÆ°u ko em Ä‘Äƒng kÃ½ suáº¥t",
            "created_time_vn": "2025-12-17 14:27:32"
          },
          {
            "id": "100015011417443",
            "name": "Hoa VÅ©",
            "text": "Vá»«a ra trÆ°á»ng cÃ³ tuyá»ƒn nhÃ¢n viÃªn kinh doanh khÃ´ng áº¡",
            "created_time_vn": "2025-12-08 11:31:04"
          },
          {
            "id": "100005138494838",
            "name": "Nguyá»…n Anh Tuáº¥n",
            "text": "Inbox",
            "created_time_vn": "2025-12-12 16:30:53"
          },
          {
            "id": "100006534735398",
            "name": "Äáº¥t Viá»‡t",
            "text": "CÃ³ tuyá»ƒn thá»£ cÆ¡ khÃ­ khÃ´ng áº¡",
            "created_time_vn": "2025-12-16 11:42:23"
          },
          {
            "id": "61583260407273",
            "name": "Pco Viá»‡t Nam",
            "text": "Pháº¡m HiÃªn",
            "created_time_vn": "2025-12-13 06:21:42"
          }
        ],
        "reactions_count": 564,
        "comments_count": 18,
        "reactions_count_before_filter": 564,
        "comments_count_before_filter": 18,
        "status": "success"
      },
      {
        "post_id": "4432161690347913",
        "flag": "vÃ ng",
        "text": "[HÃ  ÄÃ´ng, HN] TUYá»‚N Váº¬N HÃ€NH SÃ€N TMÄT LÆ¯Æ NG 6M - 12M !! KHÃ”NG YC KINH NGHIá»†M",
        "owning_profile": {
          "__typename": "User",
          "name": "Nguyá»…n HÃ  Thu",
          "id": "100007869585114"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "100032767399249",
            "name": "Háº±ng Nguyá»…n"
          }
        ],
        "comments": [],
        "reactions_count": 2,
        "comments_count": 0,
        "reactions_count_before_filter": 2,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "122171583440394422",
        "flag": "xanh",
        "text": "âœ¨ NHA KHOA META TUYá»‚N Dá»¤NG âœ¨ Vá»‹ trÃ­: BÃ¡c sÄ© RÄƒng Sá»© Tháº©m Má»¹ ChÃºng tÃ´i tÃ¬m kiáº¿m bÃ¡c sÄ© cÃ³ Ä‘á»‹nh hÆ°á»›ng phÃ¡t triá»ƒn lÃ¢u dÃ i trong lÄ©nh vá»±c rÄƒng sá»© tháº©m má»¹, mong muá»‘n lÃ m viá»‡c trong mÃ´i trÆ°á»ng chuáº©n chá»‰nh, tÃ´n trá»ng chuyÃªn mÃ´n vÃ  giÃ¡ trá»‹ cÃ¡ nhÃ¢n. ðŸ’° Thu nháº­p: Thá»a thuáº­n theo nÄƒng lá»±c (LÆ°Æ¡ng cá»©ng + KPI + ThÆ°á»Ÿng + Phá»¥ cáº¥p) ðŸ”¹ Há»‡ thá»‘ng mÃ¡y mÃ³c hiá»‡n Ä‘áº¡i ðŸ”¹ Nguá»“n khÃ¡ch á»•n Ä‘á»‹nh ðŸ”¹ Ekip há»— trá»£ chuyÃªn mÃ´n ðŸ”¹ Quy trÃ¬nh rÃµ rÃ ng â€“ minh báº¡ch ðŸ“ Äá»‹a chá»‰: 391 TrÆ°á»ng Chinh, Thanh XuÃ¢n, HÃ  Ná»™i ðŸ“² LiÃªn há»‡ á»©ng tuyá»ƒn: 036.903.6666",
        "owning_profile": {
          "__typename": "User",
          "name": "Tuyá»ƒn Dá»¥ng NhÃ¢n Sá»± Nha Khoa HÃ  Ná»™i",
          "id": "61561832674763"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61555926982278",
            "name": "Viá»‡c LÃ m PhÃº Má»¹"
          },
          {
            "id": "61556361794883",
            "name": "NgÃ´ HÃ "
          },
          {
            "id": "61557564590049",
            "name": "Tráº§n Quá»‘c TÃº"
          },
          {
            "id": "61558261029036",
            "name": "Pun Meo"
          },
          {
            "id": "61561883510251",
            "name": "Channie Quinh"
          },
          {
            "id": "61563309960672",
            "name": "Äáº·ng Háº£i Long"
          },
          {
            "id": "61564917926512",
            "name": "L.A Club Bida & Coffee Chill"
          },
          {
            "id": "61565563724536",
            "name": "Nguyá»…n ChÃ¢u"
          },
          {
            "id": "61572284594958",
            "name": "Sunny Nguyá»…n"
          },
          {
            "id": "61573721417341",
            "name": "Nguyá»…n BÃ¡ Gia"
          },
          {
            "id": "61574207106597",
            "name": "Tráº§n Linhh"
          },
          {
            "id": "61576229670272",
            "name": "Linh Hoang"
          },
          {
            "id": "61577279735800",
            "name": "Quá»³nh Anh Hr"
          },
          {
            "id": "61580336013397",
            "name": "Tuyá»ƒn dá»¥ng Hoa Sen"
          },
          {
            "id": "61581536426647",
            "name": "Nguyá»…n Phá»¥ng"
          },
          {
            "id": "61582805619015",
            "name": "Tuyá»ƒn Dá»¥ng ACC GROUP"
          },
          {
            "id": "61583305625966",
            "name": "Thanh Tháº£o"
          },
          {
            "id": "61583764201891",
            "name": "TrÆ°Æ¡ng TrÆ°Æ¡ng"
          },
          {
            "id": "61584608215620",
            "name": "Tháº£o Tháº£o"
          },
          {
            "id": "100001457361807",
            "name": "BÃ¬nh Nguyá»…n"
          },
          {
            "id": "100002952513568",
            "name": "Hung Nguyen Van"
          },
          {
            "id": "100004481532439",
            "name": "TÃ¢m Nguyá»…n"
          },
          {
            "id": "100004482543910",
            "name": "ThÃ¹y DuyÃªn"
          },
          {
            "id": "100005340428521",
            "name": "ÄÃ o Kim Dung"
          },
          {
            "id": "100005469367692",
            "name": "Háº£i Tráº§n"
          },
          {
            "id": "100005516567580",
            "name": "Nguyá»…n Song Háº£i My"
          },
          {
            "id": "100005955429677",
            "name": "ÄÃ o Cáº©m TÃº"
          },
          {
            "id": "100006028202461",
            "name": "Nguyá»…n Quang ÄÄƒng"
          },
          {
            "id": "100006251405539",
            "name": "Ãi Tháº£o"
          },
          {
            "id": "100006269208618",
            "name": "Ngá»c Ji"
          },
          {
            "id": "100006289146409",
            "name": "LÃª Thá»‹ Ngá»c Tuyáº¿t"
          },
          {
            "id": "100006726301264",
            "name": "Há»¯u Vinh"
          },
          {
            "id": "100006842225833",
            "name": "Nguyá»…n CÃ´ng Tuáº¥n"
          },
          {
            "id": "100007223975129",
            "name": "HoÃ ng Ngá»c VÃ¢n"
          },
          {
            "id": "100008214033618",
            "name": "PhÆ°Æ¡ngg Thuá»³y"
          },
          {
            "id": "100008470120812",
            "name": "Hen Lai Sau"
          },
          {
            "id": "100008819281046",
            "name": "TÆ°á»ng Vi"
          },
          {
            "id": "100010908542354",
            "name": "TrÆ°Æ¡ng Yáº¿n Ngá»c"
          },
          {
            "id": "100011164030217",
            "name": "Phan Háº±ng"
          },
          {
            "id": "100011299489100",
            "name": "NhÃ£ HÃ n"
          },
          {
            "id": "100011388368250",
            "name": "Ngá» Nguyá»…n"
          },
          {
            "id": "100011467005548",
            "name": "Mai LÃª ThuÃ½ Anh"
          },
          {
            "id": "100011626330258",
            "name": "Chini Yang"
          },
          {
            "id": "100012223865593",
            "name": "BÃ¹i Phi Khanh"
          },
          {
            "id": "100012229563696",
            "name": "Huy Nguyá»…n"
          },
          {
            "id": "100013120636790",
            "name": "Nguyá»…n Háº­u"
          },
          {
            "id": "100013203721316",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100013824304893",
            "name": "VÃ¢n Trinh"
          },
          {
            "id": "100013891117509",
            "name": "Nguyá»…n Tuáº¥n Thanh TÃ¹ng"
          },
          {
            "id": "100014181169457",
            "name": "Anh Thi"
          },
          {
            "id": "100014186708092",
            "name": "Thanh PhÃ¡t"
          },
          {
            "id": "100014468773048",
            "name": "Ngoc Ngoc"
          },
          {
            "id": "100015023324224",
            "name": "Tháº£o Vy"
          },
          {
            "id": "100021958921727",
            "name": "Nguyá»…n ThÆ¡m"
          },
          {
            "id": "100022909296508",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100023342140984",
            "name": "NgÃ´ Thá»‹ Thanh Thá»§y"
          },
          {
            "id": "100025315715732",
            "name": "Dang Hai Hoang"
          },
          {
            "id": "100026564893365",
            "name": "Tráº§n Thá»‹ ChÃ¢u Giang"
          },
          {
            "id": "100029755934272",
            "name": "Nguyá»…n Yáº¿n Nhi"
          },
          {
            "id": "100034383453231",
            "name": "Thanh Mai"
          },
          {
            "id": "100035525660779",
            "name": "Tráº§n ChÆ°Æ¡ng"
          },
          {
            "id": "100038020578188",
            "name": "Pii An"
          },
          {
            "id": "100039707792352",
            "name": "HÃ  Thanh Má»¹ Tráº§n"
          },
          {
            "id": "100055043149966",
            "name": "Tiáº¿n VÃµ"
          },
          {
            "id": "100056627937098",
            "name": "Minh UyÃªn"
          },
          {
            "id": "100056634771689",
            "name": "Huá»³nh QuyÃªn"
          },
          {
            "id": "100057082697388",
            "name": "Quá»³nh Quá»³nh"
          },
          {
            "id": "100060628333297",
            "name": "Nháº¥t Long"
          },
          {
            "id": "100063156952990",
            "name": "John Cris"
          },
          {
            "id": "100068553722908",
            "name": "Ngoc Anh"
          },
          {
            "id": "100070362357401",
            "name": "Mai PhÆ°Æ¡ng"
          },
          {
            "id": "100073323880572",
            "name": "Quá»³nh NhÆ°"
          },
          {
            "id": "100078738384859",
            "name": "HoÃ ng Nam"
          },
          {
            "id": "100079433324177",
            "name": "Vu Hai Anh"
          },
          {
            "id": "100082436944869",
            "name": "VÃµ ThÃ nh Láº­p"
          },
          {
            "id": "100083490734727",
            "name": "Nguyá»…n Nhi"
          },
          {
            "id": "100086954269137",
            "name": "Ngoc Khanh"
          },
          {
            "id": "100088595622359",
            "name": "BÃºn BÃºn"
          },
          {
            "id": "100094453605425",
            "name": "Minh Thu"
          },
          {
            "id": "100095678641731",
            "name": "Thanh Tháº£o"
          }
        ],
        "comments": [],
        "reactions_count": 81,
        "comments_count": 0,
        "reactions_count_before_filter": 81,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61563280557067",
            "name": "Nguyá»…n HÃ¹ng CÆ°á»ng"
          },
          {
            "id": "61574450648872",
            "name": "ThuÃ½ HÃ "
          },
          {
            "id": "61576353419525",
            "name": "HoÃ ng Quá»‘c Viá»‡t"
          },
          {
            "id": "61582825323894",
            "name": "Ngá»c Linh - Nem NÆ°á»›ng Nha Trang "
          },
          {
            "id": "100003640788400",
            "name": "Hai Dang"
          },
          {
            "id": "100005960256358",
            "name": "VÅ© Thá»‹ BÃ­ch Lá»‡"
          },
          {
            "id": "100009222477267",
            "name": "Pháº¡m Viá»‡t Anh"
          },
          {
            "id": "100015201542172",
            "name": "Nguyá»…n Loan"
          },
          {
            "id": "100025139152808",
            "name": "Tuoi Bui"
          },
          {
            "id": "100027238878170",
            "name": "Cáº©m TÃº"
          },
          {
            "id": "100029778233874",
            "name": "Háº±ng Ni"
          },
          {
            "id": "100042693051495",
            "name": "Nguyá»…n Trang"
          },
          {
            "id": "100046940032349",
            "name": "LÆ°Æ¡ng Ãnh"
          },
          {
            "id": "100048126162429",
            "name": "Kim Phá»¥ng"
          },
          {
            "id": "100049220042731",
            "name": "BÃ¬nh DÆ°Æ¡ng LÃª"
          }
        ],
        "comments": [
          {
            "id": "100023363242962",
            "name": "Tin Tin",
            "text": "Trang LÃª cÃ³ tuyá»ƒn nhÃ¢n viÃªn báº¿p khÃ´ng áº¡",
            "created_time_vn": "2025-11-22 17:30:19"
          },
          {
            "id": "100028298443377",
            "name": "BÃ¹i Linh",
            "text": "ðŸ“£ NHÃ€ HÃ€NG UMAI OMAKASE Dá»¤NG â€“ PHá»¤C Vá»¤ Ná»®\n\nâœ¨ Vá»‹ trÃ­: NhÃ¢n viÃªn phá»¥c vá»¥ ná»¯\nâ° Thá»i gian: Fulltime 10h -14h, 17h - 22h\n\nYÃªu cáº§u:\n â€¢ Ngoáº¡i hÃ¬nh Æ°a nhÃ¬n, nhanh nháº¹n\n â€¢ SiÃªng nÄƒng, chá»‹u khÃ³, há»— trá»£ Ä‘á»“ng Ä‘á»™i tá»‘t\n â€¢ KhÃ´ng cáº§n kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o)\n\nQuyá»n lá»£i:\n â€¢ LÆ°Æ¡ng 8tr ( 28 cÃ´ng ) + thÆ°á»Ÿng theo nÄƒng lá»±c\n â€¢ MÃ´i trÆ°á»ng lÃ m viá»‡c chuyÃªn nghiá»‡p, thÃ¢n thiá»‡n\n â€¢ Tip má»—i ngÃ y\n\nðŸ“ Äá»ŠA ÄIá»‚M LÃ€M VIá»†C: NhÃ  hÃ ng UMAI OMAKASE 11 Máº¡c ThÃ¡i TÃ´ng, Cáº§u Giáº¥y, HÃ  Ná»™i\nðŸ“ž LIÃŠN Há»† á»¨NG TUYá»‚N: Mr Linh SÄ‘t: 0949213939",
            "created_time_vn": "2025-12-06 17:02:45"
          },
          {
            "id": "100013761460826",
            "name": "HÆ°Æ¡ng Ly",
            "text": "ðŸ“¢NHÃ€ HÃ€NG ONGI JIAJANG â€“ QUÃN Má»² TÆ¯Æ NG ÄEN HÃ€N QUá»C TUYá»‚N Dá»¤NG Gáº¤P\nðŸ“ Äá»‹a chá»‰ lÃ m viá»‡c: 230 Nguyá»…n VÄƒn Tuyáº¿t, Äá»‘ng Äa, HÃ  Ná»™i \nðŸ“Giá» lÃ m: 10h-13h30 vÃ  16h30-22h\nHiá»‡n táº¡i nhÃ  hÃ ng Ä‘ang cáº§n bá»• sung nhÃ¢n sá»± cho cÃ¡c vá»‹ trÃ­ sau:\n1ï¸âƒ£ Quáº£n lÃ½\n2ï¸âƒ£ Phá»¥ báº¿p (BAO Ä‚N á»ž)\n3ï¸âƒ£ NhÃ¢n viÃªn phá»¥c vá»¥ (Part-time/Full-time) (BAO Ä‚N CA)\nðŸ“± á»©ng tuyá»ƒn Zl: 0877 213 681 (HÆ°Æ¡ng Ly)",
            "created_time_vn": "2025-11-20 09:49:55"
          },
          {
            "id": "100020526768178",
            "name": "Cáº©m TÃº",
            "text": "TUYá»‚N Dá»¤NG Táº I NHÃ€ HÃ€NG BBQ ONG MAP Q2âœ¨\nSá»‘ lÆ°á»£ng tuyá»ƒn dá»¥ng:\nðŸ¤µðŸ» Vá»‹ trÃ­ nhÃ¢n viÃªn phá»¥c vá»¥ full time vÃ  part time\nâ­ KhÃ´ng yÃªu cáº§u kinh nghiá»‡m, sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o \nâ­ Æ¯u tiÃªn nhá»¯ng báº¡n cÃ³ thá»ƒ giao tiáº¿p tiáº¿ng hÃ n, nhanh nháº¹n, chÄƒm chá»‰, tÃ­nh cÃ¡ch vui váº», hoÃ  Ä‘á»“ng\n\n* Full time\nâ­ LÆ°Æ¡ng: 9.000.000 - 14.000.000 \nâ­ï¸ Thá»i gian lÃ m viá»‡c: 12h -10h vÃ  15h - 1h \nâ­ Bonus tá»« 2.000.000/ thÃ¡ng\n\n* Part time\nâ­ LÆ°Æ¡ng 33k/h - 36k/h + bonus cao\nâ­ï¸ Thá»i gian lÃ m viá»‡c: 11h - 15h, 18h- 23h vÃ  18h - 1h \n\nðŸ  Äá»ŠA ÄIá»‚M LÃ€M VIá»†C:\n45 Song HÃ nh, An PhÃº, Q2\nBBQ Ã”NG Máº¬P Quáº­n 2\n38 Tráº§n Ngá»c Diá»‡n, Tháº£o Äiá»n, Q2\nBBQ Ã”ng Máº­p Tháº£o Äiá»n ëš±ë³´ì§‘ íƒ€ì˜¤ë””ì—”\n\nðŸ’¬LiÃªn há»‡: 0909886320- ThÆ°",
            "created_time_vn": "2025-12-01 13:54:32"
          },
          {
            "id": "100082569921800",
            "name": "Minh Huyá»n",
            "text": "Trung tÃ¢m Anh ngá»¯ EFIS English (ChÃ¹a LÃ¡ng) hiá»‡n Ä‘ang tuyá»ƒn:\nâ€¢ Giáº£ng viÃªn Tiáº¿ng Anh giao tiáº¿p\nâ€¢ ChuyÃªn viÃªn TÆ° váº¥n\nâ€¢ Marketing SEO\nâ€¢ Event â€“ Social\n\nBáº¡n nÃ o quan tÃ¢m comment hoáº·c inbox mÃ¬nh gá»­i JD chi tiáº¿t nhÃ© ðŸŒ±",
            "created_time_vn": "2025-12-22 09:05:44"
          }
        ],
        "reactions_count": 16,
        "comments_count": 5,
        "reactions_count_before_filter": 16,
        "comments_count_before_filter": 7,
        "status": "success"
      },
      {
        "post_id": "122152945058694563",
        "flag": "xanh",
        "text": "ðŸŽ‰ ðŸŒ¸ â€œTáº¿t Ä‘áº¿n xuÃ¢n vá» â€“ tÃ¬m viá»‡c Ä‘Ã¢u xa, Vingroup chÃ o Ä‘Ã³n â€“ má»Ÿ lá»‘i thÄƒng hoa!â€ ðŸŒ¸ ðŸŽ‰ ðŸ¢ VINGROUP â€“ TUYá»‚N Dá»¤NG KHá»I VÄ‚N PHÃ’NG TOÃ€N QUá»C ðŸ‡»ðŸ‡³ ðŸ‡»ðŸ‡³ Báº¡n Ä‘ang tÃ¬m kiáº¿m má»™t mÃ´i trÆ°á»ng á»•n Ä‘á»‹nh â€“ chuyÃªn nghiá»‡p â€“ cÃ³ lá»™ trÃ¬nh thÄƒng tiáº¿n rÃµ rÃ ng? ðŸ‡»ðŸ‡³ Vingroup â€“ Táº­p Ä‘oÃ n kinh táº¿ tÆ° nhÃ¢n hÃ ng Ä‘áº§u Viá»‡t Nam â€“ Ä‘ang má»Ÿ rá»™ng Ä‘á»™i ngÅ© vÄƒn phÃ²ng trÃªn toÃ n quá»‘c, sáºµn sÃ ng Ä‘á»“ng hÃ nh cÃ¹ng báº¡n bÆ°á»›c vÃ o nÄƒm má»›i vá»›i nhiá»u cÆ¡ há»™i phÃ¡t triá»ƒn Ä‘á»™t phÃ¡. ðŸ’¢ Vá»Š TRÃ ÄANG TUYá»‚N ðŸ”– NhÃ¢n ViÃªn Káº¿ ToÃ¡n ðŸ”– ChuyÃªn ViÃªn Quáº£n LÃ½ Kinh Doanh ðŸ”– NhÃ¢n ViÃªn TÆ° Váº¥n ChÄƒm SÃ³c KhÃ¡ch HÃ ng ðŸ”– TrÆ°á»Ÿng PhÃ²ng Xuáº¥t Nháº­p Kháº©u ðŸ”– TrÆ°á»Ÿng PhÃ²ng Tiáº¿p Thá»‹ ThÆ°Æ¡ng Máº¡i ðŸ”– TrÆ°á»Ÿng PhÃ²ng HÃ nh ChÃ­nh NhÃ¢n Sá»± ðŸ“ LÃ m viá»‡c táº¡i cÃ¡c vÄƒn phÃ²ng Ä‘áº¡i diá»‡n trÃªn toÃ n quá»‘c ðŸŽ¯ Táº I SAO Báº N NÃŠN á»¨NG TUYá»‚N NGAY? â–ªï¸ Thu nháº­p háº¥p dáº«n, thÆ°á»Ÿng Táº¿t rÃµ rÃ ng â–ªï¸ Báº£o hiá»ƒm Ä‘áº§y Ä‘á»§, phÃºc lá»£i á»•n Ä‘á»‹nh â–ªï¸ CÆ¡ há»™i phÃ¡t triá»ƒn sá»± nghiá»‡p, Ä‘Æ°á»£c Ä‘Ã o táº¡o chuyÃªn sÃ¢u â–ªï¸ MÃ´i trÆ°á»ng lÃ m viá»‡c minh báº¡ch, hiá»‡n Ä‘áº¡i, chuyÃªn nghiá»‡p ðŸ“¨ Ná»™p há»“ sÆ¡ trá»±c tuyáº¿n táº¡i: https://qrco.de/tuyendungVinGroup ðŸ‘‰ Tag ngÆ°á»i phÃ¹ há»£p hoáº·c chia sáº» ngay cÆ¡ há»™i tuyá»‡t vá»i nÃ y! ðŸŒŸ VINGROUP â€“ NÆ¡i tÃ i nÄƒng Ä‘Æ°á»£c phÃ¡t huy vÃ  thÃ nh cÃ´ng Ä‘Æ°á»£c ghi nháº­n. CÃ¹ng khá»Ÿi Ä‘á»™ng nÄƒm má»›i vá»›i bÆ°á»›c tiáº¿n vá»¯ng vÃ ng trong sá»± nghiá»‡p! #Vingroup #TuyenDungTet2025 #CoHoiNgheNghiep #ViecLamVanPhong #DonXuanVingroup",
        "owning_profile": {
          "__typename": "User",
          "name": "Tuyá»ƒn Dá»¥ng VinGroup",
          "id": "61570836905496"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "1002263592",
            "name": "Ran Kaori"
          },
          {
            "id": "1234976494",
            "name": "Ha Tran"
          },
          {
            "id": "1268544510",
            "name": "VÄƒn ÄÃ¬nh LÃ¢m"
          },
          {
            "id": "1277446090",
            "name": "Nguyá»…n VÄƒn Tuá»‡"
          },
          {
            "id": "1485344389",
            "name": "Hong Hanh"
          },
          {
            "id": "1572664685",
            "name": "Vu Ngoc Lan"
          },
          {
            "id": "1790504763",
            "name": "Huong Nguyen"
          },
          {
            "id": "1830492804",
            "name": "Martin Ngo"
          },
          {
            "id": "61550123255824",
            "name": "Jenny Tráº§n"
          },
          {
            "id": "61550963711871",
            "name": "ÄÃ o Quang Huáº¥n"
          },
          {
            "id": "61551494556150",
            "name": "Nguyá»…n Thá»‹ Duyá»‡t"
          },
          {
            "id": "61551798632228",
            "name": "Tuan Anh"
          },
          {
            "id": "61552652491139",
            "name": "VÃµ Ngá»c HuyÃªn"
          },
          {
            "id": "61552709622705",
            "name": "HoÃ ng Máº¡nh"
          },
          {
            "id": "61553747960696",
            "name": "Long Gia"
          },
          {
            "id": "61553761829719",
            "name": "Nam Hoang"
          },
          {
            "id": "61555731806498",
            "name": "Minh Äá»©c"
          },
          {
            "id": "61556120043116",
            "name": "Mai Tráº§n Minh"
          },
          {
            "id": "61556452044279",
            "name": "Anh Long"
          },
          {
            "id": "61556795983288",
            "name": "Bass House"
          },
          {
            "id": "61557071407694",
            "name": "DÆ°Æ¡ng Thuyáº¿t"
          },
          {
            "id": "61557775749884",
            "name": "Nguyá»…n Thá»‹ VÄƒn"
          },
          {
            "id": "61564149783940",
            "name": "Ngá»c HÃ "
          },
          {
            "id": "61564578580794",
            "name": "Nguyá»…n Khanh"
          },
          {
            "id": "61567168498234",
            "name": "Há»“ PhÆ°Æ¡ng"
          },
          {
            "id": "61569010118881",
            "name": "Elvis PhÆ°Æ¡ng"
          },
          {
            "id": "61569180890275",
            "name": "Nguyá»…n TrÆ°á»ng"
          },
          {
            "id": "61569272138269",
            "name": "HÃ¢n Sáº§u"
          },
          {
            "id": "61570253625383",
            "name": "Äinh Há»“ng Tuá»‡ Hr"
          },
          {
            "id": "61571187577749",
            "name": "Dung Nguyá»…n"
          },
          {
            "id": "61571406964597",
            "name": "LÃª Anh Háº£i"
          },
          {
            "id": "61571671900364",
            "name": "Nguyá»…n VÆ°Æ¡ng Nhi"
          },
          {
            "id": "61571840248551",
            "name": "Tráº§n Diá»‡p BÄ‘s"
          },
          {
            "id": "61571848330448",
            "name": "Há»“ PhÆ°Æ¡ng"
          },
          {
            "id": "61572490859745",
            "name": "To Lan Thinh"
          },
          {
            "id": "61572842294221",
            "name": "HÃ  Phan Thu"
          },
          {
            "id": "61573733657294",
            "name": "Há»“ Má»™c NhÃ¢n"
          },
          {
            "id": "61573734497403",
            "name": "Pháº¡m ThÃ nh An"
          },
          {
            "id": "61573744547227",
            "name": "Huá»³nh Thá»¥y Ca"
          },
          {
            "id": "61573852654944",
            "name": "VÄƒn Háº£i"
          },
          {
            "id": "61573988684453",
            "name": "VÅ© Thuá»³ Dung"
          },
          {
            "id": "61574010964642",
            "name": "Huá»³nh Há»“ng QuÃ¢n"
          },
          {
            "id": "61574110798886",
            "name": "Phan Nháº­t Mi"
          },
          {
            "id": "61574152886242",
            "name": "Phan Thu NhÃ¢n"
          },
          {
            "id": "61574175593832",
            "name": "NgÃ´ Thiá»‡n Diá»‡p"
          },
          {
            "id": "61574258109121",
            "name": "Kháº£i Tá»‹nh"
          },
          {
            "id": "61574867364927",
            "name": "Nguyá»…n VÄƒn Tráº¯ng"
          },
          {
            "id": "61574978456212",
            "name": "Bee Bee"
          },
          {
            "id": "61575737576229",
            "name": "TÃ´n Long"
          },
          {
            "id": "61576253253121",
            "name": "Le Giap"
          },
          {
            "id": "61576570737659",
            "name": "PhÃ¡p Thiá»‡n Yuuta"
          },
          {
            "id": "61577718142636",
            "name": "Nam HoÃ i LÃª"
          },
          {
            "id": "61577831266701",
            "name": "NhÃ  Phá»‘ TrÆ°á»ng Khang"
          },
          {
            "id": "61577891019065",
            "name": "Äá»— Thá»‹ Tá»‘ TrÃ¢n"
          },
          {
            "id": "61577913800061",
            "name": "Phan Tien Thai"
          },
          {
            "id": "61577966011957",
            "name": "LÃª Thá»‹ Yáº¿n Nhi"
          },
          {
            "id": "61577990310795",
            "name": "Nguyá»…n ThÃ nh Luyáº¿n"
          },
          {
            "id": "61578060900327",
            "name": "Há»“ Thá»‹ Cáº©m Giang"
          },
          {
            "id": "61578588352981",
            "name": "Anh Minh"
          },
          {
            "id": "61578920644052",
            "name": "Háº£i LuÃ¢n"
          },
          {
            "id": "61579609253307",
            "name": "LÆ°u Hiá»n"
          },
          {
            "id": "61579616184503",
            "name": "Dáº«n Nguyá»…n"
          },
          {
            "id": "61579778518833",
            "name": "Vu Huong"
          },
          {
            "id": "61579924336884",
            "name": "Thai Pham"
          },
          {
            "id": "61580075301277",
            "name": "Nguyá»…n Thá»‹ Kim Dung"
          },
          {
            "id": "61580091380494",
            "name": "Huá»³nh Diá»…m"
          },
          {
            "id": "61580652643855",
            "name": "LÃª Quang Nha"
          },
          {
            "id": "61581145032703",
            "name": "Chan Dang Quay"
          },
          {
            "id": "61581397461144",
            "name": "Tran Phuc Giáº·t LÃ "
          },
          {
            "id": "61581418713978",
            "name": "ChiÃªm Khang DÆ°Æ¡ng"
          },
          {
            "id": "61581689701972",
            "name": "Khá»•ng Báº£o Tuáº¥n"
          },
          {
            "id": "61582487331614",
            "name": "Nguyá»…n Khang Land"
          },
          {
            "id": "61582779520068",
            "name": "Thanh Äinh XuÃ¢n"
          },
          {
            "id": "61582832777139",
            "name": "Tran Phat Ngan"
          },
          {
            "id": "61582869747879",
            "name": "Anh Nguyen"
          },
          {
            "id": "61583102734016",
            "name": "Mai Linh Son"
          },
          {
            "id": "61583218533495",
            "name": "KhÃ¡nh ÄÃ o"
          },
          {
            "id": "61583648552185",
            "name": "Anh Dung LÃª"
          },
          {
            "id": "61584927061788",
            "name": "LÃª KhÃ¡nh"
          },
          {
            "id": "61585066443817",
            "name": "TÃ¢m Thiá»‡n"
          },
          {
            "id": "100000033162372",
            "name": "LÆ°Æ¡ng ThÃ¡i SÆ¡n"
          },
          {
            "id": "100000046953514",
            "name": "Nguyen Thuy Binh"
          },
          {
            "id": "100000074903034",
            "name": "Ngoc Long"
          },
          {
            "id": "100000100445450",
            "name": "Nguyen Xuan Hoang"
          },
          {
            "id": "100000110883929",
            "name": "Ha Thanh Chung"
          },
          {
            "id": "100000118488636",
            "name": "Anh Tuan Dang"
          },
          {
            "id": "100000146503895",
            "name": "Tuan Bui Duc"
          },
          {
            "id": "100000199586797",
            "name": "HoÃ ng Há»“ng"
          },
          {
            "id": "100000206390872",
            "name": "Ha Vo Ngoc"
          },
          {
            "id": "100000227057333",
            "name": "Le van Luu"
          },
          {
            "id": "100000233054222",
            "name": "Nguyá»…n Äá»©c CÃ´ng"
          },
          {
            "id": "100000233458095",
            "name": "Äá»©c Anh"
          },
          {
            "id": "100000241421870",
            "name": "CÆ°á»ng LÃ£ ÄÄƒng"
          },
          {
            "id": "100000285841717",
            "name": "Trinh Vinh"
          },
          {
            "id": "100000299911498",
            "name": "Thanh BÃ¬nh"
          },
          {
            "id": "100000335930188",
            "name": "Tien Dang"
          },
          {
            "id": "100000359003842",
            "name": "ÄÃ o Thá»‹ HÆ°Æ¡ng"
          },
          {
            "id": "100000372765424",
            "name": "Beverly Truong"
          },
          {
            "id": "100000391379114",
            "name": "ÄÄƒng Quang"
          },
          {
            "id": "100000440642840",
            "name": "Yuki Nguyen"
          },
          {
            "id": "100000465101424",
            "name": "Pham Lien"
          },
          {
            "id": "100000471456601",
            "name": "Bon Bon"
          },
          {
            "id": "100000536634518",
            "name": "VÅ© Van Thá»¥"
          },
          {
            "id": "100000574898744",
            "name": "LÃª Thu NÄƒm"
          },
          {
            "id": "100000627052981",
            "name": "Nguyá»…n XuÃ¢n HÃ²a"
          },
          {
            "id": "100000778527246",
            "name": "Nay QuyÃªn"
          },
          {
            "id": "100000941868141",
            "name": "Thoa Tran"
          },
          {
            "id": "100000980293146",
            "name": "KhÃ¡nh VÃ¢n"
          },
          {
            "id": "100000984300799",
            "name": "Tung Vu"
          },
          {
            "id": "100001022243294",
            "name": "Huyen Trieu"
          },
          {
            "id": "100001087908348",
            "name": "TÃ i. Cá»­a Tá»± Äá»™ng"
          },
          {
            "id": "100001120775721",
            "name": "LÃª Thá»‹ Minh PhÆ°á»£ng"
          },
          {
            "id": "100001342910831",
            "name": "La Hoa"
          },
          {
            "id": "100001443078158",
            "name": "Bim Lim Dim"
          },
          {
            "id": "100001508086380",
            "name": "Tháº¿ KhÆ°Æ¡ng Nguyá»…n"
          },
          {
            "id": "100001575392906",
            "name": "Huyá»n Anh Nguyá»…n"
          },
          {
            "id": "100001760897883",
            "name": "My Hieu Dao"
          },
          {
            "id": "100001812241811",
            "name": "VÅ© Thu Trang"
          },
          {
            "id": "100001911838667",
            "name": "PhÃºc Pi"
          },
          {
            "id": "100002236262875",
            "name": "DÆ°Æ¡ng TrÃ­ Thá»©c"
          },
          {
            "id": "100002239523184",
            "name": "Nguyá»…n NgÃ¢n ChÃ¢u"
          },
          {
            "id": "100002284338356",
            "name": "Phuong Vu Mai"
          },
          {
            "id": "100002380444871",
            "name": "Tráº§n TÃ¢n"
          },
          {
            "id": "100002395931625",
            "name": "Lyly Dang"
          },
          {
            "id": "100002422973147",
            "name": "Nguyá»…n ThÃ nh ÄÃ´"
          },
          {
            "id": "100002448663492",
            "name": "BÃ¹i Tuyáº¿t"
          },
          {
            "id": "100002618172780",
            "name": "Tráº§n DÅ©ng"
          },
          {
            "id": "100002654683809",
            "name": "Nguyá»…n Dung"
          },
          {
            "id": "100002768697384",
            "name": "Van Linh Nguyen"
          },
          {
            "id": "100002828608496",
            "name": "Tháº¯ng LÃª ÄÄƒng"
          },
          {
            "id": "100002894088361",
            "name": "HoÃ ng Phi HÃ¹ng"
          },
          {
            "id": "100002918321046",
            "name": "Thuá»³ Äá»—"
          },
          {
            "id": "100002946674698",
            "name": "HÃ²e Nguyá»…n VÄƒn"
          },
          {
            "id": "100002978226577",
            "name": "Le Quang Tung"
          },
          {
            "id": "100002990355280",
            "name": "Thangmatlon Cutngay"
          },
          {
            "id": "100003112959701",
            "name": "VÄƒn SÆ¡n"
          },
          {
            "id": "100003137892869",
            "name": "Phihung Hoang"
          },
          {
            "id": "100003143419391",
            "name": "Tiáº¿n DÅ©ng"
          },
          {
            "id": "100003187192760",
            "name": "Hoang Anh Ha"
          },
          {
            "id": "100003208886321",
            "name": "Nguyá»…n Huyá»n Trang"
          },
          {
            "id": "100003212128126",
            "name": "Pháº¡m VÄ©nh"
          },
          {
            "id": "100003219365046",
            "name": "HoÃ i LÃª Thá»‹"
          },
          {
            "id": "100003256625248",
            "name": "Quang Ngoc Nguyen"
          },
          {
            "id": "100003263785363",
            "name": "Thu Tráº§n"
          },
          {
            "id": "100003268721828",
            "name": "Quang TÃ¹ng"
          },
          {
            "id": "100003294388608",
            "name": "LÃª TÃ i"
          },
          {
            "id": "100003296659152",
            "name": "PhÆ°Æ¡ng Nhung"
          },
          {
            "id": "100003349716645",
            "name": "Nguyá»…n Äá»©c NvÄ‘"
          },
          {
            "id": "100003385221252",
            "name": "CÃ¢y Phong Ba"
          },
          {
            "id": "100003484607808",
            "name": "Thanh ThuÃ½"
          },
          {
            "id": "100003496539524",
            "name": "Trung TrÆ°Æ¡ng VÄƒn"
          },
          {
            "id": "100003527679379",
            "name": "Nhu Tan Nguyen"
          },
          {
            "id": "100003696053635",
            "name": "Ruby Fly"
          },
          {
            "id": "100003730111726",
            "name": "Thach Hoang Van"
          },
          {
            "id": "100003769549026",
            "name": "Tráº§n Trung NhÃ¢n"
          },
          {
            "id": "100003772078549",
            "name": "Tuoi Nguyen"
          },
          {
            "id": "100003826431405",
            "name": "Blnh Mlnh"
          },
          {
            "id": "100003826836026",
            "name": "VÅ© Linh"
          },
          {
            "id": "100003840960528",
            "name": "Ãnh Nguyá»…n"
          },
          {
            "id": "100003856208943",
            "name": "Phan HÃ²a"
          },
          {
            "id": "100003869987023",
            "name": "Nguyá»…n Thá»‹ Má»¹ Nhung"
          },
          {
            "id": "100003894536935",
            "name": "Tráº§n Há»¯u ThÃ´ng"
          },
          {
            "id": "100003911883355",
            "name": "CÆ°á»ng ThÃ nh"
          },
          {
            "id": "100003932734095",
            "name": "ThÃ nh Kyo"
          },
          {
            "id": "100003946908707",
            "name": "NguyÃªn TÃº"
          },
          {
            "id": "100003951724972",
            "name": "Nguyá»…n Thá»‹ HÃ  NgÃ¢n"
          },
          {
            "id": "100003953913292",
            "name": "DÅ©ng Nguyá»…n Minh"
          },
          {
            "id": "100004016275196",
            "name": "Há»“ VÄƒn Tuáº¥n"
          },
          {
            "id": "100004087246460",
            "name": "Nguyá»…n Há»¯u Äáº¡t"
          },
          {
            "id": "100004135123453",
            "name": "Mung Nguyen Thi"
          },
          {
            "id": "100004138992607",
            "name": "Hong Hai Vu"
          },
          {
            "id": "100004144351309",
            "name": "LÃª Trung Hiáº¿u"
          },
          {
            "id": "100004149012038",
            "name": "Huáº¿ Äáº·ng"
          },
          {
            "id": "100004174891392",
            "name": "Táº¥n TÃ i"
          },
          {
            "id": "100004256954453",
            "name": "Quá»³nh NhÆ°"
          },
          {
            "id": "100004273023294",
            "name": "Äá»— ThÃ¹y Linh"
          },
          {
            "id": "100004300397713",
            "name": "Thanh Ngo"
          },
          {
            "id": "100004304313985",
            "name": "Há»“ng PhÃºc"
          },
          {
            "id": "100004306290359",
            "name": "Hiá»n HoÃ ng"
          },
          {
            "id": "100004316522352",
            "name": "Thuá»· Pro"
          },
          {
            "id": "100004342441972",
            "name": "VÄƒn Trung"
          },
          {
            "id": "100004348142950",
            "name": "Trá»‹nh Thá»‹ Linh"
          },
          {
            "id": "100004355646949",
            "name": "VÃµ HoÃ ng Bá»­u"
          },
          {
            "id": "100004428257202",
            "name": "Äá»— Quang Dá»±"
          },
          {
            "id": "100004429086279",
            "name": "Tráº§n ThÃ¡i Äáº¡o"
          },
          {
            "id": "100004437578563",
            "name": "Sen Nháº³ng"
          },
          {
            "id": "100004463476051",
            "name": "Ngoc Anh Tran"
          },
          {
            "id": "100004560970878",
            "name": "HÃªnh Pháº¡m"
          },
          {
            "id": "100004569734453",
            "name": "Lona Cat"
          },
          {
            "id": "100004616855082",
            "name": "Triá»‡u Hiá»ƒn"
          },
          {
            "id": "100004622803079",
            "name": "Thao Ha"
          },
          {
            "id": "100004654544241",
            "name": "Nguyá»…n Thá»‹ Háº¡nh"
          },
          {
            "id": "100004746369209",
            "name": "VÄƒn Toáº£n"
          },
          {
            "id": "100004828269961",
            "name": "TrÆ°á»Ÿng Tráº§n ÄÃ¬nh"
          },
          {
            "id": "100004835741451",
            "name": "Duc Tran"
          },
          {
            "id": "100004841040407",
            "name": "Trung Thuc Hoang"
          },
          {
            "id": "100004854581771",
            "name": "Viá»‡t Nguyá»…n"
          },
          {
            "id": "100004907562634",
            "name": "VÅ© KhÃ¡nh Vy"
          },
          {
            "id": "100004933301352",
            "name": "HoÃ ng Dung"
          },
          {
            "id": "100004942956305",
            "name": "ThÃºy HoÃ ng"
          },
          {
            "id": "100005016818649",
            "name": "VÅ© Quang Hiáº¿n"
          },
          {
            "id": "100005033012757",
            "name": "Tráº§n VÃ¢n"
          },
          {
            "id": "100005060382165",
            "name": "LÃª VÄƒn Nam"
          },
          {
            "id": "100005143232807",
            "name": "Lien Nguyen"
          },
          {
            "id": "100005158926907",
            "name": "Nguyá»…n VÅ©"
          },
          {
            "id": "100005180706859",
            "name": "Thanh Binh Tran"
          },
          {
            "id": "100005198500756",
            "name": "Äiá»ƒm Nguyá»…n"
          },
          {
            "id": "100005199186637",
            "name": "Tráº§n NhÃ¢n"
          },
          {
            "id": "100005293903253",
            "name": "Viet Son"
          },
          {
            "id": "100005316904446",
            "name": "Äáº¡t Vinh ChÃ¢u"
          },
          {
            "id": "100005328273224",
            "name": "BÃ¡ch Zim"
          },
          {
            "id": "100005355072949",
            "name": "Quá»‘c Biá»ƒu"
          },
          {
            "id": "100005443655127",
            "name": "Ty Nguyen"
          },
          {
            "id": "100005476835538",
            "name": "PhÃ¹ng NghÄ©a"
          },
          {
            "id": "100005491364399",
            "name": "Nguyá»…n Thá»‹ ThÆ°"
          },
          {
            "id": "100005734712385",
            "name": "Ãnh Ãnh"
          },
          {
            "id": "100005761982763",
            "name": "TranAnh Tran"
          },
          {
            "id": "100005785600557",
            "name": "LÃª Báº£o Linh"
          },
          {
            "id": "100005987043595",
            "name": "Háº£i Äá»—"
          },
          {
            "id": "100005989327652",
            "name": "Kiet Duong Tuan"
          },
          {
            "id": "100005998215190",
            "name": "Pham Minh Chi"
          },
          {
            "id": "100006190306738",
            "name": "Vinh Nguyá»…n"
          },
          {
            "id": "100006282243357",
            "name": "TrÆ°Æ¡ng Quang Bá»•n"
          },
          {
            "id": "100006289752741",
            "name": "Pháº¡m Thuá»³"
          },
          {
            "id": "100006347823477",
            "name": "Dung Anh"
          },
          {
            "id": "100006356471950",
            "name": "LÃª Minh VÅ©"
          },
          {
            "id": "100006436550382",
            "name": "Hoang Lan"
          },
          {
            "id": "100006455468722",
            "name": "Nguyá»…n HoÃ ng"
          },
          {
            "id": "100006477952681",
            "name": "Thanh Kha"
          },
          {
            "id": "100006492082087",
            "name": "LÃ¢m VÅ©"
          },
          {
            "id": "100006527703159",
            "name": "Dung Nguyá»…n"
          },
          {
            "id": "100006534735398",
            "name": "Äáº¥t Viá»‡t"
          },
          {
            "id": "100006535210556",
            "name": "DÆ°Æ¡ng LÃª"
          },
          {
            "id": "100006564792292",
            "name": "Nguyet Duong"
          },
          {
            "id": "100006621008888",
            "name": "ChÃºc An"
          },
          {
            "id": "100006625688182",
            "name": "HoÃ ng Dung"
          },
          {
            "id": "100006629867100",
            "name": "Mai Truc"
          },
          {
            "id": "100006650558886",
            "name": "Huá»³nh Tuáº¥n Háº£i"
          },
          {
            "id": "100006652847354",
            "name": "tháº±ng khá»"
          },
          {
            "id": "100006656734334",
            "name": "Anh Tram"
          },
          {
            "id": "100006658449464",
            "name": "Pháº¡m Táº¡o"
          },
          {
            "id": "100006670560114",
            "name": "Nguyá»…n Minh TÃ¢m"
          },
          {
            "id": "100006714038802",
            "name": "Nguyá»…n Thanh Nghá»‹"
          },
          {
            "id": "100006828812149",
            "name": "Hai Con CuÃ´ng"
          },
          {
            "id": "100006870633964",
            "name": "Cuong Ha"
          },
          {
            "id": "100006910334973",
            "name": "Tra Giang"
          },
          {
            "id": "100006924643905",
            "name": "Huynh Toan"
          },
          {
            "id": "100006954573224",
            "name": "Le Hien"
          },
          {
            "id": "100007021395010",
            "name": "PhÃº SÄ©"
          },
          {
            "id": "100007141772004",
            "name": "KhÆ°Æ¡ng Tiáº¿n Tháº£o"
          },
          {
            "id": "100007147607792",
            "name": "Huy PhÆ°Æ¡ng"
          },
          {
            "id": "100007184853225",
            "name": "Phan Quá»³nh"
          },
          {
            "id": "100007210390645",
            "name": "Tran Nhat Thang"
          },
          {
            "id": "100007343377103",
            "name": "Hang Le"
          },
          {
            "id": "100007351243660",
            "name": "HoÃ ng Trá»ng"
          },
          {
            "id": "100007393903182",
            "name": "Nguyá»…n Há»“ng Háº£i"
          },
          {
            "id": "100007460525808",
            "name": "Tráº§n Minh Äá»©c"
          },
          {
            "id": "100007508854903",
            "name": "Tuyáº¿t ThÃ¡i"
          },
          {
            "id": "100007541643743",
            "name": "Thanh NgÃ "
          },
          {
            "id": "100007542781938",
            "name": "Bui Viet Vuong"
          },
          {
            "id": "100007737932763",
            "name": "Äáº·ng XuÃ¢n Quang"
          },
          {
            "id": "100007864661236",
            "name": "NgÃ¢n Tráº§n"
          },
          {
            "id": "100007882321871",
            "name": "VÄƒn Minh"
          },
          {
            "id": "100007927390679",
            "name": "Hanh Tran"
          },
          {
            "id": "100007967923641",
            "name": "Tony Tp"
          },
          {
            "id": "100008140249491",
            "name": "PÃ© Bá»±"
          },
          {
            "id": "100008221572096",
            "name": "Huyen Thu"
          },
          {
            "id": "100008234374431",
            "name": "Nguyá»…n Thanh Nga"
          },
          {
            "id": "100008248577763",
            "name": "Háº£o Äinh"
          },
          {
            "id": "100008291257535",
            "name": "Nguyá»…n Trang Linh"
          },
          {
            "id": "100008425995708",
            "name": "An Thuy"
          },
          {
            "id": "100008451288135",
            "name": "Pháº¡m HÆ°Æ¡ng"
          },
          {
            "id": "100008521248711",
            "name": "VÄƒn Tuáº¥n"
          },
          {
            "id": "100008694605147",
            "name": "Nam LE Van"
          },
          {
            "id": "100008993380043",
            "name": "ThiÃªn Sá»© BÃ´ng Há»“ng"
          },
          {
            "id": "100009041181623",
            "name": "HoÃ ng Thá»‹ Nhung"
          },
          {
            "id": "100009076064008",
            "name": "TrÆ°Æ¡ng ThiÃªn VÄƒn"
          },
          {
            "id": "100009156128207",
            "name": "Nga Nguyá»…n"
          },
          {
            "id": "100009492122316",
            "name": "Ná»™i Tpth Vinspex"
          },
          {
            "id": "100009700398050",
            "name": "Dung Dang Hong"
          },
          {
            "id": "100009710115306",
            "name": "Cao Thi Thuy Kieu"
          },
          {
            "id": "100009710402349",
            "name": "HoÃ  Mai"
          },
          {
            "id": "100009721188717",
            "name": "Nari Nguyá»…n"
          },
          {
            "id": "100009786584855",
            "name": "LÃª BÃ¡ Chiáº¿n"
          },
          {
            "id": "100009850141283",
            "name": "Há»“ CÆ°á»ng"
          },
          {
            "id": "100010045967431",
            "name": "Giang Nguyen"
          },
          {
            "id": "100010125007281",
            "name": "Nguyá»…n CÃ´ng ChÃ­nh"
          },
          {
            "id": "100010201384092",
            "name": "BÃ¹i ToÃ n"
          },
          {
            "id": "100010275101767",
            "name": "Nguyá»…n Ngá»c Phong"
          },
          {
            "id": "100010373340923",
            "name": "BÃ¡ ChÃ¢u"
          },
          {
            "id": "100010533724426",
            "name": "Quy Phi"
          },
          {
            "id": "100010608222218",
            "name": "Tráº§n Kim NgÃ¢n"
          },
          {
            "id": "100010673776672",
            "name": "HoÃ ng Tuáº¥n"
          },
          {
            "id": "100010743184484",
            "name": "Van Trung"
          },
          {
            "id": "100010888540861",
            "name": "Du Le"
          },
          {
            "id": "100010918548956",
            "name": "Thanh HoÃ ng"
          },
          {
            "id": "100010959194633",
            "name": "Pháº¡m NgÃ¢n"
          },
          {
            "id": "100011103738351",
            "name": "LÃª HÆ°á»ng"
          },
          {
            "id": "100011229511818",
            "name": "Nguyá»…n Lan PhÆ°Æ¡ngg"
          },
          {
            "id": "100011367592771",
            "name": "Nguyá»…n Mai"
          },
          {
            "id": "100011394891822",
            "name": "Nguyá»…n Hoc"
          },
          {
            "id": "100011668994702",
            "name": "Mrken 'Tráº§n'"
          },
          {
            "id": "100011798833475",
            "name": "Thanh Huyá»n Nguyá»…n"
          },
          {
            "id": "100011866704626",
            "name": "Phan Ngoan"
          },
          {
            "id": "100011931436749",
            "name": "Phan VÄƒn"
          },
          {
            "id": "100011980453016",
            "name": "Nguyá»…n HoÃ ng Minh"
          },
          {
            "id": "100012075423028",
            "name": "Nguyá»…n Minh"
          },
          {
            "id": "100012373298685",
            "name": "Nguyá»…n Há»¯u Thá»‹nh"
          },
          {
            "id": "100012594226421",
            "name": "HoÃ i BÃ¹i"
          },
          {
            "id": "100012713474153",
            "name": "Suá»‘i ÄÃ¡"
          },
          {
            "id": "100012773562115",
            "name": "Lá»c NÆ°á»›c TÃ¢y Ninh"
          },
          {
            "id": "100013065763040",
            "name": "Luong Tran"
          },
          {
            "id": "100013220139095",
            "name": "CÃ¡i GÃ¬ Cháº³ng CÃ³"
          },
          {
            "id": "100013263695559",
            "name": "Äá»©c Pháº¡m"
          },
          {
            "id": "100013358612819",
            "name": "Vansao Tran"
          },
          {
            "id": "100013379434358",
            "name": "Hoang Monaco"
          },
          {
            "id": "100013476914535",
            "name": "LÆ°u Äá»©c Duy"
          },
          {
            "id": "100013549770221",
            "name": "DÆ°Æ¡ng TÆ°á»ng Duy"
          },
          {
            "id": "100013618568123",
            "name": "Phan ÄÃ¬nh Äáº¡t"
          },
          {
            "id": "100013769500273",
            "name": "Tráº§n Äá»©c TÃ¬nh"
          },
          {
            "id": "100014470716662",
            "name": "HoÃ ng Anh BTonio Lecturer"
          },
          {
            "id": "100014518449736",
            "name": "Hanh Chu"
          },
          {
            "id": "100014736707023",
            "name": "Tuan Anh Nguyá»…n"
          },
          {
            "id": "100014744434065",
            "name": "Tráº§n TÃ¢m"
          },
          {
            "id": "100015297154167",
            "name": "Bao Hoa Nguyen"
          },
          {
            "id": "100015327542257",
            "name": "Nguyá»…n Dung"
          },
          {
            "id": "100015541562943",
            "name": "Tráº§n Hoa"
          },
          {
            "id": "100015766291522",
            "name": "ÄÃ o Gia Founder"
          },
          {
            "id": "100016384751535",
            "name": "Tráº§n PhÃº"
          },
          {
            "id": "100016569391198",
            "name": "Tooichi Kuroba"
          },
          {
            "id": "100016784174705",
            "name": "Ngá»c ToÃ n"
          },
          {
            "id": "100016807449887",
            "name": "TÃº BÃ¹i"
          },
          {
            "id": "100016858773368",
            "name": "DÆ°Æ¡ng Toáº£n Linh"
          },
          {
            "id": "100016927471613",
            "name": "ThiÃªn VÃ¢n"
          },
          {
            "id": "100017007180195",
            "name": "Xoan Tit Xoan"
          },
          {
            "id": "100017616608808",
            "name": "Nguyá»…n VÃ¢n Thá»‹nh"
          },
          {
            "id": "100017645802520",
            "name": "TrÆ°Æ¡ng TrÃ­ Äá»©c"
          },
          {
            "id": "100020736142752",
            "name": "Nguyá»…n Huy GiÃ¡p"
          },
          {
            "id": "100021702982261",
            "name": "Phan Thá»‹ Máº­n"
          },
          {
            "id": "100021719721075",
            "name": "LÃª Há»¯u HÃ "
          },
          {
            "id": "100022269277688",
            "name": "Trung CuChi"
          },
          {
            "id": "100022647950578",
            "name": "LÃª Duy Thá»"
          },
          {
            "id": "100022848772578",
            "name": "Nguyá»…n BiÃªn"
          },
          {
            "id": "100023066776436",
            "name": "Ken Ken"
          },
          {
            "id": "100023472497923",
            "name": "ÄÃ´ng MÃ¹a"
          },
          {
            "id": "100023906706671",
            "name": "Kim Dung"
          },
          {
            "id": "100024414377599",
            "name": "Hoahong Hoahong"
          },
          {
            "id": "100024616364535",
            "name": "Äinh Quang DÅ©ng"
          },
          {
            "id": "100024715094699",
            "name": "HoÃ ng Thá»‹ NgÃ n"
          },
          {
            "id": "100024755232860",
            "name": "VÄƒn ChÃ­nh"
          },
          {
            "id": "100025032575504",
            "name": "Äáº·ng VÄƒn TÃ­nh"
          },
          {
            "id": "100025033702562",
            "name": "Äá»— Diá»‡p Khanh"
          },
          {
            "id": "100025148075519",
            "name": "PhÃ¡t TrÆ°Æ¡ng"
          },
          {
            "id": "100025417395973",
            "name": "Nhung Dao"
          },
          {
            "id": "100025495093138",
            "name": "CÃ´ Äá»™c VÆ°Æ¡ng"
          },
          {
            "id": "100025667291297",
            "name": "Lyla Larry Nguyen"
          },
          {
            "id": "100026182246416",
            "name": "Pham Minh"
          },
          {
            "id": "100026300572404",
            "name": "Lan Anh Nail"
          },
          {
            "id": "100026896832330",
            "name": "Minh Quang Vu"
          },
          {
            "id": "100027140260785",
            "name": "Nguyá»…n Tháº¿ Sinh"
          },
          {
            "id": "100027447045890",
            "name": "Nguyen Háº±ng"
          },
          {
            "id": "100027773987109",
            "name": "Quan Thuáº§n"
          },
          {
            "id": "100027882458875",
            "name": "TrÆ°Æ¡ng Thanh NgÃ¢n"
          },
          {
            "id": "100027892488162",
            "name": "Há»“ Má»¹ Trang"
          },
          {
            "id": "100028057694355",
            "name": "Nguyá»…n Tháº¿ Ngá»c"
          },
          {
            "id": "100028183980483",
            "name": "Hoa Nguyen"
          },
          {
            "id": "100028499742249",
            "name": "ÄÃ o ÄÃ¬nh Luyá»‡n"
          },
          {
            "id": "100028687274030",
            "name": "Tráº§n ÄÃ¬nh VÅ©"
          },
          {
            "id": "100028696751646",
            "name": "Nga Kim VÅ© HR"
          },
          {
            "id": "100028882415709",
            "name": "Thá»§y Nguyá»…n"
          },
          {
            "id": "100029299301680",
            "name": "Vi Hoa"
          },
          {
            "id": "100029670409014",
            "name": "Huyá»n Äáº·ng"
          },
          {
            "id": "100029798453334",
            "name": "Ngá»¥y Huyá»n TrÃ¢m"
          },
          {
            "id": "100029967125807",
            "name": "LÃª HoÃ ng"
          },
          {
            "id": "100030104508772",
            "name": "Báº£o LÃ¢m"
          },
          {
            "id": "100030473134367",
            "name": "HÃ  LÃª"
          },
          {
            "id": "100030509079299",
            "name": "Tráº§n VÄƒn HÃ¹ng"
          },
          {
            "id": "100030578503940",
            "name": "Há»¯u ThÃ nh"
          },
          {
            "id": "100030659791332",
            "name": "LÆ°Æ¡ng VÄƒn TÃ¢y"
          },
          {
            "id": "100030833381157",
            "name": "Thoc Luu"
          },
          {
            "id": "100030909782658",
            "name": "VÆ°Æ¡ng XuÃ¢n Trung"
          },
          {
            "id": "100031257766967",
            "name": "Nguyá»…n Zin"
          },
          {
            "id": "100031949331540",
            "name": "Ma Tháº£o"
          },
          {
            "id": "100033158917500",
            "name": "Nhi Thá»‹"
          },
          {
            "id": "100033583038301",
            "name": "Lien Le"
          },
          {
            "id": "100034551607051",
            "name": "Kiá»u Ngá»c"
          },
          {
            "id": "100034573387118",
            "name": "Nguyá»…n Táº¥n Tháº¡nh"
          },
          {
            "id": "100035312289300",
            "name": "Pháº¡m Báº£o Vinh"
          },
          {
            "id": "100035413536551",
            "name": "Nguyá»…n Toáº£n"
          },
          {
            "id": "100035471355865",
            "name": "Pháº¡m HoÃ n Ã‚n"
          },
          {
            "id": "100035824970612",
            "name": "LÃ½ Táº§m Hoan"
          },
          {
            "id": "100035891000395",
            "name": "Nguyá»…n Kiá»u Má»µ"
          },
          {
            "id": "100036436549617",
            "name": "Äinh Thá»‹ Tuyáº¿t Mai"
          },
          {
            "id": "100037302003281",
            "name": "Äá»— Lá»¥a"
          },
          {
            "id": "100037465741341",
            "name": "Hiá»ƒu RÃ¢u"
          },
          {
            "id": "100039006110871",
            "name": "Trang TrÃ²n"
          },
          {
            "id": "100039107282206",
            "name": "Nguyá»…n Minh Phá»¥ng"
          },
          {
            "id": "100039234011717",
            "name": "ÄÃ  Chu"
          },
          {
            "id": "100039431713970",
            "name": "Äinh VÄƒn Tuáº¥n"
          },
          {
            "id": "100039791821927",
            "name": "Cuong Vu"
          },
          {
            "id": "100040344554026",
            "name": "Nguyá»…n Há»¯u ToÃ n"
          },
          {
            "id": "100040714280187",
            "name": "Khanh An Cam"
          },
          {
            "id": "100040854852044",
            "name": "Kien Nguyen"
          },
          {
            "id": "100041005845935",
            "name": "ÄoÃ n Minh Hiáº¿u"
          },
          {
            "id": "100041138773693",
            "name": "Mai Vinh"
          },
          {
            "id": "100041331110092",
            "name": "Kháº¯c Ngá»c"
          },
          {
            "id": "100041331771277",
            "name": "Há»“ PhÆ°á»›c An"
          },
          {
            "id": "100041741836664",
            "name": "Giang Má»· DuyÃªn"
          },
          {
            "id": "100042365281852",
            "name": "Trang LÃª"
          },
          {
            "id": "100042843185509",
            "name": "Huy HoÃ ng PhÃ¡t"
          },
          {
            "id": "100043083728060",
            "name": "Long Quyá»n Hino"
          },
          {
            "id": "100043837155888",
            "name": "Sunny Huá»³nh"
          },
          {
            "id": "100044217855177",
            "name": "Loan Nong"
          },
          {
            "id": "100044322856461",
            "name": "Lá»‡ Háº±ng"
          },
          {
            "id": "100044395205424",
            "name": "LÃ nh LÃª"
          },
          {
            "id": "100044750093304",
            "name": "Minh Kháº£i HÆ°ng"
          },
          {
            "id": "100044828802250",
            "name": "Tráº§n HoÃ i VÄƒn"
          },
          {
            "id": "100044982412216",
            "name": "Tuan Anh Phung Quoc"
          },
          {
            "id": "100045239104005",
            "name": "Pháº¡m Tuáº¥n"
          },
          {
            "id": "100045857166831",
            "name": "Gia Huy"
          },
          {
            "id": "100046073641870",
            "name": "Nguyá»…n Thá»‹ DuyÃªn"
          },
          {
            "id": "100046405936633",
            "name": "Há»“ XuÃ¢n Hiáº¿u"
          },
          {
            "id": "100046643683833",
            "name": "Hoang Anh Nguyen"
          },
          {
            "id": "100047608833937",
            "name": "Nguyá»…n Tháº£o Nhi"
          },
          {
            "id": "100047832253096",
            "name": "VÄƒn Táº¥n TÃ i"
          },
          {
            "id": "100048950482838",
            "name": "NgÃ´ Thanh ThÃ¹y"
          },
          {
            "id": "100049057852661",
            "name": "Gia Hung"
          },
          {
            "id": "100049137320683",
            "name": "Nguyá»…n Há»¯u TÃ¹ng"
          },
          {
            "id": "100049364013977",
            "name": "Triá»u Nguyá»…n"
          },
          {
            "id": "100049529929873",
            "name": "Trá»ng Nguyá»…n"
          },
          {
            "id": "100049933239314",
            "name": "Nguyá»…n Thanh PhÆ°Æ¡ng"
          },
          {
            "id": "100050313874375",
            "name": "Nguyá»…n KhÃ¡nh An"
          },
          {
            "id": "100050689431203",
            "name": "VÄƒn Ká»·"
          },
          {
            "id": "100050896924676",
            "name": "Chau Truong"
          },
          {
            "id": "100051580996504",
            "name": "VÆ°Æ¡ng HoÃ ng"
          },
          {
            "id": "100051631818167",
            "name": "à¸„à¸¸à¸“ à¸§à¸µà¸£à¸ à¸±à¸—à¸£"
          },
          {
            "id": "100052289653476",
            "name": "Há»“ Kim ThÃ nh Anh"
          },
          {
            "id": "100052330601510",
            "name": "Nguyá»…n XuÃ¢n Háº£i"
          },
          {
            "id": "100052797646738",
            "name": "NgÃ´ ÄÄƒng Sá»¹ Sá»¹"
          },
          {
            "id": "100053168822469",
            "name": "Khang HoÃ ng"
          },
          {
            "id": "100053385587217",
            "name": "Huá»³nh Má»¹ An"
          },
          {
            "id": "100053523216470",
            "name": "TrÆ°Æ¡ng Báº£o KhÃ¡nh"
          },
          {
            "id": "100053618811831",
            "name": "Nguyen Nghia"
          },
          {
            "id": "100053653425560",
            "name": "CÃ´ng Anh"
          },
          {
            "id": "100054118547462",
            "name": "LÆ°Æ¡ng VÄƒn GiÃ u"
          },
          {
            "id": "100055091536978",
            "name": "Nguyá»…n Thá»§y"
          },
          {
            "id": "100055456192661",
            "name": "Hai Nguyen"
          },
          {
            "id": "100056115540240",
            "name": "Vinh NguyÃªn"
          },
          {
            "id": "100056204585461",
            "name": "TÃ²ng Vinh Láº­p"
          },
          {
            "id": "100056219674828",
            "name": "Nguyá»…n ÄÄƒng Long"
          },
          {
            "id": "100056893673138",
            "name": "Pháº¡m HÆ°Æ¡ng"
          },
          {
            "id": "100056971001603",
            "name": "Äá»— Ngá»c BÃ­ch"
          },
          {
            "id": "100057218484529",
            "name": "An Dong"
          },
          {
            "id": "100057282332889",
            "name": "Äáº·ng Long"
          },
          {
            "id": "100057294213677",
            "name": "Báº¯c ChiÃªm Ks"
          },
          {
            "id": "100058695786943",
            "name": "TrÆ°Æ¡ng Ngá»c CÆ°á»ng"
          },
          {
            "id": "100059470687155",
            "name": "KiLa Kids"
          },
          {
            "id": "100061966165039",
            "name": "XuÃ¢n BÃ¹i"
          },
          {
            "id": "100063582972054",
            "name": "Nguyá»…n HÆ°Æ¡ng"
          },
          {
            "id": "100065484991136",
            "name": "Há»¯u TÄ©nh"
          },
          {
            "id": "100065755574601",
            "name": "LÃª Quang VÄƒn"
          },
          {
            "id": "100065910370542",
            "name": "Aiy Kham Ma Ny"
          },
          {
            "id": "100066564653556",
            "name": "Sen Pham"
          },
          {
            "id": "100066843591263",
            "name": "Pháº¡m Nháº­t Tiáº¿n"
          },
          {
            "id": "100067012723713",
            "name": "Pháº¡m Thanh VÃ¢n"
          },
          {
            "id": "100067050272709",
            "name": "Tráº§n ÄÃ n"
          },
          {
            "id": "100067311587908",
            "name": "Tráº§n VÄƒn TrÆ°á»ng"
          },
          {
            "id": "100067495173935",
            "name": "LÃª Ngá»c Huy"
          },
          {
            "id": "100067561286987",
            "name": "NT Bii"
          },
          {
            "id": "100067655688411",
            "name": "HoÃ ng Kim TÃ¹ng"
          },
          {
            "id": "100067783291879",
            "name": "Nguyá»…n HoÃ ng Vinh"
          },
          {
            "id": "100068319355393",
            "name": "Nguyá»…n Kháº£ Nhi"
          },
          {
            "id": "100069529777480",
            "name": "Nguyá»…n VÃµ Lá»£i"
          },
          {
            "id": "100069724183977",
            "name": "ÄÃ o Há»¯u Huá»³nh"
          },
          {
            "id": "100070643193025",
            "name": "Nguyá»…n Hoan"
          },
          {
            "id": "100070996751630",
            "name": "Thiá»u Nguyá»…n VÄƒn"
          },
          {
            "id": "100071772381887",
            "name": "Anan Anan"
          },
          {
            "id": "100071986008443",
            "name": "HoÃ ng SÆ¡n"
          },
          {
            "id": "100072577917134",
            "name": "HÃ  Moon"
          },
          {
            "id": "100072884918743",
            "name": "Äinh Ngá»c Huyá»n"
          },
          {
            "id": "100072973166250",
            "name": "LÃª Minh PhÆ°Æ¡ng"
          },
          {
            "id": "100073041764842",
            "name": "Gia An"
          },
          {
            "id": "100073288287437",
            "name": "Kim Yen"
          },
          {
            "id": "100073474667304",
            "name": "Nguyá»…n Minh Tuáº¥n"
          },
          {
            "id": "100073518842187",
            "name": "Ken Vy"
          },
          {
            "id": "100074726791534",
            "name": "Thanh Long"
          },
          {
            "id": "100074896790646",
            "name": "Nguyá»…n Äá»©c LÃ¢m"
          },
          {
            "id": "100075442416851",
            "name": "Phan Phá»¥ng Hiá»‡p"
          },
          {
            "id": "100075498409541",
            "name": "Melvin Balagan"
          },
          {
            "id": "100076228431824",
            "name": "Nguyá»…n Háº±ng BÄ‘s"
          },
          {
            "id": "100076424797674",
            "name": "Äá»— NhÆ° Quá»³nh"
          },
          {
            "id": "100076589088252",
            "name": "Tháº¡ch Äiá»n An"
          },
          {
            "id": "100076848668836",
            "name": "Tráº§n Thanh TÃ i"
          },
          {
            "id": "100076915989195",
            "name": "Pháº¡m Thá»‹ Tháº¿"
          },
          {
            "id": "100076937134966",
            "name": "Ãšt LÃª"
          },
          {
            "id": "100078537897171",
            "name": "Tráº§n Kiá»u Trinh"
          },
          {
            "id": "100078714237075",
            "name": "Pháº¡m Thanh Há»¯u"
          },
          {
            "id": "100078927330919",
            "name": "HÃ  CÃ´ng Minh"
          },
          {
            "id": "100079517160224",
            "name": "Tráº§n Minh ThÆ°"
          },
          {
            "id": "100079825482206",
            "name": "TrÆ°Æ¡ng Thá»‹ NgÃ "
          },
          {
            "id": "100080216923789",
            "name": "HoÃ ng Huy Háº£i"
          },
          {
            "id": "100080877782912",
            "name": "Nguyá»…n Quang Hiáº¿n"
          },
          {
            "id": "100081124791663",
            "name": "LÃª PhÆ°Æ¡ng Nam"
          },
          {
            "id": "100081126481372",
            "name": "Phan Thá»¥c QuyÃªn"
          },
          {
            "id": "100081183973040",
            "name": "ChÃ¢u Thu YÃªn"
          },
          {
            "id": "100081577131072",
            "name": "Nguyá»…n Huyá»n Na"
          },
          {
            "id": "100081774991139",
            "name": "Huá»³nh Trung Äá»©c"
          },
          {
            "id": "100081955574668",
            "name": "Tháº£o BÃ¹ Sab"
          },
          {
            "id": "100082844631646",
            "name": "Mo Hoang"
          },
          {
            "id": "100082951224158",
            "name": "BÃ¹i Má»¹ Háº¡nh"
          },
          {
            "id": "100082966943729",
            "name": "LÃ¢m BÃ­ch Tuyá»n"
          },
          {
            "id": "100083062064527",
            "name": "Tráº§n KhÃ¡nh Háº¡"
          },
          {
            "id": "100083671045351",
            "name": "Hung Bui"
          },
          {
            "id": "100083821880689",
            "name": "LiÃªm Tháº£o"
          },
          {
            "id": "100083933202691",
            "name": "Phan Phan VÅ©"
          },
          {
            "id": "100084120432429",
            "name": "Tráº§n Quang Minh"
          },
          {
            "id": "100084163334065",
            "name": "Nguyá»…n PhÆ°Æ¡ng Nam"
          },
          {
            "id": "100084168911187",
            "name": "Nguyá»…n Phi Long"
          },
          {
            "id": "100084280748476",
            "name": "Há»“ XuÃ¢n TiÃªn"
          },
          {
            "id": "100084396496279",
            "name": "LÃª Quá»‘c ChÆ¡n"
          },
          {
            "id": "100085008549707",
            "name": "QuÃ¡ch Diá»‡u Linh"
          },
          {
            "id": "100085712091260",
            "name": "Ly Kiet"
          },
          {
            "id": "100085914378695",
            "name": "Nguyá»…n Há»“ng Háº£i"
          },
          {
            "id": "100085951737392",
            "name": "Nguyá»…n Quang ViÃªn"
          },
          {
            "id": "100086275263199",
            "name": "Äáº·ng Äá»"
          },
          {
            "id": "100086352774017",
            "name": "Nguyá»…n Báº£o Ngá»c"
          },
          {
            "id": "100087102586087",
            "name": "Nguyá»…n Kháº¯c Háº£i"
          },
          {
            "id": "100087645018791",
            "name": "LÆ°u Ly Nguyá»…n"
          },
          {
            "id": "100088065800439",
            "name": "Lclc Mai Hoang"
          },
          {
            "id": "100088319020681",
            "name": "Mer Malate"
          },
          {
            "id": "100088442995929",
            "name": "NgÃ´ VÄƒn TÃ i"
          },
          {
            "id": "100088653865647",
            "name": "Pháº¡m Thu HiÃªn"
          },
          {
            "id": "100088820324939",
            "name": "Äá»— Tá»‘ UyÃªn"
          },
          {
            "id": "100089027143175",
            "name": "Huá»³nh Tháº£o"
          },
          {
            "id": "100089049978165",
            "name": "Phan Diá»‡u Tháº£o"
          },
          {
            "id": "100089120417250",
            "name": "Äá»— Thu PhÆ°Æ¡ng"
          },
          {
            "id": "100089417413352",
            "name": "Nguyá»…n Luáº­t"
          },
          {
            "id": "100089649075119",
            "name": "Nguyá»…n Tuáº¥n Lá»™c"
          },
          {
            "id": "100089832851412",
            "name": "HÆ°Æ¡ng LÃª"
          },
          {
            "id": "100090085357128",
            "name": "Äinh VÄƒn Hiáº¿n"
          },
          {
            "id": "100090241781437",
            "name": "BÃ¹i Ngá»c TrÃ¢n"
          },
          {
            "id": "100090303896046",
            "name": "ÄÃ¬nh Há»¯u"
          },
          {
            "id": "100090614678217",
            "name": "Duy NG"
          },
          {
            "id": "100090678280373",
            "name": "Nguyá»…n Ngá»c BÃ­ch"
          },
          {
            "id": "100090779798919",
            "name": "Jonel Sabay Ilustresimo"
          },
          {
            "id": "100090913833818",
            "name": "Huá»³nh Ngá»c Háº£i"
          },
          {
            "id": "100091399080812",
            "name": "BÃ¹i Äá»©c Viá»‡t"
          },
          {
            "id": "100091552787383",
            "name": "Ngá»c Lan"
          },
          {
            "id": "100091835664338",
            "name": "Äáº·ng Ngá»c Hiá»‡u"
          },
          {
            "id": "100092372214965",
            "name": "Trung VÅ©"
          },
          {
            "id": "100092597356876",
            "name": "VÅ© Tháº£o VÃ¢n"
          },
          {
            "id": "100092965899049",
            "name": "Khantavan Vixaisak"
          },
          {
            "id": "100093194018066",
            "name": "Nguyá»…n BÃ¡ Äá»“ng"
          },
          {
            "id": "100093227391507",
            "name": "Cuki Male"
          },
          {
            "id": "100093950400415",
            "name": "HoÃ ng Nam"
          },
          {
            "id": "100094132527257",
            "name": "LÃª Thá»‹ LÆ°Æ¡ng"
          },
          {
            "id": "100094226885826",
            "name": "ThiÃªn Ã‚n Táº¡p HoÃ¡"
          },
          {
            "id": "100094749792539",
            "name": "Pháº¡m HÆ°Æ¡ng Tháº£o"
          },
          {
            "id": "100094786226589",
            "name": "LÃª TÆ°á»ng Vy"
          },
          {
            "id": "100094996895373",
            "name": "NgÃ´ Quang ToÃ n"
          },
          {
            "id": "100095185767836",
            "name": "Nguyá»…n Tuan Tuan"
          },
          {
            "id": "100095202421179",
            "name": "Lani Äá»—"
          },
          {
            "id": "100095443894318",
            "name": "Pháº¡m CÃ´ng Huy"
          }
        ],
        "comments": [
          {
            "id": "100008502215600",
            "name": "Toan Phung",
            "text": "Ib",
            "created_time_vn": "2025-12-13 01:36:31"
          },
          {
            "id": "100008502215600",
            "name": "Toan Phung",
            "text": "ChuyÃªn viÃªn quáº£n lÃ½ KD",
            "created_time_vn": "2025-12-13 01:36:54"
          },
          {
            "id": "100000391379114",
            "name": "ÄÄƒng Quang",
            "text": "Thanh Nho chÃº lÃ m hÃ nh chÃ­nh dc",
            "created_time_vn": "2025-12-15 13:35:42"
          },
          {
            "id": "100009156433293",
            "name": "Ngá»c Linh",
            "text": "ThÆ° Thá»",
            "created_time_vn": "2025-12-15 10:18:37"
          },
          {
            "id": "100000292595738",
            "name": "Linh Pháº¡m",
            "text": "Pháº¡m KhÃ¡nh Linhnh",
            "created_time_vn": "2025-12-13 20:02:47"
          },
          {
            "id": "100005379331337",
            "name": "Ha Le",
            "text": "LÆ°u LÆ°u ThÃ¹y",
            "created_time_vn": "2025-12-14 23:03:57"
          },
          {
            "id": "100021760787632",
            "name": "NÃªn Pháº¡m",
            "text": "Cáº§n tá»‘i thiá»ƒu báº±ng cáº¥p j áº¡.",
            "created_time_vn": "2025-12-18 06:15:38"
          },
          {
            "id": "100038140512546",
            "name": "Tráº§n HÃ  Huyá»n",
            "text": "á»ž Ä‘Ã¢u",
            "created_time_vn": "2025-12-11 23:14:34"
          },
          {
            "id": "100013436617586",
            "name": "Nhung Cao",
            "text": "Kim Anh Nguyen",
            "created_time_vn": "2025-12-11 21:03:07"
          },
          {
            "id": "61576606707704",
            "name": "Pháº¡m Há»¯u ToÃ n",
            "text": "Pháº¡m Thá»‹ Ngá»c Bá»™i",
            "created_time_vn": "2025-12-05 22:25:30"
          },
          {
            "id": "100036154251433",
            "name": "Pháº¡m Tiáº¿n",
            "text": "Pháº¡m TrÃ ",
            "created_time_vn": "2025-12-14 21:15:08"
          },
          {
            "id": "100090804673944",
            "name": "Pháº¿ Giáº¥y BÃ¬a",
            "text": "CÃ³ á»Ÿ hÃ  huy táº­p gia lÃ¢m hn ko b",
            "created_time_vn": "2025-12-16 22:13:58"
          },
          {
            "id": "61572424185468",
            "name": "Nguyá»…n Äá»©c Trá»ng",
            "text": "Inbox",
            "created_time_vn": "2025-12-15 04:08:16"
          },
          {
            "id": "100005916301142",
            "name": "Tai Dao",
            "text": "BÃªn mÃ¬nh cÃ³ tuyá»ƒn tham mÆ°u ko em Ä‘Äƒng kÃ½ suáº¥t",
            "created_time_vn": "2025-12-17 14:27:32"
          },
          {
            "id": "100015011417443",
            "name": "Hoa VÅ©",
            "text": "Vá»«a ra trÆ°á»ng cÃ³ tuyá»ƒn nhÃ¢n viÃªn kinh doanh khÃ´ng áº¡",
            "created_time_vn": "2025-12-08 11:31:04"
          },
          {
            "id": "100005138494838",
            "name": "Nguyá»…n Anh Tuáº¥n",
            "text": "Inbox",
            "created_time_vn": "2025-12-12 16:30:53"
          },
          {
            "id": "100006534735398",
            "name": "Äáº¥t Viá»‡t",
            "text": "CÃ³ tuyá»ƒn thá»£ cÆ¡ khÃ­ khÃ´ng áº¡",
            "created_time_vn": "2025-12-16 11:42:23"
          },
          {
            "id": "61583260407273",
            "name": "Pco Viá»‡t Nam",
            "text": "Pháº¡m HiÃªn",
            "created_time_vn": "2025-12-13 06:21:42"
          }
        ],
        "reactions_count": 564,
        "comments_count": 18,
        "reactions_count_before_filter": 564,
        "comments_count_before_filter": 18,
        "status": "success"
      },
      {
        "post_id": "4432161690347913",
        "flag": "vÃ ng",
        "text": "[HÃ  ÄÃ´ng, HN] TUYá»‚N Váº¬N HÃ€NH SÃ€N TMÄT LÆ¯Æ NG 6M - 12M !! KHÃ”NG YC KINH NGHIá»†M",
        "owning_profile": {
          "__typename": "User",
          "name": "Nguyá»…n HÃ  Thu",
          "id": "100007869585114"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "100032767399249",
            "name": "Háº±ng Nguyá»…n"
          }
        ],
        "comments": [],
        "reactions_count": 2,
        "comments_count": 0,
        "reactions_count_before_filter": 2,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "122171583440394422",
        "flag": "xanh",
        "text": "âœ¨ NHA KHOA META TUYá»‚N Dá»¤NG âœ¨ Vá»‹ trÃ­: BÃ¡c sÄ© RÄƒng Sá»© Tháº©m Má»¹ ChÃºng tÃ´i tÃ¬m kiáº¿m bÃ¡c sÄ© cÃ³ Ä‘á»‹nh hÆ°á»›ng phÃ¡t triá»ƒn lÃ¢u dÃ i trong lÄ©nh vá»±c rÄƒng sá»© tháº©m má»¹, mong muá»‘n lÃ m viá»‡c trong mÃ´i trÆ°á»ng chuáº©n chá»‰nh, tÃ´n trá»ng chuyÃªn mÃ´n vÃ  giÃ¡ trá»‹ cÃ¡ nhÃ¢n. ðŸ’° Thu nháº­p: Thá»a thuáº­n theo nÄƒng lá»±c (LÆ°Æ¡ng cá»©ng + KPI + ThÆ°á»Ÿng + Phá»¥ cáº¥p) ðŸ”¹ Há»‡ thá»‘ng mÃ¡y mÃ³c hiá»‡n Ä‘áº¡i ðŸ”¹ Nguá»“n khÃ¡ch á»•n Ä‘á»‹nh ðŸ”¹ Ekip há»— trá»£ chuyÃªn mÃ´n ðŸ”¹ Quy trÃ¬nh rÃµ rÃ ng â€“ minh báº¡ch ðŸ“ Äá»‹a chá»‰: 391 TrÆ°á»ng Chinh, Thanh XuÃ¢n, HÃ  Ná»™i ðŸ“² LiÃªn há»‡ á»©ng tuyá»ƒn: 036.903.6666",
        "owning_profile": {
          "__typename": "User",
          "name": "Tuyá»ƒn Dá»¥ng NhÃ¢n Sá»± Nha Khoa HÃ  Ná»™i",
          "id": "61561832674763"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61555926982278",
            "name": "Viá»‡c LÃ m PhÃº Má»¹"
          },
          {
            "id": "61556361794883",
            "name": "NgÃ´ HÃ "
          },
          {
            "id": "61557564590049",
            "name": "Tráº§n Quá»‘c TÃº"
          },
          {
            "id": "61558261029036",
            "name": "Pun Meo"
          },
          {
            "id": "61561883510251",
            "name": "Channie Quinh"
          },
          {
            "id": "61563309960672",
            "name": "Äáº·ng Háº£i Long"
          },
          {
            "id": "61564917926512",
            "name": "L.A Club Bida & Coffee Chill"
          },
          {
            "id": "61565563724536",
            "name": "Nguyá»…n ChÃ¢u"
          },
          {
            "id": "61572284594958",
            "name": "Sunny Nguyá»…n"
          },
          {
            "id": "61573721417341",
            "name": "Nguyá»…n BÃ¡ Gia"
          },
          {
            "id": "61574207106597",
            "name": "Tráº§n Linhh"
          },
          {
            "id": "61576229670272",
            "name": "Linh Hoang"
          },
          {
            "id": "61577279735800",
            "name": "Quá»³nh Anh Hr"
          },
          {
            "id": "61580336013397",
            "name": "Tuyá»ƒn dá»¥ng Hoa Sen"
          },
          {
            "id": "61581536426647",
            "name": "Nguyá»…n Phá»¥ng"
          },
          {
            "id": "61582805619015",
            "name": "Tuyá»ƒn Dá»¥ng ACC GROUP"
          },
          {
            "id": "61583305625966",
            "name": "Thanh Tháº£o"
          },
          {
            "id": "61583764201891",
            "name": "TrÆ°Æ¡ng TrÆ°Æ¡ng"
          },
          {
            "id": "61584608215620",
            "name": "Tháº£o Tháº£o"
          },
          {
            "id": "100001457361807",
            "name": "BÃ¬nh Nguyá»…n"
          },
          {
            "id": "100002952513568",
            "name": "Hung Nguyen Van"
          },
          {
            "id": "100004481532439",
            "name": "TÃ¢m Nguyá»…n"
          },
          {
            "id": "100004482543910",
            "name": "ThÃ¹y DuyÃªn"
          },
          {
            "id": "100005340428521",
            "name": "ÄÃ o Kim Dung"
          },
          {
            "id": "100005469367692",
            "name": "Háº£i Tráº§n"
          },
          {
            "id": "100005516567580",
            "name": "Nguyá»…n Song Háº£i My"
          },
          {
            "id": "100005955429677",
            "name": "ÄÃ o Cáº©m TÃº"
          },
          {
            "id": "100006028202461",
            "name": "Nguyá»…n Quang ÄÄƒng"
          },
          {
            "id": "100006251405539",
            "name": "Ãi Tháº£o"
          },
          {
            "id": "100006269208618",
            "name": "Ngá»c Ji"
          },
          {
            "id": "100006289146409",
            "name": "LÃª Thá»‹ Ngá»c Tuyáº¿t"
          },
          {
            "id": "100006726301264",
            "name": "Há»¯u Vinh"
          },
          {
            "id": "100006842225833",
            "name": "Nguyá»…n CÃ´ng Tuáº¥n"
          },
          {
            "id": "100007223975129",
            "name": "HoÃ ng Ngá»c VÃ¢n"
          },
          {
            "id": "100008214033618",
            "name": "PhÆ°Æ¡ngg Thuá»³y"
          },
          {
            "id": "100008470120812",
            "name": "Hen Lai Sau"
          },
          {
            "id": "100008819281046",
            "name": "TÆ°á»ng Vi"
          },
          {
            "id": "100010908542354",
            "name": "TrÆ°Æ¡ng Yáº¿n Ngá»c"
          },
          {
            "id": "100011164030217",
            "name": "Phan Háº±ng"
          },
          {
            "id": "100011299489100",
            "name": "NhÃ£ HÃ n"
          },
          {
            "id": "100011388368250",
            "name": "Ngá» Nguyá»…n"
          },
          {
            "id": "100011467005548",
            "name": "Mai LÃª ThuÃ½ Anh"
          },
          {
            "id": "100011626330258",
            "name": "Chini Yang"
          },
          {
            "id": "100012223865593",
            "name": "BÃ¹i Phi Khanh"
          },
          {
            "id": "100012229563696",
            "name": "Huy Nguyá»…n"
          },
          {
            "id": "100013120636790",
            "name": "Nguyá»…n Háº­u"
          },
          {
            "id": "100013203721316",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100013824304893",
            "name": "VÃ¢n Trinh"
          },
          {
            "id": "100013891117509",
            "name": "Nguyá»…n Tuáº¥n Thanh TÃ¹ng"
          },
          {
            "id": "100014181169457",
            "name": "Anh Thi"
          },
          {
            "id": "100014186708092",
            "name": "Thanh PhÃ¡t"
          },
          {
            "id": "100014468773048",
            "name": "Ngoc Ngoc"
          },
          {
            "id": "100015023324224",
            "name": "Tháº£o Vy"
          },
          {
            "id": "100021958921727",
            "name": "Nguyá»…n ThÆ¡m"
          },
          {
            "id": "100022909296508",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100023342140984",
            "name": "NgÃ´ Thá»‹ Thanh Thá»§y"
          },
          {
            "id": "100025315715732",
            "name": "Dang Hai Hoang"
          },
          {
            "id": "100026564893365",
            "name": "Tráº§n Thá»‹ ChÃ¢u Giang"
          },
          {
            "id": "100029755934272",
            "name": "Nguyá»…n Yáº¿n Nhi"
          },
          {
            "id": "100034383453231",
            "name": "Thanh Mai"
          },
          {
            "id": "100035525660779",
            "name": "Tráº§n ChÆ°Æ¡ng"
          },
          {
            "id": "100038020578188",
            "name": "Pii An"
          },
          {
            "id": "100039707792352",
            "name": "HÃ  Thanh Má»¹ Tráº§n"
          },
          {
            "id": "100055043149966",
            "name": "Tiáº¿n VÃµ"
          },
          {
            "id": "100056627937098",
            "name": "Minh UyÃªn"
          },
          {
            "id": "100056634771689",
            "name": "Huá»³nh QuyÃªn"
          },
          {
            "id": "100057082697388",
            "name": "Quá»³nh Quá»³nh"
          },
          {
            "id": "100060628333297",
            "name": "Nháº¥t Long"
          },
          {
            "id": "100063156952990",
            "name": "John Cris"
          },
          {
            "id": "100068553722908",
            "name": "Ngoc Anh"
          },
          {
            "id": "100070362357401",
            "name": "Mai PhÆ°Æ¡ng"
          },
          {
            "id": "100073323880572",
            "name": "Quá»³nh NhÆ°"
          },
          {
            "id": "100078738384859",
            "name": "HoÃ ng Nam"
          },
          {
            "id": "100079433324177",
            "name": "Vu Hai Anh"
          },
          {
            "id": "100082436944869",
            "name": "VÃµ ThÃ nh Láº­p"
          },
          {
            "id": "100083490734727",
            "name": "Nguyá»…n Nhi"
          },
          {
            "id": "100086954269137",
            "name": "Ngoc Khanh"
          },
          {
            "id": "100088595622359",
            "name": "BÃºn BÃºn"
          },
          {
            "id": "100094453605425",
            "name": "Minh Thu"
          },
          {
            "id": "100095678641731",
            "name": "Thanh Tháº£o"
          }
        ],
        "comments": [],
        "reactions_count": 81,
        "comments_count": 0,
        "reactions_count_before_filter": 81,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61563280557067",
            "name": "Nguyá»…n HÃ¹ng CÆ°á»ng"
          },
          {
            "id": "61574450648872",
            "name": "ThuÃ½ HÃ "
          },
          {
            "id": "61576353419525",
            "name": "HoÃ ng Quá»‘c Viá»‡t"
          },
          {
            "id": "61582825323894",
            "name": "Ngá»c Linh - Nem NÆ°á»›ng Nha Trang "
          },
          {
            "id": "100003640788400",
            "name": "Hai Dang"
          },
          {
            "id": "100005960256358",
            "name": "VÅ© Thá»‹ BÃ­ch Lá»‡"
          },
          {
            "id": "100009222477267",
            "name": "Pháº¡m Viá»‡t Anh"
          },
          {
            "id": "100015201542172",
            "name": "Nguyá»…n Loan"
          },
          {
            "id": "100025139152808",
            "name": "Tuoi Bui"
          },
          {
            "id": "100027238878170",
            "name": "Cáº©m TÃº"
          },
          {
            "id": "100029778233874",
            "name": "Háº±ng Ni"
          },
          {
            "id": "100042693051495",
            "name": "Nguyá»…n Trang"
          },
          {
            "id": "100046940032349",
            "name": "LÆ°Æ¡ng Ãnh"
          },
          {
            "id": "100048126162429",
            "name": "Kim Phá»¥ng"
          },
          {
            "id": "100049220042731",
            "name": "BÃ¬nh DÆ°Æ¡ng LÃª"
          }
        ],
        "comments": [
          {
            "id": "100023363242962",
            "name": "Tin Tin",
            "text": "Trang LÃª cÃ³ tuyá»ƒn nhÃ¢n viÃªn báº¿p khÃ´ng áº¡",
            "created_time_vn": "2025-11-22 17:30:19"
          },
          {
            "id": "100028298443377",
            "name": "BÃ¹i Linh",
            "text": "ðŸ“£ NHÃ€ HÃ€NG UMAI OMAKASE Dá»¤NG â€“ PHá»¤C Vá»¤ Ná»®\n\nâœ¨ Vá»‹ trÃ­: NhÃ¢n viÃªn phá»¥c vá»¥ ná»¯\nâ° Thá»i gian: Fulltime 10h -14h, 17h - 22h\n\nYÃªu cáº§u:\n â€¢ Ngoáº¡i hÃ¬nh Æ°a nhÃ¬n, nhanh nháº¹n\n â€¢ SiÃªng nÄƒng, chá»‹u khÃ³, há»— trá»£ Ä‘á»“ng Ä‘á»™i tá»‘t\n â€¢ KhÃ´ng cáº§n kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o)\n\nQuyá»n lá»£i:\n â€¢ LÆ°Æ¡ng 8tr ( 28 cÃ´ng ) + thÆ°á»Ÿng theo nÄƒng lá»±c\n â€¢ MÃ´i trÆ°á»ng lÃ m viá»‡c chuyÃªn nghiá»‡p, thÃ¢n thiá»‡n\n â€¢ Tip má»—i ngÃ y\n\nðŸ“ Äá»ŠA ÄIá»‚M LÃ€M VIá»†C: NhÃ  hÃ ng UMAI OMAKASE 11 Máº¡c ThÃ¡i TÃ´ng, Cáº§u Giáº¥y, HÃ  Ná»™i\nðŸ“ž LIÃŠN Há»† á»¨NG TUYá»‚N: Mr Linh SÄ‘t: 0949213939",
            "created_time_vn": "2025-12-06 17:02:45"
          },
          {
            "id": "100013761460826",
            "name": "HÆ°Æ¡ng Ly",
            "text": "ðŸ“¢NHÃ€ HÃ€NG ONGI JIAJANG â€“ QUÃN Má»² TÆ¯Æ NG ÄEN HÃ€N QUá»C TUYá»‚N Dá»¤NG Gáº¤P\nðŸ“ Äá»‹a chá»‰ lÃ m viá»‡c: 230 Nguyá»…n VÄƒn Tuyáº¿t, Äá»‘ng Äa, HÃ  Ná»™i \nðŸ“Giá» lÃ m: 10h-13h30 vÃ  16h30-22h\nHiá»‡n táº¡i nhÃ  hÃ ng Ä‘ang cáº§n bá»• sung nhÃ¢n sá»± cho cÃ¡c vá»‹ trÃ­ sau:\n1ï¸âƒ£ Quáº£n lÃ½\n2ï¸âƒ£ Phá»¥ báº¿p (BAO Ä‚N á»ž)\n3ï¸âƒ£ NhÃ¢n viÃªn phá»¥c vá»¥ (Part-time/Full-time) (BAO Ä‚N CA)\nðŸ“± á»©ng tuyá»ƒn Zl: 0877 213 681 (HÆ°Æ¡ng Ly)",
            "created_time_vn": "2025-11-20 09:49:55"
          },
          {
            "id": "100020526768178",
            "name": "Cáº©m TÃº",
            "text": "TUYá»‚N Dá»¤NG Táº I NHÃ€ HÃ€NG BBQ ONG MAP Q2âœ¨\nSá»‘ lÆ°á»£ng tuyá»ƒn dá»¥ng:\nðŸ¤µðŸ» Vá»‹ trÃ­ nhÃ¢n viÃªn phá»¥c vá»¥ full time vÃ  part time\nâ­ KhÃ´ng yÃªu cáº§u kinh nghiá»‡m, sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o \nâ­ Æ¯u tiÃªn nhá»¯ng báº¡n cÃ³ thá»ƒ giao tiáº¿p tiáº¿ng hÃ n, nhanh nháº¹n, chÄƒm chá»‰, tÃ­nh cÃ¡ch vui váº», hoÃ  Ä‘á»“ng\n\n* Full time\nâ­ LÆ°Æ¡ng: 9.000.000 - 14.000.000 \nâ­ï¸ Thá»i gian lÃ m viá»‡c: 12h -10h vÃ  15h - 1h \nâ­ Bonus tá»« 2.000.000/ thÃ¡ng\n\n* Part time\nâ­ LÆ°Æ¡ng 33k/h - 36k/h + bonus cao\nâ­ï¸ Thá»i gian lÃ m viá»‡c: 11h - 15h, 18h- 23h vÃ  18h - 1h \n\nðŸ  Äá»ŠA ÄIá»‚M LÃ€M VIá»†C:\n45 Song HÃ nh, An PhÃº, Q2\nBBQ Ã”NG Máº¬P Quáº­n 2\n38 Tráº§n Ngá»c Diá»‡n, Tháº£o Äiá»n, Q2\nBBQ Ã”ng Máº­p Tháº£o Äiá»n ëš±ë³´ì§‘ íƒ€ì˜¤ë””ì—”\n\nðŸ’¬LiÃªn há»‡: 0909886320- ThÆ°",
            "created_time_vn": "2025-12-01 13:54:32"
          },
          {
            "id": "100082569921800",
            "name": "Minh Huyá»n",
            "text": "Trung tÃ¢m Anh ngá»¯ EFIS English (ChÃ¹a LÃ¡ng) hiá»‡n Ä‘ang tuyá»ƒn:\nâ€¢ Giáº£ng viÃªn Tiáº¿ng Anh giao tiáº¿p\nâ€¢ ChuyÃªn viÃªn TÆ° váº¥n\nâ€¢ Marketing SEO\nâ€¢ Event â€“ Social\n\nBáº¡n nÃ o quan tÃ¢m comment hoáº·c inbox mÃ¬nh gá»­i JD chi tiáº¿t nhÃ© ðŸŒ±",
            "created_time_vn": "2025-12-22 09:05:44"
          }
        ],
        "reactions_count": 16,
        "comments_count": 5,
        "reactions_count_before_filter": 16,
        "comments_count_before_filter": 7,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 10,
  "total_reactions": 1326,
  "total_comments": 46
}
--- END FILE: backend\data\results\all_results_20251222_220621.json ---

--- START FILE: backend\data\results\all_results_20251222_230001.json ---
{
    "total_files": 1,
    "results_by_file": {
      "b77da63d-af55-43c2-ab7f-364250b20e30.json": [
        {
          "post_id": "24955032474094131",
          "flag": "vÃ ng",
          "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
          "owning_profile": {
            "__typename": "User",
            "name": "Gia Minh",
            "id": "61568481862081"
          },
          "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
          "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
          "reactions": [
            {
              "id": "100044138143352",
              "name": "meme"
            },
            {
              "id": "61555926982278",
              "name": "hehe"
            },
            {
              "id": "61556361794883",
              "name": "NgÃ´ HÃ "
            },
            {
              "id": "61557564590049",
              "name": "Tráº§n Quá»‘c TÃº"
            },
            {
              "id": "61558261029036",
              "name": "Pun Meo"
            },
            {
              "id": "61561883510251",
              "name": "Channie Quinh"
            },
            {
              "id": "61563309960672",
              "name": "Äáº·ng Háº£i Long"
            },
            {
              "id": "61564917926512",
              "name": "L.A Club Bida & Coffee Chill"
            },
            {
              "id": "61565563724536",
              "name": "Nguyá»…n ChÃ¢u"
            },
            {
              "id": "61572284594958",
              "name": "Sunny Nguyá»…n"
            },
            {
              "id": "61573721417341",
              "name": "Nguyá»…n BÃ¡ Gia"
            },
            {
              "id": "61574207106597",
              "name": "Tráº§n Linhh"
            },
            {
              "id": "61576229670272",
              "name": "Linh Hoang"
            },
            {
              "id": "61577279735800",
              "name": "Quá»³nh Anh Hr"
            },
            {
              "id": "61580336013397",
              "name": "Tuyá»ƒn dá»¥ng Hoa Sen"
            },
            {
              "id": "61581536426647",
              "name": "Nguyá»…n Phá»¥ng"
            },
            {
              "id": "61582805619015",
              "name": "Tuyá»ƒn Dá»¥ng ACC GROUP"
            },
            {
              "id": "61583305625966",
              "name": "Thanh Tháº£o"
            },
            {
              "id": "61583764201891",
              "name": "TrÆ°Æ¡ng TrÆ°Æ¡ng"
            },
            {
              "id": "61584608215620",
              "name": "Tháº£o Tháº£o"
            },
            {
              "id": "100001457361807",
              "name": "BÃ¬nh Nguyá»…n"
            },
            {
              "id": "100002952513568",
              "name": "Hung Nguyen Van"
            },
            {
              "id": "100004481532439",
              "name": "TÃ¢m Nguyá»…n"
            },
            {
              "id": "100004482543910",
              "name": "ThÃ¹y DuyÃªn"
            },
            {
              "id": "100005340428521",
              "name": "ÄÃ o Kim Dung"
            },
            {
              "id": "100005469367692",
              "name": "Háº£i Tráº§n"
            },
            {
              "id": "100005516567580",
              "name": "Nguyá»…n Song Háº£i My"
            },
            {
              "id": "100005955429677",
              "name": "ÄÃ o Cáº©m TÃº"
            },
            {
              "id": "100006028202461",
              "name": "Nguyá»…n Quang ÄÄƒng"
            },
            {
              "id": "100006251405539",
              "name": "Ãi Tháº£o"
            },
            {
              "id": "100006269208618",
              "name": "Ngá»c Ji"
            },
            {
              "id": "100006289146409",
              "name": "LÃª Thá»‹ Ngá»c Tuyáº¿t"
            },
            {
              "id": "100006726301264",
              "name": "Há»¯u Vinh"
            },
            {
              "id": "100006842225833",
              "name": "Nguyá»…n CÃ´ng Tuáº¥n"
            },
            {
              "id": "100007223975129",
              "name": "HoÃ ng Ngá»c VÃ¢n"
            },
            {
              "id": "100008214033618",
              "name": "PhÆ°Æ¡ngg Thuá»³y"
            },
            {
              "id": "100008470120812",
              "name": "Hen Lai Sau"
            },
            {
              "id": "100008819281046",
              "name": "TÆ°á»ng Vi"
            },
            {
              "id": "100010908542354",
              "name": "TrÆ°Æ¡ng Yáº¿n Ngá»c"
            },
            {
              "id": "100011164030217",
              "name": "Phan Háº±ng"
            },
            {
              "id": "100011299489100",
              "name": "NhÃ£ HÃ n"
            },
            {
              "id": "100011388368250",
              "name": "Ngá» Nguyá»…n"
            },
            {
              "id": "100011467005548",
              "name": "Mai LÃª ThuÃ½ Anh"
            },
            {
              "id": "100011626330258",
              "name": "Chini Yang"
            },
            {
              "id": "100012223865593",
              "name": "BÃ¹i Phi Khanh"
            },
            {
              "id": "100012229563696",
              "name": "Huy Nguyá»…n"
            },
            {
              "id": "100013120636790",
              "name": "Nguyá»…n Háº­u"
            },
            {
              "id": "100013203721316",
              "name": "Thu HoÃ i"
            },
            {
              "id": "100013824304893",
              "name": "VÃ¢n Trinh"
            },
            {
              "id": "100013891117509",
              "name": "Nguyá»…n Tuáº¥n Thanh TÃ¹ng"
            },
            {
              "id": "100014181169457",
              "name": "Anh Thi"
            },
            {
              "id": "100014186708092",
              "name": "Thanh PhÃ¡t"
            },
            {
              "id": "100014468773048",
              "name": "Ngoc Ngoc"
            },
            {
              "id": "100015023324224",
              "name": "Tháº£o Vy"
            },
            {
              "id": "100021958921727",
              "name": "Nguyá»…n ThÆ¡m"
            },
            {
              "id": "100022909296508",
              "name": "Thu HoÃ i"
            },
            {
              "id": "100023342140984",
              "name": "NgÃ´ Thá»‹ Thanh Thá»§y"
            },
            {
              "id": "100025315715732",
              "name": "Dang Hai Hoang"
            },
            {
              "id": "100026564893365",
              "name": "Tráº§n Thá»‹ ChÃ¢u Giang"
            },
            {
              "id": "100029755934272",
              "name": "Nguyá»…n Yáº¿n Nhi"
            },
            {
              "id": "100034383453231",
              "name": "Thanh Mai"
            },
            {
              "id": "100035525660779",
              "name": "Tráº§n ChÆ°Æ¡ng"
            },
            {
              "id": "100038020578188",
              "name": "Pii An"
            },
            {
              "id": "100039707792352",
              "name": "HÃ  Thanh Má»¹ Tráº§n"
            },
            {
              "id": "100055043149966",
              "name": "Tiáº¿n VÃµ"
            },
            {
              "id": "100056627937098",
              "name": "Minh UyÃªn"
            },
            {
              "id": "100056634771689",
              "name": "Huá»³nh QuyÃªn"
            },
            {
              "id": "100057082697388",
              "name": "Quá»³nh Quá»³nh"
            },
            {
              "id": "100060628333297",
              "name": "Nháº¥t Long"
            },
            {
              "id": "100063156952990",
              "name": "John Cris"
            },
            {
              "id": "100068553722908",
              "name": "Ngoc Anh"
            },
            {
              "id": "100070362357401",
              "name": "Mai PhÆ°Æ¡ng"
            },
            {
              "id": "100073323880572",
              "name": "Quá»³nh NhÆ°"
            },
            {
              "id": "100078738384859",
              "name": "HoÃ ng Nam"
            },
            {
              "id": "100079433324177",
              "name": "Vu Hai Anh"
            },
            {
              "id": "100082436944869",
              "name": "VÃµ ThÃ nh Láº­p"
            },
            {
              "id": "100083490734727",
              "name": "Nguyá»…n Nhi"
            },
            {
              "id": "100086954269137",
              "name": "Ngoc Khanh"
            },
            {
              "id": "100088595622359",
              "name": "BÃºn BÃºn"
            },
            {
              "id": "100094453605425",
              "name": "Minh Thu"
            },
            {
              "id": "100095678641731",
              "name": "Thanh Tháº£o"
            }
          ],
          "comments": [],
          "reactions_count": 81,
          "comments_count": 0,
          "reactions_count_before_filter": 81,
          "comments_count_before_filter": 0,
          "status": "success"
        },
        {
          "post_id": "2198533247305479",
          "flag": "vÃ ng",
          "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
          "owning_profile": {
            "__typename": "User",
            "name": "Trang LÃª",
            "id": "100006577548369"
          },
          "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
          "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
          "reactions": [
            {
              "id": "100044138143352",
              "name": "KhÃ¡nh PhÆ°Æ¡ng"
            },
            {
              "id": "61563280557067",
              "name": "Nguyá»…n HÃ¹ng CÆ°á»ng"
            },
            {
              "id": "61574450648872",
              "name": "ThuÃ½ HÃ "
            },
            {
              "id": "61576353419525",
              "name": "HoÃ ng Quá»‘c Viá»‡t"
            },
            {
              "id": "61582825323894",
              "name": "Ngá»c Linh - Nem NÆ°á»›ng Nha Trang "
            },
            {
              "id": "100003640788400",
              "name": "Hai Dang"
            },
            {
              "id": "100005960256358",
              "name": "VÅ© Thá»‹ BÃ­ch Lá»‡"
            },
            {
              "id": "100009222477267",
              "name": "Pháº¡m Viá»‡t Anh"
            },
            {
              "id": "100015201542172",
              "name": "Nguyá»…n Loan"
            },
            {
              "id": "100025139152808",
              "name": "Tuoi Bui"
            },
            {
              "id": "100027238878170",
              "name": "Cáº©m TÃº"
            },
            {
              "id": "100029778233874",
              "name": "Háº±ng Ni"
            },
            {
              "id": "100042693051495",
              "name": "Nguyá»…n Trang"
            },
            {
              "id": "100046940032349",
              "name": "LÆ°Æ¡ng Ãnh"
            },
            {
              "id": "100048126162429",
              "name": "Kim Phá»¥ng"
            },
            {
              "id": "100049220042731",
              "name": "BÃ¬nh DÆ°Æ¡ng LÃª"
            }
          ],
          "comments": [
            {
              "id": "100023363242962",
              "name": "Tin Tin",
              "text": "Trang LÃª cÃ³ tuyá»ƒn nhÃ¢n viÃªn báº¿p khÃ´ng áº¡",
              "created_time_vn": "2025-11-22 17:30:19"
            },
            {
              "id": "100028298443377",
              "name": "BÃ¹i Linh",
              "text": "ðŸ“£ NHÃ€ HÃ€NG UMAI OMAKASE Dá»¤NG â€“ PHá»¤C Vá»¤ Ná»®\n\nâœ¨ Vá»‹ trÃ­: NhÃ¢n viÃªn phá»¥c vá»¥ ná»¯\nâ° Thá»i gian: Fulltime 10h -14h, 17h - 22h\n\nYÃªu cáº§u:\n â€¢ Ngoáº¡i hÃ¬nh Æ°a nhÃ¬n, nhanh nháº¹n\n â€¢ SiÃªng nÄƒng, chá»‹u khÃ³, há»— trá»£ Ä‘á»“ng Ä‘á»™i tá»‘t\n â€¢ KhÃ´ng cáº§n kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o)\n\nQuyá»n lá»£i:\n â€¢ LÆ°Æ¡ng 8tr ( 28 cÃ´ng ) + thÆ°á»Ÿng theo nÄƒng lá»±c\n â€¢ MÃ´i trÆ°á»ng lÃ m viá»‡c chuyÃªn nghiá»‡p, thÃ¢n thiá»‡n\n â€¢ Tip má»—i ngÃ y\n\nðŸ“ Äá»ŠA ÄIá»‚M LÃ€M VIá»†C: NhÃ  hÃ ng UMAI OMAKASE 11 Máº¡c ThÃ¡i TÃ´ng, Cáº§u Giáº¥y, HÃ  Ná»™i\nðŸ“ž LIÃŠN Há»† á»¨NG TUYá»‚N: Mr Linh SÄ‘t: 0949213939",
              "created_time_vn": "2025-12-06 17:02:45"
            },
            {
              "id": "100013761460826",
              "name": "HÆ°Æ¡ng Ly",
              "text": "ðŸ“¢NHÃ€ HÃ€NG ONGI JIAJANG â€“ QUÃN Má»² TÆ¯Æ NG ÄEN HÃ€N QUá»C TUYá»‚N Dá»¤NG Gáº¤P\nðŸ“ Äá»‹a chá»‰ lÃ m viá»‡c: 230 Nguyá»…n VÄƒn Tuyáº¿t, Äá»‘ng Äa, HÃ  Ná»™i \nðŸ“Giá» lÃ m: 10h-13h30 vÃ  16h30-22h\nHiá»‡n táº¡i nhÃ  hÃ ng Ä‘ang cáº§n bá»• sung nhÃ¢n sá»± cho cÃ¡c vá»‹ trÃ­ sau:\n1ï¸âƒ£ Quáº£n lÃ½\n2ï¸âƒ£ Phá»¥ báº¿p (BAO Ä‚N á»ž)\n3ï¸âƒ£ NhÃ¢n viÃªn phá»¥c vá»¥ (Part-time/Full-time) (BAO Ä‚N CA)\nðŸ“± á»©ng tuyá»ƒn Zl: 0877 213 681 (HÆ°Æ¡ng Ly)",
              "created_time_vn": "2025-11-20 09:49:55"
            },
            {
              "id": "100020526768178",
              "name": "Cáº©m TÃº",
              "text": "TUYá»‚N Dá»¤NG Táº I NHÃ€ HÃ€NG BBQ ONG MAP Q2âœ¨\nSá»‘ lÆ°á»£ng tuyá»ƒn dá»¥ng:\nðŸ¤µðŸ» Vá»‹ trÃ­ nhÃ¢n viÃªn phá»¥c vá»¥ full time vÃ  part time\nâ­ KhÃ´ng yÃªu cáº§u kinh nghiá»‡m, sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o \nâ­ Æ¯u tiÃªn nhá»¯ng báº¡n cÃ³ thá»ƒ giao tiáº¿p tiáº¿ng hÃ n, nhanh nháº¹n, chÄƒm chá»‰, tÃ­nh cÃ¡ch vui váº», hoÃ  Ä‘á»“ng\n\n* Full time\nâ­ LÆ°Æ¡ng: 9.000.000 - 14.000.000 \nâ­ï¸ Thá»i gian lÃ m viá»‡c: 12h -10h vÃ  15h - 1h \nâ­ Bonus tá»« 2.000.000/ thÃ¡ng\n\n* Part time\nâ­ LÆ°Æ¡ng 33k/h - 36k/h + bonus cao\nâ­ï¸ Thá»i gian lÃ m viá»‡c: 11h - 15h, 18h- 23h vÃ  18h - 1h \n\nðŸ  Äá»ŠA ÄIá»‚M LÃ€M VIá»†C:\n45 Song HÃ nh, An PhÃº, Q2\nBBQ Ã”NG Máº¬P Quáº­n 2\n38 Tráº§n Ngá»c Diá»‡n, Tháº£o Äiá»n, Q2\nBBQ Ã”ng Máº­p Tháº£o Äiá»n ëš±ë³´ì§‘ íƒ€ì˜¤ë””ì—”\n\nðŸ’¬LiÃªn há»‡: 0909886320- ThÆ°",
              "created_time_vn": "2025-12-01 13:54:32"
            },
            {
              "id": "100082569921800",
              "name": "Minh Huyá»n",
              "text": "Trung tÃ¢m Anh ngá»¯ EFIS English (ChÃ¹a LÃ¡ng) hiá»‡n Ä‘ang tuyá»ƒn:\nâ€¢ Giáº£ng viÃªn Tiáº¿ng Anh giao tiáº¿p\nâ€¢ ChuyÃªn viÃªn TÆ° váº¥n\nâ€¢ Marketing SEO\nâ€¢ Event â€“ Social\n\nBáº¡n nÃ o quan tÃ¢m comment hoáº·c inbox mÃ¬nh gá»­i JD chi tiáº¿t nhÃ© ðŸŒ±",
              "created_time_vn": "2025-12-22 09:05:44"
            }
          ],
          "reactions_count": 16,
          "comments_count": 5,
          "reactions_count_before_filter": 16,
          "comments_count_before_filter": 7,
          "status": "success"
        }
      ]
    },
    "total_posts_processed": 2,
    "total_reactions": 97,
    "total_comments": 5
  }0
--- END FILE: backend\data\results\all_results_20251222_230001.json ---

--- START FILE: backend\data\results\all_results_20251224_000724.json ---
{
  "total_files": 1,
  "results_by_file": {
    "b77da63d-af55-43c2-ab7f-364250b20e30.json": [
      {
        "post_id": "122152945058694563",
        "flag": "xanh",
        "text": "ðŸŽ‰ ðŸŒ¸ â€œTáº¿t Ä‘áº¿n xuÃ¢n vá» â€“ tÃ¬m viá»‡c Ä‘Ã¢u xa, Vingroup chÃ o Ä‘Ã³n â€“ má»Ÿ lá»‘i thÄƒng hoa!â€ ðŸŒ¸ ðŸŽ‰ ðŸ¢ VINGROUP â€“ TUYá»‚N Dá»¤NG KHá»I VÄ‚N PHÃ’NG TOÃ€N QUá»C ðŸ‡»ðŸ‡³ ðŸ‡»ðŸ‡³ Báº¡n Ä‘ang tÃ¬m kiáº¿m má»™t mÃ´i trÆ°á»ng á»•n Ä‘á»‹nh â€“ chuyÃªn nghiá»‡p â€“ cÃ³ lá»™ trÃ¬nh thÄƒng tiáº¿n rÃµ rÃ ng? ðŸ‡»ðŸ‡³ Vingroup â€“ Táº­p Ä‘oÃ n kinh táº¿ tÆ° nhÃ¢n hÃ ng Ä‘áº§u Viá»‡t Nam â€“ Ä‘ang má»Ÿ rá»™ng Ä‘á»™i ngÅ© vÄƒn phÃ²ng trÃªn toÃ n quá»‘c, sáºµn sÃ ng Ä‘á»“ng hÃ nh cÃ¹ng báº¡n bÆ°á»›c vÃ o nÄƒm má»›i vá»›i nhiá»u cÆ¡ há»™i phÃ¡t triá»ƒn Ä‘á»™t phÃ¡. ðŸ’¢ Vá»Š TRÃ ÄANG TUYá»‚N ðŸ”– NhÃ¢n ViÃªn Káº¿ ToÃ¡n ðŸ”– ChuyÃªn ViÃªn Quáº£n LÃ½ Kinh Doanh ðŸ”– NhÃ¢n ViÃªn TÆ° Váº¥n ChÄƒm SÃ³c KhÃ¡ch HÃ ng ðŸ”– TrÆ°á»Ÿng PhÃ²ng Xuáº¥t Nháº­p Kháº©u ðŸ”– TrÆ°á»Ÿng PhÃ²ng Tiáº¿p Thá»‹ ThÆ°Æ¡ng Máº¡i ðŸ”– TrÆ°á»Ÿng PhÃ²ng HÃ nh ChÃ­nh NhÃ¢n Sá»± ðŸ“ LÃ m viá»‡c táº¡i cÃ¡c vÄƒn phÃ²ng Ä‘áº¡i diá»‡n trÃªn toÃ n quá»‘c ðŸŽ¯ Táº I SAO Báº N NÃŠN á»¨NG TUYá»‚N NGAY? â–ªï¸ Thu nháº­p háº¥p dáº«n, thÆ°á»Ÿng Táº¿t rÃµ rÃ ng â–ªï¸ Báº£o hiá»ƒm Ä‘áº§y Ä‘á»§, phÃºc lá»£i á»•n Ä‘á»‹nh â–ªï¸ CÆ¡ há»™i phÃ¡t triá»ƒn sá»± nghiá»‡p, Ä‘Æ°á»£c Ä‘Ã o táº¡o chuyÃªn sÃ¢u â–ªï¸ MÃ´i trÆ°á»ng lÃ m viá»‡c minh báº¡ch, hiá»‡n Ä‘áº¡i, chuyÃªn nghiá»‡p ðŸ“¨ Ná»™p há»“ sÆ¡ trá»±c tuyáº¿n táº¡i: https://qrco.de/tuyendungVinGroup ðŸ‘‰ Tag ngÆ°á»i phÃ¹ há»£p hoáº·c chia sáº» ngay cÆ¡ há»™i tuyá»‡t vá»i nÃ y! ðŸŒŸ VINGROUP â€“ NÆ¡i tÃ i nÄƒng Ä‘Æ°á»£c phÃ¡t huy vÃ  thÃ nh cÃ´ng Ä‘Æ°á»£c ghi nháº­n. CÃ¹ng khá»Ÿi Ä‘á»™ng nÄƒm má»›i vá»›i bÆ°á»›c tiáº¿n vá»¯ng vÃ ng trong sá»± nghiá»‡p! #Vingroup #TuyenDungTet2025 #CoHoiNgheNghiep #ViecLamVanPhong #DonXuanVingroup",
        "owning_profile": {
          "__typename": "User",
          "name": "Tuyá»ƒn Dá»¥ng VinGroup",
          "id": "61570836905496"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "1002263592",
            "name": "Ran Kaori"
          },
          {
            "id": "1234976494",
            "name": "Ha Tran"
          },
          {
            "id": "1268544510",
            "name": "VÄƒn ÄÃ¬nh LÃ¢m"
          },
          {
            "id": "1277446090",
            "name": "Nguyá»…n VÄƒn Tuá»‡"
          },
          {
            "id": "1485344389",
            "name": "Hong Hanh"
          },
          {
            "id": "1572664685",
            "name": "Vu Ngoc Lan"
          },
          {
            "id": "1790504763",
            "name": "Huong Nguyen"
          },
          {
            "id": "1830492804",
            "name": "Martin Ngo"
          },
          {
            "id": "61550123255824",
            "name": "Jenny Tráº§n"
          },
          {
            "id": "61550963711871",
            "name": "ÄÃ o Quang Huáº¥n"
          },
          {
            "id": "61551494556150",
            "name": "Nguyá»…n Thá»‹ Duyá»‡t"
          },
          {
            "id": "61551798632228",
            "name": "Tuan Anh"
          },
          {
            "id": "61552652491139",
            "name": "VÃµ Ngá»c HuyÃªn"
          },
          {
            "id": "61552709622705",
            "name": "HoÃ ng Máº¡nh"
          },
          {
            "id": "61553747960696",
            "name": "Long Gia"
          },
          {
            "id": "61553761829719",
            "name": "Nam Hoang"
          },
          {
            "id": "61555731806498",
            "name": "Minh Äá»©c"
          },
          {
            "id": "61556120043116",
            "name": "Mai Tráº§n Minh"
          },
          {
            "id": "61556452044279",
            "name": "Anh Long"
          },
          {
            "id": "61556795983288",
            "name": "Bass House"
          },
          {
            "id": "61557071407694",
            "name": "DÆ°Æ¡ng Thuyáº¿t"
          },
          {
            "id": "61557775749884",
            "name": "Nguyá»…n Thá»‹ VÄƒn"
          },
          {
            "id": "61564149783940",
            "name": "Ngá»c HÃ "
          },
          {
            "id": "61564578580794",
            "name": "Nguyá»…n Khanh"
          },
          {
            "id": "61567168498234",
            "name": "Há»“ PhÆ°Æ¡ng"
          },
          {
            "id": "61569010118881",
            "name": "Elvis PhÆ°Æ¡ng"
          },
          {
            "id": "61569180890275",
            "name": "Nguyá»…n TrÆ°á»ng"
          },
          {
            "id": "61569272138269",
            "name": "HÃ¢n Sáº§u"
          },
          {
            "id": "61570253625383",
            "name": "Äinh Há»“ng Tuá»‡ Hr"
          },
          {
            "id": "61571187577749",
            "name": "Dung Nguyá»…n"
          },
          {
            "id": "61571406964597",
            "name": "LÃª Anh Háº£i"
          },
          {
            "id": "61571671900364",
            "name": "Nguyá»…n VÆ°Æ¡ng Nhi"
          },
          {
            "id": "61571840248551",
            "name": "Tráº§n Diá»‡p BÄ‘s"
          },
          {
            "id": "61571848330448",
            "name": "Há»“ PhÆ°Æ¡ng"
          },
          {
            "id": "61572490859745",
            "name": "To Lan Thinh"
          },
          {
            "id": "61572842294221",
            "name": "HÃ  Phan Thu"
          },
          {
            "id": "61573733657294",
            "name": "Há»“ Má»™c NhÃ¢n"
          },
          {
            "id": "61573734497403",
            "name": "Pháº¡m ThÃ nh An"
          },
          {
            "id": "61573744547227",
            "name": "Huá»³nh Thá»¥y Ca"
          },
          {
            "id": "61573852654944",
            "name": "VÄƒn Háº£i"
          },
          {
            "id": "61573988684453",
            "name": "VÅ© Thuá»³ Dung"
          },
          {
            "id": "61574010964642",
            "name": "Huá»³nh Há»“ng QuÃ¢n"
          },
          {
            "id": "61574110798886",
            "name": "Phan Nháº­t Mi"
          },
          {
            "id": "61574152886242",
            "name": "Phan Thu NhÃ¢n"
          },
          {
            "id": "61574175593832",
            "name": "NgÃ´ Thiá»‡n Diá»‡p"
          },
          {
            "id": "61574258109121",
            "name": "Kháº£i Tá»‹nh"
          },
          {
            "id": "61574867364927",
            "name": "Nguyá»…n VÄƒn Tráº¯ng"
          },
          {
            "id": "61574978456212",
            "name": "Bee Bee"
          },
          {
            "id": "61575737576229",
            "name": "TÃ´n Long"
          },
          {
            "id": "61576253253121",
            "name": "Le Giap"
          },
          {
            "id": "61576570737659",
            "name": "PhÃ¡p Thiá»‡n Yuuta"
          },
          {
            "id": "61577718142636",
            "name": "Nam HoÃ i LÃª"
          },
          {
            "id": "61577831266701",
            "name": "NhÃ  Phá»‘ TrÆ°á»ng Khang"
          },
          {
            "id": "61577891019065",
            "name": "Äá»— Thá»‹ Tá»‘ TrÃ¢n"
          },
          {
            "id": "61577913800061",
            "name": "Phan Tien Thai"
          },
          {
            "id": "61577966011957",
            "name": "LÃª Thá»‹ Yáº¿n Nhi"
          },
          {
            "id": "61577990310795",
            "name": "Nguyá»…n ThÃ nh Luyáº¿n"
          },
          {
            "id": "61578060900327",
            "name": "Há»“ Thá»‹ Cáº©m Giang"
          },
          {
            "id": "61578588352981",
            "name": "Anh Minh"
          },
          {
            "id": "61578920644052",
            "name": "Háº£i LuÃ¢n"
          },
          {
            "id": "61579609253307",
            "name": "LÆ°u Hiá»n"
          },
          {
            "id": "61579616184503",
            "name": "Dáº«n Nguyá»…n"
          },
          {
            "id": "61579778518833",
            "name": "Vu Huong"
          },
          {
            "id": "61579924336884",
            "name": "Thai Pham"
          },
          {
            "id": "61580075301277",
            "name": "Nguyá»…n Thá»‹ Kim Dung"
          },
          {
            "id": "61580091380494",
            "name": "Huá»³nh Diá»…m"
          },
          {
            "id": "61580652643855",
            "name": "LÃª Quang Nha"
          },
          {
            "id": "61581145032703",
            "name": "Chan Dang Quay"
          },
          {
            "id": "61581397461144",
            "name": "Tran Phuc Giáº·t LÃ "
          },
          {
            "id": "61581418713978",
            "name": "ChiÃªm Khang DÆ°Æ¡ng"
          },
          {
            "id": "61581689701972",
            "name": "Khá»•ng Báº£o Tuáº¥n"
          },
          {
            "id": "61582487331614",
            "name": "Nguyá»…n Khang Land"
          },
          {
            "id": "61582779520068",
            "name": "Thanh Äinh XuÃ¢n"
          },
          {
            "id": "61582832777139",
            "name": "Tran Phat Ngan"
          },
          {
            "id": "61582869747879",
            "name": "Anh Nguyen"
          },
          {
            "id": "61583102734016",
            "name": "Mai Linh Son"
          },
          {
            "id": "61583218533495",
            "name": "KhÃ¡nh ÄÃ o"
          },
          {
            "id": "61583648552185",
            "name": "Anh Dung LÃª"
          },
          {
            "id": "61584927061788",
            "name": "LÃª KhÃ¡nh"
          },
          {
            "id": "61585066443817",
            "name": "TÃ¢m Thiá»‡n"
          },
          {
            "id": "100000033162372",
            "name": "LÆ°Æ¡ng ThÃ¡i SÆ¡n"
          },
          {
            "id": "100000046953514",
            "name": "Nguyen Thuy Binh"
          },
          {
            "id": "100000074903034",
            "name": "Ngoc Long"
          },
          {
            "id": "100000100445450",
            "name": "Nguyen Xuan Hoang"
          },
          {
            "id": "100000110883929",
            "name": "Ha Thanh Chung"
          },
          {
            "id": "100000118488636",
            "name": "Anh Tuan Dang"
          },
          {
            "id": "100000146503895",
            "name": "Tuan Bui Duc"
          },
          {
            "id": "100000199586797",
            "name": "HoÃ ng Há»“ng"
          },
          {
            "id": "100000206390872",
            "name": "Ha Vo Ngoc"
          },
          {
            "id": "100000227057333",
            "name": "Le van Luu"
          },
          {
            "id": "100000233054222",
            "name": "Nguyá»…n Äá»©c CÃ´ng"
          },
          {
            "id": "100000233458095",
            "name": "Äá»©c Anh"
          },
          {
            "id": "100000241421870",
            "name": "CÆ°á»ng LÃ£ ÄÄƒng"
          },
          {
            "id": "100000285841717",
            "name": "Trinh Vinh"
          },
          {
            "id": "100000299911498",
            "name": "Thanh BÃ¬nh"
          },
          {
            "id": "100000335930188",
            "name": "Tien Dang"
          },
          {
            "id": "100000359003842",
            "name": "ÄÃ o Thá»‹ HÆ°Æ¡ng"
          },
          {
            "id": "100000372765424",
            "name": "Beverly Truong"
          },
          {
            "id": "100000391379114",
            "name": "ÄÄƒng Quang"
          },
          {
            "id": "100000440642840",
            "name": "Yuki Nguyen"
          },
          {
            "id": "100000465101424",
            "name": "Pham Lien"
          },
          {
            "id": "100000471456601",
            "name": "Bon Bon"
          },
          {
            "id": "100000536634518",
            "name": "VÅ© Van Thá»¥"
          },
          {
            "id": "100000574898744",
            "name": "LÃª Thu NÄƒm"
          },
          {
            "id": "100000627052981",
            "name": "Nguyá»…n XuÃ¢n HÃ²a"
          },
          {
            "id": "100000778527246",
            "name": "Nay QuyÃªn"
          },
          {
            "id": "100000941868141",
            "name": "Thoa Tran"
          },
          {
            "id": "100000980293146",
            "name": "KhÃ¡nh VÃ¢n"
          },
          {
            "id": "100000984300799",
            "name": "Tung Vu"
          },
          {
            "id": "100001022243294",
            "name": "Huyen Trieu"
          },
          {
            "id": "100001087908348",
            "name": "TÃ i. Cá»­a Tá»± Äá»™ng"
          },
          {
            "id": "100001120775721",
            "name": "LÃª Thá»‹ Minh PhÆ°á»£ng"
          },
          {
            "id": "100001342910831",
            "name": "La Hoa"
          },
          {
            "id": "100001443078158",
            "name": "Bim Lim Dim"
          },
          {
            "id": "100001508086380",
            "name": "Tháº¿ KhÆ°Æ¡ng Nguyá»…n"
          },
          {
            "id": "100001575392906",
            "name": "Huyá»n Anh Nguyá»…n"
          },
          {
            "id": "100001760897883",
            "name": "My Hieu Dao"
          },
          {
            "id": "100001812241811",
            "name": "VÅ© Thu Trang"
          },
          {
            "id": "100001911838667",
            "name": "PhÃºc Pi"
          },
          {
            "id": "100002236262875",
            "name": "DÆ°Æ¡ng TrÃ­ Thá»©c"
          },
          {
            "id": "100002239523184",
            "name": "Nguyá»…n NgÃ¢n ChÃ¢u"
          },
          {
            "id": "100002284338356",
            "name": "Phuong Vu Mai"
          },
          {
            "id": "100002380444871",
            "name": "Tráº§n TÃ¢n"
          },
          {
            "id": "100002395931625",
            "name": "Lyly Dang"
          },
          {
            "id": "100002422973147",
            "name": "Nguyá»…n ThÃ nh ÄÃ´"
          },
          {
            "id": "100002448663492",
            "name": "BÃ¹i Tuyáº¿t"
          },
          {
            "id": "100002618172780",
            "name": "Tráº§n DÅ©ng"
          },
          {
            "id": "100002654683809",
            "name": "Nguyá»…n Dung"
          },
          {
            "id": "100002768697384",
            "name": "Van Linh Nguyen"
          },
          {
            "id": "100002828608496",
            "name": "Tháº¯ng LÃª ÄÄƒng"
          },
          {
            "id": "100002894088361",
            "name": "HoÃ ng Phi HÃ¹ng"
          },
          {
            "id": "100002918321046",
            "name": "Thuá»³ Äá»—"
          },
          {
            "id": "100002946674698",
            "name": "HÃ²e Nguyá»…n VÄƒn"
          },
          {
            "id": "100002978226577",
            "name": "Le Quang Tung"
          },
          {
            "id": "100002990355280",
            "name": "Thangmatlon Cutngay"
          },
          {
            "id": "100003112959701",
            "name": "VÄƒn SÆ¡n"
          },
          {
            "id": "100003137892869",
            "name": "Phihung Hoang"
          },
          {
            "id": "100003143419391",
            "name": "Tiáº¿n DÅ©ng"
          },
          {
            "id": "100003187192760",
            "name": "Hoang Anh Ha"
          },
          {
            "id": "100003208886321",
            "name": "Nguyá»…n Huyá»n Trang"
          },
          {
            "id": "100003212128126",
            "name": "Pháº¡m VÄ©nh"
          },
          {
            "id": "100003219365046",
            "name": "HoÃ i LÃª Thá»‹"
          },
          {
            "id": "100003256625248",
            "name": "Quang Ngoc Nguyen"
          },
          {
            "id": "100003263785363",
            "name": "Thu Tráº§n"
          },
          {
            "id": "100003268721828",
            "name": "Quang TÃ¹ng"
          },
          {
            "id": "100003294388608",
            "name": "LÃª TÃ i"
          },
          {
            "id": "100003296659152",
            "name": "PhÆ°Æ¡ng Nhung"
          },
          {
            "id": "100003349716645",
            "name": "Nguyá»…n Äá»©c NvÄ‘"
          },
          {
            "id": "100003385221252",
            "name": "CÃ¢y Phong Ba"
          },
          {
            "id": "100003484607808",
            "name": "Thanh ThuÃ½"
          },
          {
            "id": "100003496539524",
            "name": "Trung TrÆ°Æ¡ng VÄƒn"
          },
          {
            "id": "100003527679379",
            "name": "Nhu Tan Nguyen"
          },
          {
            "id": "100003696053635",
            "name": "Ruby Fly"
          },
          {
            "id": "100003730111726",
            "name": "Thach Hoang Van"
          },
          {
            "id": "100003769549026",
            "name": "Tráº§n Trung NhÃ¢n"
          },
          {
            "id": "100003772078549",
            "name": "Tuoi Nguyen"
          },
          {
            "id": "100003826431405",
            "name": "Blnh Mlnh"
          },
          {
            "id": "100003826836026",
            "name": "VÅ© Linh"
          },
          {
            "id": "100003840960528",
            "name": "Ãnh Nguyá»…n"
          },
          {
            "id": "100003856208943",
            "name": "Phan HÃ²a"
          },
          {
            "id": "100003869987023",
            "name": "Nguyá»…n Thá»‹ Má»¹ Nhung"
          },
          {
            "id": "100003894536935",
            "name": "Tráº§n Há»¯u ThÃ´ng"
          },
          {
            "id": "100003911883355",
            "name": "CÆ°á»ng ThÃ nh"
          },
          {
            "id": "100003932734095",
            "name": "ThÃ nh Kyo"
          },
          {
            "id": "100003946908707",
            "name": "NguyÃªn TÃº"
          },
          {
            "id": "100003951724972",
            "name": "Nguyá»…n Thá»‹ HÃ  NgÃ¢n"
          },
          {
            "id": "100003953913292",
            "name": "DÅ©ng Nguyá»…n Minh"
          },
          {
            "id": "100004016275196",
            "name": "Há»“ VÄƒn Tuáº¥n"
          },
          {
            "id": "100004087246460",
            "name": "Nguyá»…n Há»¯u Äáº¡t"
          },
          {
            "id": "100004135123453",
            "name": "Mung Nguyen Thi"
          },
          {
            "id": "100004138992607",
            "name": "Hong Hai Vu"
          },
          {
            "id": "100004144351309",
            "name": "LÃª Trung Hiáº¿u"
          },
          {
            "id": "100004149012038",
            "name": "Huáº¿ Äáº·ng"
          },
          {
            "id": "100004174891392",
            "name": "Táº¥n TÃ i"
          },
          {
            "id": "100004256954453",
            "name": "Quá»³nh NhÆ°"
          },
          {
            "id": "100004273023294",
            "name": "Äá»— ThÃ¹y Linh"
          },
          {
            "id": "100004300397713",
            "name": "Thanh Ngo"
          },
          {
            "id": "100004304313985",
            "name": "Há»“ng PhÃºc"
          },
          {
            "id": "100004306290359",
            "name": "Hiá»n HoÃ ng"
          },
          {
            "id": "100004316522352",
            "name": "Thuá»· Pro"
          },
          {
            "id": "100004342441972",
            "name": "VÄƒn Trung"
          },
          {
            "id": "100004348142950",
            "name": "Trá»‹nh Thá»‹ Linh"
          },
          {
            "id": "100004355646949",
            "name": "VÃµ HoÃ ng Bá»­u"
          },
          {
            "id": "100004428257202",
            "name": "Äá»— Quang Dá»±"
          },
          {
            "id": "100004429086279",
            "name": "Tráº§n ThÃ¡i Äáº¡o"
          },
          {
            "id": "100004437578563",
            "name": "Sen Nháº³ng"
          },
          {
            "id": "100004463476051",
            "name": "Ngoc Anh Tran"
          },
          {
            "id": "100004560970878",
            "name": "HÃªnh Pháº¡m"
          },
          {
            "id": "100004569734453",
            "name": "Lona Cat"
          },
          {
            "id": "100004616855082",
            "name": "Triá»‡u Hiá»ƒn"
          },
          {
            "id": "100004622803079",
            "name": "Thao Ha"
          },
          {
            "id": "100004654544241",
            "name": "Nguyá»…n Thá»‹ Háº¡nh"
          },
          {
            "id": "100004746369209",
            "name": "VÄƒn Toáº£n"
          },
          {
            "id": "100004828269961",
            "name": "TrÆ°á»Ÿng Tráº§n ÄÃ¬nh"
          },
          {
            "id": "100004835741451",
            "name": "Duc Tran"
          },
          {
            "id": "100004841040407",
            "name": "Trung Thuc Hoang"
          },
          {
            "id": "100004854581771",
            "name": "Viá»‡t Nguyá»…n"
          },
          {
            "id": "100004907562634",
            "name": "VÅ© KhÃ¡nh Vy"
          },
          {
            "id": "100004933301352",
            "name": "HoÃ ng Dung"
          },
          {
            "id": "100004942956305",
            "name": "ThÃºy HoÃ ng"
          },
          {
            "id": "100005016818649",
            "name": "VÅ© Quang Hiáº¿n"
          },
          {
            "id": "100005033012757",
            "name": "Tráº§n VÃ¢n"
          },
          {
            "id": "100005060382165",
            "name": "LÃª VÄƒn Nam"
          },
          {
            "id": "100005143232807",
            "name": "Lien Nguyen"
          },
          {
            "id": "100005158926907",
            "name": "Nguyá»…n VÅ©"
          },
          {
            "id": "100005180706859",
            "name": "Thanh Binh Tran"
          },
          {
            "id": "100005198500756",
            "name": "Äiá»ƒm Nguyá»…n"
          },
          {
            "id": "100005199186637",
            "name": "Tráº§n NhÃ¢n"
          },
          {
            "id": "100005293903253",
            "name": "Viet Son"
          },
          {
            "id": "100005316904446",
            "name": "Äáº¡t Vinh ChÃ¢u"
          },
          {
            "id": "100005328273224",
            "name": "BÃ¡ch Zim"
          },
          {
            "id": "100005355072949",
            "name": "Quá»‘c Biá»ƒu"
          },
          {
            "id": "100005443655127",
            "name": "Ty Nguyen"
          },
          {
            "id": "100005476835538",
            "name": "PhÃ¹ng NghÄ©a"
          },
          {
            "id": "100005491364399",
            "name": "Nguyá»…n Thá»‹ ThÆ°"
          },
          {
            "id": "100005734712385",
            "name": "Ãnh Ãnh"
          },
          {
            "id": "100005761982763",
            "name": "TranAnh Tran"
          },
          {
            "id": "100005785600557",
            "name": "LÃª Báº£o Linh"
          },
          {
            "id": "100005987043595",
            "name": "Háº£i Äá»—"
          },
          {
            "id": "100005989327652",
            "name": "Kiet Duong Tuan"
          },
          {
            "id": "100005998215190",
            "name": "Pham Minh Chi"
          },
          {
            "id": "100006190306738",
            "name": "Vinh Nguyá»…n"
          },
          {
            "id": "100006282243357",
            "name": "TrÆ°Æ¡ng Quang Bá»•n"
          },
          {
            "id": "100006289752741",
            "name": "Pháº¡m Thuá»³"
          },
          {
            "id": "100006347823477",
            "name": "Dung Anh"
          },
          {
            "id": "100006356471950",
            "name": "LÃª Minh VÅ©"
          },
          {
            "id": "100006436550382",
            "name": "Hoang Lan"
          },
          {
            "id": "100006455468722",
            "name": "Nguyá»…n HoÃ ng"
          },
          {
            "id": "100006477952681",
            "name": "Thanh Kha"
          },
          {
            "id": "100006492082087",
            "name": "LÃ¢m VÅ©"
          },
          {
            "id": "100006527703159",
            "name": "Dung Nguyá»…n"
          },
          {
            "id": "100006534735398",
            "name": "Äáº¥t Viá»‡t"
          },
          {
            "id": "100006535210556",
            "name": "DÆ°Æ¡ng LÃª"
          },
          {
            "id": "100006564792292",
            "name": "Nguyet Duong"
          },
          {
            "id": "100006621008888",
            "name": "ChÃºc An"
          },
          {
            "id": "100006625688182",
            "name": "HoÃ ng Dung"
          },
          {
            "id": "100006629867100",
            "name": "Mai Truc"
          },
          {
            "id": "100006650558886",
            "name": "Huá»³nh Tuáº¥n Háº£i"
          },
          {
            "id": "100006652847354",
            "name": "tháº±ng khá»"
          },
          {
            "id": "100006656734334",
            "name": "Anh Tram"
          },
          {
            "id": "100006658449464",
            "name": "Pháº¡m Táº¡o"
          },
          {
            "id": "100006670560114",
            "name": "Nguyá»…n Minh TÃ¢m"
          },
          {
            "id": "100006714038802",
            "name": "Nguyá»…n Thanh Nghá»‹"
          },
          {
            "id": "100006828812149",
            "name": "Hai Con CuÃ´ng"
          },
          {
            "id": "100006870633964",
            "name": "Cuong Ha"
          },
          {
            "id": "100006910334973",
            "name": "Tra Giang"
          },
          {
            "id": "100006924643905",
            "name": "Huynh Toan"
          },
          {
            "id": "100006954573224",
            "name": "Le Hien"
          },
          {
            "id": "100007021395010",
            "name": "PhÃº SÄ©"
          },
          {
            "id": "100007141772004",
            "name": "KhÆ°Æ¡ng Tiáº¿n Tháº£o"
          },
          {
            "id": "100007147607792",
            "name": "Huy PhÆ°Æ¡ng"
          },
          {
            "id": "100007184853225",
            "name": "Phan Quá»³nh"
          },
          {
            "id": "100007210390645",
            "name": "Tran Nhat Thang"
          },
          {
            "id": "100007343377103",
            "name": "Hang Le"
          },
          {
            "id": "100007351243660",
            "name": "HoÃ ng Trá»ng"
          },
          {
            "id": "100007393903182",
            "name": "Nguyá»…n Há»“ng Háº£i"
          },
          {
            "id": "100007460525808",
            "name": "Tráº§n Minh Äá»©c"
          },
          {
            "id": "100007508854903",
            "name": "Tuyáº¿t ThÃ¡i"
          },
          {
            "id": "100007541643743",
            "name": "Thanh NgÃ "
          },
          {
            "id": "100007542781938",
            "name": "Bui Viet Vuong"
          },
          {
            "id": "100007737932763",
            "name": "Äáº·ng XuÃ¢n Quang"
          },
          {
            "id": "100007864661236",
            "name": "NgÃ¢n Tráº§n"
          },
          {
            "id": "100007882321871",
            "name": "VÄƒn Minh"
          },
          {
            "id": "100007927390679",
            "name": "Hanh Tran"
          },
          {
            "id": "100007967923641",
            "name": "Tony Tp"
          },
          {
            "id": "100008140249491",
            "name": "PÃ© Bá»±"
          },
          {
            "id": "100008221572096",
            "name": "Huyen Thu"
          },
          {
            "id": "100008234374431",
            "name": "Nguyá»…n Thanh Nga"
          },
          {
            "id": "100008248577763",
            "name": "Háº£o Äinh"
          },
          {
            "id": "100008291257535",
            "name": "Nguyá»…n Trang Linh"
          },
          {
            "id": "100008425995708",
            "name": "An Thuy"
          },
          {
            "id": "100008451288135",
            "name": "Pháº¡m HÆ°Æ¡ng"
          },
          {
            "id": "100008521248711",
            "name": "VÄƒn Tuáº¥n"
          },
          {
            "id": "100008694605147",
            "name": "Nam LE Van"
          },
          {
            "id": "100008993380043",
            "name": "ThiÃªn Sá»© BÃ´ng Há»“ng"
          },
          {
            "id": "100009041181623",
            "name": "HoÃ ng Thá»‹ Nhung"
          },
          {
            "id": "100009076064008",
            "name": "TrÆ°Æ¡ng ThiÃªn VÄƒn"
          },
          {
            "id": "100009156128207",
            "name": "Nga Nguyá»…n"
          },
          {
            "id": "100009492122316",
            "name": "Ná»™i Tpth Vinspex"
          },
          {
            "id": "100009700398050",
            "name": "Dung Dang Hong"
          },
          {
            "id": "100009710115306",
            "name": "Cao Thi Thuy Kieu"
          },
          {
            "id": "100009710402349",
            "name": "HoÃ  Mai"
          },
          {
            "id": "100009721188717",
            "name": "Nari Nguyá»…n"
          },
          {
            "id": "100009786584855",
            "name": "LÃª BÃ¡ Chiáº¿n"
          },
          {
            "id": "100009850141283",
            "name": "Há»“ CÆ°á»ng"
          },
          {
            "id": "100010045967431",
            "name": "Giang Nguyen"
          },
          {
            "id": "100010125007281",
            "name": "Nguyá»…n CÃ´ng ChÃ­nh"
          },
          {
            "id": "100010201384092",
            "name": "BÃ¹i ToÃ n"
          },
          {
            "id": "100010275101767",
            "name": "Nguyá»…n Ngá»c Phong"
          },
          {
            "id": "100010373340923",
            "name": "BÃ¡ ChÃ¢u"
          },
          {
            "id": "100010533724426",
            "name": "Quy Phi"
          },
          {
            "id": "100010608222218",
            "name": "Tráº§n Kim NgÃ¢n"
          },
          {
            "id": "100010673776672",
            "name": "HoÃ ng Tuáº¥n"
          },
          {
            "id": "100010743184484",
            "name": "Van Trung"
          },
          {
            "id": "100010888540861",
            "name": "Du Le"
          },
          {
            "id": "100010918548956",
            "name": "Thanh HoÃ ng"
          },
          {
            "id": "100010959194633",
            "name": "Pháº¡m NgÃ¢n"
          },
          {
            "id": "100011103738351",
            "name": "LÃª HÆ°á»ng"
          },
          {
            "id": "100011229511818",
            "name": "Nguyá»…n Lan PhÆ°Æ¡ngg"
          },
          {
            "id": "100011367592771",
            "name": "Nguyá»…n Mai"
          },
          {
            "id": "100011394891822",
            "name": "Nguyá»…n Hoc"
          },
          {
            "id": "100011668994702",
            "name": "Mrken 'Tráº§n'"
          },
          {
            "id": "100011798833475",
            "name": "Thanh Huyá»n Nguyá»…n"
          },
          {
            "id": "100011866704626",
            "name": "Phan Ngoan"
          },
          {
            "id": "100011931436749",
            "name": "Phan VÄƒn"
          },
          {
            "id": "100011980453016",
            "name": "Nguyá»…n HoÃ ng Minh"
          },
          {
            "id": "100012075423028",
            "name": "Nguyá»…n Minh"
          },
          {
            "id": "100012373298685",
            "name": "Nguyá»…n Há»¯u Thá»‹nh"
          },
          {
            "id": "100012594226421",
            "name": "HoÃ i BÃ¹i"
          },
          {
            "id": "100012713474153",
            "name": "Suá»‘i ÄÃ¡"
          },
          {
            "id": "100012773562115",
            "name": "Lá»c NÆ°á»›c TÃ¢y Ninh"
          },
          {
            "id": "100013065763040",
            "name": "Luong Tran"
          },
          {
            "id": "100013220139095",
            "name": "CÃ¡i GÃ¬ Cháº³ng CÃ³"
          },
          {
            "id": "100013263695559",
            "name": "Äá»©c Pháº¡m"
          },
          {
            "id": "100013358612819",
            "name": "Vansao Tran"
          },
          {
            "id": "100013379434358",
            "name": "Hoang Monaco"
          },
          {
            "id": "100013476914535",
            "name": "LÆ°u Äá»©c Duy"
          },
          {
            "id": "100013549770221",
            "name": "DÆ°Æ¡ng TÆ°á»ng Duy"
          },
          {
            "id": "100013618568123",
            "name": "Phan ÄÃ¬nh Äáº¡t"
          },
          {
            "id": "100013769500273",
            "name": "Tráº§n Äá»©c TÃ¬nh"
          },
          {
            "id": "100014470716662",
            "name": "HoÃ ng Anh BTonio Lecturer"
          },
          {
            "id": "100014518449736",
            "name": "Hanh Chu"
          },
          {
            "id": "100014736707023",
            "name": "Tuan Anh Nguyá»…n"
          },
          {
            "id": "100014744434065",
            "name": "Tráº§n TÃ¢m"
          },
          {
            "id": "100015297154167",
            "name": "Bao Hoa Nguyen"
          },
          {
            "id": "100015327542257",
            "name": "Nguyá»…n Dung"
          },
          {
            "id": "100015541562943",
            "name": "Tráº§n Hoa"
          },
          {
            "id": "100015766291522",
            "name": "ÄÃ o Gia Founder"
          },
          {
            "id": "100016384751535",
            "name": "Tráº§n PhÃº"
          },
          {
            "id": "100016569391198",
            "name": "Tooichi Kuroba"
          },
          {
            "id": "100016784174705",
            "name": "Ngá»c ToÃ n"
          },
          {
            "id": "100016807449887",
            "name": "TÃº BÃ¹i"
          },
          {
            "id": "100016858773368",
            "name": "DÆ°Æ¡ng Toáº£n Linh"
          },
          {
            "id": "100016927471613",
            "name": "ThiÃªn VÃ¢n"
          },
          {
            "id": "100017007180195",
            "name": "Xoan Tit Xoan"
          },
          {
            "id": "100017616608808",
            "name": "Nguyá»…n VÃ¢n Thá»‹nh"
          },
          {
            "id": "100017645802520",
            "name": "TrÆ°Æ¡ng TrÃ­ Äá»©c"
          },
          {
            "id": "100020736142752",
            "name": "Nguyá»…n Huy GiÃ¡p"
          },
          {
            "id": "100021702982261",
            "name": "Phan Thá»‹ Máº­n"
          },
          {
            "id": "100021719721075",
            "name": "LÃª Há»¯u HÃ "
          },
          {
            "id": "100022269277688",
            "name": "Trung CuChi"
          },
          {
            "id": "100022647950578",
            "name": "LÃª Duy Thá»"
          },
          {
            "id": "100022848772578",
            "name": "Nguyá»…n BiÃªn"
          },
          {
            "id": "100023066776436",
            "name": "Ken Ken"
          },
          {
            "id": "100023472497923",
            "name": "ÄÃ´ng MÃ¹a"
          },
          {
            "id": "100023906706671",
            "name": "Kim Dung"
          },
          {
            "id": "100024414377599",
            "name": "Hoahong Hoahong"
          },
          {
            "id": "100024616364535",
            "name": "Äinh Quang DÅ©ng"
          },
          {
            "id": "100024715094699",
            "name": "HoÃ ng Thá»‹ NgÃ n"
          },
          {
            "id": "100024755232860",
            "name": "VÄƒn ChÃ­nh"
          },
          {
            "id": "100025032575504",
            "name": "Äáº·ng VÄƒn TÃ­nh"
          },
          {
            "id": "100025033702562",
            "name": "Äá»— Diá»‡p Khanh"
          },
          {
            "id": "100025148075519",
            "name": "PhÃ¡t TrÆ°Æ¡ng"
          },
          {
            "id": "100025417395973",
            "name": "Nhung Dao"
          },
          {
            "id": "100025495093138",
            "name": "CÃ´ Äá»™c VÆ°Æ¡ng"
          },
          {
            "id": "100025667291297",
            "name": "Lyla Larry Nguyen"
          },
          {
            "id": "100026182246416",
            "name": "Pham Minh"
          },
          {
            "id": "100026300572404",
            "name": "Lan Anh Nail"
          },
          {
            "id": "100026896832330",
            "name": "Minh Quang Vu"
          },
          {
            "id": "100027140260785",
            "name": "Nguyá»…n Tháº¿ Sinh"
          },
          {
            "id": "100027447045890",
            "name": "Nguyen Háº±ng"
          },
          {
            "id": "100027773987109",
            "name": "Quan Thuáº§n"
          },
          {
            "id": "100027882458875",
            "name": "TrÆ°Æ¡ng Thanh NgÃ¢n"
          },
          {
            "id": "100027892488162",
            "name": "Há»“ Má»¹ Trang"
          },
          {
            "id": "100028057694355",
            "name": "Nguyá»…n Tháº¿ Ngá»c"
          },
          {
            "id": "100028183980483",
            "name": "Hoa Nguyen"
          },
          {
            "id": "100028499742249",
            "name": "ÄÃ o ÄÃ¬nh Luyá»‡n"
          },
          {
            "id": "100028687274030",
            "name": "Tráº§n ÄÃ¬nh VÅ©"
          },
          {
            "id": "100028696751646",
            "name": "Nga Kim VÅ© HR"
          },
          {
            "id": "100028882415709",
            "name": "Thá»§y Nguyá»…n"
          },
          {
            "id": "100029299301680",
            "name": "Vi Hoa"
          },
          {
            "id": "100029670409014",
            "name": "Huyá»n Äáº·ng"
          },
          {
            "id": "100029798453334",
            "name": "Ngá»¥y Huyá»n TrÃ¢m"
          },
          {
            "id": "100029967125807",
            "name": "LÃª HoÃ ng"
          },
          {
            "id": "100030104508772",
            "name": "Báº£o LÃ¢m"
          },
          {
            "id": "100030473134367",
            "name": "HÃ  LÃª"
          },
          {
            "id": "100030509079299",
            "name": "Tráº§n VÄƒn HÃ¹ng"
          },
          {
            "id": "100030578503940",
            "name": "Há»¯u ThÃ nh"
          },
          {
            "id": "100030659791332",
            "name": "LÆ°Æ¡ng VÄƒn TÃ¢y"
          },
          {
            "id": "100030833381157",
            "name": "Thoc Luu"
          },
          {
            "id": "100030909782658",
            "name": "VÆ°Æ¡ng XuÃ¢n Trung"
          },
          {
            "id": "100031257766967",
            "name": "Nguyá»…n Zin"
          },
          {
            "id": "100031949331540",
            "name": "Ma Tháº£o"
          },
          {
            "id": "100033158917500",
            "name": "Nhi Thá»‹"
          },
          {
            "id": "100033583038301",
            "name": "Lien Le"
          },
          {
            "id": "100034551607051",
            "name": "Kiá»u Ngá»c"
          },
          {
            "id": "100034573387118",
            "name": "Nguyá»…n Táº¥n Tháº¡nh"
          },
          {
            "id": "100035312289300",
            "name": "Pháº¡m Báº£o Vinh"
          },
          {
            "id": "100035413536551",
            "name": "Nguyá»…n Toáº£n"
          },
          {
            "id": "100035471355865",
            "name": "Pháº¡m HoÃ n Ã‚n"
          },
          {
            "id": "100035824970612",
            "name": "LÃ½ Táº§m Hoan"
          },
          {
            "id": "100035891000395",
            "name": "Nguyá»…n Kiá»u Má»µ"
          },
          {
            "id": "100036436549617",
            "name": "Äinh Thá»‹ Tuyáº¿t Mai"
          },
          {
            "id": "100037302003281",
            "name": "Äá»— Lá»¥a"
          },
          {
            "id": "100037465741341",
            "name": "Hiá»ƒu RÃ¢u"
          },
          {
            "id": "100039006110871",
            "name": "Trang TrÃ²n"
          },
          {
            "id": "100039107282206",
            "name": "Nguyá»…n Minh Phá»¥ng"
          },
          {
            "id": "100039234011717",
            "name": "ÄÃ  Chu"
          },
          {
            "id": "100039431713970",
            "name": "Äinh VÄƒn Tuáº¥n"
          },
          {
            "id": "100039791821927",
            "name": "Cuong Vu"
          },
          {
            "id": "100040344554026",
            "name": "Nguyá»…n Há»¯u ToÃ n"
          },
          {
            "id": "100040714280187",
            "name": "Khanh An Cam"
          },
          {
            "id": "100040854852044",
            "name": "Kien Nguyen"
          },
          {
            "id": "100041005845935",
            "name": "ÄoÃ n Minh Hiáº¿u"
          },
          {
            "id": "100041138773693",
            "name": "Mai Vinh"
          },
          {
            "id": "100041331110092",
            "name": "Kháº¯c Ngá»c"
          },
          {
            "id": "100041331771277",
            "name": "Há»“ PhÆ°á»›c An"
          },
          {
            "id": "100041741836664",
            "name": "Giang Má»· DuyÃªn"
          },
          {
            "id": "100042365281852",
            "name": "Trang LÃª"
          },
          {
            "id": "100042843185509",
            "name": "Huy HoÃ ng PhÃ¡t"
          },
          {
            "id": "100043083728060",
            "name": "Long Quyá»n Hino"
          },
          {
            "id": "100043837155888",
            "name": "Sunny Huá»³nh"
          },
          {
            "id": "100044217855177",
            "name": "Loan Nong"
          },
          {
            "id": "100044322856461",
            "name": "Lá»‡ Háº±ng"
          },
          {
            "id": "100044395205424",
            "name": "LÃ nh LÃª"
          },
          {
            "id": "100044750093304",
            "name": "Minh Kháº£i HÆ°ng"
          },
          {
            "id": "100044828802250",
            "name": "Tráº§n HoÃ i VÄƒn"
          },
          {
            "id": "100044982412216",
            "name": "Tuan Anh Phung Quoc"
          },
          {
            "id": "100045239104005",
            "name": "Pháº¡m Tuáº¥n"
          },
          {
            "id": "100045857166831",
            "name": "Gia Huy"
          },
          {
            "id": "100046073641870",
            "name": "Nguyá»…n Thá»‹ DuyÃªn"
          },
          {
            "id": "100046405936633",
            "name": "Há»“ XuÃ¢n Hiáº¿u"
          },
          {
            "id": "100046643683833",
            "name": "Hoang Anh Nguyen"
          },
          {
            "id": "100047608833937",
            "name": "Nguyá»…n Tháº£o Nhi"
          },
          {
            "id": "100047832253096",
            "name": "VÄƒn Táº¥n TÃ i"
          },
          {
            "id": "100048950482838",
            "name": "NgÃ´ Thanh ThÃ¹y"
          },
          {
            "id": "100049057852661",
            "name": "Gia Hung"
          },
          {
            "id": "100049137320683",
            "name": "Nguyá»…n Há»¯u TÃ¹ng"
          },
          {
            "id": "100049364013977",
            "name": "Triá»u Nguyá»…n"
          },
          {
            "id": "100049529929873",
            "name": "Trá»ng Nguyá»…n"
          },
          {
            "id": "100049933239314",
            "name": "Nguyá»…n Thanh PhÆ°Æ¡ng"
          },
          {
            "id": "100050313874375",
            "name": "Nguyá»…n KhÃ¡nh An"
          },
          {
            "id": "100050689431203",
            "name": "VÄƒn Ká»·"
          },
          {
            "id": "100050896924676",
            "name": "Chau Truong"
          },
          {
            "id": "100051580996504",
            "name": "VÆ°Æ¡ng HoÃ ng"
          },
          {
            "id": "100051631818167",
            "name": "à¸„à¸¸à¸“ à¸§à¸µà¸£à¸ à¸±à¸—à¸£"
          },
          {
            "id": "100052289653476",
            "name": "Há»“ Kim ThÃ nh Anh"
          },
          {
            "id": "100052330601510",
            "name": "Nguyá»…n XuÃ¢n Háº£i"
          },
          {
            "id": "100052797646738",
            "name": "NgÃ´ ÄÄƒng Sá»¹ Sá»¹"
          },
          {
            "id": "100053168822469",
            "name": "Khang HoÃ ng"
          },
          {
            "id": "100053385587217",
            "name": "Huá»³nh Má»¹ An"
          },
          {
            "id": "100053523216470",
            "name": "TrÆ°Æ¡ng Báº£o KhÃ¡nh"
          },
          {
            "id": "100053618811831",
            "name": "Nguyen Nghia"
          },
          {
            "id": "100053653425560",
            "name": "CÃ´ng Anh"
          },
          {
            "id": "100054118547462",
            "name": "LÆ°Æ¡ng VÄƒn GiÃ u"
          },
          {
            "id": "100055091536978",
            "name": "Nguyá»…n Thá»§y"
          },
          {
            "id": "100055456192661",
            "name": "Hai Nguyen"
          },
          {
            "id": "100056115540240",
            "name": "Vinh NguyÃªn"
          },
          {
            "id": "100056204585461",
            "name": "TÃ²ng Vinh Láº­p"
          },
          {
            "id": "100056219674828",
            "name": "Nguyá»…n ÄÄƒng Long"
          },
          {
            "id": "100056893673138",
            "name": "Pháº¡m HÆ°Æ¡ng"
          },
          {
            "id": "100056971001603",
            "name": "Äá»— Ngá»c BÃ­ch"
          },
          {
            "id": "100057218484529",
            "name": "An Dong"
          },
          {
            "id": "100057282332889",
            "name": "Äáº·ng Long"
          },
          {
            "id": "100057294213677",
            "name": "Báº¯c ChiÃªm Ks"
          },
          {
            "id": "100058695786943",
            "name": "TrÆ°Æ¡ng Ngá»c CÆ°á»ng"
          },
          {
            "id": "100059470687155",
            "name": "KiLa Kids"
          },
          {
            "id": "100061966165039",
            "name": "XuÃ¢n BÃ¹i"
          },
          {
            "id": "100063582972054",
            "name": "Nguyá»…n HÆ°Æ¡ng"
          },
          {
            "id": "100065484991136",
            "name": "Há»¯u TÄ©nh"
          },
          {
            "id": "100065755574601",
            "name": "LÃª Quang VÄƒn"
          },
          {
            "id": "100065910370542",
            "name": "Aiy Kham Ma Ny"
          },
          {
            "id": "100066564653556",
            "name": "Sen Pham"
          },
          {
            "id": "100066843591263",
            "name": "Pháº¡m Nháº­t Tiáº¿n"
          },
          {
            "id": "100067012723713",
            "name": "Pháº¡m Thanh VÃ¢n"
          },
          {
            "id": "100067050272709",
            "name": "Tráº§n ÄÃ n"
          },
          {
            "id": "100067311587908",
            "name": "Tráº§n VÄƒn TrÆ°á»ng"
          },
          {
            "id": "100067495173935",
            "name": "LÃª Ngá»c Huy"
          },
          {
            "id": "100067561286987",
            "name": "NT Bii"
          },
          {
            "id": "100067655688411",
            "name": "HoÃ ng Kim TÃ¹ng"
          },
          {
            "id": "100067783291879",
            "name": "Nguyá»…n HoÃ ng Vinh"
          },
          {
            "id": "100068319355393",
            "name": "Nguyá»…n Kháº£ Nhi"
          },
          {
            "id": "100069529777480",
            "name": "Nguyá»…n VÃµ Lá»£i"
          },
          {
            "id": "100069724183977",
            "name": "ÄÃ o Há»¯u Huá»³nh"
          },
          {
            "id": "100070643193025",
            "name": "Nguyá»…n Hoan"
          },
          {
            "id": "100070996751630",
            "name": "Thiá»u Nguyá»…n VÄƒn"
          },
          {
            "id": "100071772381887",
            "name": "Anan Anan"
          },
          {
            "id": "100071986008443",
            "name": "HoÃ ng SÆ¡n"
          },
          {
            "id": "100072577917134",
            "name": "HÃ  Moon"
          },
          {
            "id": "100072884918743",
            "name": "Äinh Ngá»c Huyá»n"
          },
          {
            "id": "100072973166250",
            "name": "LÃª Minh PhÆ°Æ¡ng"
          },
          {
            "id": "100073041764842",
            "name": "Gia An"
          },
          {
            "id": "100073288287437",
            "name": "Kim Yen"
          },
          {
            "id": "100073474667304",
            "name": "Nguyá»…n Minh Tuáº¥n"
          },
          {
            "id": "100073518842187",
            "name": "Ken Vy"
          },
          {
            "id": "100074726791534",
            "name": "Thanh Long"
          },
          {
            "id": "100074896790646",
            "name": "Nguyá»…n Äá»©c LÃ¢m"
          },
          {
            "id": "100075442416851",
            "name": "Phan Phá»¥ng Hiá»‡p"
          },
          {
            "id": "100075498409541",
            "name": "Melvin Balagan"
          },
          {
            "id": "100076228431824",
            "name": "Nguyá»…n Háº±ng BÄ‘s"
          },
          {
            "id": "100076424797674",
            "name": "Äá»— NhÆ° Quá»³nh"
          },
          {
            "id": "100076589088252",
            "name": "Tháº¡ch Äiá»n An"
          },
          {
            "id": "100076848668836",
            "name": "Tráº§n Thanh TÃ i"
          },
          {
            "id": "100076915989195",
            "name": "Pháº¡m Thá»‹ Tháº¿"
          },
          {
            "id": "100076937134966",
            "name": "Ãšt LÃª"
          },
          {
            "id": "100078537897171",
            "name": "Tráº§n Kiá»u Trinh"
          },
          {
            "id": "100078714237075",
            "name": "Pháº¡m Thanh Há»¯u"
          },
          {
            "id": "100078927330919",
            "name": "HÃ  CÃ´ng Minh"
          },
          {
            "id": "100079517160224",
            "name": "Tráº§n Minh ThÆ°"
          },
          {
            "id": "100079825482206",
            "name": "TrÆ°Æ¡ng Thá»‹ NgÃ "
          },
          {
            "id": "100080216923789",
            "name": "HoÃ ng Huy Háº£i"
          },
          {
            "id": "100080877782912",
            "name": "Nguyá»…n Quang Hiáº¿n"
          },
          {
            "id": "100081124791663",
            "name": "LÃª PhÆ°Æ¡ng Nam"
          },
          {
            "id": "100081126481372",
            "name": "Phan Thá»¥c QuyÃªn"
          },
          {
            "id": "100081183973040",
            "name": "ChÃ¢u Thu YÃªn"
          },
          {
            "id": "100081577131072",
            "name": "Nguyá»…n Huyá»n Na"
          },
          {
            "id": "100081774991139",
            "name": "Huá»³nh Trung Äá»©c"
          },
          {
            "id": "100081955574668",
            "name": "Tháº£o BÃ¹ Sab"
          },
          {
            "id": "100082844631646",
            "name": "Mo Hoang"
          },
          {
            "id": "100082951224158",
            "name": "BÃ¹i Má»¹ Háº¡nh"
          },
          {
            "id": "100082966943729",
            "name": "LÃ¢m BÃ­ch Tuyá»n"
          },
          {
            "id": "100083062064527",
            "name": "Tráº§n KhÃ¡nh Háº¡"
          },
          {
            "id": "100083671045351",
            "name": "Hung Bui"
          },
          {
            "id": "100083821880689",
            "name": "LiÃªm Tháº£o"
          },
          {
            "id": "100083933202691",
            "name": "Phan Phan VÅ©"
          },
          {
            "id": "100084120432429",
            "name": "Tráº§n Quang Minh"
          },
          {
            "id": "100084163334065",
            "name": "Nguyá»…n PhÆ°Æ¡ng Nam"
          },
          {
            "id": "100084168911187",
            "name": "Nguyá»…n Phi Long"
          },
          {
            "id": "100084280748476",
            "name": "Há»“ XuÃ¢n TiÃªn"
          },
          {
            "id": "100084396496279",
            "name": "LÃª Quá»‘c ChÆ¡n"
          },
          {
            "id": "100085008549707",
            "name": "QuÃ¡ch Diá»‡u Linh"
          },
          {
            "id": "100085712091260",
            "name": "Ly Kiet"
          },
          {
            "id": "100085914378695",
            "name": "Nguyá»…n Há»“ng Háº£i"
          },
          {
            "id": "100085951737392",
            "name": "Nguyá»…n Quang ViÃªn"
          },
          {
            "id": "100086275263199",
            "name": "Äáº·ng Äá»"
          },
          {
            "id": "100086352774017",
            "name": "Nguyá»…n Báº£o Ngá»c"
          },
          {
            "id": "100087102586087",
            "name": "Nguyá»…n Kháº¯c Háº£i"
          },
          {
            "id": "100087645018791",
            "name": "LÆ°u Ly Nguyá»…n"
          },
          {
            "id": "100088065800439",
            "name": "Lclc Mai Hoang"
          },
          {
            "id": "100088319020681",
            "name": "Mer Malate"
          },
          {
            "id": "100088442995929",
            "name": "NgÃ´ VÄƒn TÃ i"
          },
          {
            "id": "100088653865647",
            "name": "Pháº¡m Thu HiÃªn"
          },
          {
            "id": "100088820324939",
            "name": "Äá»— Tá»‘ UyÃªn"
          },
          {
            "id": "100089027143175",
            "name": "Huá»³nh Tháº£o"
          },
          {
            "id": "100089049978165",
            "name": "Phan Diá»‡u Tháº£o"
          },
          {
            "id": "100089120417250",
            "name": "Äá»— Thu PhÆ°Æ¡ng"
          },
          {
            "id": "100089417413352",
            "name": "Nguyá»…n Luáº­t"
          },
          {
            "id": "100089649075119",
            "name": "Nguyá»…n Tuáº¥n Lá»™c"
          },
          {
            "id": "100089832851412",
            "name": "HÆ°Æ¡ng LÃª"
          },
          {
            "id": "100090085357128",
            "name": "Äinh VÄƒn Hiáº¿n"
          },
          {
            "id": "100090241781437",
            "name": "BÃ¹i Ngá»c TrÃ¢n"
          },
          {
            "id": "100090303896046",
            "name": "ÄÃ¬nh Há»¯u"
          },
          {
            "id": "100090614678217",
            "name": "Duy NG"
          },
          {
            "id": "100090678280373",
            "name": "Nguyá»…n Ngá»c BÃ­ch"
          },
          {
            "id": "100090779798919",
            "name": "Jonel Sabay Ilustresimo"
          },
          {
            "id": "100090913833818",
            "name": "Huá»³nh Ngá»c Háº£i"
          },
          {
            "id": "100091399080812",
            "name": "BÃ¹i Äá»©c Viá»‡t"
          },
          {
            "id": "100091552787383",
            "name": "Ngá»c Lan"
          },
          {
            "id": "100091835664338",
            "name": "Äáº·ng Ngá»c Hiá»‡u"
          },
          {
            "id": "100092372214965",
            "name": "Trung VÅ©"
          },
          {
            "id": "100092597356876",
            "name": "VÅ© Tháº£o VÃ¢n"
          },
          {
            "id": "100092965899049",
            "name": "Khantavan Vixaisak"
          },
          {
            "id": "100093194018066",
            "name": "Nguyá»…n BÃ¡ Äá»“ng"
          },
          {
            "id": "100093227391507",
            "name": "Cuki Male"
          },
          {
            "id": "100093950400415",
            "name": "HoÃ ng Nam"
          },
          {
            "id": "100094132527257",
            "name": "LÃª Thá»‹ LÆ°Æ¡ng"
          },
          {
            "id": "100094226885826",
            "name": "ThiÃªn Ã‚n Táº¡p HoÃ¡"
          },
          {
            "id": "100094749792539",
            "name": "Pháº¡m HÆ°Æ¡ng Tháº£o"
          },
          {
            "id": "100094786226589",
            "name": "LÃª TÆ°á»ng Vy"
          },
          {
            "id": "100094996895373",
            "name": "NgÃ´ Quang ToÃ n"
          },
          {
            "id": "100095185767836",
            "name": "Nguyá»…n Tuan Tuan"
          },
          {
            "id": "100095202421179",
            "name": "Lani Äá»—"
          }
        ],
        "comments": [
          {
            "id": "100008502215600",
            "name": "Toan Phung",
            "text": "Ib",
            "created_time_vn": "2025-12-13 01:36:31"
          },
          {
            "id": "100008502215600",
            "name": "Toan Phung",
            "text": "ChuyÃªn viÃªn quáº£n lÃ½ KD",
            "created_time_vn": "2025-12-13 01:36:54"
          },
          {
            "id": "100000391379114",
            "name": "ÄÄƒng Quang",
            "text": "Thanh Nho chÃº lÃ m hÃ nh chÃ­nh dc",
            "created_time_vn": "2025-12-15 13:35:42"
          },
          {
            "id": "100009156433293",
            "name": "Ngá»c Linh",
            "text": "ThÆ° Thá»",
            "created_time_vn": "2025-12-15 10:18:37"
          },
          {
            "id": "100000292595738",
            "name": "Linh Pháº¡m",
            "text": "Pháº¡m KhÃ¡nh Linhnh",
            "created_time_vn": "2025-12-13 20:02:47"
          },
          {
            "id": "100005379331337",
            "name": "Ha Le",
            "text": "LÆ°u LÆ°u ThÃ¹y",
            "created_time_vn": "2025-12-14 23:03:57"
          },
          {
            "id": "100021760787632",
            "name": "NÃªn Pháº¡m",
            "text": "Cáº§n tá»‘i thiá»ƒu báº±ng cáº¥p j áº¡.",
            "created_time_vn": "2025-12-18 06:15:38"
          },
          {
            "id": "100038140512546",
            "name": "Tráº§n HÃ  Huyá»n",
            "text": "á»ž Ä‘Ã¢u",
            "created_time_vn": "2025-12-11 23:14:34"
          },
          {
            "id": "100013436617586",
            "name": "Nhung Cao",
            "text": "Kim Anh Nguyen",
            "created_time_vn": "2025-12-11 21:03:07"
          },
          {
            "id": "61576606707704",
            "name": "Pháº¡m Há»¯u ToÃ n",
            "text": "Pháº¡m Thá»‹ Ngá»c Bá»™i",
            "created_time_vn": "2025-12-05 22:25:30"
          },
          {
            "id": "100036154251433",
            "name": "Pháº¡m Tiáº¿n",
            "text": "Pháº¡m TrÃ ",
            "created_time_vn": "2025-12-14 21:15:08"
          },
          {
            "id": "100090804673944",
            "name": "Pháº¿ Giáº¥y BÃ¬a",
            "text": "CÃ³ á»Ÿ hÃ  huy táº­p gia lÃ¢m hn ko b",
            "created_time_vn": "2025-12-16 22:13:58"
          },
          {
            "id": "61572424185468",
            "name": "Nguyá»…n Äá»©c Trá»ng",
            "text": "Inbox",
            "created_time_vn": "2025-12-15 04:08:16"
          },
          {
            "id": "100005916301142",
            "name": "Tai Dao",
            "text": "BÃªn mÃ¬nh cÃ³ tuyá»ƒn tham mÆ°u ko em Ä‘Äƒng kÃ½ suáº¥t",
            "created_time_vn": "2025-12-17 14:27:32"
          },
          {
            "id": "100015011417443",
            "name": "Hoa VÅ©",
            "text": "Vá»«a ra trÆ°á»ng cÃ³ tuyá»ƒn nhÃ¢n viÃªn kinh doanh khÃ´ng áº¡",
            "created_time_vn": "2025-12-08 11:31:04"
          },
          {
            "id": "100005138494838",
            "name": "Nguyá»…n Anh Tuáº¥n",
            "text": "Inbox",
            "created_time_vn": "2025-12-12 16:30:53"
          },
          {
            "id": "100006534735398",
            "name": "Äáº¥t Viá»‡t",
            "text": "CÃ³ tuyá»ƒn thá»£ cÆ¡ khÃ­ khÃ´ng áº¡",
            "created_time_vn": "2025-12-16 11:42:23"
          },
          {
            "id": "61583260407273",
            "name": "Pco Viá»‡t Nam",
            "text": "Pháº¡m HiÃªn",
            "created_time_vn": "2025-12-13 06:21:42"
          }
        ],
        "reactions_count": 563,
        "comments_count": 18,
        "reactions_count_before_filter": 563,
        "comments_count_before_filter": 18,
        "status": "success"
      },
      {
        "post_id": "4432161690347913",
        "flag": "vÃ ng",
        "text": "[HÃ  ÄÃ´ng, HN] TUYá»‚N Váº¬N HÃ€NH SÃ€N TMÄT LÆ¯Æ NG 6M - 12M !! KHÃ”NG YC KINH NGHIá»†M",
        "owning_profile": {
          "__typename": "User",
          "name": "Nguyá»…n HÃ  Thu",
          "id": "100007869585114"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "100032767399249",
            "name": "Háº±ng Nguyá»…n"
          }
        ],
        "comments": [],
        "reactions_count": 2,
        "comments_count": 0,
        "reactions_count_before_filter": 2,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "122171583440394422",
        "flag": "xanh",
        "text": "âœ¨ NHA KHOA META TUYá»‚N Dá»¤NG âœ¨ Vá»‹ trÃ­: BÃ¡c sÄ© RÄƒng Sá»© Tháº©m Má»¹ ChÃºng tÃ´i tÃ¬m kiáº¿m bÃ¡c sÄ© cÃ³ Ä‘á»‹nh hÆ°á»›ng phÃ¡t triá»ƒn lÃ¢u dÃ i trong lÄ©nh vá»±c rÄƒng sá»© tháº©m má»¹, mong muá»‘n lÃ m viá»‡c trong mÃ´i trÆ°á»ng chuáº©n chá»‰nh, tÃ´n trá»ng chuyÃªn mÃ´n vÃ  giÃ¡ trá»‹ cÃ¡ nhÃ¢n. ðŸ’° Thu nháº­p: Thá»a thuáº­n theo nÄƒng lá»±c (LÆ°Æ¡ng cá»©ng + KPI + ThÆ°á»Ÿng + Phá»¥ cáº¥p) ðŸ”¹ Há»‡ thá»‘ng mÃ¡y mÃ³c hiá»‡n Ä‘áº¡i ðŸ”¹ Nguá»“n khÃ¡ch á»•n Ä‘á»‹nh ðŸ”¹ Ekip há»— trá»£ chuyÃªn mÃ´n ðŸ”¹ Quy trÃ¬nh rÃµ rÃ ng â€“ minh báº¡ch ðŸ“ Äá»‹a chá»‰: 391 TrÆ°á»ng Chinh, Thanh XuÃ¢n, HÃ  Ná»™i ðŸ“² LiÃªn há»‡ á»©ng tuyá»ƒn: 036.903.6666",
        "owning_profile": {
          "__typename": "User",
          "name": "Tuyá»ƒn Dá»¥ng NhÃ¢n Sá»± Nha Khoa HÃ  Ná»™i",
          "id": "61561832674763"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61555926982278",
            "name": "Viá»‡c LÃ m PhÃº Má»¹"
          },
          {
            "id": "61556361794883",
            "name": "NgÃ´ HÃ "
          },
          {
            "id": "61557564590049",
            "name": "Tráº§n Quá»‘c TÃº"
          },
          {
            "id": "61558261029036",
            "name": "Pun Meo"
          },
          {
            "id": "61561883510251",
            "name": "Channie Quinh"
          },
          {
            "id": "61563309960672",
            "name": "Äáº·ng Háº£i Long"
          },
          {
            "id": "61564917926512",
            "name": "L.A Club Bida & Coffee Chill"
          },
          {
            "id": "61565563724536",
            "name": "Nguyá»…n ChÃ¢u"
          },
          {
            "id": "61572284594958",
            "name": "Sunny Nguyá»…n"
          },
          {
            "id": "61573721417341",
            "name": "Nguyá»…n BÃ¡ Gia"
          },
          {
            "id": "61574207106597",
            "name": "Tráº§n Linhh"
          },
          {
            "id": "61576229670272",
            "name": "Linh Hoang"
          },
          {
            "id": "61577279735800",
            "name": "Quá»³nh Anh Hr"
          },
          {
            "id": "61580336013397",
            "name": "Tuyá»ƒn dá»¥ng Hoa Sen"
          },
          {
            "id": "61581536426647",
            "name": "Nguyá»…n Phá»¥ng"
          },
          {
            "id": "61582805619015",
            "name": "Tuyá»ƒn Dá»¥ng ACC GROUP"
          },
          {
            "id": "61583305625966",
            "name": "Thanh Tháº£o"
          },
          {
            "id": "61583764201891",
            "name": "TrÆ°Æ¡ng TrÆ°Æ¡ng"
          },
          {
            "id": "61584608215620",
            "name": "Tháº£o Tháº£o"
          },
          {
            "id": "100001457361807",
            "name": "BÃ¬nh Nguyá»…n"
          },
          {
            "id": "100002952513568",
            "name": "Hung Nguyen Van"
          },
          {
            "id": "100004481532439",
            "name": "TÃ¢m Nguyá»…n"
          },
          {
            "id": "100004482543910",
            "name": "ThÃ¹y DuyÃªn"
          },
          {
            "id": "100005340428521",
            "name": "ÄÃ o Kim Dung"
          },
          {
            "id": "100005469367692",
            "name": "Háº£i Tráº§n"
          },
          {
            "id": "100005516567580",
            "name": "Nguyá»…n Song Háº£i My"
          },
          {
            "id": "100005955429677",
            "name": "ÄÃ o Cáº©m TÃº"
          },
          {
            "id": "100006028202461",
            "name": "Nguyá»…n Quang ÄÄƒng"
          },
          {
            "id": "100006251405539",
            "name": "Ãi Tháº£o"
          },
          {
            "id": "100006269208618",
            "name": "Ngá»c Ji"
          },
          {
            "id": "100006289146409",
            "name": "LÃª Thá»‹ Ngá»c Tuyáº¿t"
          },
          {
            "id": "100006726301264",
            "name": "Há»¯u Vinh"
          },
          {
            "id": "100006842225833",
            "name": "Nguyá»…n CÃ´ng Tuáº¥n"
          },
          {
            "id": "100007223975129",
            "name": "HoÃ ng Ngá»c VÃ¢n"
          },
          {
            "id": "100008214033618",
            "name": "PhÆ°Æ¡ngg Thuá»³y"
          },
          {
            "id": "100008470120812",
            "name": "Hen Lai Sau"
          },
          {
            "id": "100008819281046",
            "name": "TÆ°á»ng Vi"
          },
          {
            "id": "100010908542354",
            "name": "TrÆ°Æ¡ng Yáº¿n Ngá»c"
          },
          {
            "id": "100011164030217",
            "name": "Phan Háº±ng"
          },
          {
            "id": "100011299489100",
            "name": "NhÃ£ HÃ n"
          },
          {
            "id": "100011388368250",
            "name": "Ngá» Nguyá»…n"
          },
          {
            "id": "100011467005548",
            "name": "Mai LÃª ThuÃ½ Anh"
          },
          {
            "id": "100011626330258",
            "name": "Chini Yang"
          },
          {
            "id": "100012223865593",
            "name": "BÃ¹i Phi Khanh"
          },
          {
            "id": "100012229563696",
            "name": "Huy Nguyá»…n"
          },
          {
            "id": "100013120636790",
            "name": "Nguyá»…n Háº­u"
          },
          {
            "id": "100013203721316",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100013824304893",
            "name": "VÃ¢n Trinh"
          },
          {
            "id": "100013891117509",
            "name": "Nguyá»…n Tuáº¥n Thanh TÃ¹ng"
          },
          {
            "id": "100014181169457",
            "name": "Anh Thi"
          },
          {
            "id": "100014186708092",
            "name": "Thanh PhÃ¡t"
          },
          {
            "id": "100014468773048",
            "name": "Ngoc Ngoc"
          },
          {
            "id": "100015023324224",
            "name": "Tháº£o Vy"
          },
          {
            "id": "100021958921727",
            "name": "Nguyá»…n ThÆ¡m"
          },
          {
            "id": "100022909296508",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100023342140984",
            "name": "NgÃ´ Thá»‹ Thanh Thá»§y"
          },
          {
            "id": "100025315715732",
            "name": "Dang Hai Hoang"
          },
          {
            "id": "100026564893365",
            "name": "Tráº§n Thá»‹ ChÃ¢u Giang"
          },
          {
            "id": "100029755934272",
            "name": "Nguyá»…n Yáº¿n Nhi"
          },
          {
            "id": "100034383453231",
            "name": "Thanh Mai"
          },
          {
            "id": "100035525660779",
            "name": "Tráº§n ChÆ°Æ¡ng"
          },
          {
            "id": "100038020578188",
            "name": "Pii An"
          },
          {
            "id": "100039707792352",
            "name": "HÃ  Thanh Má»¹ Tráº§n"
          },
          {
            "id": "100055043149966",
            "name": "Tiáº¿n VÃµ"
          },
          {
            "id": "100056627937098",
            "name": "Minh UyÃªn"
          },
          {
            "id": "100056634771689",
            "name": "Huá»³nh QuyÃªn"
          },
          {
            "id": "100057082697388",
            "name": "Quá»³nh Quá»³nh"
          },
          {
            "id": "100060628333297",
            "name": "Nháº¥t Long"
          },
          {
            "id": "100063156952990",
            "name": "John Cris"
          },
          {
            "id": "100068553722908",
            "name": "Ngoc Anh"
          },
          {
            "id": "100070362357401",
            "name": "Mai PhÆ°Æ¡ng"
          },
          {
            "id": "100073323880572",
            "name": "Quá»³nh NhÆ°"
          },
          {
            "id": "100078738384859",
            "name": "HoÃ ng Nam"
          },
          {
            "id": "100079433324177",
            "name": "Vu Hai Anh"
          },
          {
            "id": "100082436944869",
            "name": "VÃµ ThÃ nh Láº­p"
          },
          {
            "id": "100083490734727",
            "name": "Nguyá»…n Nhi"
          },
          {
            "id": "100086954269137",
            "name": "Ngoc Khanh"
          },
          {
            "id": "100088595622359",
            "name": "BÃºn BÃºn"
          },
          {
            "id": "100094453605425",
            "name": "Minh Thu"
          },
          {
            "id": "100095678641731",
            "name": "Thanh Tháº£o"
          }
        ],
        "comments": [],
        "reactions_count": 81,
        "comments_count": 0,
        "reactions_count_before_filter": 81,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61563280557067",
            "name": "Nguyá»…n HÃ¹ng CÆ°á»ng"
          },
          {
            "id": "61574450648872",
            "name": "ThuÃ½ HÃ "
          },
          {
            "id": "61576353419525",
            "name": "HoÃ ng Quá»‘c Viá»‡t"
          },
          {
            "id": "61582825323894",
            "name": "Ngá»c Linh - Nem NÆ°á»›ng Nha Trang "
          },
          {
            "id": "100003640788400",
            "name": "Hai Dang"
          },
          {
            "id": "100005960256358",
            "name": "VÅ© Thá»‹ BÃ­ch Lá»‡"
          },
          {
            "id": "100009222477267",
            "name": "Pháº¡m Viá»‡t Anh"
          },
          {
            "id": "100015201542172",
            "name": "Nguyá»…n Loan"
          },
          {
            "id": "100025139152808",
            "name": "Tuoi Bui"
          },
          {
            "id": "100027238878170",
            "name": "Cáº©m TÃº"
          },
          {
            "id": "100029778233874",
            "name": "Háº±ng Ni"
          },
          {
            "id": "100042693051495",
            "name": "Nguyá»…n Trang"
          },
          {
            "id": "100046940032349",
            "name": "LÆ°Æ¡ng Ãnh"
          },
          {
            "id": "100048126162429",
            "name": "Kim Phá»¥ng"
          },
          {
            "id": "100049220042731",
            "name": "BÃ¬nh DÆ°Æ¡ng LÃª"
          }
        ],
        "comments": [
          {
            "id": "100023363242962",
            "name": "Tin Tin",
            "text": "Trang LÃª cÃ³ tuyá»ƒn nhÃ¢n viÃªn báº¿p khÃ´ng áº¡",
            "created_time_vn": "2025-11-22 17:30:19"
          },
          {
            "id": "100028298443377",
            "name": "BÃ¹i Linh",
            "text": "ðŸ“£ NHÃ€ HÃ€NG UMAI OMAKASE Dá»¤NG â€“ PHá»¤C Vá»¤ Ná»®\n\nâœ¨ Vá»‹ trÃ­: NhÃ¢n viÃªn phá»¥c vá»¥ ná»¯\nâ° Thá»i gian: Fulltime 10h -14h, 17h - 22h\n\nYÃªu cáº§u:\n â€¢ Ngoáº¡i hÃ¬nh Æ°a nhÃ¬n, nhanh nháº¹n\n â€¢ SiÃªng nÄƒng, chá»‹u khÃ³, há»— trá»£ Ä‘á»“ng Ä‘á»™i tá»‘t\n â€¢ KhÃ´ng cáº§n kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o)\n\nQuyá»n lá»£i:\n â€¢ LÆ°Æ¡ng 8tr ( 28 cÃ´ng ) + thÆ°á»Ÿng theo nÄƒng lá»±c\n â€¢ MÃ´i trÆ°á»ng lÃ m viá»‡c chuyÃªn nghiá»‡p, thÃ¢n thiá»‡n\n â€¢ Tip má»—i ngÃ y\n\nðŸ“ Äá»ŠA ÄIá»‚M LÃ€M VIá»†C: NhÃ  hÃ ng UMAI OMAKASE 11 Máº¡c ThÃ¡i TÃ´ng, Cáº§u Giáº¥y, HÃ  Ná»™i\nðŸ“ž LIÃŠN Há»† á»¨NG TUYá»‚N: Mr Linh SÄ‘t: 0949213939",
            "created_time_vn": "2025-12-06 17:02:45"
          },
          {
            "id": "100013761460826",
            "name": "HÆ°Æ¡ng Ly",
            "text": "ðŸ“¢NHÃ€ HÃ€NG ONGI JIAJANG â€“ QUÃN Má»² TÆ¯Æ NG ÄEN HÃ€N QUá»C TUYá»‚N Dá»¤NG Gáº¤P\nðŸ“ Äá»‹a chá»‰ lÃ m viá»‡c: 230 Nguyá»…n VÄƒn Tuyáº¿t, Äá»‘ng Äa, HÃ  Ná»™i \nðŸ“Giá» lÃ m: 10h-13h30 vÃ  16h30-22h\nHiá»‡n táº¡i nhÃ  hÃ ng Ä‘ang cáº§n bá»• sung nhÃ¢n sá»± cho cÃ¡c vá»‹ trÃ­ sau:\n1ï¸âƒ£ Quáº£n lÃ½\n2ï¸âƒ£ Phá»¥ báº¿p (BAO Ä‚N á»ž)\n3ï¸âƒ£ NhÃ¢n viÃªn phá»¥c vá»¥ (Part-time/Full-time) (BAO Ä‚N CA)\nðŸ“± á»©ng tuyá»ƒn Zl: 0877 213 681 (HÆ°Æ¡ng Ly)",
            "created_time_vn": "2025-11-20 09:49:55"
          },
          {
            "id": "100020526768178",
            "name": "Cáº©m TÃº",
            "text": "TUYá»‚N Dá»¤NG Táº I NHÃ€ HÃ€NG BBQ ONG MAP Q2âœ¨\nSá»‘ lÆ°á»£ng tuyá»ƒn dá»¥ng:\nðŸ¤µðŸ» Vá»‹ trÃ­ nhÃ¢n viÃªn phá»¥c vá»¥ full time vÃ  part time\nâ­ KhÃ´ng yÃªu cáº§u kinh nghiá»‡m, sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o \nâ­ Æ¯u tiÃªn nhá»¯ng báº¡n cÃ³ thá»ƒ giao tiáº¿p tiáº¿ng hÃ n, nhanh nháº¹n, chÄƒm chá»‰, tÃ­nh cÃ¡ch vui váº», hoÃ  Ä‘á»“ng\n\n* Full time\nâ­ LÆ°Æ¡ng: 9.000.000 - 14.000.000 \nâ­ï¸ Thá»i gian lÃ m viá»‡c: 12h -10h vÃ  15h - 1h \nâ­ Bonus tá»« 2.000.000/ thÃ¡ng\n\n* Part time\nâ­ LÆ°Æ¡ng 33k/h - 36k/h + bonus cao\nâ­ï¸ Thá»i gian lÃ m viá»‡c: 11h - 15h, 18h- 23h vÃ  18h - 1h \n\nðŸ  Äá»ŠA ÄIá»‚M LÃ€M VIá»†C:\n45 Song HÃ nh, An PhÃº, Q2\nBBQ Ã”NG Máº¬P Quáº­n 2\n38 Tráº§n Ngá»c Diá»‡n, Tháº£o Äiá»n, Q2\nBBQ Ã”ng Máº­p Tháº£o Äiá»n ëš±ë³´ì§‘ íƒ€ì˜¤ë””ì—”\n\nðŸ’¬LiÃªn há»‡: 0909886320- ThÆ°",
            "created_time_vn": "2025-12-01 13:54:32"
          },
          {
            "id": "100082569921800",
            "name": "Minh Huyá»n",
            "text": "Trung tÃ¢m Anh ngá»¯ EFIS English (ChÃ¹a LÃ¡ng) hiá»‡n Ä‘ang tuyá»ƒn:\nâ€¢ Giáº£ng viÃªn Tiáº¿ng Anh giao tiáº¿p\nâ€¢ ChuyÃªn viÃªn TÆ° váº¥n\nâ€¢ Marketing SEO\nâ€¢ Event â€“ Social\n\nBáº¡n nÃ o quan tÃ¢m comment hoáº·c inbox mÃ¬nh gá»­i JD chi tiáº¿t nhÃ© ðŸŒ±",
            "created_time_vn": "2025-12-22 09:05:44"
          }
        ],
        "reactions_count": 16,
        "comments_count": 5,
        "reactions_count_before_filter": 16,
        "comments_count_before_filter": 7,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 5,
  "total_reactions": 662,
  "total_comments": 23
}
--- END FILE: backend\data\results\all_results_20251224_000724.json ---

--- START FILE: backend\data\results\all_results_20251224_002824.json ---
{
  "total_files": 1,
  "results_by_file": {
    "b77da63d-af55-43c2-ab7f-364250b20e30.json": [
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "b77da63d-af55-43c2-ab7f-364250b20e30.json",
        "profile_id": "b77da63d-af55-43c2-ab7f-364250b20e30",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61563280557067",
            "name": "Nguyá»…n HÃ¹ng CÆ°á»ng"
          },
          {
            "id": "61574450648872",
            "name": "ThuÃ½ HÃ "
          },
          {
            "id": "61576353419525",
            "name": "HoÃ ng Quá»‘c Viá»‡t"
          },
          {
            "id": "61582825323894",
            "name": "Ngá»c Linh - Nem NÆ°á»›ng Nha Trang "
          },
          {
            "id": "100003640788400",
            "name": "Hai Dang"
          },
          {
            "id": "100005960256358",
            "name": "VÅ© Thá»‹ BÃ­ch Lá»‡"
          },
          {
            "id": "100009222477267",
            "name": "Pháº¡m Viá»‡t Anh"
          },
          {
            "id": "100015201542172",
            "name": "Nguyá»…n Loan"
          },
          {
            "id": "100025139152808",
            "name": "Tuoi Bui"
          },
          {
            "id": "100027238878170",
            "name": "Cáº©m TÃº"
          },
          {
            "id": "100029778233874",
            "name": "Háº±ng Ni"
          },
          {
            "id": "100042693051495",
            "name": "Nguyá»…n Trang"
          },
          {
            "id": "100046940032349",
            "name": "LÆ°Æ¡ng Ãnh"
          },
          {
            "id": "100048126162429",
            "name": "Kim Phá»¥ng"
          },
          {
            "id": "100049220042731",
            "name": "BÃ¬nh DÆ°Æ¡ng LÃª"
          }
        ],
        "comments": [
          {
            "id": "100023363242962",
            "name": "Tin Tin",
            "text": "Trang LÃª cÃ³ tuyá»ƒn nhÃ¢n viÃªn báº¿p khÃ´ng áº¡",
            "created_time_vn": "2025-11-22 17:30:19"
          },
          {
            "id": "100028298443377",
            "name": "BÃ¹i Linh",
            "text": "ðŸ“£ NHÃ€ HÃ€NG UMAI OMAKASE Dá»¤NG â€“ PHá»¤C Vá»¤ Ná»®\n\nâœ¨ Vá»‹ trÃ­: NhÃ¢n viÃªn phá»¥c vá»¥ ná»¯\nâ° Thá»i gian: Fulltime 10h -14h, 17h - 22h\n\nYÃªu cáº§u:\n â€¢ Ngoáº¡i hÃ¬nh Æ°a nhÃ¬n, nhanh nháº¹n\n â€¢ SiÃªng nÄƒng, chá»‹u khÃ³, há»— trá»£ Ä‘á»“ng Ä‘á»™i tá»‘t\n â€¢ KhÃ´ng cáº§n kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o)\n\nQuyá»n lá»£i:\n â€¢ LÆ°Æ¡ng 8tr ( 28 cÃ´ng ) + thÆ°á»Ÿng theo nÄƒng lá»±c\n â€¢ MÃ´i trÆ°á»ng lÃ m viá»‡c chuyÃªn nghiá»‡p, thÃ¢n thiá»‡n\n â€¢ Tip má»—i ngÃ y\n\nðŸ“ Äá»ŠA ÄIá»‚M LÃ€M VIá»†C: NhÃ  hÃ ng UMAI OMAKASE 11 Máº¡c ThÃ¡i TÃ´ng, Cáº§u Giáº¥y, HÃ  Ná»™i\nðŸ“ž LIÃŠN Há»† á»¨NG TUYá»‚N: Mr Linh SÄ‘t: 0949213939",
            "created_time_vn": "2025-12-06 17:02:45"
          },
          {
            "id": "100013761460826",
            "name": "HÆ°Æ¡ng Ly",
            "text": "ðŸ“¢NHÃ€ HÃ€NG ONGI JIAJANG â€“ QUÃN Má»² TÆ¯Æ NG ÄEN HÃ€N QUá»C TUYá»‚N Dá»¤NG Gáº¤P\nðŸ“ Äá»‹a chá»‰ lÃ m viá»‡c: 230 Nguyá»…n VÄƒn Tuyáº¿t, Äá»‘ng Äa, HÃ  Ná»™i \nðŸ“Giá» lÃ m: 10h-13h30 vÃ  16h30-22h\nHiá»‡n táº¡i nhÃ  hÃ ng Ä‘ang cáº§n bá»• sung nhÃ¢n sá»± cho cÃ¡c vá»‹ trÃ­ sau:\n1ï¸âƒ£ Quáº£n lÃ½\n2ï¸âƒ£ Phá»¥ báº¿p (BAO Ä‚N á»ž)\n3ï¸âƒ£ NhÃ¢n viÃªn phá»¥c vá»¥ (Part-time/Full-time) (BAO Ä‚N CA)\nðŸ“± á»©ng tuyá»ƒn Zl: 0877 213 681 (HÆ°Æ¡ng Ly)",
            "created_time_vn": "2025-11-20 09:49:55"
          },
          {
            "id": "100020526768178",
            "name": "Cáº©m TÃº",
            "text": "TUYá»‚N Dá»¤NG Táº I NHÃ€ HÃ€NG BBQ ONG MAP Q2âœ¨\nSá»‘ lÆ°á»£ng tuyá»ƒn dá»¥ng:\nðŸ¤µðŸ» Vá»‹ trÃ­ nhÃ¢n viÃªn phá»¥c vá»¥ full time vÃ  part time\nâ­ KhÃ´ng yÃªu cáº§u kinh nghiá»‡m, sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o \nâ­ Æ¯u tiÃªn nhá»¯ng báº¡n cÃ³ thá»ƒ giao tiáº¿p tiáº¿ng hÃ n, nhanh nháº¹n, chÄƒm chá»‰, tÃ­nh cÃ¡ch vui váº», hoÃ  Ä‘á»“ng\n\n* Full time\nâ­ LÆ°Æ¡ng: 9.000.000 - 14.000.000 \nâ­ï¸ Thá»i gian lÃ m viá»‡c: 12h -10h vÃ  15h - 1h \nâ­ Bonus tá»« 2.000.000/ thÃ¡ng\n\n* Part time\nâ­ LÆ°Æ¡ng 33k/h - 36k/h + bonus cao\nâ­ï¸ Thá»i gian lÃ m viá»‡c: 11h - 15h, 18h- 23h vÃ  18h - 1h \n\nðŸ  Äá»ŠA ÄIá»‚M LÃ€M VIá»†C:\n45 Song HÃ nh, An PhÃº, Q2\nBBQ Ã”NG Máº¬P Quáº­n 2\n38 Tráº§n Ngá»c Diá»‡n, Tháº£o Äiá»n, Q2\nBBQ Ã”ng Máº­p Tháº£o Äiá»n ëš±ë³´ì§‘ íƒ€ì˜¤ë””ì—”\n\nðŸ’¬LiÃªn há»‡: 0909886320- ThÆ°",
            "created_time_vn": "2025-12-01 13:54:32"
          },
          {
            "id": "100082569921800",
            "name": "Minh Huyá»n",
            "text": "Trung tÃ¢m Anh ngá»¯ EFIS English (ChÃ¹a LÃ¡ng) hiá»‡n Ä‘ang tuyá»ƒn:\nâ€¢ Giáº£ng viÃªn Tiáº¿ng Anh giao tiáº¿p\nâ€¢ ChuyÃªn viÃªn TÆ° váº¥n\nâ€¢ Marketing SEO\nâ€¢ Event â€“ Social\n\nBáº¡n nÃ o quan tÃ¢m comment hoáº·c inbox mÃ¬nh gá»­i JD chi tiáº¿t nhÃ© ðŸŒ±",
            "created_time_vn": "2025-12-22 09:05:44"
          }
        ],
        "reactions_count": 16,
        "comments_count": 5,
        "reactions_count_before_filter": 16,
        "comments_count_before_filter": 7,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 1,
  "total_reactions": 16,
  "total_comments": 5
}
--- END FILE: backend\data\results\all_results_20251224_002824.json ---

--- START FILE: backend\data\results\all_results_20251224_010549.json ---
{
  "total_files": 1,
  "results_by_file": {
    "caabaa64-f2c5-4254-a83b-7f6d57632503.json": [
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61555926982278",
            "name": "Viá»‡c LÃ m PhÃº Má»¹"
          },
          {
            "id": "61556361794883",
            "name": "NgÃ´ HÃ "
          },
          {
            "id": "61557564590049",
            "name": "Tráº§n Quá»‘c TÃº"
          },
          {
            "id": "61558261029036",
            "name": "Pun Meo"
          },
          {
            "id": "61561883510251",
            "name": "Channie Quinh"
          },
          {
            "id": "61563309960672",
            "name": "Äáº·ng Háº£i Long"
          },
          {
            "id": "61564917926512",
            "name": "L.A Club Bida & Coffee Chill"
          },
          {
            "id": "61565563724536",
            "name": "Nguyá»…n ChÃ¢u"
          },
          {
            "id": "61572284594958",
            "name": "Sunny Nguyá»…n"
          },
          {
            "id": "61573721417341",
            "name": "Nguyá»…n BÃ¡ Gia"
          },
          {
            "id": "61574207106597",
            "name": "Tráº§n Linhh"
          },
          {
            "id": "61576229670272",
            "name": "Linh Hoang"
          },
          {
            "id": "61577279735800",
            "name": "Quá»³nh Anh Hr"
          },
          {
            "id": "61580336013397",
            "name": "Tuyá»ƒn dá»¥ng Hoa Sen"
          },
          {
            "id": "61581536426647",
            "name": "Nguyá»…n Phá»¥ng"
          },
          {
            "id": "61582805619015",
            "name": "Tuyá»ƒn Dá»¥ng ACC GROUP"
          },
          {
            "id": "61583305625966",
            "name": "Thanh Tháº£o"
          },
          {
            "id": "61583764201891",
            "name": "TrÆ°Æ¡ng TrÆ°Æ¡ng"
          },
          {
            "id": "61584608215620",
            "name": "Tháº£o Tháº£o"
          },
          {
            "id": "100001457361807",
            "name": "BÃ¬nh Nguyá»…n"
          },
          {
            "id": "100002952513568",
            "name": "Hung Nguyen Van"
          },
          {
            "id": "100004481532439",
            "name": "TÃ¢m Nguyá»…n"
          },
          {
            "id": "100004482543910",
            "name": "ThÃ¹y DuyÃªn"
          },
          {
            "id": "100005340428521",
            "name": "ÄÃ o Kim Dung"
          },
          {
            "id": "100005469367692",
            "name": "Háº£i Tráº§n"
          },
          {
            "id": "100005516567580",
            "name": "Nguyá»…n Song Háº£i My"
          },
          {
            "id": "100005955429677",
            "name": "ÄÃ o Cáº©m TÃº"
          },
          {
            "id": "100006028202461",
            "name": "Nguyá»…n Quang ÄÄƒng"
          },
          {
            "id": "100006251405539",
            "name": "Ãi Tháº£o"
          },
          {
            "id": "100006269208618",
            "name": "Ngá»c Ji"
          },
          {
            "id": "100006289146409",
            "name": "LÃª Thá»‹ Ngá»c Tuyáº¿t"
          },
          {
            "id": "100006726301264",
            "name": "Há»¯u Vinh"
          },
          {
            "id": "100006842225833",
            "name": "Nguyá»…n CÃ´ng Tuáº¥n"
          },
          {
            "id": "100007223975129",
            "name": "HoÃ ng Ngá»c VÃ¢n"
          },
          {
            "id": "100008214033618",
            "name": "PhÆ°Æ¡ngg Thuá»³y"
          },
          {
            "id": "100008470120812",
            "name": "Hen Lai Sau"
          },
          {
            "id": "100008819281046",
            "name": "TÆ°á»ng Vi"
          },
          {
            "id": "100010908542354",
            "name": "TrÆ°Æ¡ng Yáº¿n Ngá»c"
          },
          {
            "id": "100011164030217",
            "name": "Phan Háº±ng"
          },
          {
            "id": "100011299489100",
            "name": "NhÃ£ HÃ n"
          },
          {
            "id": "100011388368250",
            "name": "Ngá» Nguyá»…n"
          },
          {
            "id": "100011467005548",
            "name": "Mai LÃª ThuÃ½ Anh"
          },
          {
            "id": "100011626330258",
            "name": "Chini Yang"
          },
          {
            "id": "100012223865593",
            "name": "BÃ¹i Phi Khanh"
          },
          {
            "id": "100012229563696",
            "name": "Huy Nguyá»…n"
          },
          {
            "id": "100013120636790",
            "name": "Nguyá»…n Háº­u"
          },
          {
            "id": "100013203721316",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100013824304893",
            "name": "VÃ¢n Trinh"
          },
          {
            "id": "100013891117509",
            "name": "Nguyá»…n Tuáº¥n Thanh TÃ¹ng"
          },
          {
            "id": "100014181169457",
            "name": "Anh Thi"
          },
          {
            "id": "100014186708092",
            "name": "Thanh PhÃ¡t"
          },
          {
            "id": "100014468773048",
            "name": "Ngoc Ngoc"
          },
          {
            "id": "100015023324224",
            "name": "Tháº£o Vy"
          },
          {
            "id": "100021958921727",
            "name": "Nguyá»…n ThÆ¡m"
          },
          {
            "id": "100022909296508",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100023342140984",
            "name": "NgÃ´ Thá»‹ Thanh Thá»§y"
          },
          {
            "id": "100025315715732",
            "name": "Dang Hai Hoang"
          },
          {
            "id": "100026564893365",
            "name": "Tráº§n Thá»‹ ChÃ¢u Giang"
          },
          {
            "id": "100029755934272",
            "name": "Nguyá»…n Yáº¿n Nhi"
          },
          {
            "id": "100034383453231",
            "name": "Thanh Mai"
          },
          {
            "id": "100035525660779",
            "name": "Tráº§n ChÆ°Æ¡ng"
          },
          {
            "id": "100038020578188",
            "name": "Pii An"
          },
          {
            "id": "100039707792352",
            "name": "HÃ  Thanh Má»¹ Tráº§n"
          },
          {
            "id": "100055043149966",
            "name": "Tiáº¿n VÃµ"
          },
          {
            "id": "100056627937098",
            "name": "Minh UyÃªn"
          },
          {
            "id": "100056634771689",
            "name": "Huá»³nh QuyÃªn"
          },
          {
            "id": "100057082697388",
            "name": "Quá»³nh Quá»³nh"
          },
          {
            "id": "100060628333297",
            "name": "Nháº¥t Long"
          },
          {
            "id": "100063156952990",
            "name": "John Cris"
          },
          {
            "id": "100068553722908",
            "name": "Ngoc Anh"
          },
          {
            "id": "100070362357401",
            "name": "Mai PhÆ°Æ¡ng"
          },
          {
            "id": "100073323880572",
            "name": "Quá»³nh NhÆ°"
          },
          {
            "id": "100078738384859",
            "name": "HoÃ ng Nam"
          },
          {
            "id": "100079433324177",
            "name": "Vu Hai Anh"
          },
          {
            "id": "100082436944869",
            "name": "VÃµ ThÃ nh Láº­p"
          },
          {
            "id": "100083490734727",
            "name": "Nguyá»…n Nhi"
          },
          {
            "id": "100086954269137",
            "name": "Ngoc Khanh"
          },
          {
            "id": "100088595622359",
            "name": "BÃºn BÃºn"
          },
          {
            "id": "100094453605425",
            "name": "Minh Thu"
          },
          {
            "id": "100095678641731",
            "name": "Thanh Tháº£o"
          }
        ],
        "comments": [],
        "reactions_count": 81,
        "comments_count": 0,
        "reactions_count_before_filter": 81,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61563280557067",
            "name": "Nguyá»…n HÃ¹ng CÆ°á»ng"
          },
          {
            "id": "61574450648872",
            "name": "ThuÃ½ HÃ "
          },
          {
            "id": "61576353419525",
            "name": "HoÃ ng Quá»‘c Viá»‡t"
          },
          {
            "id": "61582825323894",
            "name": "Ngá»c Linh - Nem NÆ°á»›ng Nha Trang "
          },
          {
            "id": "100003640788400",
            "name": "Hai Dang"
          },
          {
            "id": "100005960256358",
            "name": "VÅ© Thá»‹ BÃ­ch Lá»‡"
          },
          {
            "id": "100009222477267",
            "name": "Pháº¡m Viá»‡t Anh"
          },
          {
            "id": "100015201542172",
            "name": "Nguyá»…n Loan"
          },
          {
            "id": "100025139152808",
            "name": "Tuoi Bui"
          },
          {
            "id": "100027238878170",
            "name": "Cáº©m TÃº"
          },
          {
            "id": "100029778233874",
            "name": "Háº±ng Ni"
          },
          {
            "id": "100042693051495",
            "name": "Nguyá»…n Trang"
          },
          {
            "id": "100046940032349",
            "name": "LÆ°Æ¡ng Ãnh"
          },
          {
            "id": "100048126162429",
            "name": "Kim Phá»¥ng"
          },
          {
            "id": "100049220042731",
            "name": "BÃ¬nh DÆ°Æ¡ng LÃª"
          }
        ],
        "comments": [
          {
            "id": "100023363242962",
            "name": "Tin Tin",
            "text": "Trang LÃª cÃ³ tuyá»ƒn nhÃ¢n viÃªn báº¿p khÃ´ng áº¡",
            "created_time_vn": "2025-11-22 17:30:19"
          },
          {
            "id": "100028298443377",
            "name": "BÃ¹i Linh",
            "text": "ðŸ“£ NHÃ€ HÃ€NG UMAI OMAKASE Dá»¤NG â€“ PHá»¤C Vá»¤ Ná»®\n\nâœ¨ Vá»‹ trÃ­: NhÃ¢n viÃªn phá»¥c vá»¥ ná»¯\nâ° Thá»i gian: Fulltime 10h -14h, 17h - 22h\n\nYÃªu cáº§u:\n â€¢ Ngoáº¡i hÃ¬nh Æ°a nhÃ¬n, nhanh nháº¹n\n â€¢ SiÃªng nÄƒng, chá»‹u khÃ³, há»— trá»£ Ä‘á»“ng Ä‘á»™i tá»‘t\n â€¢ KhÃ´ng cáº§n kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o)\n\nQuyá»n lá»£i:\n â€¢ LÆ°Æ¡ng 8tr ( 28 cÃ´ng ) + thÆ°á»Ÿng theo nÄƒng lá»±c\n â€¢ MÃ´i trÆ°á»ng lÃ m viá»‡c chuyÃªn nghiá»‡p, thÃ¢n thiá»‡n\n â€¢ Tip má»—i ngÃ y\n\nðŸ“ Äá»ŠA ÄIá»‚M LÃ€M VIá»†C: NhÃ  hÃ ng UMAI OMAKASE 11 Máº¡c ThÃ¡i TÃ´ng, Cáº§u Giáº¥y, HÃ  Ná»™i\nðŸ“ž LIÃŠN Há»† á»¨NG TUYá»‚N: Mr Linh SÄ‘t: 0949213939",
            "created_time_vn": "2025-12-06 17:02:45"
          },
          {
            "id": "100013761460826",
            "name": "HÆ°Æ¡ng Ly",
            "text": "ðŸ“¢NHÃ€ HÃ€NG ONGI JIAJANG â€“ QUÃN Má»² TÆ¯Æ NG ÄEN HÃ€N QUá»C TUYá»‚N Dá»¤NG Gáº¤P\nðŸ“ Äá»‹a chá»‰ lÃ m viá»‡c: 230 Nguyá»…n VÄƒn Tuyáº¿t, Äá»‘ng Äa, HÃ  Ná»™i \nðŸ“Giá» lÃ m: 10h-13h30 vÃ  16h30-22h\nHiá»‡n táº¡i nhÃ  hÃ ng Ä‘ang cáº§n bá»• sung nhÃ¢n sá»± cho cÃ¡c vá»‹ trÃ­ sau:\n1ï¸âƒ£ Quáº£n lÃ½\n2ï¸âƒ£ Phá»¥ báº¿p (BAO Ä‚N á»ž)\n3ï¸âƒ£ NhÃ¢n viÃªn phá»¥c vá»¥ (Part-time/Full-time) (BAO Ä‚N CA)\nðŸ“± á»©ng tuyá»ƒn Zl: 0877 213 681 (HÆ°Æ¡ng Ly)",
            "created_time_vn": "2025-11-20 09:49:55"
          },
          {
            "id": "100020526768178",
            "name": "Cáº©m TÃº",
            "text": "TUYá»‚N Dá»¤NG Táº I NHÃ€ HÃ€NG BBQ ONG MAP Q2âœ¨\nSá»‘ lÆ°á»£ng tuyá»ƒn dá»¥ng:\nðŸ¤µðŸ» Vá»‹ trÃ­ nhÃ¢n viÃªn phá»¥c vá»¥ full time vÃ  part time\nâ­ KhÃ´ng yÃªu cáº§u kinh nghiá»‡m, sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o \nâ­ Æ¯u tiÃªn nhá»¯ng báº¡n cÃ³ thá»ƒ giao tiáº¿p tiáº¿ng hÃ n, nhanh nháº¹n, chÄƒm chá»‰, tÃ­nh cÃ¡ch vui váº», hoÃ  Ä‘á»“ng\n\n* Full time\nâ­ LÆ°Æ¡ng: 9.000.000 - 14.000.000 \nâ­ï¸ Thá»i gian lÃ m viá»‡c: 12h -10h vÃ  15h - 1h \nâ­ Bonus tá»« 2.000.000/ thÃ¡ng\n\n* Part time\nâ­ LÆ°Æ¡ng 33k/h - 36k/h + bonus cao\nâ­ï¸ Thá»i gian lÃ m viá»‡c: 11h - 15h, 18h- 23h vÃ  18h - 1h \n\nðŸ  Äá»ŠA ÄIá»‚M LÃ€M VIá»†C:\n45 Song HÃ nh, An PhÃº, Q2\nBBQ Ã”NG Máº¬P Quáº­n 2\n38 Tráº§n Ngá»c Diá»‡n, Tháº£o Äiá»n, Q2\nBBQ Ã”ng Máº­p Tháº£o Äiá»n ëš±ë³´ì§‘ íƒ€ì˜¤ë””ì—”\n\nðŸ’¬LiÃªn há»‡: 0909886320- ThÆ°",
            "created_time_vn": "2025-12-01 13:54:32"
          },
          {
            "id": "100082569921800",
            "name": "Minh Huyá»n",
            "text": "Trung tÃ¢m Anh ngá»¯ EFIS English (ChÃ¹a LÃ¡ng) hiá»‡n Ä‘ang tuyá»ƒn:\nâ€¢ Giáº£ng viÃªn Tiáº¿ng Anh giao tiáº¿p\nâ€¢ ChuyÃªn viÃªn TÆ° váº¥n\nâ€¢ Marketing SEO\nâ€¢ Event â€“ Social\n\nBáº¡n nÃ o quan tÃ¢m comment hoáº·c inbox mÃ¬nh gá»­i JD chi tiáº¿t nhÃ© ðŸŒ±",
            "created_time_vn": "2025-12-22 09:05:44"
          }
        ],
        "reactions_count": 16,
        "comments_count": 5,
        "reactions_count_before_filter": 16,
        "comments_count_before_filter": 7,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 2,
  "total_reactions": 97,
  "total_comments": 5
}
--- END FILE: backend\data\results\all_results_20251224_010549.json ---

--- START FILE: backend\data\results\all_results_20251224_013325.json ---
{
  "total_files": 1,
  "results_by_file": {
    "caabaa64-f2c5-4254-a83b-7f6d57632503.json": [
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61555926982278",
            "name": "Viá»‡c LÃ m PhÃº Má»¹"
          },
          {
            "id": "61556361794883",
            "name": "NgÃ´ HÃ "
          },
          {
            "id": "61557564590049",
            "name": "Tráº§n Quá»‘c TÃº"
          },
          {
            "id": "61558261029036",
            "name": "Pun Meo"
          },
          {
            "id": "61561883510251",
            "name": "Channie Quinh"
          },
          {
            "id": "61563309960672",
            "name": "Äáº·ng Háº£i Long"
          },
          {
            "id": "61564917926512",
            "name": "L.A Club Bida & Coffee Chill"
          },
          {
            "id": "61565563724536",
            "name": "Nguyá»…n ChÃ¢u"
          },
          {
            "id": "61572284594958",
            "name": "Sunny Nguyá»…n"
          },
          {
            "id": "61573721417341",
            "name": "Nguyá»…n BÃ¡ Gia"
          },
          {
            "id": "61574207106597",
            "name": "Tráº§n Linhh"
          },
          {
            "id": "61576229670272",
            "name": "Linh Hoang"
          },
          {
            "id": "61577279735800",
            "name": "Quá»³nh Anh Hr"
          },
          {
            "id": "61580336013397",
            "name": "Tuyá»ƒn dá»¥ng Hoa Sen"
          },
          {
            "id": "61581536426647",
            "name": "Nguyá»…n Phá»¥ng"
          },
          {
            "id": "61582805619015",
            "name": "Tuyá»ƒn Dá»¥ng ACC GROUP"
          },
          {
            "id": "61583305625966",
            "name": "Thanh Tháº£o"
          },
          {
            "id": "61583764201891",
            "name": "TrÆ°Æ¡ng TrÆ°Æ¡ng"
          },
          {
            "id": "61584608215620",
            "name": "Tháº£o Tháº£o"
          },
          {
            "id": "100001457361807",
            "name": "BÃ¬nh Nguyá»…n"
          },
          {
            "id": "100002952513568",
            "name": "Hung Nguyen Van"
          },
          {
            "id": "100004481532439",
            "name": "TÃ¢m Nguyá»…n"
          },
          {
            "id": "100004482543910",
            "name": "ThÃ¹y DuyÃªn"
          },
          {
            "id": "100005340428521",
            "name": "ÄÃ o Kim Dung"
          },
          {
            "id": "100005469367692",
            "name": "Háº£i Tráº§n"
          },
          {
            "id": "100005516567580",
            "name": "Nguyá»…n Song Háº£i My"
          },
          {
            "id": "100005955429677",
            "name": "ÄÃ o Cáº©m TÃº"
          },
          {
            "id": "100006028202461",
            "name": "Nguyá»…n Quang ÄÄƒng"
          },
          {
            "id": "100006251405539",
            "name": "Ãi Tháº£o"
          },
          {
            "id": "100006269208618",
            "name": "Ngá»c Ji"
          },
          {
            "id": "100006289146409",
            "name": "LÃª Thá»‹ Ngá»c Tuyáº¿t"
          },
          {
            "id": "100006726301264",
            "name": "Há»¯u Vinh"
          },
          {
            "id": "100006842225833",
            "name": "Nguyá»…n CÃ´ng Tuáº¥n"
          },
          {
            "id": "100007223975129",
            "name": "HoÃ ng Ngá»c VÃ¢n"
          },
          {
            "id": "100008214033618",
            "name": "PhÆ°Æ¡ngg Thuá»³y"
          },
          {
            "id": "100008470120812",
            "name": "Hen Lai Sau"
          },
          {
            "id": "100008819281046",
            "name": "TÆ°á»ng Vi"
          },
          {
            "id": "100010908542354",
            "name": "TrÆ°Æ¡ng Yáº¿n Ngá»c"
          },
          {
            "id": "100011164030217",
            "name": "Phan Háº±ng"
          },
          {
            "id": "100011299489100",
            "name": "NhÃ£ HÃ n"
          },
          {
            "id": "100011388368250",
            "name": "Ngá» Nguyá»…n"
          },
          {
            "id": "100011467005548",
            "name": "Mai LÃª ThuÃ½ Anh"
          },
          {
            "id": "100011626330258",
            "name": "Chini Yang"
          },
          {
            "id": "100012223865593",
            "name": "BÃ¹i Phi Khanh"
          },
          {
            "id": "100012229563696",
            "name": "Huy Nguyá»…n"
          },
          {
            "id": "100013120636790",
            "name": "Nguyá»…n Háº­u"
          },
          {
            "id": "100013203721316",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100013824304893",
            "name": "VÃ¢n Trinh"
          },
          {
            "id": "100013891117509",
            "name": "Nguyá»…n Tuáº¥n Thanh TÃ¹ng"
          },
          {
            "id": "100014181169457",
            "name": "Anh Thi"
          },
          {
            "id": "100014186708092",
            "name": "Thanh PhÃ¡t"
          },
          {
            "id": "100014468773048",
            "name": "Ngoc Ngoc"
          },
          {
            "id": "100015023324224",
            "name": "Tháº£o Vy"
          },
          {
            "id": "100021958921727",
            "name": "Nguyá»…n ThÆ¡m"
          },
          {
            "id": "100022909296508",
            "name": "Thu HoÃ i"
          },
          {
            "id": "100023342140984",
            "name": "NgÃ´ Thá»‹ Thanh Thá»§y"
          },
          {
            "id": "100025315715732",
            "name": "Dang Hai Hoang"
          },
          {
            "id": "100026564893365",
            "name": "Tráº§n Thá»‹ ChÃ¢u Giang"
          },
          {
            "id": "100029755934272",
            "name": "Nguyá»…n Yáº¿n Nhi"
          },
          {
            "id": "100034383453231",
            "name": "Thanh Mai"
          },
          {
            "id": "100035525660779",
            "name": "Tráº§n ChÆ°Æ¡ng"
          },
          {
            "id": "100038020578188",
            "name": "Pii An"
          },
          {
            "id": "100039707792352",
            "name": "HÃ  Thanh Má»¹ Tráº§n"
          },
          {
            "id": "100055043149966",
            "name": "Tiáº¿n VÃµ"
          },
          {
            "id": "100056627937098",
            "name": "Minh UyÃªn"
          },
          {
            "id": "100056634771689",
            "name": "Huá»³nh QuyÃªn"
          },
          {
            "id": "100057082697388",
            "name": "Quá»³nh Quá»³nh"
          },
          {
            "id": "100060628333297",
            "name": "Nháº¥t Long"
          },
          {
            "id": "100063156952990",
            "name": "John Cris"
          },
          {
            "id": "100068553722908",
            "name": "Ngoc Anh"
          },
          {
            "id": "100070362357401",
            "name": "Mai PhÆ°Æ¡ng"
          },
          {
            "id": "100073323880572",
            "name": "Quá»³nh NhÆ°"
          },
          {
            "id": "100078738384859",
            "name": "HoÃ ng Nam"
          },
          {
            "id": "100079433324177",
            "name": "Vu Hai Anh"
          },
          {
            "id": "100082436944869",
            "name": "VÃµ ThÃ nh Láº­p"
          },
          {
            "id": "100083490734727",
            "name": "Nguyá»…n Nhi"
          },
          {
            "id": "100086954269137",
            "name": "Ngoc Khanh"
          },
          {
            "id": "100088595622359",
            "name": "BÃºn BÃºn"
          },
          {
            "id": "100094453605425",
            "name": "Minh Thu"
          },
          {
            "id": "100095678641731",
            "name": "Thanh Tháº£o"
          }
        ],
        "comments": [],
        "reactions_count": 81,
        "comments_count": 0,
        "reactions_count_before_filter": 81,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [
          {
            "id": "100044138143352",
            "name": "KhÃ¡nh PhÆ°Æ¡ng"
          },
          {
            "id": "61563280557067",
            "name": "Nguyá»…n HÃ¹ng CÆ°á»ng"
          },
          {
            "id": "61574450648872",
            "name": "ThuÃ½ HÃ "
          },
          {
            "id": "61576353419525",
            "name": "HoÃ ng Quá»‘c Viá»‡t"
          },
          {
            "id": "61582825323894",
            "name": "Ngá»c Linh - Nem NÆ°á»›ng Nha Trang "
          },
          {
            "id": "100003640788400",
            "name": "Hai Dang"
          },
          {
            "id": "100005960256358",
            "name": "VÅ© Thá»‹ BÃ­ch Lá»‡"
          },
          {
            "id": "100009222477267",
            "name": "Pháº¡m Viá»‡t Anh"
          },
          {
            "id": "100015201542172",
            "name": "Nguyá»…n Loan"
          },
          {
            "id": "100025139152808",
            "name": "Tuoi Bui"
          },
          {
            "id": "100027238878170",
            "name": "Cáº©m TÃº"
          },
          {
            "id": "100029778233874",
            "name": "Háº±ng Ni"
          },
          {
            "id": "100042693051495",
            "name": "Nguyá»…n Trang"
          },
          {
            "id": "100046940032349",
            "name": "LÆ°Æ¡ng Ãnh"
          },
          {
            "id": "100048126162429",
            "name": "Kim Phá»¥ng"
          },
          {
            "id": "100049220042731",
            "name": "BÃ¬nh DÆ°Æ¡ng LÃª"
          }
        ],
        "comments": [
          {
            "id": "100023363242962",
            "name": "Tin Tin",
            "text": "Trang LÃª cÃ³ tuyá»ƒn nhÃ¢n viÃªn báº¿p khÃ´ng áº¡",
            "created_time_vn": "2025-11-22 17:30:19"
          },
          {
            "id": "100028298443377",
            "name": "BÃ¹i Linh",
            "text": "ðŸ“£ NHÃ€ HÃ€NG UMAI OMAKASE Dá»¤NG â€“ PHá»¤C Vá»¤ Ná»®\n\nâœ¨ Vá»‹ trÃ­: NhÃ¢n viÃªn phá»¥c vá»¥ ná»¯\nâ° Thá»i gian: Fulltime 10h -14h, 17h - 22h\n\nYÃªu cáº§u:\n â€¢ Ngoáº¡i hÃ¬nh Æ°a nhÃ¬n, nhanh nháº¹n\n â€¢ SiÃªng nÄƒng, chá»‹u khÃ³, há»— trá»£ Ä‘á»“ng Ä‘á»™i tá»‘t\n â€¢ KhÃ´ng cáº§n kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o)\n\nQuyá»n lá»£i:\n â€¢ LÆ°Æ¡ng 8tr ( 28 cÃ´ng ) + thÆ°á»Ÿng theo nÄƒng lá»±c\n â€¢ MÃ´i trÆ°á»ng lÃ m viá»‡c chuyÃªn nghiá»‡p, thÃ¢n thiá»‡n\n â€¢ Tip má»—i ngÃ y\n\nðŸ“ Äá»ŠA ÄIá»‚M LÃ€M VIá»†C: NhÃ  hÃ ng UMAI OMAKASE 11 Máº¡c ThÃ¡i TÃ´ng, Cáº§u Giáº¥y, HÃ  Ná»™i\nðŸ“ž LIÃŠN Há»† á»¨NG TUYá»‚N: Mr Linh SÄ‘t: 0949213939",
            "created_time_vn": "2025-12-06 17:02:45"
          },
          {
            "id": "100013761460826",
            "name": "HÆ°Æ¡ng Ly",
            "text": "ðŸ“¢NHÃ€ HÃ€NG ONGI JIAJANG â€“ QUÃN Má»² TÆ¯Æ NG ÄEN HÃ€N QUá»C TUYá»‚N Dá»¤NG Gáº¤P\nðŸ“ Äá»‹a chá»‰ lÃ m viá»‡c: 230 Nguyá»…n VÄƒn Tuyáº¿t, Äá»‘ng Äa, HÃ  Ná»™i \nðŸ“Giá» lÃ m: 10h-13h30 vÃ  16h30-22h\nHiá»‡n táº¡i nhÃ  hÃ ng Ä‘ang cáº§n bá»• sung nhÃ¢n sá»± cho cÃ¡c vá»‹ trÃ­ sau:\n1ï¸âƒ£ Quáº£n lÃ½\n2ï¸âƒ£ Phá»¥ báº¿p (BAO Ä‚N á»ž)\n3ï¸âƒ£ NhÃ¢n viÃªn phá»¥c vá»¥ (Part-time/Full-time) (BAO Ä‚N CA)\nðŸ“± á»©ng tuyá»ƒn Zl: 0877 213 681 (HÆ°Æ¡ng Ly)",
            "created_time_vn": "2025-11-20 09:49:55"
          },
          {
            "id": "100020526768178",
            "name": "Cáº©m TÃº",
            "text": "TUYá»‚N Dá»¤NG Táº I NHÃ€ HÃ€NG BBQ ONG MAP Q2âœ¨\nSá»‘ lÆ°á»£ng tuyá»ƒn dá»¥ng:\nðŸ¤µðŸ» Vá»‹ trÃ­ nhÃ¢n viÃªn phá»¥c vá»¥ full time vÃ  part time\nâ­ KhÃ´ng yÃªu cáº§u kinh nghiá»‡m, sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o \nâ­ Æ¯u tiÃªn nhá»¯ng báº¡n cÃ³ thá»ƒ giao tiáº¿p tiáº¿ng hÃ n, nhanh nháº¹n, chÄƒm chá»‰, tÃ­nh cÃ¡ch vui váº», hoÃ  Ä‘á»“ng\n\n* Full time\nâ­ LÆ°Æ¡ng: 9.000.000 - 14.000.000 \nâ­ï¸ Thá»i gian lÃ m viá»‡c: 12h -10h vÃ  15h - 1h \nâ­ Bonus tá»« 2.000.000/ thÃ¡ng\n\n* Part time\nâ­ LÆ°Æ¡ng 33k/h - 36k/h + bonus cao\nâ­ï¸ Thá»i gian lÃ m viá»‡c: 11h - 15h, 18h- 23h vÃ  18h - 1h \n\nðŸ  Äá»ŠA ÄIá»‚M LÃ€M VIá»†C:\n45 Song HÃ nh, An PhÃº, Q2\nBBQ Ã”NG Máº¬P Quáº­n 2\n38 Tráº§n Ngá»c Diá»‡n, Tháº£o Äiá»n, Q2\nBBQ Ã”ng Máº­p Tháº£o Äiá»n ëš±ë³´ì§‘ íƒ€ì˜¤ë””ì—”\n\nðŸ’¬LiÃªn há»‡: 0909886320- ThÆ°",
            "created_time_vn": "2025-12-01 13:54:32"
          },
          {
            "id": "100082569921800",
            "name": "Minh Huyá»n",
            "text": "Trung tÃ¢m Anh ngá»¯ EFIS English (ChÃ¹a LÃ¡ng) hiá»‡n Ä‘ang tuyá»ƒn:\nâ€¢ Giáº£ng viÃªn Tiáº¿ng Anh giao tiáº¿p\nâ€¢ ChuyÃªn viÃªn TÆ° váº¥n\nâ€¢ Marketing SEO\nâ€¢ Event â€“ Social\n\nBáº¡n nÃ o quan tÃ¢m comment hoáº·c inbox mÃ¬nh gá»­i JD chi tiáº¿t nhÃ© ðŸŒ±",
            "created_time_vn": "2025-12-22 09:05:44"
          }
        ],
        "reactions_count": 16,
        "comments_count": 5,
        "reactions_count_before_filter": 16,
        "comments_count_before_filter": 7,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 2,
  "total_reactions": 97,
  "total_comments": 5
}
--- END FILE: backend\data\results\all_results_20251224_013325.json ---

--- START FILE: backend\data\results\all_results_20251225_022251.json ---
{
  "total_files": 1,
  "results_by_file": {
    "caabaa64-f2c5-4254-a83b-7f6d57632503.json": [
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 2,
  "total_reactions": 0,
  "total_comments": 0
}
--- END FILE: backend\data\results\all_results_20251225_022251.json ---

--- START FILE: backend\data\results\all_results_20251225_024322.json ---
{
  "total_files": 1,
  "results_by_file": {
    "caabaa64-f2c5-4254-a83b-7f6d57632503.json": [
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 12,
  "total_reactions": 0,
  "total_comments": 0
}
--- END FILE: backend\data\results\all_results_20251225_024322.json ---

--- START FILE: backend\data\results\all_results_20251225_032851.json ---
{
  "total_files": 1,
  "results_by_file": {
    "caabaa64-f2c5-4254-a83b-7f6d57632503.json": [
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "24955032474094131",
        "flag": "vÃ ng",
        "text": "[BSV] Tuyá»ƒn dá»¥ng NV cho Táº­p ÄoÃ n VIETTEL: - NV VÄ‚N PHÃ’NG lÃ m giá» hÃ nh chÃ­nh ðŸ’° Thu nháº­p 8-15tr. ChÆ°a tÃ­nh lÆ°Æ¡ng thÆ°á»Ÿng - LÃ m táº¡i trá»¥ sá»Ÿ VIETTEL HCM - Äá»‹a chá»‰ lÃ m viá»‡c: 158/2A HoÃ ng Hoa ThÃ¡m, phÆ°á»ng 12, Q.TÃ¢n BÃ¬nh ðŸ‘‰ khÃ´ng yÃªu cáº§u kinh nghiá»‡m ðŸ‘‰ Cháº¿ Ä‘á»™ phÃºc lá»£i tá»‘t âœ… Cháº¥m Ä‘á»ƒ nháº­n JD ThÃ´ng tin contact: âœ« LiÃªn há»‡ bá»™ pháº­n tuyá»ƒn dá»¥ng : 0922312726 Mr Nhiá»‡m âœ« Email: truonghuunhiem@bs24vietnam.vn",
        "owning_profile": {
          "__typename": "User",
          "name": "Gia Minh",
          "id": "61568481862081"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "2198533247305479",
        "flag": "vÃ ng",
        "text": "Vá»‹ trÃ­ tuyá»ƒn dá»¥ng: LÃ m viá»‡c 8 tiáº¿ng ðŸ¥° â€¢NhÃ¢n viÃªn than Full : 8.500.000vnd ( Tuyá»ƒn nhÃ¢n viÃªn lÃ m viá»‡c lÃ¢u dÃ i ) â€¢NhÃ¢n viÃªn Lá»… tÃ¢n Full ca gÃ£y hoáº·c chuyÃªn ca 12h~20h30 . LÆ°Æ¡ng thoáº£ thuáº­n â€¢NhÃ¢n viÃªn phá»¥c vá»¥: NhÃ¢n viÃªn fulltime NhÃ  hÃ ng HÃ n Quá»‘c Ca gÃ£y 10h-14h/17h-22h hoáº·c 9h-14h/17h-21h ( nghá»‰ trÆ°a 3 tiáº¿ng ) hoáº·c Ca part xoay ca linh Ä‘á»™ng 10h-14h vÃ  18h - 22h. Hoáº·c part 12h-16h30 vÃ  13h - 17h30. - Cháº¿ Ä‘á»™, quyá»n lá»£i: LÆ°Æ¡ng cÆ¡ báº£n + Äƒn ca 2 bá»¯a + há»— trá»£ tiá»n Ä‘i láº¡i + 100% TIá»€N TIP. LÃ m 26ngÃ y/thÃ¡ng - Äá»‘i vá»›i nhÃ¢n viÃªn full sau 6 thÃ¡ng hÆ°á»Ÿng phÃ©p nÄƒm, vÃ  Ä‘á»‘i vá»›i táº¥t cáº£ nhÃ¢n viÃªn ngÃ y Lá»… Táº¿t x 400% lÆ°Æ¡ng + thÆ°á»Ÿng . Thu nháº­p tá»« 6-10tr â€¢MÃ´i trÆ°á»ng tráº» trung, thÃ¢n thiá»‡n, Ä‘á»“ng nghiá»‡p dá»… thÆ°Æ¡ng â€¢CÆ¡ há»™i há»c há»i ká»¹ nÄƒng giao tiáº¿p, phá»¥c vá»¥ chuyÃªn nghiá»‡p YÃªu cáº§u: â€¢KhÃ´ng yÃªu cáº§u kinh nghiá»‡m (sáº½ Ä‘Æ°á»£c Ä‘Ã o táº¡o) â€¢Nhanh nháº¹n, chÄƒm chá»‰, cÃ³ tinh tháº§n trÃ¡ch nhiá»‡m â€¢ThÃ¡i Ä‘á»™ vui váº», lá»‹ch sá»± vá»›i khÃ¡ch hÃ ng ðŸ“ Äá»‹a chá»‰: NhÃ  hÃ ng GOJUMONG CASUAL táº§ng 6 Lotte Liá»…u Giai ðŸ“ž LiÃªn há»‡ trá»±c tiáº¿p hoáº·c zalo: Quáº£n lÃ½ Mrs Trang: 0987.469.405",
        "owning_profile": {
          "__typename": "User",
          "name": "Trang LÃª",
          "id": "100006577548369"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 4,
  "total_reactions": 0,
  "total_comments": 0
}
--- END FILE: backend\data\results\all_results_20251225_032851.json ---

--- START FILE: backend\data\results\all_results_20251225_161451.json ---
{
  "total_files": 1,
  "results_by_file": {
    "caabaa64-f2c5-4254-a83b-7f6d57632503.json": [
      {
        "post_id": "122152945058694563",
        "flag": "xanh",
        "text": "ðŸŽ‰ ðŸŒ¸ â€œTáº¿t Ä‘áº¿n xuÃ¢n vá» â€“ tÃ¬m viá»‡c Ä‘Ã¢u xa, Vingroup chÃ o Ä‘Ã³n â€“ má»Ÿ lá»‘i thÄƒng hoa!â€ ðŸŒ¸ ðŸŽ‰ ðŸ¢ VINGROUP â€“ TUYá»‚N Dá»¤NG KHá»I VÄ‚N PHÃ’NG TOÃ€N QUá»C ðŸ‡»ðŸ‡³ ðŸ‡»ðŸ‡³ Báº¡n Ä‘ang tÃ¬m kiáº¿m má»™t mÃ´i trÆ°á»ng á»•n Ä‘á»‹nh â€“ chuyÃªn nghiá»‡p â€“ cÃ³ lá»™ trÃ¬nh thÄƒng tiáº¿n rÃµ rÃ ng? ðŸ‡»ðŸ‡³ Vingroup â€“ Táº­p Ä‘oÃ n kinh táº¿ tÆ° nhÃ¢n hÃ ng Ä‘áº§u Viá»‡t Nam â€“ Ä‘ang má»Ÿ rá»™ng Ä‘á»™i ngÅ© vÄƒn phÃ²ng trÃªn toÃ n quá»‘c, sáºµn sÃ ng Ä‘á»“ng hÃ nh cÃ¹ng báº¡n bÆ°á»›c vÃ o nÄƒm má»›i vá»›i nhiá»u cÆ¡ há»™i phÃ¡t triá»ƒn Ä‘á»™t phÃ¡. ðŸ’¢ Vá»Š TRÃ ÄANG TUYá»‚N ðŸ”– NhÃ¢n ViÃªn Káº¿ ToÃ¡n ðŸ”– ChuyÃªn ViÃªn Quáº£n LÃ½ Kinh Doanh ðŸ”– NhÃ¢n ViÃªn TÆ° Váº¥n ChÄƒm SÃ³c KhÃ¡ch HÃ ng ðŸ”– TrÆ°á»Ÿng PhÃ²ng Xuáº¥t Nháº­p Kháº©u ðŸ”– TrÆ°á»Ÿng PhÃ²ng Tiáº¿p Thá»‹ ThÆ°Æ¡ng Máº¡i ðŸ”– TrÆ°á»Ÿng PhÃ²ng HÃ nh ChÃ­nh NhÃ¢n Sá»± ðŸ“ LÃ m viá»‡c táº¡i cÃ¡c vÄƒn phÃ²ng Ä‘áº¡i diá»‡n trÃªn toÃ n quá»‘c ðŸŽ¯ Táº I SAO Báº N NÃŠN á»¨NG TUYá»‚N NGAY? â–ªï¸ Thu nháº­p háº¥p dáº«n, thÆ°á»Ÿng Táº¿t rÃµ rÃ ng â–ªï¸ Báº£o hiá»ƒm Ä‘áº§y Ä‘á»§, phÃºc lá»£i á»•n Ä‘á»‹nh â–ªï¸ CÆ¡ há»™i phÃ¡t triá»ƒn sá»± nghiá»‡p, Ä‘Æ°á»£c Ä‘Ã o táº¡o chuyÃªn sÃ¢u â–ªï¸ MÃ´i trÆ°á»ng lÃ m viá»‡c minh báº¡ch, hiá»‡n Ä‘áº¡i, chuyÃªn nghiá»‡p ðŸ“¨ Ná»™p há»“ sÆ¡ trá»±c tuyáº¿n táº¡i: https://qrco.de/tuyendungVinGroup ðŸ‘‰ Tag ngÆ°á»i phÃ¹ há»£p hoáº·c chia sáº» ngay cÆ¡ há»™i tuyá»‡t vá»i nÃ y! ðŸŒŸ VINGROUP â€“ NÆ¡i tÃ i nÄƒng Ä‘Æ°á»£c phÃ¡t huy vÃ  thÃ nh cÃ´ng Ä‘Æ°á»£c ghi nháº­n. CÃ¹ng khá»Ÿi Ä‘á»™ng nÄƒm má»›i vá»›i bÆ°á»›c tiáº¿n vá»¯ng vÃ ng trong sá»± nghiá»‡p! #Vingroup #TuyenDungTet2025 #CoHoiNgheNghiep #ViecLamVanPhong #DonXuanVingroup",
        "owning_profile": {
          "__typename": "User",
          "name": "Tuyá»ƒn Dá»¥ng VinGroup",
          "id": "61570836905496"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "122152945058694563",
        "flag": "xanh",
        "text": "ðŸŽ‰ ðŸŒ¸ â€œTáº¿t Ä‘áº¿n xuÃ¢n vá» â€“ tÃ¬m viá»‡c Ä‘Ã¢u xa, Vingroup chÃ o Ä‘Ã³n â€“ má»Ÿ lá»‘i thÄƒng hoa!â€ ðŸŒ¸ ðŸŽ‰ ðŸ¢ VINGROUP â€“ TUYá»‚N Dá»¤NG KHá»I VÄ‚N PHÃ’NG TOÃ€N QUá»C ðŸ‡»ðŸ‡³ ðŸ‡»ðŸ‡³ Báº¡n Ä‘ang tÃ¬m kiáº¿m má»™t mÃ´i trÆ°á»ng á»•n Ä‘á»‹nh â€“ chuyÃªn nghiá»‡p â€“ cÃ³ lá»™ trÃ¬nh thÄƒng tiáº¿n rÃµ rÃ ng? ðŸ‡»ðŸ‡³ Vingroup â€“ Táº­p Ä‘oÃ n kinh táº¿ tÆ° nhÃ¢n hÃ ng Ä‘áº§u Viá»‡t Nam â€“ Ä‘ang má»Ÿ rá»™ng Ä‘á»™i ngÅ© vÄƒn phÃ²ng trÃªn toÃ n quá»‘c, sáºµn sÃ ng Ä‘á»“ng hÃ nh cÃ¹ng báº¡n bÆ°á»›c vÃ o nÄƒm má»›i vá»›i nhiá»u cÆ¡ há»™i phÃ¡t triá»ƒn Ä‘á»™t phÃ¡. ðŸ’¢ Vá»Š TRÃ ÄANG TUYá»‚N ðŸ”– NhÃ¢n ViÃªn Káº¿ ToÃ¡n ðŸ”– ChuyÃªn ViÃªn Quáº£n LÃ½ Kinh Doanh ðŸ”– NhÃ¢n ViÃªn TÆ° Váº¥n ChÄƒm SÃ³c KhÃ¡ch HÃ ng ðŸ”– TrÆ°á»Ÿng PhÃ²ng Xuáº¥t Nháº­p Kháº©u ðŸ”– TrÆ°á»Ÿng PhÃ²ng Tiáº¿p Thá»‹ ThÆ°Æ¡ng Máº¡i ðŸ”– TrÆ°á»Ÿng PhÃ²ng HÃ nh ChÃ­nh NhÃ¢n Sá»± ðŸ“ LÃ m viá»‡c táº¡i cÃ¡c vÄƒn phÃ²ng Ä‘áº¡i diá»‡n trÃªn toÃ n quá»‘c ðŸŽ¯ Táº I SAO Báº N NÃŠN á»¨NG TUYá»‚N NGAY? â–ªï¸ Thu nháº­p háº¥p dáº«n, thÆ°á»Ÿng Táº¿t rÃµ rÃ ng â–ªï¸ Báº£o hiá»ƒm Ä‘áº§y Ä‘á»§, phÃºc lá»£i á»•n Ä‘á»‹nh â–ªï¸ CÆ¡ há»™i phÃ¡t triá»ƒn sá»± nghiá»‡p, Ä‘Æ°á»£c Ä‘Ã o táº¡o chuyÃªn sÃ¢u â–ªï¸ MÃ´i trÆ°á»ng lÃ m viá»‡c minh báº¡ch, hiá»‡n Ä‘áº¡i, chuyÃªn nghiá»‡p ðŸ“¨ Ná»™p há»“ sÆ¡ trá»±c tuyáº¿n táº¡i: https://qrco.de/tuyendungVinGroup ðŸ‘‰ Tag ngÆ°á»i phÃ¹ há»£p hoáº·c chia sáº» ngay cÆ¡ há»™i tuyá»‡t vá»i nÃ y! ðŸŒŸ VINGROUP â€“ NÆ¡i tÃ i nÄƒng Ä‘Æ°á»£c phÃ¡t huy vÃ  thÃ nh cÃ´ng Ä‘Æ°á»£c ghi nháº­n. CÃ¹ng khá»Ÿi Ä‘á»™ng nÄƒm má»›i vá»›i bÆ°á»›c tiáº¿n vá»¯ng vÃ ng trong sá»± nghiá»‡p! #Vingroup #TuyenDungTet2025 #CoHoiNgheNghiep #ViecLamVanPhong #DonXuanVingroup",
        "owning_profile": {
          "__typename": "User",
          "name": "Tuyá»ƒn Dá»¥ng VinGroup",
          "id": "61570836905496"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "4432161690347913",
        "flag": "vÃ ng",
        "text": "[HÃ  ÄÃ´ng, HN] TUYá»‚N Váº¬N HÃ€NH SÃ€N TMÄT LÆ¯Æ NG 6M - 12M !! KHÃ”NG YC KINH NGHIá»†M",
        "owning_profile": {
          "__typename": "User",
          "name": "Nguyá»…n HÃ  Thu",
          "id": "100007869585114"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "4432161690347913",
        "flag": "vÃ ng",
        "text": "[HÃ  ÄÃ´ng, HN] TUYá»‚N Váº¬N HÃ€NH SÃ€N TMÄT LÆ¯Æ NG 6M - 12M !! KHÃ”NG YC KINH NGHIá»†M",
        "owning_profile": {
          "__typename": "User",
          "name": "Nguyá»…n HÃ  Thu",
          "id": "100007869585114"
        },
        "source_file": "caabaa64-f2c5-4254-a83b-7f6d57632503.json",
        "profile_id": "caabaa64-f2c5-4254-a83b-7f6d57632503",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 4,
  "total_reactions": 0,
  "total_comments": 0
}
--- END FILE: backend\data\results\all_results_20251225_161451.json ---

--- START FILE: backend\worker\check_cookies.py ---
import requests


def _import_get_cookies():
    try:
        from get_payload import get_cookies_by_profile_id  # type: ignore
        return get_cookies_by_profile_id
    except Exception:
        try:
            from backend.worker.get_payload import get_cookies_by_profile_id  # type: ignore
            return get_cookies_by_profile_id
        except Exception:
            from worker.get_payload import get_cookies_by_profile_id  # type: ignore
            return get_cookies_by_profile_id


get_cookies_by_profile_id = _import_get_cookies()


def check_cookie_by_title(profile_id: str) -> dict:
    """
    Táº£i facebook.com vá»›i cookies vÃ  kiá»ƒm tra title Ä‘Äƒng nháº­p.
    Title "Facebook â€“ log in or sign up" => cookies die.
    """
    cookie = get_cookies_by_profile_id(profile_id)
    if not cookie:
        return {"status": "dead", "message": "âŒ KhÃ´ng láº¥y Ä‘Æ°á»£c cookie"}

    url = "https://www.facebook.com/"
    headers = {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",
        "accept-encoding": "gzip, deflate",
        "accept-language": "en,vi;q=0.9,en-US;q=0.8",
        "referer": "https://www.facebook.com/",
        "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": '"Windows"',
        "upgrade-insecure-requests": "1",
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
        "cookie": cookie,
    }

    try:
        resp = requests.get(url, headers=headers, timeout=20, allow_redirects=True)
        login_title = '<title id="pageTitle">Facebook â€“ log in or sign up</title>'
        html_lower = resp.text.lower()

        if login_title.lower() in html_lower:
            return {
                "status": "dead",
                "message": "âŒ PhÃ¡t hiá»‡n title login: cookies die",
                "status_code": resp.status_code,
                "final_url": resp.url,
            }

        # KhÃ´ng tháº¥y title login => coi lÃ  cookies cÃ²n sá»‘ng (dÃ¹ status khÃ¡c 200)
        return {
            "status": "alive",
            "message": "âœ… KhÃ´ng tháº¥y title login, coi cookies cÃ²n sá»‘ng",
            "status_code": resp.status_code,
            "final_url": resp.url,
        }
    except Exception as e:
        return {"status": "error", "message": f"âŒ Lá»—i: {e}"}


if __name__ == "__main__":
    profile_id = "031ca13d-e8fa-400c-a603-df57a2806788"
    result = check_cookie_by_title(profile_id)
    print(result["message"])


--- END FILE: backend\worker\check_cookies.py ---

--- START FILE: backend\worker\get_all_info.py ---
import json
import os
from pathlib import Path
from datetime import datetime
from single_get_reactions import get_all_users_by_fid
from single_get_comment import get_all_comments_by_post_id
from core import control as control_state
from core.paths import get_data_dir

def _import_get_payload_funcs():
    """
    Try multiple import paths for get_payload functions so the worker scripts
    can be run from different working directories.
    Returns tuple: (get_payload_by_profile_id, get_cookies_by_profile_id, get_access_token_by_profile_id)
    """
    try:
        from get_payload import get_payload_by_profile_id, get_cookies_by_profile_id, get_access_token_by_profile_id  # type: ignore
        return get_payload_by_profile_id, get_cookies_by_profile_id, get_access_token_by_profile_id
    except Exception:
        try:
            from backend.worker.get_payload import get_payload_by_profile_id, get_cookies_by_profile_id, get_access_token_by_profile_id  # type: ignore
            return get_payload_by_profile_id, get_cookies_by_profile_id, get_access_token_by_profile_id
        except Exception:
            from worker.get_payload import get_payload_by_profile_id, get_cookies_by_profile_id, get_access_token_by_profile_id  # type: ignore
            return get_payload_by_profile_id, get_cookies_by_profile_id, get_access_token_by_profile_id


# Get payload functions (imported via helper)
get_payload_by_profile_id, get_cookies_by_profile_id, get_access_token_by_profile_id = _import_get_payload_funcs()

# ====== ÄÆ¯á»œNG DáºªN THEO PROJECT ROOT ======
POST_IDS_DIR = get_data_dir() / "post_ids"
RESULTS_DIR = get_data_dir() / "results"
OUTPUT_DIR = RESULTS_DIR  # Alias cho RESULTS_DIR Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch
# File all_results kÃ¨m timestamp cho má»—i láº§n cháº¡y (chá»‰ má»™t file duy nháº¥t)
RUN_TS = datetime.now().strftime("%Y%m%d_%H%M%S")
ALL_RESULTS_FILE = OUTPUT_DIR / f"all_results_{RUN_TS}.json"
# Bá»™ nhá»› Ä‘á»‡m káº¿t quáº£ Ä‘á»ƒ ghi dáº¡ng summary giá»‘ng all_results_summary_selected
ALL_RESULTS_DATA = {
    "total_files": 0,
    "results_by_file": {},
    "total_posts_processed": 0,
    "total_reactions": 0,
    "total_comments": 0,
}

def cleanup_old_result_files(max_days: int = 3) -> int:
    """
    XÃ³a cÃ¡c file all_results cÅ© quÃ¡ max_days ngÃ y.
    Tráº£ vá» sá»‘ file Ä‘Ã£ xÃ³a.
    """
    import re
    from datetime import datetime, timedelta

    if not OUTPUT_DIR.exists():
        return 0

    # Pattern Ä‘á»ƒ parse timestamp tá»« tÃªn file: all_results_YYYYMMDD_HHMMSS.json
    pattern = re.compile(r'all_results_(\d{8})_(\d{6})\.json$')

    current_time = datetime.now()
    max_age = timedelta(days=max_days)
    deleted_count = 0

    # Duyá»‡t qua táº¥t cáº£ file trong thÆ° má»¥c
    for file_path in OUTPUT_DIR.glob("*.json"):
        if not file_path.is_file():
            continue

        match = pattern.match(file_path.name)
        if not match:
            continue

        date_str, time_str = match.groups()
        try:
            # Parse thÃ nh datetime
            file_datetime = datetime.strptime(f"{date_str} {time_str}", "%Y%m%d %H%M%S")

            # Kiá»ƒm tra tuá»•i file
            if current_time - file_datetime > max_age:
                try:
                    file_path.unlink()  # XÃ³a file
                    deleted_count += 1
                    print(f"ÄÃ£ xÃ³a file cÅ©: {file_path.name}")
                except Exception as e:
                    print(f"Lá»—i khi xÃ³a file {file_path.name}: {e}")

        except ValueError:
            # Náº¿u khÃ´ng parse Ä‘Æ°á»£c timestamp, bá» qua
            continue

    return deleted_count


# Biáº¿n global Ä‘á»ƒ lÆ°u tiáº¿n trÃ¬nh khi Ä‘ang láº¥y thÃ´ng tin
INFO_PROGRESS = {
    "is_running": False,
    "current": 0,
    "total": 0,
    "current_file": "",
}

# Táº¡o thÆ° má»¥c output náº¿u chÆ°a cÃ³
OUTPUT_DIR.mkdir(parents=True, exist_ok=True)

# ====== PROFILE ID ======
# Profile ID máº·c Ä‘á»‹nh, cÃ³ thá»ƒ thay Ä‘á»•i
DEFAULT_PROFILE_ID = "031ca13d-e8fa-400c-a603-df57a2806788"


def filter_by_owner_id(items, owner_id):
    """
    Lá»c bá» cÃ¡c items cÃ³ id trÃ¹ng vá»›i owner_id
    
    Args:
        items (list): Danh sÃ¡ch items (reactions hoáº·c comments)
        owner_id (str): ID cá»§a owner cáº§n loáº¡i bá»
        
    Returns:
        list: Danh sÃ¡ch items Ä‘Ã£ Ä‘Æ°á»£c lá»c
    """
    if not owner_id or not items:
        return items
    
    filtered = []
    removed_count = 0
    
    for item in items:
        # Reactions: {"id": user_id, "name": user_name}
        # Comments: {"id": user_id, "name": user_name, "text": ...} hoáº·c {"id": comment_id, "author": {"id": user_id, ...}}
        item_id = None
        
        # Thá»­ láº¥y id tá»« cÃ¡c vá»‹ trÃ­ cÃ³ thá»ƒ
        if "id" in item:
            # Vá»›i comments, cÃ³ thá»ƒ lÃ  comment_id hoáº·c user_id
            # Náº¿u cÃ³ "author", thÃ¬ id lÃ  comment_id, cáº§n láº¥y tá»« author
            if "author" in item and isinstance(item["author"], dict):
                item_id = item["author"].get("id")
            else:
                # Náº¿u khÃ´ng cÃ³ author, thÃ¬ id chÃ­nh lÃ  user_id
                item_id = item.get("id")
        
        # Náº¿u váº«n chÆ°a cÃ³, thá»­ cÃ¡c field khÃ¡c
        if not item_id:
            item_id = item.get("user_id")
        
        # Chá»‰ thÃªm vÃ o náº¿u id khÃ¡c vá»›i owner_id
        if item_id != owner_id:
            filtered.append(item)
        else:
            removed_count += 1
    
    if removed_count > 0:
        print(f"   ðŸš« ÄÃ£ lá»c bá» {removed_count} items tá»« owner (ID: {owner_id})")
    
    return filtered


def process_post_id(post_data, file_name, profile_id, payload_dict, cookies):
    """
    Xá»­ lÃ½ má»™t post: láº¥y reactions vÃ  comments
    
    Args:
        post_data (dict hoáº·c str): 
            - Náº¿u lÃ  dict: {"id": "...", "flag": "...", "text": "...", "owning_profile": {...}}
            - Náº¿u lÃ  str: post_id (format cÅ©, Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch)
        file_name (str): TÃªn file JSON chá»©a post nÃ y
        profile_id (str): Profile ID
        payload_dict (dict): Payload dictionary Ä‘Ã£ Ä‘Æ°á»£c load sáºµn
        cookies (str): Cookie string Ä‘Ã£ Ä‘Æ°á»£c load sáºµn
        
    Returns:
        dict: Káº¿t quáº£ vá»›i reactions vÃ  comments
    """
    # Xá»­ lÃ½ cáº£ format cÅ© (string) vÃ  format má»›i (object)
    if isinstance(post_data, str):
        # Format cÅ©: chá»‰ lÃ  string post_id
        post_id = post_data
        flag = None
        text = None
        owning_profile = None
        owning_profile_id = None
    else:
        # Format má»›i: object vá»›i id, flag, text, owning_profile
        post_id = post_data.get("id")
        flag = post_data.get("flag")
        text = post_data.get("text")
        owning_profile = post_data.get("owning_profile")
        owning_profile_id = owning_profile.get("id") if owning_profile else None
    
    if not post_id:
        print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y post_id trong post_data")
        return None
    
    print("\n" + "="*70)
    print(f"ðŸ“Œ Xá»­ lÃ½ Post ID: {post_id}")
    if flag:
        print(f"ðŸ·ï¸  Flag: {flag}")
    if owning_profile:
        print(f"ðŸ‘¤ Owner: {owning_profile.get('name', 'N/A')} (ID: {owning_profile_id})")
    print(f"ðŸ“ Tá»« file: {file_name}")
    print(f"ðŸ‘¤ Profile ID: {profile_id}")
    print("="*70)
    
    result = {
        "post_id": post_id,
        "flag": flag,
        "text": text,
        "owning_profile": owning_profile,
        "source_file": file_name,
        "profile_id": profile_id,
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
    }
    
    try:
        # 1. Láº¥y reactions
        print(f"\nðŸ”µ Báº¯t Ä‘áº§u láº¥y REACTIONS cho post_id: {post_id}")
        reactions = get_all_users_by_fid(post_id, payload_dict, profile_id, cookies)
        result["reactions_count_before_filter"] = len(reactions)
        
        # Lá»c bá» reactions tá»« owner
        if owning_profile_id:
            reactions = filter_by_owner_id(reactions, owning_profile_id)
            filtered_count = result["reactions_count_before_filter"] - len(reactions)
            if filtered_count > 0:
                print(f"ðŸš« ÄÃ£ lá»c bá» {filtered_count} reactions tá»« owner (ID: {owning_profile_id})")
        
        result["reactions"] = reactions
        result["reactions_count"] = len(reactions)
        print(f"âœ… ÄÃ£ láº¥y Ä‘Æ°á»£c {result['reactions_count']} reactions (sau khi lá»c)")
        
        # 2. Láº¥y comments
        print(f"\nðŸŸ¢ Báº¯t Ä‘áº§u láº¥y COMMENTS cho post_id: {post_id}")
        comments = get_all_comments_by_post_id(post_id, payload_dict, profile_id, cookies)
        result["comments_count_before_filter"] = len(comments)
        
        # Lá»c bá» comments tá»« owner
        if owning_profile_id:
            comments = filter_by_owner_id(comments, owning_profile_id)
            filtered_count = result["comments_count_before_filter"] - len(comments)
            if filtered_count > 0:
                print(f"ðŸš« ÄÃ£ lá»c bá» {filtered_count} comments tá»« owner (ID: {owning_profile_id})")
        
        result["comments"] = comments
        result["comments_count"] = len(comments)
        print(f"âœ… ÄÃ£ láº¥y Ä‘Æ°á»£c {result['comments_count']} comments (sau khi lá»c)")
        
    except RuntimeError as e:
        # Re-raise RuntimeError (EMERGENCY_STOP) Ä‘á»ƒ caller cÃ³ thá»ƒ dá»«ng hoÃ n toÃ n
        if "EMERGENCY_STOP" in str(e):
            raise
        # Náº¿u khÃ´ng pháº£i EMERGENCY_STOP thÃ¬ xá»­ lÃ½ nhÆ° lá»—i thÃ´ng thÆ°á»ng
        print(f"âŒ Lá»—i khi xá»­ lÃ½ post_id {post_id}: {e}")
        import traceback
        traceback.print_exc()
        result["status"] = "error"
        result["error"] = str(e)
    except Exception as e:
        print(f"âŒ Lá»—i khi xá»­ lÃ½ post_id {post_id}: {e}")
        import traceback
        traceback.print_exc()
        result["status"] = "error"
        result["error"] = str(e)
    
    return result


def append_to_all_results(file_name: str, result: dict):
    """
    Append FULL result vÃ o cáº¥u trÃºc summary (results_by_file) vÃ  ghi ra all_results_<timestamp>.json NGAY Láº¬P Tá»¨C.
    """
    try:
        # Bá»• sung list cho file náº¿u chÆ°a cÃ³
        results_by_file = ALL_RESULTS_DATA.get("results_by_file", {})
        file_list = results_by_file.get(file_name)
        if file_list is None:
            file_list = []
            results_by_file[file_name] = file_list
        file_list.append(result)
        ALL_RESULTS_DATA["results_by_file"] = results_by_file

        # Cáº­p nháº­t counters
        ALL_RESULTS_DATA["total_posts_processed"] = sum(len(v) for v in results_by_file.values())
        ALL_RESULTS_DATA["total_reactions"] += int(result.get("reactions_count", 0) or 0)
        ALL_RESULTS_DATA["total_comments"] += int(result.get("comments_count", 0) or 0)
        ALL_RESULTS_DATA["total_files"] = len(results_by_file.keys())

        # Cleanup file cÅ© quÃ¡ 3 ngÃ y trÆ°á»›c khi ghi file má»›i
        cleanup_old_result_files(3)

        # Ghi file NGAY Láº¬P Tá»¨C vÃ  flush Ä‘á»ƒ Ä‘áº£m báº£o dá»¯ liá»‡u Ä‘Æ°á»£c ghi ngay
        with ALL_RESULTS_FILE.open("w", encoding="utf-8") as f:
            json.dump(ALL_RESULTS_DATA, f, ensure_ascii=False, indent=2)
            f.flush()  # Äáº£m báº£o dá»¯ liá»‡u Ä‘Æ°á»£c ghi ngay vÃ o disk
            os.fsync(f.fileno())  # Force write to disk (náº¿u há»‡ thá»‘ng há»— trá»£)
        
        post_id = result.get("post_id", "N/A")
        print(f"ðŸ’¾ ÄÃ£ lÆ°u post_id {post_id} vÃ o {ALL_RESULTS_FILE}")
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi lÆ°u vÃ o {ALL_RESULTS_FILE}: {e}")
        import traceback
        traceback.print_exc()


def _check_stop_pause(profile_id: str | None = None):
    """TÃ´n trá»ng nÃºt dá»«ng / pause (global hoáº·c theo profile)."""
    stop, paused, reason = control_state.check_flags(profile_id)
    if stop:
        raise RuntimeError(f"EMERGENCY_STOP ({reason})")
    if paused:
        print(f"â¸ï¸ Äang táº¡m dá»«ng ({reason}), chá» tiáº¿p tá»¥c ...")
        control_state.wait_if_paused(profile_id, sleep_seconds=0.5)


def extract_profile_id_from_filename(file_name):
    """
    TÃ¡ch profile_id tá»« tÃªn file (vÃ­ dá»¥: 031ca13d-e8fa-400c-a603-df57a2806788.json -> 031ca13d-e8fa-400c-a603-df57a2806788)
    
    Args:
        file_name (str): TÃªn file (cÃ³ thá»ƒ cÃ³ hoáº·c khÃ´ng cÃ³ Ä‘Æ°á»ng dáº«n)
        
    Returns:
        str: Profile ID hoáº·c None náº¿u khÃ´ng tÃ¡ch Ä‘Æ°á»£c
    """
    # Láº¥y tÃªn file khÃ´ng cÃ³ extension
    base_name = os.path.splitext(os.path.basename(file_name))[0]
    
    # Kiá»ƒm tra xem cÃ³ pháº£i lÃ  UUID format khÃ´ng (cÃ³ dáº¥u gáº¡ch ngang)
    if '-' in base_name and len(base_name) == 36:  # UUID format: 8-4-4-4-12
        return base_name
    
    return None


def process_post_ids_file(file_path):
    """
    Xá»­ lÃ½ má»™t file JSON chá»©a danh sÃ¡ch post_ids
    
    Args:
        file_path (str | Path): ÄÆ°á»ng dáº«n Ä‘áº¿n file JSON
        
    Returns:
        list: Danh sÃ¡ch káº¿t quáº£ cá»§a táº¥t cáº£ post_ids trong file
    """
    # Chuyá»ƒn Ä‘á»•i thÃ nh Path náº¿u lÃ  string
    file_path = Path(file_path) if not isinstance(file_path, Path) else file_path
    file_name = file_path.name
    
    # Tá»± Ä‘á»™ng tÃ¡ch profile_id tá»« tÃªn file
    profile_id = extract_profile_id_from_filename(file_name)
    
    if not profile_id:
        print(f"âš ï¸ KhÃ´ng thá»ƒ tÃ¡ch profile_id tá»« tÃªn file: {file_name}")
        print(f"   Sá»­ dá»¥ng profile_id máº·c Ä‘á»‹nh: {DEFAULT_PROFILE_ID}")
        profile_id = DEFAULT_PROFILE_ID
    else:
        print(f"âœ… ÄÃ£ tÃ¡ch profile_id tá»« tÃªn file: {profile_id}")
    
    print("\n" + "="*70)
    print(f"ðŸ“‚ Äang xá»­ lÃ½ file: {file_name}")
    print(f"ðŸ‘¤ Profile ID: {profile_id}")
    print("="*70)
    
    try:
        with file_path.open("r", encoding="utf-8") as f:
            post_ids = json.load(f)
        
        if not isinstance(post_ids, list):
            print(f"âš ï¸ File {file_name} khÃ´ng chá»©a máº£ng post_ids")
            return []
        
        # Kiá»ƒm tra náº¿u file trá»‘ng hoáº·c khÃ´ng cÃ³ dá»¯ liá»‡u
        if len(post_ids) == 0:
            print(f"âš ï¸ File {file_name} khÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t (file trá»‘ng)")
            raise ValueError(f"File {file_name} khÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t")
        
        print(f"ðŸ“‹ TÃ¬m tháº¥y {len(post_ids)} post(s) trong file")
        
        # Load payload vÃ  cookies má»™t láº§n cho táº¥t cáº£ posts
        print(f"\nðŸ”„ Äang láº¥y payload vÃ  cookies tá»« profile_id: {profile_id}")
        # Khi báº¯t Ä‘áº§u xá»­ lÃ½, Ä‘áº£m báº£o profile khÃ´ng bá»‹ STOP trong runtime_control
        control_state.resume_profile(profile_id)

        payload_dict = get_payload_by_profile_id(profile_id)
        if not payload_dict:
            print(f"âŒ KhÃ´ng thá»ƒ láº¥y payload tá»« profile_id: {profile_id}")
            return []
        
        cookies = get_cookies_by_profile_id(profile_id)
        if not cookies:
            print(f"âŒ KhÃ´ng thá»ƒ láº¥y cookies tá»« profile_id: {profile_id}")
            return []
        
        print(f"âœ… ÄÃ£ load payload vÃ  cookies thÃ nh cÃ´ng (sáº½ dÃ¹ng chung cho táº¥t cáº£ {len(post_ids)} posts)")
        
        results = []
        idx = 0
        while idx < len(post_ids):
            try:
                _check_stop_pause(profile_id)
            except RuntimeError as stp:
                print(f"ðŸ›‘ Dá»«ng xá»­ lÃ½ file {file_name} do stop/pause: {stp}")
                break

            post_data = post_ids[idx]
            # Xá»­ lÃ½ cáº£ format cÅ© (string) vÃ  format má»›i (object)
            if isinstance(post_data, str):
                post_id = post_data
            else:
                post_id = post_data.get("id")
            
            if not post_id:
                print(f"âš ï¸ [{idx+1}/{len(post_ids)}] Bá» qua item khÃ´ng cÃ³ post_id: {post_data}")
                idx += 1
                continue
            
            print(f"\n{'='*70}")
            print(f"ðŸ“Œ [{idx+1}/{len(post_ids)}] Xá»­ lÃ½ Post ID: {post_id}")
            print(f"{'='*70}")
            
            try:
                result = process_post_id(post_data, file_name, profile_id, payload_dict, cookies)
            except RuntimeError as stp:
                # Náº¿u lÃ  EMERGENCY_STOP thÃ¬ dá»«ng ngay
                if "EMERGENCY_STOP" in str(stp):
                    print(f"ðŸ›‘ Dá»«ng xá»­ lÃ½ file {file_name} do stop: {stp}")
                    raise  # Re-raise Ä‘á»ƒ caller cÃ³ thá»ƒ catch vÃ  break
                # Náº¿u khÃ´ng pháº£i EMERGENCY_STOP thÃ¬ xá»­ lÃ½ nhÆ° lá»—i thÃ´ng thÆ°á»ng
                print(f"âŒ Lá»—i RuntimeError khi xá»­ lÃ½ post_id {post_id}: {stp}")
                result = None
            
            if result:
                results.append(result)
                
                # Append full result vÃ o all_results_<timestamp>.json (summary-style)
                append_to_all_results(file_name, result)

                # Cáº­p nháº­t tiáº¿n trÃ¬nh
                INFO_PROGRESS["current"] += 1

                # XÃ³a post_id Ä‘Ã£ xá»­ lÃ½ khá»i file nguá»“n
                post_ids.pop(idx)
                try:
                    with file_path.open("w", encoding="utf-8") as f:
                        json.dump(post_ids, f, ensure_ascii=False, indent=2)
                    print(f"ðŸ—‘ï¸ ÄÃ£ xÃ³a post_id {post_id} khá»i {file_name}")
                except Exception as e:
                    print(f"âš ï¸ KhÃ´ng thá»ƒ ghi láº¡i file {file_name} sau khi xÃ³a post_id: {e}")
                # khÃ´ng tÄƒng idx vÃ¬ Ä‘Ã£ pop, danh sÃ¡ch Ä‘Ã£ dá»‹ch sang trÃ¡i
                continue
            
            # Náº¿u khÃ´ng cÃ³ result (lá»—i) thÃ¬ tÄƒng idx Ä‘á»ƒ trÃ¡nh loop vÃ´ háº¡n
            idx += 1
            # Váº«n cáº­p nháº­t tiáº¿n trÃ¬nh dÃ¹ cÃ³ lá»—i
            INFO_PROGRESS["current"] += 1
        
        return results
        
    except ValueError as e:
        # Re-raise ValueError Ä‘á»ƒ caller cÃ³ thá»ƒ catch vÃ  xá»­ lÃ½
        if "khÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t" in str(e):
            raise
        print(f"âŒ Lá»—i: {e}")
        return []
    except FileNotFoundError:
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y file: {file_path}")
        return []
    except json.JSONDecodeError as e:
        print(f"âŒ Lá»—i: File {file_name} khÃ´ng pháº£i JSON há»£p lá»‡: {e}")
        return []
    except Exception as e:
        print(f"âŒ Lá»—i khi xá»­ lÃ½ file {file_name}: {e}")
        import traceback
        traceback.print_exc()
        return []


def get_all_info_from_post_ids_dir():
    """
    Xá»­ lÃ½ táº¥t cáº£ cÃ¡c file JSON trong thÆ° má»¥c data/post_ids/
    Má»—i file sáº½ tá»± Ä‘á»™ng sá»­ dá»¥ng profile_id tá»« tÃªn file
    """
    global INFO_PROGRESS
    
    print("\n" + "="*70)
    print("ðŸš€ Báº®T Äáº¦U Xá»¬ LÃ Táº¤T Cáº¢ POST IDs")
    print("="*70)
    print("â„¹ï¸  Má»—i file sáº½ tá»± Ä‘á»™ng sá»­ dá»¥ng profile_id tá»« tÃªn file")
    print("="*70)
    
    # Láº¥y táº¥t cáº£ file JSON trong thÆ° má»¥c
    post_ids_path = Path(POST_IDS_DIR)
    if not post_ids_path.exists():
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y thÆ° má»¥c: {POST_IDS_DIR}")
        INFO_PROGRESS["is_running"] = False
        return
    
    json_files = list(post_ids_path.glob("*.json"))
    
    if not json_files:
        print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y file JSON nÃ o trong {POST_IDS_DIR}")
        INFO_PROGRESS["is_running"] = False
        raise ValueError("KhÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t Ä‘á»ƒ xá»­ lÃ½")
    
    print(f"ðŸ“ TÃ¬m tháº¥y {len(json_files)} file(s) JSON")
    
    # TÃ­nh tá»•ng sá»‘ bÃ i trÆ°á»›c khi báº¯t Ä‘áº§u
    total_posts = 0
    for file_path in json_files:
        try:
            with file_path.open("r", encoding="utf-8") as f:
                data = json.load(f)
                if isinstance(data, list):
                    total_posts += len(data)
        except Exception:
            pass
    
    # Khá»Ÿi táº¡o tiáº¿n trÃ¬nh
    INFO_PROGRESS = {
        "is_running": True,
        "current": 0,
        "total": total_posts,
        "current_file": "",
    }
    
    all_results = {}
    has_data = False
    
    # Xá»­ lÃ½ tá»«ng file (má»—i file sáº½ tá»± Ä‘á»™ng extract profile_id tá»« tÃªn file)
    for file_path in json_files:
        try:
            _check_stop_pause(None)
        except RuntimeError as stp:
            print(f"ðŸ›‘ Dá»«ng toÃ n bá»™ do stop/pause: {stp}")
            break
        file_name = file_path.name
        INFO_PROGRESS["current_file"] = file_name
        try:
            results = process_post_ids_file(str(file_path))
            all_results[file_name] = results
            if results:
                has_data = True
        except ValueError as e:
            # Náº¿u file trá»‘ng thÃ¬ bá» qua vÃ  tiáº¿p tá»¥c vá»›i file khÃ¡c
            if "khÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t" in str(e):
                print(f"âš ï¸ {e}")
                all_results[file_name] = []
                continue
            raise
    
    # Kiá»ƒm tra náº¿u khÃ´ng cÃ³ file nÃ o cÃ³ dá»¯ liá»‡u
    if not has_data:
        INFO_PROGRESS["is_running"] = False
        raise ValueError("KhÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t Ä‘á»ƒ xá»­ lÃ½")
    
    # Káº¿t quáº£ Ä‘Ã£ Ä‘Æ°á»£c ghi vÃ o ALL_RESULTS_FILE trong quÃ¡ trÃ¬nh cháº¡y
    print("\n" + "="*70)
    print("âœ… HOÃ€N THÃ€NH Xá»¬ LÃ Táº¤T Cáº¢ POST IDs")
    print("="*70)
    print(f"ðŸ“Š Tá»•ng sá»‘ file Ä‘Ã£ xá»­ lÃ½: {len(json_files)}")
    print(f"ðŸ“Š Tá»•ng sá»‘ post Ä‘Ã£ xá»­ lÃ½: {ALL_RESULTS_DATA['total_posts_processed']}")
    print(f"ðŸ“Š Tá»•ng sá»‘ reactions: {ALL_RESULTS_DATA['total_reactions']}")
    print(f"ðŸ“Š Tá»•ng sá»‘ comments: {ALL_RESULTS_DATA['total_comments']}")
    print(f"ðŸ’¾ ÄÃ£ lÆ°u káº¿t quáº£ vÃ o: {ALL_RESULTS_FILE}")
    print("="*70)
    
    # Reset tiáº¿n trÃ¬nh
    INFO_PROGRESS["is_running"] = False
    INFO_PROGRESS["current"] = 0
    INFO_PROGRESS["total"] = 0
    INFO_PROGRESS["current_file"] = ""


def get_info_for_profile_ids(profile_ids):
    """
    Xá»­ lÃ½ chá»‰ cÃ¡c profile_id Ä‘Æ°á»£c chá»n (dá»±a vÃ o file tÃªn <profile_id>.json trong data/post_ids).
    
    Args:
        profile_ids (list[str]): Danh sÃ¡ch profile_id cáº§n xá»­ lÃ½
    
    Returns:
        dict: summary tÆ°Æ¡ng tá»± get_all_info_from_post_ids_dir nhÆ°ng chá»‰ cho profile Ä‘Ã£ chá»n
    """
    if not profile_ids:
        print("âš ï¸ KhÃ´ng cÃ³ profile_id nÃ o Ä‘Æ°á»£c cung cáº¥p.")
        return {}

    post_ids_path = Path(POST_IDS_DIR)
    if not post_ids_path.exists():
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y thÆ° má»¥c: {POST_IDS_DIR}")
        return {}

    # Chuáº©n hÃ³a vÃ  loáº¡i bá» trÃ¹ng
    target_ids = {str(pid).strip() for pid in profile_ids if str(pid).strip()}
    if not target_ids:
        print("âš ï¸ Danh sÃ¡ch profile_id sau khi lá»c rá»—ng.")
        return {}

    # Lá»c file theo profile_id
    json_files = []
    for pid in target_ids:
        candidate = post_ids_path / f"{pid}.json"
        if candidate.exists():
            json_files.append(candidate)
        else:
            print(f"âš ï¸ Bá» qua: khÃ´ng tÃ¬m tháº¥y file post_ids cho profile_id={pid} ({candidate})")

    if not json_files:
        print("âš ï¸ KhÃ´ng cÃ³ file JSON nÃ o khá»›p profile_id Ä‘Æ°á»£c chá»n.")
        INFO_PROGRESS["is_running"] = False
        raise ValueError("KhÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t Ä‘á»ƒ xá»­ lÃ½")

    print(f"ðŸ“ TÃ¬m tháº¥y {len(json_files)} file(s) JSON theo danh sÃ¡ch profile Ä‘Ã£ chá»n.")

    # TÃ­nh tá»•ng sá»‘ bÃ i trÆ°á»›c khi báº¯t Ä‘áº§u
    total_posts = 0
    for file_path in json_files:
        try:
            with file_path.open("r", encoding="utf-8") as f:
                data = json.load(f)
                if isinstance(data, list):
                    total_posts += len(data)
        except Exception:
            pass

    # Khá»Ÿi táº¡o tiáº¿n trÃ¬nh
    INFO_PROGRESS = {
        "is_running": True,
        "current": 0,
        "total": total_posts,
        "current_file": "",
    }

    all_results = {}
    has_data = False
    for file_path in json_files:
        try:
            _check_stop_pause(None)
        except RuntimeError as stp:
            print(f"ðŸ›‘ Dá»«ng do stop/pause: {stp}")
            break
        file_name = file_path.name
        INFO_PROGRESS["current_file"] = file_name
        try:
            results = process_post_ids_file(str(file_path))
            all_results[file_name] = results
            if results:
                has_data = True
        except ValueError as e:
            # Náº¿u file trá»‘ng thÃ¬ bá» qua vÃ  tiáº¿p tá»¥c vá»›i file khÃ¡c
            if "khÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t" in str(e):
                print(f"âš ï¸ {e}")
                all_results[file_name] = []
                continue
            raise
    
    # Kiá»ƒm tra náº¿u khÃ´ng cÃ³ file nÃ o cÃ³ dá»¯ liá»‡u
    if not has_data:
        INFO_PROGRESS["is_running"] = False
        raise ValueError("KhÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t Ä‘á»ƒ xá»­ lÃ½")

    # Káº¿t quáº£ Ä‘Ã£ Ä‘Æ°á»£c ghi vÃ o ALL_RESULTS_FILE trong quÃ¡ trÃ¬nh cháº¡y
    print("\n" + "="*70)
    print("âœ… HOÃ€N THÃ€NH Xá»¬ LÃ PROFILE ÄÃƒ CHá»ŒN")
    print("="*70)
    print(f"ðŸ“Š Tá»•ng sá»‘ file Ä‘Ã£ xá»­ lÃ½: {len(json_files)}")
    print(f"ðŸ“Š Tá»•ng sá»‘ post Ä‘Ã£ xá»­ lÃ½: {ALL_RESULTS_DATA['total_posts_processed']}")
    print(f"ðŸ“Š Tá»•ng sá»‘ reactions: {ALL_RESULTS_DATA['total_reactions']}")
    print(f"ðŸ“Š Tá»•ng sá»‘ comments: {ALL_RESULTS_DATA['total_comments']}")
    print(f"ðŸ’¾ ÄÃ£ lÆ°u káº¿t quáº£ vÃ o: {ALL_RESULTS_FILE}")
    print("="*70)

    # Reset tiáº¿n trÃ¬nh
    INFO_PROGRESS["is_running"] = False
    INFO_PROGRESS["current"] = 0
    INFO_PROGRESS["total"] = 0
    INFO_PROGRESS["current_file"] = ""

    return ALL_RESULTS_DATA


if __name__ == "__main__":
    get_all_info_from_post_ids_dir()

--- END FILE: backend\worker\get_all_info.py ---

--- START FILE: backend\worker\get_id.py ---
import requests
import json
import re
import codecs
from urllib.parse import urlencode, urlparse, parse_qs

# ====== LÆ¯U Ã ======
# Cookies vÃ  payload Ä‘Æ°á»£c láº¥y tá»« cookies.json vÃ  payload.txt thÃ´ng qua profile_id
# cookies.json cÃ³ cáº¥u trÃºc: {"profile_id": {"cookie": "...", "access_token": "..."}}
# Sá»­ dá»¥ng get_payload.get_payload_by_profile_id(profile_id) Ä‘á»ƒ láº¥y payload
# Sá»­ dá»¥ng get_payload.get_cookies_by_profile_id(profile_id) Ä‘á»ƒ láº¥y cookie


def _import_get_cookies_by_profile_id():
    """
    Há»— trá»£ cháº¡y Ä‘Æ°á»£c cáº£ 2 kiá»ƒu:
    - cháº¡y trá»±c tiáº¿p trong folder backend/worker (import get_payload)
    - cháº¡y qua module backend.worker.get_id (import backend.worker.get_payload)
    """
    try:
        from get_payload import get_cookies_by_profile_id  # type: ignore
        return get_cookies_by_profile_id
    except Exception:
        try:
            from backend.worker.get_payload import get_cookies_by_profile_id  # type: ignore
            return get_cookies_by_profile_id
        except Exception:
            # fallback (náº¿u sys.path Ä‘Ã£ append worker_path)
            from worker.get_payload import get_cookies_by_profile_id  # type: ignore
            return get_cookies_by_profile_id


# ================================
#   HÃ€M Gá»ŒI API Vá»šI URL VIDEO
# ================================
def get_post_id(video_url, profile_id, cookies=None):
    """
    Láº¥y post_id vÃ  owning_profile tá»« HTML source (view-source)
    Sá»­ dá»¥ng cookies Ä‘á»ƒ má»Ÿ nhÆ° trÃ¬nh duyá»‡t bÃ¬nh thÆ°á»ng
    
    Args:
        video_url (str): URL cá»§a video Facebook (vÃ­ dá»¥: "https://www.facebook.com/reel/1525194028720314/")
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y cookies
        cookies (str, optional): Cookie string (náº¿u Ä‘Ã£ cÃ³ sáºµn)
        
    Returns:
        tuple: (post_id, owning_profile_dict) hoáº·c (None, None) náº¿u khÃ´ng tÃ¬m tháº¥y
        owning_profile_dict: {"__typename": "...", "name": "...", "id": "..."} hoáº·c None
    """
    # Sá»­ dá»¥ng HTML source Ä‘á»ƒ láº¥y thÃ´ng tin (vá»›i cookies)
    post_id, owning_profile, post_text = get_post_id_from_html(video_url, profile_id, cookies)
    
    # Decode Unicode escape sequences trong owning_profile name náº¿u cÃ³
    if owning_profile and "name" in owning_profile:
        name = owning_profile['name']
        if isinstance(name, str) and '\\u' in name:
            try:
                name = json.loads(f'"{name}"')
                owning_profile['name'] = name
            except:
                try:
                    name = codecs.decode(name, 'unicode_escape')
                    owning_profile['name'] = name
                except:
                    pass
    
    return post_id, owning_profile, post_text


def get_post_id_from_html(url, profile_id, cookies=None):
    """
    Láº¥y post_id vÃ  owning_profile tá»« HTML source cá»§a trang (view-source)
    Sá»­ dá»¥ng cookies Ä‘á»ƒ má»Ÿ nhÆ° trÃ¬nh duyá»‡t bÃ¬nh thÆ°á»ng
    
    Args:
        url (str): URL cá»§a Facebook post
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y cookies
        cookies (str, optional): Cookie string (náº¿u Ä‘Ã£ cÃ³ sáºµn)
        
    Returns:
        tuple: (post_id, owning_profile_dict) hoáº·c (None, None) náº¿u khÃ´ng tÃ¬m tháº¥y
        owning_profile_dict: {"__typename": "...", "name": "...", "id": "..."} hoáº·c None
    """
    get_cookies_by_profile_id = _import_get_cookies_by_profile_id()
    
    # Láº¥y cookies náº¿u chÆ°a cÃ³
    if cookies is None:
        cookies = get_cookies_by_profile_id(profile_id)
        if not cookies:
            print(f"âŒ KhÃ´ng thá»ƒ láº¥y cookies tá»« profile_id: {profile_id}")
            return None, None
    
    try:
        # Táº¡o session Ä‘á»ƒ quáº£n lÃ½ cookies tá»‘t hÆ¡n (nhÆ° trÃ¬nh duyá»‡t)
        session = requests.Session()
        
        # Parse cookies string thÃ nh dict vÃ  thÃªm vÃ o session
        # Cookies string format: "name1=value1; name2=value2; ..."
        if cookies:
            cookies_dict = {}
            for cookie_pair in cookies.split(';'):
                cookie_pair = cookie_pair.strip()
                if '=' in cookie_pair:
                    key, value = cookie_pair.split('=', 1)
                    cookies_dict[key.strip()] = value.strip()
            session.cookies.update(cookies_dict)
        
        # Headers cho GET request (giá»‘ng trÃ¬nh duyá»‡t, CHá»ˆ gzip/deflate Ä‘á»ƒ trÃ¡nh lá»—i brotli trÃªn mÃ¡y thiáº¿u thÆ° viá»‡n)
        get_headers = {
            "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",
            "accept-encoding": "gzip, deflate",
            "accept-language": "en,vi;q=0.9,en-US;q=0.8",
            "referer": "https://www.facebook.com/",
            "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": '"Windows"',
            "sec-fetch-dest": "document",
            "sec-fetch-mode": "navigate",
            "sec-fetch-site": "same-origin",
            "upgrade-insecure-requests": "1",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
        }
        
        # Láº¥y HTML source trá»±c tiáº¿p (view-source) vá»›i cookies
        print(f"ðŸŒ Láº¥y HTML source (view-source) trá»±c tiáº¿p tá»«: {url}")
        response = session.get(url, headers=get_headers)
        
        print(f"ðŸ“Š Status Code: {response.status_code}")
        print(f"ðŸ“„ Response Length: {len(response.text)} characters")
        
        if response.status_code != 200:
            print(f"âŒ Status code khÃ´ng pháº£i 200: {response.status_code}")
            return None, None
        
        html_content = response.text
        print(f"âœ… ÄÃ£ láº¥y HTML content ({len(html_content)} kÃ½ tá»±)")
        
        # Debug: TÃ¬m cÃ¡c pattern cÃ³ thá»ƒ cÃ³ trong HTML
        # Facebook cÃ³ thá»ƒ escape hoáº·c encode khÃ¡c
        print(f"\nðŸ” Äang tÃ¬m kiáº¿m patterns...")
        
        # Thá»­ tÃ¬m post_id vá»›i nhiá»u pattern khÃ¡c nhau
        post_id = None
        
        # Pattern 1: "post_id":"123456789" (chuáº©n)
        match = re.search(r'"post_id"\s*:\s*"(\d+)"', html_content)
        if match:
            post_id = match.group(1)
            print(f"âœ… TÃ¬m tháº¥y post_id (pattern 1): {post_id}")
        else:
            # Pattern 2: "post_id":123456789 (khÃ´ng cÃ³ quotes)
            match = re.search(r'"post_id"\s*:\s*(\d+)', html_content)
            if match:
                post_id = match.group(1)
                print(f"âœ… TÃ¬m tháº¥y post_id (pattern 2): {post_id}")
            else:
                # Pattern 3: post_id":"123456789" (cÃ³ thá»ƒ escape)
                match = re.search(r'post_id["\']?\s*:\s*["\']?(\d+)', html_content)
                if match:
                    post_id = match.group(1)
                    print(f"âœ… TÃ¬m tháº¥y post_id (pattern 3): {post_id}")
                else:
                    # Pattern 4: TÃ¬m trong JSON structure
                    # CÃ³ thá»ƒ lÃ  JSON Ä‘Æ°á»£c embed trong HTML
                    json_matches = re.findall(r'["\']post_id["\']\s*:\s*["\']?(\d+)', html_content, re.IGNORECASE)
                    if json_matches:
                        post_id = json_matches[0]
                        print(f"âœ… TÃ¬m tháº¥y post_id (pattern 4 - JSON): {post_id}")
                    else:
                        print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y post_id vá»›i báº¥t ká»³ pattern nÃ o")
                        # Debug: TÃ¬m má»™t sá»‘ pattern khÃ¡c Ä‘á»ƒ xem HTML cÃ³ gÃ¬
                        if '"post_id"' in html_content:
                            print(f"   ðŸ” TÃ¬m tháº¥y chuá»—i 'post_id' trong HTML nhÆ°ng khÃ´ng match pattern")
                            # TÃ¬m context xung quanh
                            idx = html_content.find('"post_id"')
                            if idx != -1:
                                context = html_content[max(0, idx-50):min(len(html_content), idx+100)]
                                print(f"   ðŸ“‹ Context: {context[:150]}...")
                        else:
                            print(f"   ðŸ” KhÃ´ng tÃ¬m tháº¥y chuá»—i 'post_id' trong HTML")
        
        # ===== TÃŒM OWNING_PROFILE Äáº¦U TIÃŠN TRONG HTML =====
        # Pattern: "owning_profile":{"__typename":"User","name":"...","id":"..."}
        # CÃ³ thá»ƒ cÃ³ cÃ¡c field khÃ¡c nhÆ° "short_name" giá»¯a cÃ¡c field
        owning_profile = None
        
        # TÃ¬m owning_profile vá»›i nhiá»u pattern khÃ¡c nhau
        
        # Pattern 1: "owning_profile":{ (chuáº©n)
        pattern = r'"owning_profile"\s*:\s*\{'
        match = re.search(pattern, html_content)
        
        if match:
            print(f"âœ… TÃ¬m tháº¥y 'owning_profile':{{ táº¡i vá»‹ trÃ­ {match.start()}")
            start_pos = match.end()
            
            # TÃ¬m closing brace tÆ°Æ¡ng á»©ng (balanced braces)
            brace_count = 1
            end_pos = start_pos
            while end_pos < len(html_content) and brace_count > 0:
                if html_content[end_pos] == '{':
                    brace_count += 1
                elif html_content[end_pos] == '}':
                    brace_count -= 1
                end_pos += 1
            
            if brace_count == 0:
                # Láº¥y ná»™i dung bÃªn trong braces
                block_content = html_content[start_pos:end_pos-1]
                print(f"   ðŸ“‹ Block content length: {len(block_content)} characters")
                
                # TÃ¬m cÃ¡c field trong block nÃ y
                owning_profile_data = {}
                
                # TÃ¬m __typename
                typename_match = re.search(r'"__typename"\s*:\s*"([^"]+)"', block_content)
                if typename_match:
                    owning_profile_data["__typename"] = typename_match.group(1)
                    print(f"   âœ… TÃ¬m tháº¥y __typename: {typename_match.group(1)}")
                
                # TÃ¬m name
                name_match = re.search(r'"name"\s*:\s*"([^"]+)"', block_content)
                if name_match:
                    owning_profile_data["name"] = name_match.group(1)
                    print(f"   âœ… TÃ¬m tháº¥y name: {name_match.group(1)[:50]}...")
                
                # TÃ¬m id
                id_match = re.search(r'"id"\s*:\s*"([^"]+)"', block_content)
                if id_match:
                    owning_profile_data["id"] = id_match.group(1)
                    print(f"   âœ… TÃ¬m tháº¥y id: {id_match.group(1)}")
                
                # Chá»‰ láº¥y náº¿u cÃ³ Ä‘á»§ Ã­t nháº¥t 2 trong 3 fields (__typename, name, id)
                if len(owning_profile_data) >= 2:
                    owning_profile = owning_profile_data
                    print(f"âœ… ÄÃ£ extract owning_profile thÃ nh cÃ´ng")
                else:
                    print(f"âš ï¸ KhÃ´ng Ä‘á»§ fields trong owning_profile (chá»‰ cÃ³ {len(owning_profile_data)} fields)")
            else:
                print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y closing brace tÆ°Æ¡ng á»©ng (brace_count: {brace_count})")
        else:
            print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y pattern 'owning_profile':{{")
            # Debug: Kiá»ƒm tra xem cÃ³ chuá»—i owning_profile khÃ´ng
            if '"owning_profile"' in html_content or "'owning_profile'" in html_content:
                print(f"   ðŸ” TÃ¬m tháº¥y chuá»—i 'owning_profile' trong HTML nhÆ°ng khÃ´ng match pattern")
                # TÃ¬m context xung quanh
                idx = html_content.find('owning_profile')
                if idx != -1:
                    context = html_content[max(0, idx-50):min(len(html_content), idx+200)]
                    print(f"   ðŸ“‹ Context: {context[:200]}...")
            else:
                print(f"   ðŸ” KhÃ´ng tÃ¬m tháº¥y chuá»—i 'owning_profile' trong HTML")
                # CÃ³ thá»ƒ HTML Ä‘Æ°á»£c minify, thá»­ tÃ¬m trong JSON blocks
                # Facebook thÆ°á»ng embed JSON trong script tags
                script_tags = re.findall(r'<script[^>]*>(.*?)</script>', html_content, re.DOTALL)
                print(f"   ðŸ” TÃ¬m tháº¥y {len(script_tags)} script tags, Ä‘ang tÃ¬m trong Ä‘Ã³...")
                for i, script_content in enumerate(script_tags[:5]):  # Chá»‰ check 5 script Ä‘áº§u tiÃªn
                    if 'owning_profile' in script_content:
                        print(f"   âœ… TÃ¬m tháº¥y 'owning_profile' trong script tag #{i+1}")
                        # TÃ¬m trong script nÃ y
                        match = re.search(r'"owning_profile"\s*:\s*\{', script_content)
                        if match:
                            print(f"      âœ… Match pattern trong script tag!")
                            # Extract tá»« script content
                            start_pos = match.end()
                            brace_count = 1
                            end_pos = start_pos
                            while end_pos < len(script_content) and brace_count > 0:
                                if script_content[end_pos] == '{':
                                    brace_count += 1
                                elif script_content[end_pos] == '}':
                                    brace_count -= 1
                                end_pos += 1
                            
                            if brace_count == 0:
                                block_content = script_content[start_pos:end_pos-1]
                                owning_profile_data = {}
                                
                                typename_match = re.search(r'"__typename"\s*:\s*"([^"]+)"', block_content)
                                if typename_match:
                                    owning_profile_data["__typename"] = typename_match.group(1)
                                
                                name_match = re.search(r'"name"\s*:\s*"([^"]+)"', block_content)
                                if name_match:
                                    owning_profile_data["name"] = name_match.group(1)
                                
                                id_match = re.search(r'"id"\s*:\s*"([^"]+)"', block_content)
                                if id_match:
                                    owning_profile_data["id"] = id_match.group(1)
                                
                                if len(owning_profile_data) >= 2:
                                    owning_profile = owning_profile_data
                                    print(f"      âœ… ÄÃ£ extract owning_profile tá»« script tag!")
                                    break
        
        # Decode Unicode escape sequences trong owning_profile name náº¿u cÃ³
        if owning_profile and "name" in owning_profile:
            name = owning_profile['name']
            if isinstance(name, str) and '\\u' in name:
                try:
                    name = json.loads(f'"{name}"')
                    owning_profile['name'] = name
                except:
                    try:
                        name = codecs.decode(name, 'unicode_escape')
                        owning_profile['name'] = name
                    except:
                        pass

        # ===== Láº¤Y Ná»˜I DUNG BÃ€I POST =====
        post_text = None

        # Æ¯u tiÃªn láº¥y ná»™i dung trong block story_message (ná»™i dung bÃ i post)
        content_html = None

        story_match = re.search(
            r'data-ad-rendering-role="story_message"[^>]*>(.*?)</div></div></div>',
            html_content,
            re.DOTALL,
        )
        if story_match:
            content_html = story_match.group(1)
            print("âœ… TÃ¬m tháº¥y block story_message Ä‘á»ƒ trÃ­ch ná»™i dung bÃ i post")
        else:
            # Fallback: dÃ¹ng má»™t pháº§n Ä‘áº§u HTML
            content_html = html_content[:500_000]
            print("âš ï¸ KhÃ´ng tÃ¬m tháº¥y block story_message, dÃ¹ng fallback (500KB Ä‘áº§u HTML)")

        # Thay <img ... alt="..."> báº±ng chÃ­nh alt (Ä‘á»ƒ giá»¯ emoji/text)
        def _img_alt_to_text(m):
            alt_text = m.group(1) or ""
            return f" {alt_text} "

        content_html = re.sub(
            r'<img[^>]*alt="([^"]*)"[^>]*>',
            _img_alt_to_text,
            content_html,
            flags=re.IGNORECASE,
        )

        # Bá» toÃ n bá»™ tag HTML cÃ²n láº¡i
        text_raw = re.sub(r"<[^>]*>", " ", content_html)
        # Chuáº©n hÃ³a khoáº£ng tráº¯ng
        text_clean = re.sub(r"\s+", " ", text_raw).strip()

        if text_clean:
            post_text = text_clean
            preview = post_text[:400] + "..." if len(post_text) > 400 else post_text
            print(f"âœ… Post text (preview): {preview}")
        else:
            print("âš ï¸ KhÃ´ng trÃ­ch Ä‘Æ°á»£c ná»™i dung bÃ i post tá»« HTML")

        return post_id, owning_profile, post_text
            
    except Exception as e:
        print(f"âŒ Lá»—i khi láº¥y HTML source: {e}")
        import traceback
        traceback.print_exc()
        return None, None


def get_page_id_from_html(url, profile_id, cookies=None):
    """
    Láº¥y page_id tá»« HTML source cá»§a trang (view-source)
    Sá»­ dá»¥ng cookies Ä‘á»ƒ má»Ÿ nhÆ° trÃ¬nh duyá»‡t bÃ¬nh thÆ°á»ng
    
    Args:
        url (str): URL cá»§a Facebook page/group
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y cookies
        cookies (str, optional): Cookie string (náº¿u Ä‘Ã£ cÃ³ sáºµn)
        
    Returns:
        str: page_id Ä‘áº§u tiÃªn tÃ¬m tháº¥y hoáº·c None
    """
    get_cookies_by_profile_id = _import_get_cookies_by_profile_id()

    # âœ… Æ¯u tiÃªn tuyá»‡t Ä‘á»‘i: náº¿u URL Ä‘Ã£ cÃ³ numeric group_id thÃ¬ tráº£ vá» luÃ´n (á»•n Ä‘á»‹nh nháº¥t)
    try:
        m_url = re.search(r"/groups/(\d+)", str(url or ""))
        if m_url:
            return m_url.group(1)
    except Exception:
        pass
    
    # Láº¥y cookies náº¿u chÆ°a cÃ³
    if cookies is None:
        cookies = get_cookies_by_profile_id(profile_id)
        if not cookies:
            print(f"âŒ KhÃ´ng thá»ƒ láº¥y cookies tá»« profile_id: {profile_id}")
            return None
    
    try:
        # Táº¡o session Ä‘á»ƒ quáº£n lÃ½ cookies tá»‘t hÆ¡n (nhÆ° trÃ¬nh duyá»‡t)
        session = requests.Session()
        
        # Parse cookies string thÃ nh dict vÃ  thÃªm vÃ o session
        if cookies:
            cookies_dict = {}
            for cookie_pair in cookies.split(';'):
                cookie_pair = cookie_pair.strip()
                if '=' in cookie_pair:
                    key, value = cookie_pair.split('=', 1)
                    cookies_dict[key.strip()] = value.strip()
            session.cookies.update(cookies_dict)
        
        # Headers cho GET request (giá»‘ng trÃ¬nh duyá»‡t, CHá»ˆ gzip/deflate Ä‘á»ƒ trÃ¡nh lá»—i brotli trÃªn mÃ¡y thiáº¿u thÆ° viá»‡n)
        get_headers = {
            "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",
            "accept-encoding": "gzip, deflate",
            "accept-language": "en,vi;q=0.9,en-US;q=0.8",
            "referer": "https://www.facebook.com/",
            "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": '"Windows"',
            "sec-fetch-dest": "document",
            "sec-fetch-mode": "navigate",
            "sec-fetch-site": "same-origin",
            "upgrade-insecure-requests": "1",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
        }
        
        # Láº¥y HTML source trá»±c tiáº¿p (view-source) vá»›i cookies
        print(f"ðŸŒ Láº¥y HTML source (view-source) trá»±c tiáº¿p tá»«: {url}")
        response = session.get(url, headers=get_headers)
        
        if response.status_code != 200:
            return None

        # âœ… Náº¿u Facebook redirect sang URL cÃ³ /groups/<id> thÃ¬ Æ°u tiÃªn láº¥y luÃ´n tá»« response.url
        try:
            m_final = re.search(r"/groups/(\d+)", str(getattr(response, "url", "") or ""))
            if m_final:
                return m_final.group(1)
        except Exception:
            pass
        
        html_content = response.text
        
        # ===== Æ¯U TIÃŠN Láº¤Y "GROUP ID" (trÃ¡nh nháº·t nháº§m page_id khÃ¡c trong HTML) =====
        # 1) CÃ¡c pattern ráº¥t Ä‘áº·c hiá»‡u cho group
        group_specific_patterns = [
            # page_id_type = group (Æ°u tiÃªn)
            r'"page_id"\s*:\s*"(\d+)"\s*,\s*"page_id_type"\s*:\s*"group"',
            r'"page_id_type"\s*:\s*"group"\s*,\s*"page_id"\s*:\s*"(\d+)"',
            # groupID/group_id
            r'"groupID"\s*:\s*"(\d+)"',
            r'"group_id"\s*:\s*"(\d+)"',
        ]
        for pat in group_specific_patterns:
            m = re.search(pat, html_content, flags=re.IGNORECASE)
            if m:
                return m.group(1)

        # 2) Náº¿u HTML cÃ³ /groups/<id> thÃ¬ Æ°u tiÃªn ID xuáº¥t hiá»‡n nhiá»u nháº¥t (trÃ¡nh dÃ­nh 1 ID cá»‘ Ä‘á»‹nh á»Ÿ header)
        try:
            group_ids = re.findall(r"/groups/(\d+)", html_content, flags=re.IGNORECASE)
            if group_ids:
                # chá»n ID phá»• biáº¿n nháº¥t
                freq: dict[str, int] = {}
                for gid in group_ids:
                    freq[gid] = freq.get(gid, 0) + 1
                group_ids_sorted = sorted(freq.items(), key=lambda x: x[1], reverse=True)
                return group_ids_sorted[0][0]
        except Exception:
            pass

        # 3) Fallback cuá»‘i: tÃ¬m page_id nhÆ°ng chá»n cÃ¡i cÃ³ táº§n suáº¥t cao nháº¥t (Ä‘á»¡ nháº·t "cÃ¡i Ä‘áº§u tiÃªn")
        try:
            candidates: list[str] = []
            for pat in [
                r'"page_id"\s*:\s*"(\d+)"',
                r'page_id["\']\s*:\s*["\'](\d+)',
                r'page_id=(\d+)',
                r'data-page-id="(\d+)"',
                r'"pageID"\s*:\s*"(\d+)"',
            ]:
                candidates.extend(re.findall(pat, html_content, flags=re.IGNORECASE) or [])
            if candidates:
                freq2: dict[str, int] = {}
                for cid in candidates:
                    freq2[cid] = freq2.get(cid, 0) + 1
                cand_sorted = sorted(freq2.items(), key=lambda x: x[1], reverse=True)
                return cand_sorted[0][0]
        except Exception:
            pass

        return None
            
    except Exception:
        return None


def get_id_from_url(url, profile_id):
    """
    HÃ m tá»•ng há»£p tá»± Ä‘á»™ng phÃ¡t hiá»‡n loáº¡i URL vÃ  láº¥y page_id hoáº·c post_id tÆ°Æ¡ng á»©ng
    Sá»­ dá»¥ng HTML source (view-source) vá»›i cookies Ä‘á»ƒ má»Ÿ nhÆ° trÃ¬nh duyá»‡t bÃ¬nh thÆ°á»ng
    
    Logic:
    - Náº¿u URL chá»©a "group" â†’ lÃ  group (chá»‰ láº¥y page_id)
    - CÃ²n láº¡i táº¥t cáº£ â†’ lÃ  post (láº¥y post_id vÃ  owning_profile)
    
    Args:
        url (str): URL cá»§a Facebook (cÃ³ thá»ƒ lÃ  group hoáº·c post)
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y cookies
        
    Returns:
        dict: {
            "page_id": str hoáº·c None,
            "post_id": str hoáº·c None,
            "owning_profile": dict hoáº·c None,
            "url_type": str ("group" hoáº·c "post")
        }
    """
    get_cookies_by_profile_id = _import_get_cookies_by_profile_id()
    
    # Load cookies má»™t láº§n duy nháº¥t
    cookies = get_cookies_by_profile_id(profile_id)
    
    if not cookies:
        print(f"âŒ KhÃ´ng thá»ƒ láº¥y cookies tá»« profile_id: {profile_id}")
        return {
            "page_id": None,
            "post_id": None,
            "owning_profile": None,
            "url_type": "post"
        }
    
    url_lower = url.lower()
    result = {
        "page_id": None,
        "post_id": None,
        "owning_profile": None,
        "url_type": "post"  # Máº·c Ä‘á»‹nh lÃ  post
    }
    
    # PhÃ¡t hiá»‡n loáº¡i URL: náº¿u cÃ³ "group" trong URL â†’ lÃ  group
    if "group" in url_lower:
        result["url_type"] = "group"
        page_id = get_page_id_from_html(url, profile_id, cookies)
        result["page_id"] = page_id
        if page_id:
            print(f"page_id: {page_id}")
        return result
    else:
        # Táº¥t cáº£ cÃ¡c URL khÃ¡c Ä‘á»u lÃ  post
        result["url_type"] = "post"
        
        # Láº¥y post_id, owning_profile vÃ  post_text tá»« HTML source (vá»›i cookies)
        post_id, owning_profile, post_text = get_post_id(url, profile_id, cookies)
        
        result["post_id"] = post_id
        result["owning_profile"] = owning_profile
        result["post_text"] = post_text
        
        # In káº¿t quáº£ cuá»‘i cÃ¹ng
        if post_id:
            print(f"post_id: {post_id}")
        
        if owning_profile:
            owning_profile_typename = owning_profile.get("__typename")
            owning_profile_name = owning_profile.get("name")
            owning_profile_id = owning_profile.get("id")
            
            if owning_profile_typename:
                print(f"owning_profile.__typename: {owning_profile_typename}")
            if owning_profile_name:
                print(f"owning_profile.name: {owning_profile_name}")
            if owning_profile_id:
                print(f"owning_profile.id: {owning_profile_id}")

        if post_text:
            preview = post_text[:200] + "..." if len(post_text) > 200 else post_text
            print(f"post_text: {preview}")
        
        return result


if __name__ == "__main__":
    # VÃ­ dá»¥ sá»­ dá»¥ng hÃ m get_id_from_url (tá»•ng há»£p)
    profile_id = "621e1f5d-0c42-481e-9ddd-7abaafce68ed"
    
    # Test vá»›i group URL
    # group_url = "https://www.facebook.com/groups/987870664956102/"
    # result = get_id_from_url(group_url, profile_id)
    
    # Test vá»›i video/post URL
    url = "https://www.facebook.com/share/p/18AKfiXuZM/"
    result = get_id_from_url(url, profile_id)
    print("heLLO" ,result)
--- END FILE: backend\worker\get_id.py ---

--- START FILE: backend\worker\get_payload.py ---
import requests
import re
import json
import time
from urllib.parse import parse_qs, unquote_plus
from pathlib import Path

# ====== ÄÆ¯á»œNG DáºªN THEO PROJECT ROOT ======
from core.paths import get_config_dir, get_settings_path
SETTINGS_JSON_FILE = get_settings_path()  # backend/config/settings.json
PAYLOAD_TXT_FILE = get_config_dir() / "payload.txt"


def _normalize_cookie(cookie: str | None) -> str | None:
    if cookie is None:
        return None
    cookie = str(cookie).strip()
    if not cookie:
        return None
    # Loáº¡i bá» kÃ½ tá»± xuá»‘ng dÃ²ng vÃ  khoáº£ng tráº¯ng thá»«a
    return " ".join(cookie.split())


def _read_settings_profile_config(profile_id: str) -> dict | None:
    """
    Äá»c PROFILE_IDS[profile_id] tá»« backend/config/settings.json.
    Tráº£ vá» dict config hoáº·c None náº¿u khÃ´ng cÃ³.
    """
    try:
        if not SETTINGS_JSON_FILE.exists():
            return None
        with SETTINGS_JSON_FILE.open("r", encoding="utf-8") as f:
            raw = json.load(f)
        profiles = raw.get("PROFILE_IDS")
        if not isinstance(profiles, dict):
            return None
        cfg = profiles.get(profile_id)
        return cfg if isinstance(cfg, dict) else None
    except Exception:
        return None


def get_cookies_by_profile_id(profile_id):
    """
    Láº¥y cookies theo profile_id.

    Æ¯u tiÃªn Ä‘á»c tá»« backend/config/settings.json:
      PROFILE_IDS[profile_id].cookie
    
    Args:
        profile_id (str): Profile ID (vÃ­ dá»¥: "031ca13d-e8fa-400c-a603-df57a2806788")
    
    Returns:
        str: Cookie string hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    # 1) Æ¯U TIÃŠN: settings.json
    cfg = _read_settings_profile_config(profile_id)
    if cfg is not None:
        cookie = _normalize_cookie(cfg.get("cookie"))
        if cookie:
            return cookie

    print(f"âŒ KhÃ´ng tÃ¬m tháº¥y cookie trong {SETTINGS_JSON_FILE} cho profile_id='{profile_id}'")
    return None


def get_access_token_by_profile_id(profile_id):
    """
    Láº¥y access_token theo profile_id.

    Æ¯u tiÃªn Ä‘á»c tá»« backend/config/settings.json:
      PROFILE_IDS[profile_id].access_token
    
    Args:
        profile_id (str): Profile ID (vÃ­ dá»¥: "031ca13d-e8fa-400c-a603-df57a2806788")
    
    Returns:
        str: Access token hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    # 1) Æ¯U TIÃŠN: settings.json
    cfg = _read_settings_profile_config(profile_id)
    if cfg is not None:
        access_token = str(cfg.get("access_token") or "").strip()
        if access_token:
            return access_token

    print(f"âŒ KhÃ´ng tÃ¬m tháº¥y access_token trong {SETTINGS_JSON_FILE} cho profile_id='{profile_id}'")
    return None


def get_base_headers(cookie):
    """
    Táº¡o headers vá»›i cookie Ä‘Æ°á»£c truyá»n vÃ o
    
    Args:
        cookie (str): Cookie string
    
    Returns:
        dict: Headers dictionary
    """
    return {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",
        "accept-encoding": "gzip, deflate",
        "accept-language": "en,vi;q=0.9,en-US;q=0.8",
        "cookie": cookie,
        "referer": "https://www.facebook.com/",
        "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": '"Windows"',
        "sec-fetch-dest": "document",
        "sec-fetch-mode": "navigate",
        "sec-fetch-site": "same-origin",
        "upgrade-insecure-requests": "1",
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
    }


def get_c_user(cookie):
    """
    Láº¥y c_user tá»« cookie
    
    Args:
        cookie (str): Cookie string
    
    Returns:
        str: GiÃ¡ trá»‹ c_user hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    try:
        match = re.search(r'c_user=(\d+)', cookie)
        if match:
            return match.group(1)
        return None
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi láº¥y c_user: {e}")
        return None


def get_jazoest(fb_dtsg):
    """
    TÃ­nh jazoest tá»« fb_dtsg
    
    Args:
        fb_dtsg (str): GiÃ¡ trá»‹ fb_dtsg
    
    Returns:
        str: GiÃ¡ trá»‹ jazoest
    """
    if not fb_dtsg:
        return None
    jazoest = str(sum(ord(c) for c in fb_dtsg))
    return jazoest


def get_lsd(html):
    """
    Láº¥y lsd tá»« HTML
    
    Args:
        html (str): HTML content
    
    Returns:
        str: GiÃ¡ trá»‹ lsd hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    try:
        match = re.search(r'"LSD",\[\],{"token":"(.*?)"}', html)
        if match:
            return match.group(1)
        return None
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi láº¥y lsd: {e}")
        return None


def get_spin_r(html):
    """
    Láº¥y __spin_r tá»« HTML
    
    Args:
        html (str): HTML content
    
    Returns:
        str: GiÃ¡ trá»‹ __spin_r hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    try:
        match = re.search(r'"__spin_r":(\d+)', html)
        if match:
            return match.group(1)
        return None
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi láº¥y __spin_r: {e}")
        return None


def get_spin_t(html):
    """
    Láº¥y __spin_t tá»« HTML
    
    Args:
        html (str): HTML content
    
    Returns:
        str: GiÃ¡ trá»‹ __spin_t hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    try:
        match = re.search(r'"__spin_t":(\d+)', html)
        if match:
            return match.group(1)
        return None
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi láº¥y __spin_t: {e}")
        return None


def get_fb_dtsg(cookie, profile_id: str | None = None, return_page_source: bool = False):
    """
    Láº¥y fb_dtsg tá»« Facebook.com
    
    Args:
        cookie (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng
    
    Returns:
        str: GiÃ¡ trá»‹ fb_dtsg hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    url = "https://www.facebook.com"

    print(f"\nðŸš€ Báº¯t Ä‘áº§u headless capture tá»«: {url} (CHá»ˆ DÃ™NG Selenium/WebDriver)")

    # First: if profile_id provided, try reading fb_dtsg from settings.json
    try:
        if profile_id:
            cfg = _read_settings_profile_config(profile_id)
            if isinstance(cfg, dict):
                fb_from_cfg = cfg.get("fb_dtsg") or cfg.get("fb_dtsg_token") or cfg.get("fb_dtsg_value")
                if fb_from_cfg:
                    fb_from_cfg = str(fb_from_cfg).strip()
                    if fb_from_cfg:
                        print(f"â„¹ï¸ Láº¥y fb_dtsg tá»« {SETTINGS_JSON_FILE} cho profile_id={profile_id}")
                        if return_page_source:
                            return fb_from_cfg, ""
                        return fb_from_cfg
    except Exception:
        pass

    # Require Selenium + webdriver-manager; fail loudly if unavailable
    try:
        from selenium import webdriver
        from selenium.webdriver.chrome.options import Options
        from selenium.webdriver.chrome.service import Service
        from selenium.common.exceptions import WebDriverException
        from webdriver_manager.chrome import ChromeDriverManager
    except Exception as e:
        print(f"âŒ Selenium or webdriver_manager not available: {e}")
        return None

    options = Options()
    options.add_argument("--headless")
    options.add_argument("--disable-gpu")
    options.add_argument("--no-sandbox")
    options.add_argument("--disable-dev-shm-usage")
    options.add_argument("--window-size=1200,800")
    options.set_capability("goog:loggingPrefs", {"performance": "ALL"})

    try:
        service = Service(ChromeDriverManager().install())
        driver = webdriver.Chrome(service=service, options=options)
    except WebDriverException as e:
        print(f"âŒ KhÃ´ng thá»ƒ khá»Ÿi táº¡o Chrome WebDriver: {e}")
        return None
    except Exception as e:
        print(f"âŒ Lá»—i khi cÃ i/cháº¡y ChromeDriver: {e}")
        return None

    try:
        try:
            driver.execute_cdp_cmd("Network.enable", {})
            driver.execute_cdp_cmd("Network.setExtraHTTPHeaders", {"headers": {"cookie": cookie}})
        except Exception:
            pass

        driver.get(url)
        time.sleep(3)

        fb_dtsg = None
        try:
            logs = driver.get_log("performance")
        except Exception:
            logs = []

        for entry in logs:
            try:
                msg = json.loads(entry.get("message", "{}")).get("message", {})
                method = msg.get("method", "")
                params = msg.get("params", {}) or {}
                if method in ("Network.requestWillBeSent", "Network.responseReceived"):
                    req = params.get("request") or params.get("response") or {}
                    url_req = req.get("url") or ""
                    if "api/graphql" in url_req:
                        postData = req.get("postData") or params.get("request", {}).get("postData", "") or ""
                        if postData:
                            m = re.search(r'fb_dtsg["\\\']?\\s*[:=]\\s*["\\\']([^"\\\']+)', postData)
                            if not m:
                                m = re.search(r'fb_dtsg=([^&"\\\']+)', postData)
                            if m:
                                fb_dtsg = m.group(1)
                                print(f"âœ… Báº¯t Ä‘Æ°á»£c fb_dtsg tá»« graphql postData: {fb_dtsg[:50]}...")
                                break
            except Exception:
                continue

        if not fb_dtsg:
            # last resort: search in rendered page source (still within headless mode)
            html_content = driver.page_source or ""
            patterns = [
                r'"name":"fb_dtsg","value":"([^"]+)"',
                r'"token":"([^"]+)","type":"fb_dtsg"',
                r'"fb_dtsg"\\s*:\\s*"([^"]+)"',
                r'name="fb_dtsg"\\s+value="([^"]+)"',
                r'DTSGInitData.*?"token":"([^"]+)"'
            ]
            for i, pattern in enumerate(patterns, 1):
                match = re.search(pattern, html_content)
                if match:
                    fb_dtsg = match.group(1)
                    print(f"âœ… TÃ¬m tháº¥y fb_dtsg trong page_source vá»›i pattern {i}: {fb_dtsg[:50]}...")
                    break

        if return_page_source:
            try:
                page_source = driver.page_source or ""
            except Exception:
                page_source = ""
            return fb_dtsg, page_source
        return fb_dtsg
    finally:
        try:
            driver.quit()
        except Exception:
            pass


def capture_graphql_post_payloads(cookie, timeout: int = 6, first_only: bool = True):
    """
    DÃ¹ng headless Chrome (CDP performance logs) Ä‘á»ƒ báº¯t cÃ¡c request POST tá»›i /api/graphql/
    Tráº£ vá» danh sÃ¡ch dict chá»©a: url, request_id, post_data (raw string), parsed (dict)
    Chá»‰ tráº£ cÃ¡c request cÃ³ response status == 200.
    """
    url = "https://www.facebook.com"

    try:
        from selenium import webdriver
        from selenium.webdriver.chrome.options import Options
        from selenium.webdriver.chrome.service import Service
        from selenium.common.exceptions import WebDriverException
        from webdriver_manager.chrome import ChromeDriverManager
    except Exception as e:
        print(f"âŒ Selenium/webdriver_manager unavailable: {e}")
        return []

    options = Options()
    options.add_argument("--headless")
    options.add_argument("--disable-gpu")
    options.add_argument("--no-sandbox")
    options.add_argument("--disable-dev-shm-usage")
    options.add_argument("--window-size=1200,800")
    options.set_capability("goog:loggingPrefs", {"performance": "ALL"})

    try:
        service = Service(ChromeDriverManager().install())
        driver = webdriver.Chrome(service=service, options=options)
    except Exception as e:
        print(f"âŒ Cannot start ChromeDriver: {e}")
        return []

    try:
        try:
            driver.execute_cdp_cmd("Network.enable", {})
            driver.execute_cdp_cmd("Network.setExtraHTTPHeaders", {"headers": {"cookie": cookie}})
        except Exception:
            pass

        driver.get(url)
        # allow network activity
        time.sleep(max(2, timeout))

        try:
            logs = driver.get_log("performance")
        except Exception:
            logs = []

        requests_map = {}
        responses_map = {}

        for entry in logs:
            try:
                msg = json.loads(entry.get("message", "{}")).get("message", {})
                method = msg.get("method", "")
                params = msg.get("params", {}) or {}
                request_id = params.get("requestId")

                if method == "Network.requestWillBeSent":
                    req = params.get("request", {}) or {}
                    url_req = req.get("url", "")
                    meth = req.get("method", "").upper()
                    if "/api/graphql" in url_req and meth == "POST":
                        requests_map[request_id] = {
                            "url": url_req,
                            "postData": req.get("postData", ""),
                            "headers": req.get("headers", {})
                        }

                elif method == "Network.responseReceived":
                    resp = params.get("response", {}) or {}
                    status = resp.get("status")
                    responses_map[request_id] = status
            except Exception:
                continue

        results = []
        for req_id, req_info in requests_map.items():
            status = responses_map.get(req_id)
            if status != 200:
                continue
            raw_post = req_info.get("postData", "") or ""
            # postData may be urlencoded form; parse it
            parsed_qs = parse_qs(raw_post, keep_blank_values=True)
            # flatten values to single string
            parsed = {k: (v[0] if isinstance(v, list) and len(v) > 0 else "") for k, v in parsed_qs.items()}
            # also decode pluses for safety
            parsed = {k: unquote_plus(v) if isinstance(v, str) else v for k, v in parsed.items()}

            results.append({
                "request_id": req_id,
                "url": req_info.get("url"),
                "raw_post_data": raw_post,
                "parsed": parsed,
                "status": status,
                "headers": req_info.get("headers", {})
            })

            if first_only and results:
                break

        if not results:
            print("âš ï¸ KhÃ´ng báº¯t Ä‘Æ°á»£c POST /api/graphql/ vá»›i status 200 trong khoáº£ng thá»i gian nÃ y.")
        else:
            print(f"âœ… Báº¯t Ä‘Æ°á»£c {len(results)} POST /api/graphql/ (status=200).")

        return results
    finally:
        try:
            driver.quit()
        except Exception:
            pass


def get_all_payload_values(cookie, profile_id: str | None = None):
    """
    Láº¥y táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ payload tá»« Facebook.com
    
    Args:
        cookie (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng
    
    Returns:
        dict: Dictionary chá»©a c_user, av, __user, fb_dtsg, jazoest, lsd, spin_r, spin_t hoáº·c None náº¿u lá»—i
    """
    # CHá»ˆ DÃ™NG HEADLESS SELENIUM: khÃ´ng cÃ²n fallback báº±ng requests.get
    try:
        # Láº¥y c_user tá»« cookie (tá»« cookie string)
        c_user = get_c_user(cookie)
        if c_user:
            print(f"âœ… TÃ¬m tháº¥y c_user: {c_user}")
        else:
            print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y c_user trong cookie")

        # Try to get fb_dtsg from settings.json first (if profile_id provided)
        fb_from_cfg = None
        if profile_id:
            try:
                cfg = _read_settings_profile_config(profile_id)
                if isinstance(cfg, dict):
                    fb_from_cfg = cfg.get("fb_dtsg") or cfg.get("fb_dtsg_token") or cfg.get("fb_dtsg_value")
                    if fb_from_cfg:
                        fb_from_cfg = str(fb_from_cfg).strip()
            except Exception:
                fb_from_cfg = None

        fb_dtsg = None
        html_content = ""
        payload = {}

        # If fb_dtsg not present in settings, capture graphql POST payload to extract it and other values.
        if not fb_from_cfg:
            parsed_post = capture_graphql_post_payload(cookie, timeout=5)
            if not parsed_post:
                print("âŒ KhÃ´ng tÃ¬m tháº¥y POST /api/graphql hoáº·c khÃ´ng parse Ä‘Æ°á»£c payload")
                return None
            payload = parsed_post  # dict of string->string
            fb_dtsg = payload.get("fb_dtsg") or payload.get("fb_dtsg_token") or None
            if fb_dtsg:
                print(f"âœ… fb_dtsg tá»« payload: {fb_dtsg[:30]}...")
                # Persist fb_dtsg into settings.json for this profile_id if provided
                if profile_id:
                    try:
                        if SETTINGS_JSON_FILE.exists():
                            with SETTINGS_JSON_FILE.open("r", encoding="utf-8") as sf:
                                sdata = json.load(sf)
                        else:
                            sdata = {}
                        profiles = sdata.get("PROFILE_IDS") or {}
                        if not isinstance(profiles, dict):
                            profiles = {}
                        profile_cfg = profiles.get(profile_id) or {}
                        if not isinstance(profile_cfg, dict):
                            profile_cfg = {}
                        profile_cfg["fb_dtsg"] = fb_dtsg
                        profiles[profile_id] = profile_cfg
                        sdata["PROFILE_IDS"] = profiles
                        with SETTINGS_JSON_FILE.open("w", encoding="utf-8") as sf:
                            json.dump(sdata, sf, ensure_ascii=False, indent=2)
                        print(f"âœ… ÄÃ£ ghi fb_dtsg vÃ o {SETTINGS_JSON_FILE} cho profile_id={profile_id}")
                    except Exception as e:
                        print(f"âš ï¸ KhÃ´ng thá»ƒ ghi fb_dtsg vÃ o settings.json: {e}")
        else:
            fb_dtsg = fb_from_cfg
            payload = {}
            print(f"â„¹ï¸ Sá»­ dá»¥ng fb_dtsg tá»« {SETTINGS_JSON_FILE} cho profile_id={profile_id} â€” khÃ´ng khá»Ÿi Ä‘á»™ng headless capture")

        # prefer payload __user/av when present, otherwise use c_user
        av = payload.get("av") or payload.get("__user") or payload.get("__aaid") or c_user
        __user = payload.get("__user") or av or c_user
        c_user_final = c_user or __user or av

        # jazoest may be present in payload, otherwise compute from fb_dtsg
        jazoest = payload.get("jazoest") or (get_jazoest(fb_dtsg) if fb_dtsg else None)

        # lsd / spin values may be present in payload or in page source
        lsd = payload.get("lsd") or payload.get("x-fb-lsd") or None
        spin_r = payload.get("__spin_r") or None
        spin_t = payload.get("__spin_t") or None

        print(f"âœ… Báº¯t Ä‘Æ°á»£c graphql payload keys: {list(payload.keys())}")
        if fb_dtsg:
            print(f"âœ… fb_dtsg: {fb_dtsg[:30]}...")

        result = {
            "c_user": c_user_final,
            "av": av,
            "__user": __user,
            "fb_dtsg": fb_dtsg,
            "jazoest": jazoest,
            "lsd": lsd,
            "spin_r": spin_r,
            "spin_t": spin_t
        }
        return result
    except Exception as e:
        print(f"âŒ Lá»—i khi láº¥y payload values (headless): {e}")
        import traceback
        traceback.print_exc()
        return None


def capture_graphql_post_payload(cookie, timeout: int = 8):
    """
    DÃ¹ng headless Selenium + performance logs Ä‘á»ƒ báº¯t POST requests tá»›i /api/graphql/
    Tráº£ vá» dictionary tá»« postData (form-urlencoded) cá»§a request Ä‘áº§u tÃ¬m Ä‘Æ°á»£c.

    Args:
        cookie (str): Cookie string Ä‘á»ƒ inject
        timeout (int): Sá»‘ giÃ¢y chá» sau khi load trang Ä‘á»ƒ thu logs

    Returns:
        dict | None: parsed payload (string->string) hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    try:
        from selenium import webdriver
        from selenium.webdriver.chrome.options import Options
        from selenium.webdriver.chrome.service import Service
        from selenium.common.exceptions import WebDriverException
        from webdriver_manager.chrome import ChromeDriverManager
        from urllib.parse import parse_qs, unquote_plus
    except Exception as e:
        print(f"âŒ Selenium/webdriver_manager hoáº·c urllib khÃ´ng cÃ³: {e}")
        return None

    options = Options()
    options.add_argument("--headless")
    options.add_argument("--disable-gpu")
    options.add_argument("--no-sandbox")
    options.add_argument("--disable-dev-shm-usage")
    options.add_argument("--window-size=1200,800")
    options.set_capability("goog:loggingPrefs", {"performance": "ALL"})

    try:
        service = Service(ChromeDriverManager().install())
        driver = webdriver.Chrome(service=service, options=options)
    except WebDriverException as e:
        print(f"âŒ KhÃ´ng thá»ƒ khá»Ÿi táº¡o Chrome WebDriver: {e}")
        return None
    except Exception as e:
        print(f"âŒ Lá»—i khi cÃ i/cháº¡y ChromeDriver: {e}")
        return None

    try:
        try:
            driver.execute_cdp_cmd("Network.enable", {})
            driver.execute_cdp_cmd("Network.setExtraHTTPHeaders", {"headers": {"cookie": cookie}})
        except Exception:
            pass

        driver.get("https://www.facebook.com")
        time.sleep(timeout)

        try:
            logs = driver.get_log("performance")
        except Exception:
            logs = []

        for entry in logs:
            try:
                msg = json.loads(entry.get("message", "{}")).get("message", {})
                method = msg.get("method", "")
                params = msg.get("params", {}) or {}
                # requestWillBeSent contains request with postData
                if method == "Network.requestWillBeSent":
                    req = params.get("request", {}) or {}
                    url_req = req.get("url", "") or ""
                    postData = req.get("postData", "") or ""
                    if "/api/graphql" in url_req and postData:
                        # postData is form-urlencoded string; parse it
                        try:
                            parsed = parse_qs(postData, keep_blank_values=True)
                            # flatten values: take first value and url-decode
                            flat = {k: unquote_plus(v[0]) if isinstance(v, list) and v else (v if isinstance(v, str) else "") for k, v in parsed.items()}
                            print(f"âœ… Báº¯t Ä‘Æ°á»£c graphql POST táº¡i {url_req}, keys: {list(flat.keys())}")
                            return flat
                        except Exception as e:
                            print(f"âš ï¸ Lá»—i khi parse postData: {e}")
                            # try manual parse fallback
                            try:
                                parts = postData.split("&")
                                flat = {}
                                for p in parts:
                                    if "=" in p:
                                        k, v = p.split("=", 1)
                                        flat[k] = unquote_plus(v)
                                if flat:
                                    print(f"âœ… Báº¯t Ä‘Æ°á»£c graphql POST (manual parse), keys: {list(flat.keys())}")
                                    return flat
                            except Exception:
                                pass
                # also consider Network.responseReceived -> might include requestId, skip for now
            except Exception:
                continue

        print("âš ï¸ KhÃ´ng tÃ¬m tháº¥y POST tá»›i /api/graphql/ trong performance logs")
        return None
    finally:
        try:
            driver.quit()
        except Exception:
            pass


def create_payload_dict(payload_values):
    """
    Táº¡o payload dictionary tá»« payload.txt vÃ  payload_values
    
    Args:
        payload_values (dict): Dictionary chá»©a cÃ¡c giÃ¡ trá»‹ Ä‘á»™ng (fb_dtsg, jazoest, lsd, etc.)
    
    Returns:
        dict: Payload dictionary hoÃ n chá»‰nh
    """
    try:
        # Äá»c file payload.txt
        with PAYLOAD_TXT_FILE.open("r", encoding="utf-8") as f:
            content = f.read().strip()
        
        # Parse tá»«ng dÃ²ng key: value
        payload_dict = {}
        for line in content.split('\n'):
            line = line.strip()
            if not line or not ':' in line:
                continue
            
            # TÃ¡ch key vÃ  value
            parts = line.split(':', 1)
            if len(parts) == 2:
                key = parts[0].strip().replace('"', '').replace("'", '')
                value = parts[1].strip().replace('"', '').replace("'", '').rstrip(',').strip()
                if key and value:
                    payload_dict[key] = value
        
        # Cáº­p nháº­t cÃ¡c giÃ¡ trá»‹ Ä‘á»™ng tá»« payload_values
        if payload_values.get('c_user'):
            payload_dict['av'] = payload_values['c_user']
            payload_dict['__user'] = payload_values['c_user']
        
        if payload_values.get('fb_dtsg'):
            payload_dict['fb_dtsg'] = payload_values['fb_dtsg']
        
        if payload_values.get('jazoest'):
            payload_dict['jazoest'] = payload_values['jazoest']
        
        if payload_values.get('lsd'):
            payload_dict['lsd'] = payload_values['lsd']
        
        if payload_values.get('spin_r'):
            payload_dict['__spin_r'] = payload_values['spin_r']
        
        if payload_values.get('spin_t'):
            payload_dict['__spin_t'] = payload_values['spin_t']
        
        print(f"âœ… ÄÃ£ táº¡o payload dictionary vá»›i {len(payload_dict)} keys")
        return payload_dict
        
    except FileNotFoundError:
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y file {PAYLOAD_TXT_FILE}!")
        return None
    except Exception as e:
        print(f"âŒ Lá»—i khi táº¡o payload dict: {e}")
        return None


def get_payload_by_profile_id(profile_id):
    """
    Láº¥y payload dictionary dá»±a trÃªn profile_id
    
    Args:
        profile_id (str): Profile ID (vÃ­ dá»¥: "031ca13d-e8fa-400c-a603-df57a2806788")
    
    Returns:
        dict: Payload dictionary hoÃ n chá»‰nh hoáº·c None náº¿u lá»—i
    """
    # Láº¥y cookies tá»« profile_id
    cookie = get_cookies_by_profile_id(profile_id)
    if not cookie:
        return None
    
    # Láº¥y payload values tá»« Facebook (truyá»n profile_id Ä‘á»ƒ Æ°u tiÃªn fb_dtsg tá»« settings.json)
    payload_values = get_all_payload_values(cookie, profile_id=profile_id)
    if not payload_values:
        return None
    
    # Táº¡o payload dict tá»« payload.txt vÃ  payload_values
    payload_dict = create_payload_dict(payload_values)
    return payload_dict


def update_payload_file(payload_values):
    """
    Cáº­p nháº­t file payload.txt vá»›i cÃ¡c giÃ¡ trá»‹ má»›i
    
    Args:
        payload_values (dict): Dictionary chá»©a cÃ¡c giÃ¡ trá»‹ cáº§n cáº­p nháº­t
            - c_user: GiÃ¡ trá»‹ c_user (sáº½ thay cho av vÃ  __user)
            - fb_dtsg: GiÃ¡ trá»‹ fb_dtsg
            - jazoest: GiÃ¡ trá»‹ jazoest
            - lsd: GiÃ¡ trá»‹ lsd
            - spin_r: GiÃ¡ trá»‹ __spin_r
            - spin_t: GiÃ¡ trá»‹ __spin_t
    
    Returns:
        bool: True náº¿u thÃ nh cÃ´ng, False náº¿u lá»—i
    """
    PAYLOAD_FILE = get_config_dir() / "payload.txt"
    
    try:
        # Äá»c file payload hiá»‡n táº¡i
        if not PAYLOAD_FILE.exists():
            print(f"âš ï¸ File {PAYLOAD_FILE} khÃ´ng tá»“n táº¡i")
            return False
            
        with PAYLOAD_FILE.open("r", encoding="utf-8") as f:
            lines = f.readlines()
        
        # Cáº­p nháº­t cÃ¡c giÃ¡ trá»‹
        updated_lines = []
        for line in lines:
            original_line = line
            
            # Cáº­p nháº­t av vÃ  __user náº¿u cÃ³ c_user
            if payload_values.get('c_user'):
                if line.strip().startswith('"av":'):
                    line = f'"av": "{payload_values["c_user"]}",\n'
                elif line.strip().startswith('"__user":'):
                    line = f'"__user": "{payload_values["c_user"]}",\n'
            
            # Cáº­p nháº­t fb_dtsg
            if payload_values.get('fb_dtsg') and line.strip().startswith('"fb_dtsg":'):
                line = f'"fb_dtsg": "{payload_values["fb_dtsg"]}",\n'
            
            # Cáº­p nháº­t jazoest
            if payload_values.get('jazoest') and line.strip().startswith('"jazoest":'):
                line = f'"jazoest": "{payload_values["jazoest"]}",\n'
            
            # Cáº­p nháº­t lsd
            if payload_values.get('lsd') and line.strip().startswith('"lsd":'):
                line = f'"lsd": "{payload_values["lsd"]}",\n'
            
            # Cáº­p nháº­t __spin_r
            if payload_values.get('spin_r') and line.strip().startswith('"__spin_r":'):
                line = f'"__spin_r": "{payload_values["spin_r"]}",\n'
            
            # Cáº­p nháº­t __spin_t
            if payload_values.get('spin_t') and line.strip().startswith('"__spin_t":'):
                line = f'"__spin_t": "{payload_values["spin_t"]}",\n'
            
            updated_lines.append(line)
        
        # Ghi láº¡i file
        with PAYLOAD_FILE.open("w", encoding="utf-8") as f:
            f.writelines(updated_lines)
        
        print(f"âœ… ÄÃ£ cáº­p nháº­t file {PAYLOAD_FILE}")
        return True
        
    except Exception as e:
        print(f"âŒ Lá»—i khi cáº­p nháº­t file payload: {e}")
        import traceback
        traceback.print_exc()
        return False


def ensure_payload_from_bad_response(profile_id: str | None, cookie: str | None, response_text: str | None = None, timeout: int = 8):
    """
    Khi gáº·p response khÃ´ng pháº£i JSON (vÃ­ dá»¥ tráº£ vá» 'for (;;);{...error...}'), cá»‘ gáº¯ng:
      - Láº¥y fb_dtsg, lsd tá»« `response_text` náº¿u cÃ³
      - Náº¿u khÃ´ng, khá»Ÿi Ä‘á»™ng headless capture (`capture_graphql_post_payload`) Ä‘á»ƒ báº¯t postData
      - Ghi cÃ¡c giÃ¡ trá»‹ tÃ¬m Ä‘Æ°á»£c vÃ o `settings.json` trong PROFILE_IDS[profile_id]
    Tráº£ vá» dict vá»›i cÃ¡c giÃ¡ trá»‹ tÃ¬m Ä‘Æ°á»£c hoáº·c None náº¿u tháº¥t báº¡i.
    """
    try:
        fb_dtsg = None
        lsd = None

        text = response_text or ""
        # Remove facebook XSSI prefix if present
        if isinstance(text, str) and text.startswith("for (;;);"):
            text = text[len("for (;;);"):]

        # Try parse JSON body if possible and extract known fields
        try:
            parsed_json = json.loads(text) if text else {}
            if isinstance(parsed_json, dict):
                # some responses may include tokens under nested structures
                # quick search for common keys
                for k in ("fb_dtsg", "fb_dtsg_token", "fb_dtsg_value"):
                    v = parsed_json.get(k)
                    if v:
                        fb_dtsg = str(v)
                        break
                # lsd may appear as x-fb-lsd or lsd
                for k in ("lsd", "x-fb-lsd"):
                    v = parsed_json.get(k)
                    if v:
                        lsd = str(v)
                        break
        except Exception:
            parsed_json = {}

        # Fallback: regex search in raw text
        if not fb_dtsg and isinstance(text, str):
            fb_patterns = [
                r'"name":"fb_dtsg","value":"([^"]+)"',
                r'"token":"([^"]+)","type":"fb_dtsg"',
                r'"fb_dtsg"\s*:\s*"([^"]+)"',
                r'name="fb_dtsg"\s+value="([^"]+)"',
                r'DTSGInitData.*?"token":"([^"]+)"'
            ]
            for p in fb_patterns:
                m = re.search(p, text)
                if m:
                    fb_dtsg = m.group(1)
                    break

        if not lsd and isinstance(text, str):
            lsd_patterns = [
                r'"LSD",\[\],{"token":"(.*?)"}',
                r'"x-fb-lsd"\s*:\s*"([^"]+)"',
                r'"lsd"\s*:\s*"([^"]+)"'
            ]
            for p in lsd_patterns:
                m = re.search(p, text)
                if m:
                    lsd = m.group(1)
                    break

        # If still not found, attempt headless capture to parse graphql postData
        if not fb_dtsg or not lsd:
            try:
                parsed = capture_graphql_post_payload(cookie, timeout=timeout)
                if isinstance(parsed, dict):
                    if not fb_dtsg:
                        fb_dtsg = parsed.get("fb_dtsg") or parsed.get("fb_dtsg_token") or parsed.get("fb_dtsg_value")
                    if not lsd:
                        lsd = parsed.get("lsd") or parsed.get("x-fb-lsd")
            except Exception as e:
                print(f"âš ï¸ Headless capture failed: {e}")

        # Persist into settings.json if profile_id provided and we found anything
        if profile_id and (fb_dtsg or lsd):
            try:
                if SETTINGS_JSON_FILE.exists():
                    with SETTINGS_JSON_FILE.open("r", encoding="utf-8") as sf:
                        sdata = json.load(sf)
                else:
                    sdata = {}
                profiles = sdata.get("PROFILE_IDS") or {}
                if not isinstance(profiles, dict):
                    profiles = {}
                profile_cfg = profiles.get(profile_id) or {}
                if not isinstance(profile_cfg, dict):
                    profile_cfg = {}
                if fb_dtsg:
                    profile_cfg["fb_dtsg"] = fb_dtsg
                if lsd:
                    profile_cfg["lsd"] = lsd
                profiles[profile_id] = profile_cfg
                sdata["PROFILE_IDS"] = profiles
                with SETTINGS_JSON_FILE.open("w", encoding="utf-8") as sf:
                    json.dump(sdata, sf, ensure_ascii=False, indent=2)
                print(f"âœ… ÄÃ£ ghi payload values vÃ o {SETTINGS_JSON_FILE} cho profile_id={profile_id}")
            except Exception as e:
                print(f"âš ï¸ KhÃ´ng thá»ƒ ghi vÃ o settings.json: {e}")

        result = {"fb_dtsg": fb_dtsg, "lsd": lsd}
        return result
    except Exception as e:
        print(f"âŒ ensure_payload_from_bad_response failed: {e}")
        return None
if __name__ == "__main__":
    # VÃ­ dá»¥ sá»­ dá»¥ng vá»›i profile_id
    profile_id = "031ca13d-e8fa-400c-a603-df57a2806788"
    payload_dict = get_payload_by_profile_id(profile_id)
    
    if payload_dict:
        print(f"\nðŸ“‹ Payload dictionary Ä‘Ã£ táº¡o thÃ nh cÃ´ng!")
        print(f"   Sá»‘ lÆ°á»£ng keys: {len(payload_dict)}")
        print(f"   Sample keys: {list(payload_dict.keys())[:5]}")
    else:
        print(f"\nâŒ KhÃ´ng thá»ƒ táº¡o payload dictionary")


--- END FILE: backend\worker\get_payload.py ---

--- START FILE: backend\worker\get_post_from_page.py ---
import requests
import json
from pathlib import Path
from datetime import datetime, timezone, timedelta
from urllib.parse import urlparse, parse_qs

# ====== LÆ¯U Ã ======
# Láº¥y access_token tá»« cookies.json thÃ´ng qua profile_id
# Sá»­ dá»¥ng get_payload.get_access_token_by_profile_id(profile_id) Ä‘á»ƒ láº¥y access_token


def get_access_token_by_profile_id(profile_id):
    """
    Láº¥y access_token tá»« cookies.json dá»±a trÃªn profile_id
    
    Args:
        profile_id (str): Profile ID (vÃ­ dá»¥: "031ca13d-e8fa-400c-a603-df57a2806788")
    
    Returns:
        str: Access token hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    from get_payload import get_access_token_by_profile_id as get_token
    return get_token(profile_id)


def parse_datetime_string(dt_string):
    """
    Parse datetime string tá»« Facebook API (format: "2025-12-14T17:58:05+0000")
    
    Args:
        dt_string (str): Datetime string tá»« Facebook API
        
    Returns:
        datetime: Datetime object hoáº·c None náº¿u parse lá»—i
    """
    try:
        # Format: "2025-12-14T17:58:05+0000"
        # Chuyá»ƒn thÃ nh: "2025-12-14T17:58:05+00:00" Ä‘á»ƒ parse Ä‘Æ°á»£c
        if dt_string.endswith("+0000"):
            dt_string = dt_string.replace("+0000", "+00:00")
        elif dt_string.endswith("-0000"):
            dt_string = dt_string.replace("-0000", "-00:00")
        
        return datetime.fromisoformat(dt_string)
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi parse datetime '{dt_string}': {e}")
        return None


def convert_to_vietnam_datetime(dt_string):
    """
    Chuyá»ƒn Ä‘á»•i datetime string tá»« Facebook API sang ngÃ y thÃ¡ng nÄƒm theo mÃºi giá» Viá»‡t Nam (UTC+7)
    
    Args:
        dt_string (str): Datetime string tá»« Facebook API (format: "2025-12-14T17:58:05+0000")
        
    Returns:
        str: NgÃ y thÃ¡ng nÄƒm theo format "YYYY-MM-DD HH:MM:SS" (mÃºi giá» Viá»‡t Nam) hoáº·c None náº¿u lá»—i
    """
    try:
        # Parse datetime tá»« API (UTC)
        dt_utc = parse_datetime_string(dt_string)
        if not dt_utc:
            return None
        
        # Chuyá»ƒn sang mÃºi giá» Viá»‡t Nam (UTC+7)
        vietnam_tz = timezone(timedelta(hours=7))
        dt_vietnam = dt_utc.astimezone(vietnam_tz)
        
        # Format thÃ nh ngÃ y thÃ¡ng nÄƒm
        return dt_vietnam.strftime("%Y-%m-%d %H:%M:%S")
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi chuyá»ƒn Ä‘á»•i datetime '{dt_string}' sang giá» Viá»‡t Nam: {e}")
        return None


def parse_vietnam_datetime(date_str, is_end_of_day=False):
    """
    Parse ngÃ y thÃ¡ng nÄƒm theo mÃºi giá» Viá»‡t Nam (UTC+7) vÃ  chuyá»ƒn sang UTC
    
    Há»— trá»£ cÃ¡c format:
    - "2025-12-14" hoáº·c "2025/12/14"
    - "14-12-2025" hoáº·c "14/12/2025"
    - "2025-12-14 00:00:00" hoáº·c "2025-12-14 23:59:59"
    
    Args:
        date_str (str): Chuá»—i ngÃ y thÃ¡ng nÄƒm
        is_end_of_day (bool): Náº¿u True, Ä‘áº·t thá»i gian lÃ  23:59:59, náº¿u False lÃ  00:00:00
        
    Returns:
        tuple: (datetime_utc, datetime_string_for_api) hoáº·c (None, None) náº¿u lá»—i
    """
    try:
        # MÃºi giá» Viá»‡t Nam (UTC+7)
        vietnam_tz = timezone(timedelta(hours=7))
        
        # Loáº¡i bá» khoáº£ng tráº¯ng thá»«a
        date_str = date_str.strip()
        
        # Xá»­ lÃ½ cÃ¡c format khÃ¡c nhau
        dt = None
        
        # Format: "2025-12-14" hoáº·c "2025/12/14"
        if "-" in date_str or "/" in date_str:
            # Thay tháº¿ "/" báº±ng "-"
            date_str = date_str.replace("/", "-")
            
            # TÃ¡ch pháº§n ngÃ y vÃ  giá» (náº¿u cÃ³)
            parts = date_str.split()
            date_part = parts[0]
            time_part = parts[1] if len(parts) > 1 else None
            
            # Parse date part
            date_parts = date_part.split("-")
            
            if len(date_parts) == 3:
                # Kiá»ƒm tra format: YYYY-MM-DD hoáº·c DD-MM-YYYY
                if len(date_parts[0]) == 4:  # YYYY-MM-DD
                    year, month, day = date_parts
                else:  # DD-MM-YYYY
                    day, month, year = date_parts
                
                year = int(year)
                month = int(month)
                day = int(day)
                
                # Parse time part (náº¿u cÃ³)
                if time_part:
                    time_parts = time_part.split(":")
                    hour = int(time_parts[0])
                    minute = int(time_parts[1]) if len(time_parts) > 1 else 0
                    second = int(time_parts[2]) if len(time_parts) > 2 else 0
                else:
                    # Náº¿u khÃ´ng cÃ³ time, Ä‘áº·t theo is_end_of_day
                    if is_end_of_day:
                        hour, minute, second = 23, 59, 59
                    else:
                        hour, minute, second = 0, 0, 0
                
                # Táº¡o datetime vá»›i mÃºi giá» Viá»‡t Nam
                dt = datetime(year, month, day, hour, minute, second, tzinfo=vietnam_tz)
        
        # Náº¿u khÃ´ng parse Ä‘Æ°á»£c, thá»­ parse trá»±c tiáº¿p
        if dt is None:
            # Thá»­ parse vá»›i cÃ¡c format khÃ¡c
            formats = [
                "%Y-%m-%d",
                "%d-%m-%Y",
                "%Y/%m/%d",
                "%d/%m/%Y",
                "%Y-%m-%d %H:%M:%S",
                "%d-%m-%Y %H:%M:%S",
            ]
            
            for fmt in formats:
                try:
                    dt = datetime.strptime(date_str, fmt)
                    # ThÃªm mÃºi giá» Viá»‡t Nam
                    dt = dt.replace(tzinfo=vietnam_tz)
                    # Náº¿u khÃ´ng cÃ³ giá», Ä‘áº·t theo is_end_of_day
                    if "%H" not in fmt:
                        if is_end_of_day:
                            dt = dt.replace(hour=23, minute=59, second=59)
                        else:
                            dt = dt.replace(hour=0, minute=0, second=0)
                    break
                except ValueError:
                    continue
        
        if dt is None:
            raise ValueError(f"KhÃ´ng thá»ƒ parse date string: {date_str}")
        
        # Chuyá»ƒn sang UTC
        dt_utc = dt.astimezone(timezone.utc)
        
        # Format cho API: Unix timestamp hoáº·c ISO format
        # Sá»­ dá»¥ng Unix timestamp (dá»… dÃ ng hÆ¡n)
        unix_timestamp = str(int(dt_utc.timestamp()))
        
        return dt_utc, unix_timestamp
        
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi parse Vietnam datetime '{date_str}': {e}")
        return None, None


def get_posts_from_page(page_id, profile_id, start_date=None, end_date=None, limit=None):
    """
    Láº¥y danh sÃ¡ch posts tá»« page/group qua Graph API vá»›i Ä‘iá»u kiá»‡n lá»c theo thá»i gian
    
    Args:
        page_id (str): Page ID hoáº·c Group ID
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y access_token
        start_date (str, required): NgÃ y báº¯t Ä‘áº§u theo mÃºi giá» Viá»‡t Nam (format: "2025-12-14" hoáº·c "14/12/2025")
        end_date (str, required): NgÃ y káº¿t thÃºc theo mÃºi giá» Viá»‡t Nam (format: "2025-12-14" hoáº·c "14/12/2025")
        limit (int, optional): Giá»›i háº¡n sá»‘ lÆ°á»£ng posts (None = khÃ´ng giá»›i háº¡n)
        
    Returns:
        list: Danh sÃ¡ch posts phÃ¹ há»£p Ä‘iá»u kiá»‡n thá»i gian [{"id": "...", "updated_time": "..."}, ...]
    """
    # Validate thá»i gian
    if not start_date or not end_date:
        print(f"âŒ Lá»—i: Cáº§n cung cáº¥p cáº£ start_date vÃ  end_date")
        return []
    
    # Láº¥y access_token
    access_token = get_access_token_by_profile_id(profile_id)
    if not access_token:
        print(f"âŒ KhÃ´ng thá»ƒ láº¥y access_token tá»« profile_id: {profile_id}")
        return []
    
    # Parse ngÃ y thÃ¡ng nÄƒm theo mÃºi giá» Viá»‡t Nam vÃ  chuyá»ƒn sang UTC
    start_dt, start_timestamp = parse_vietnam_datetime(start_date, is_end_of_day=False)
    end_dt, end_timestamp = parse_vietnam_datetime(end_date, is_end_of_day=True)
    
    if not start_dt or not end_dt:
        print(f"âŒ Lá»—i: KhÃ´ng thá»ƒ parse ngÃ y thÃ¡ng")
        return []
    
    # Validate: start_date pháº£i <= end_date
    if start_dt > end_dt:
        print(f"âŒ Lá»—i: start_date ({start_date}) pháº£i <= end_date ({end_date})")
        return []
    
    # Base URL cho Graph API
    base_url = f"https://graph.facebook.com/v24.0/{page_id}"
    
    # Parameters cho request (sá»­ dá»¥ng Unix timestamp)
    # Sá»­ dá»¥ng feed.limit(1000) Ä‘á»ƒ láº¥y nhiá»u posts má»—i trang (tá»‘i Ä‘a 1000)
    params = {
        "access_token": access_token,
        "fields": "feed.limit(1000){id,created_time}",
        "format": "json",
        "method": "get",
        "pretty": "0",
        "suppress_http_code": "1",
        "since": start_timestamp,  # Unix timestamp (UTC)
        "until": end_timestamp,     # Unix timestamp (UTC)
        "debug": "all",
        "origin_graph_explorer": "1",
        "transport": "cors"
    }
    
    all_posts = []
    next_url = None
    page_count = 0
    
    print(f"\nðŸš€ Báº¯t Ä‘áº§u láº¥y posts tá»« page_id: {page_id}")
    print(f"   ðŸ“… NgÃ y báº¯t Ä‘áº§u (VN): {start_date} â†’ UTC: {start_dt.strftime('%Y-%m-%d %H:%M:%S UTC')}")
    print(f"   ðŸ“… NgÃ y káº¿t thÃºc (VN): {end_date} â†’ UTC: {end_dt.strftime('%Y-%m-%d %H:%M:%S UTC')}")
    
    while True:
        # Gá»­i request
        if next_url:
            # Sá»­ dá»¥ng URL pagination tá»« response trÆ°á»›c
            url = next_url
            response = requests.get(url)
        else:
            # Request Ä‘áº§u tiÃªn
            url = base_url
            response = requests.get(url, params=params)
        
        page_count += 1
        print(f"\nðŸ“„ Trang {page_count}: {url[:100]}...")
        
        if response.status_code != 200:
            print(f"âŒ Lá»—i: Status code {response.status_code}")
            print(f"Response: {response.text[:500]}")
            break
        
        try:
            data = response.json()
            
            # Kiá»ƒm tra lá»—i tá»« API
            if "error" in data:
                print(f"âŒ Lá»—i tá»« API: {data['error']}")
                break
            
            # Láº¥y feed data
            feed_data = data.get("feed", {})
            posts = feed_data.get("data", [])
            
            if not posts:
                print(f"   â„¹ï¸ KhÃ´ng cÃ³ posts nÃ o trong trang nÃ y")
                break
            
            print(f"   ðŸ“‹ TÃ¬m tháº¥y {len(posts)} posts trong trang nÃ y")
            
            # Lá»c posts theo Ä‘iá»u kiá»‡n thá»i gian
            matched_count = 0
            for post in posts:
                post_id = post.get("id")
                created_time_str = post.get("created_time")
                
                if not post_id or not created_time_str:
                    continue
                
                # Parse created_time
                created_dt = parse_datetime_string(created_time_str)
                if not created_dt:
                    continue
                
                # Kiá»ƒm tra Ä‘iá»u kiá»‡n thá»i gian: start_time <= created_time <= end_time
                # Äáº£m báº£o created_time náº±m trong khoáº£ng [start_dt, end_dt]
                if start_dt <= created_dt <= end_dt:
                    # Chuyá»ƒn Ä‘á»•i sang ngÃ y thÃ¡ng nÄƒm theo mÃºi giá» Viá»‡t Nam
                    created_time_vn = convert_to_vietnam_datetime(created_time_str)
                    
                    all_posts.append({
                        "id": post_id,
                        "created_time": created_time_vn if created_time_vn else created_time_str
                    })
                    matched_count += 1
            
            print(f"   âœ… CÃ³ {matched_count} posts phÃ¹ há»£p Ä‘iá»u kiá»‡n trong trang nÃ y")
            
            # Kiá»ƒm tra limit
            if limit and len(all_posts) >= limit:
                print(f"   â¹ï¸ ÄÃ£ Ä‘áº¡t giá»›i háº¡n {limit} posts")
                all_posts = all_posts[:limit]
                break
            
            # Kiá»ƒm tra pagination
            paging = feed_data.get("paging", {})
            if "next" in paging:
                next_url = paging["next"]
            else:
                print(f"   â„¹ï¸ KhÃ´ng cÃ²n trang tiáº¿p theo")
                break
                
        except json.JSONDecodeError as e:
            print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡")
            print(f"Response text (500 kÃ½ tá»± Ä‘áº§u): {response.text[:500]}")
            break
        except Exception as e:
            print(f"âŒ Lá»—i khi xá»­ lÃ½ response: {e}")
            import traceback
            traceback.print_exc()
            break
    
    print(f"\nâœ… HoÃ n thÃ nh! Tá»•ng cá»™ng láº¥y Ä‘Æ°á»£c {len(all_posts)} posts phÃ¹ há»£p Ä‘iá»u kiá»‡n")
    return all_posts


def get_post_ids_from_page(page_id, profile_id, start_date=None, end_date=None, limit=None):
    """
    Láº¥y danh sÃ¡ch post IDs tá»« page/group (chá»‰ tráº£ vá» IDs, khÃ´ng cÃ³ thÃ´ng tin thá»i gian)
    
    Args:
        page_id (str): Page ID hoáº·c Group ID
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y access_token
        start_date (str, required): NgÃ y báº¯t Ä‘áº§u theo mÃºi giá» Viá»‡t Nam (format: "2025-12-14" hoáº·c "14/12/2025")
        end_date (str, required): NgÃ y káº¿t thÃºc theo mÃºi giá» Viá»‡t Nam (format: "2025-12-14" hoáº·c "14/12/2025")
        limit (int, optional): Giá»›i háº¡n sá»‘ lÆ°á»£ng posts
        
    Returns:
        list: Danh sÃ¡ch post IDs (strings)
    """
    posts = get_posts_from_page(page_id, profile_id, start_date, end_date, limit)
    return [post["id"] for post in posts]


if __name__ == "__main__":
    import os
    
    # VÃ­ dá»¥ sá»­ dá»¥ng
    profile_id = "b77da63d-af55-43c2-ab7f-364250b20e30"
    page_id = "445142479459290"
    
    # Láº¥y posts vá»›i Ä‘iá»u kiá»‡n thá»i gian (theo mÃºi giá» Viá»‡t Nam)
    start_date = "2025-12-8"  # NgÃ y báº¯t Ä‘áº§u (sáº½ tá»± Ä‘á»™ng Ä‘áº·t 00:00:00 VN = 17:00:00 UTC ngÃ y hÃ´m trÆ°á»›c)
    end_date = "2025-12-14"    # NgÃ y káº¿t thÃºc (sáº½ tá»± Ä‘á»™ng Ä‘áº·t 23:59:59 VN = 16:59:59 UTC ngÃ y hÃ´m sau)
    
    posts = get_posts_from_page(page_id, profile_id, start_date, end_date, limit=None)
    
    # In káº¿t quáº£
    print(f"\nðŸ“Š Káº¿t quáº£:")
    print(f"   Tá»•ng sá»‘ posts: {len(posts)}")
    if posts:
        print(f"   VÃ­ dá»¥ 5 posts Ä‘áº§u tiÃªn:")
        for post in posts[:5]:
            print(f"      - {post['id']} (created: {post['created_time']})")
    
    # LÆ°u ra file JSON (dÃ¹ng get_data_dir Ä‘á»ƒ Ä‘Ãºng cáº£ khi cháº¡y .exe)
    from core.paths import get_data_dir
    output_dir = get_data_dir()
    output_dir.mkdir(parents=True, exist_ok=True)
    
    # Táº¡o tÃªn file dá»±a trÃªn page_id vÃ  ngÃ y
    filename = f"{page_id}_posts_{start_date.replace('/', '-')}_to_{end_date.replace('/', '-')}.json"
    filepath = output_dir / filename
    
    # Táº¡o dá»¯ liá»‡u Ä‘á»ƒ lÆ°u
    output_data = {
        "page_id": page_id,
        "profile_id": profile_id,
        "start_date": start_date,
        "end_date": end_date,
        "total_posts": len(posts),
        "posts": posts
    }
    
    # LÆ°u file JSON
    with filepath.open("w", encoding="utf-8") as f:
        json.dump(output_data, f, ensure_ascii=False, indent=2)
    
    print(f"\nðŸ’¾ ÄÃ£ lÆ°u káº¿t quáº£ vÃ o: {filepath}")
    print(f"   Tá»•ng sá»‘ posts: {len(posts)}")
    
    # Láº¥y chá»‰ post IDs
    post_ids = get_post_ids_from_page(page_id, profile_id, start_date, end_date)
    print(f"\nðŸ“‹ Post IDs: {len(post_ids)}")
    if post_ids:
        print(f"   VÃ­ dá»¥: {post_ids[:5]}")


--- END FILE: backend\worker\get_post_from_page.py ---

--- START FILE: backend\worker\single_get_comment.py ---
import requests
from requests.adapters import HTTPAdapter
from urllib3.util.retry import Retry
import json
import base64
from urllib.parse import urlencode
from datetime import datetime, timezone, timedelta

# Import control state Ä‘á»ƒ check stop/pause
try:
    from backend.core.control import check_flags, wait_if_paused
except ImportError:
    try:
        from core.control import check_flags, wait_if_paused
    except ImportError:
        # Fallback: náº¿u khÃ´ng import Ä‘Æ°á»£c thÃ¬ dÃ¹ng dummy functions
        def check_flags(profile_id=None):
            return False, False, ""
        def wait_if_paused(profile_id=None, sleep_seconds=0.5):
            pass

# ====== LÆ¯U Ã ======
# Cookies vÃ  payload Ä‘Æ°á»£c láº¥y tá»« cookies.json vÃ  payload.txt thÃ´ng qua profile_id
# cookies.json cÃ³ cáº¥u trÃºc: {"profile_id": {"cookie": "...", "access_token": "..."}}
# Sá»­ dá»¥ng get_payload.get_payload_by_profile_id(profile_id) Ä‘á»ƒ láº¥y payload
# Sá»­ dá»¥ng get_payload.get_cookies_by_profile_id(profile_id) Ä‘á»ƒ láº¥y cookie

# ====== Táº O FEEDBACK ID Tá»ª POST_ID ======
def create_feedback_id(post_id):
    """Chuyá»ƒn Ä‘á»•i post_id thÃ nh feedback ID báº±ng base64"""
    s = f"feedback:{post_id}"
    feedback_id = base64.b64encode(s.encode()).decode()
    return feedback_id


# ====== CHUYá»‚N Äá»”I TIMESTAMP SANG GIá»œ VIá»†T NAM (UTC+7) ======
def convert_timestamp_to_vietnam_time(timestamp):
    """
    Chuyá»ƒn Ä‘á»•i Unix timestamp sang giá» Viá»‡t Nam (UTC+7)
    
    Args:
        timestamp (int): Unix timestamp (sá»‘ giÃ¢y tá»« epoch)
        
    Returns:
        str: Thá»i gian Ä‘á»‹nh dáº¡ng "YYYY-MM-DD HH:MM:SS" (giá» Viá»‡t Nam) hoáº·c None náº¿u timestamp khÃ´ng há»£p lá»‡
    """
    if timestamp is None:
        return None
    
    try:
        # Táº¡o datetime tá»« timestamp (UTC)
        dt_utc = datetime.fromtimestamp(timestamp, tz=timezone.utc)
        
        # Chuyá»ƒn sang giá» Viá»‡t Nam (UTC+7)
        vietnam_tz = timezone(timedelta(hours=7))
        dt_vietnam = dt_utc.astimezone(vietnam_tz)
        
        # Format thÃ nh string
        return dt_vietnam.strftime("%Y-%m-%d %H:%M:%S")
    except (ValueError, OSError, TypeError) as e:
        print(f"âš ï¸ Lá»—i khi chuyá»ƒn Ä‘á»•i timestamp {timestamp}: {e}")
        return None


# ====== EXTRACT USERS Tá»ª JSON ======
def extract_users_from_json(data, users_list, seen_ids):
    """
    Äá»‡ quy Ä‘á»ƒ tÃ¬m táº¥t cáº£ cÃ¡c user objects trong JSON structure vÃ  láº¥y text cá»§a comment
    
    Args:
        data: JSON data (dict, list, hoáº·c primitive)
        users_list: List Ä‘á»ƒ lÆ°u cÃ¡c user Ä‘Ã£ tÃ¬m tháº¥y
        seen_ids: Set Ä‘á»ƒ track cÃ¡c id Ä‘Ã£ tháº¥y, trÃ¡nh trÃ¹ng láº·p
    """
    if isinstance(data, dict):
        # Náº¿u cÃ³ key "user" vÃ  value lÃ  dict cÃ³ "id" vÃ  "name"
        if "user" in data and isinstance(data["user"], dict):
            user = data["user"]
            user_id = user.get("id")
            user_name = user.get("name")
            
            # Láº¥y text tá»« body náº¿u cÃ³
            comment_text = None
            if "body" in data and isinstance(data["body"], dict):
                comment_text = data["body"].get("text")
            
            # Láº¥y created_time náº¿u cÃ³
            created_time = data.get("created_time")
            created_time_vn = None
            if created_time:
                created_time_vn = convert_timestamp_to_vietnam_time(created_time)
            
            if user_id and user_name:
                # Táº¡o key duy nháº¥t tá»« user_id vÃ  text (Ä‘á»ƒ trÃ¡nh trÃ¹ng comment)
                unique_key = f"{user_id}_{comment_text}" if comment_text else user_id
                
                # Chá»‰ thÃªm náº¿u chÆ°a cÃ³ trong seen_ids
                if unique_key not in seen_ids:
                    seen_ids.add(unique_key)
                    user_data = {
                        "id": user_id,
                        "name": user_name,
                        "text": comment_text if comment_text else ""
                    }
                    # ThÃªm created_time_vn náº¿u cÃ³ (chá»‰ lÆ°u giá» Viá»‡t Nam)
                    if created_time_vn:
                        user_data["created_time_vn"] = created_time_vn
                    
                    users_list.append(user_data)
        
        # Äá»‡ quy vÃ o táº¥t cáº£ cÃ¡c values
        for value in data.values():
            extract_users_from_json(value, users_list, seen_ids)
    
    elif isinstance(data, list):
        # Äá»‡ quy vÃ o táº¥t cáº£ cÃ¡c items trong list
        for item in data:
            extract_users_from_json(item, users_list, seen_ids)


# ================================
#   Gá»¬I REQUEST GRAPHQL Vá»šI CURSOR
# ================================
def send_request(post_id, payload_dict, profile_id, cookies, commentsAfterCursor=None):
    """Gá»­i request GraphQL Ä‘á»ƒ láº¥y comments vá»›i post_id vÃ  commentsAfterCursor (náº¿u cÃ³)"""
    
    # Táº¡o feedback ID tá»« post_id
    feedback_id = create_feedback_id(post_id)
    
    # Variables cho comments API
    variables = {
        "commentsAfterCount": -1,
        "commentsAfterCursor": commentsAfterCursor if commentsAfterCursor else None,
        "commentsBeforeCount": None,
        "commentsBeforeCursor": None,
        "commentsIntentToken": "RANKED_UNFILTERED_CHRONOLOGICAL_REPLIES_INTENT_V1",
        "feedLocation": "POST_PERMALINK_DIALOG",
        "focusCommentID": None,
        "scale": 1,
        "useDefaultActor": False,
        "id": feedback_id,
        "__relay_internal__pv__CometUFICommentAvatarStickerAnimatedImagerelayprovider": False,
        "__relay_internal__pv__IsWorkUserrelayprovider": False
    }
    
    # ThÃªm commentsAfterCursor náº¿u cÃ³
    if commentsAfterCursor:
        print(f"   ðŸ”„ Sá»­ dá»¥ng commentsAfterCursor: {commentsAfterCursor[:50]}...")
    else:
        print(f"   ðŸ”„ KhÃ´ng cÃ³ commentsAfterCursor (trang Ä‘áº§u tiÃªn)")
    
    # Debug: In ra variables Ä‘á»ƒ kiá»ƒm tra
    print(f"   ðŸ“‹ Variables: {json.dumps(variables, ensure_ascii=True)}")
    
    # Sá»­ dá»¥ng payload Ä‘Æ°á»£c truyá»n vÃ o vÃ  thÃªm variables, doc_id, fb_api_req_friendly_name, __crn
    payload_dict = payload_dict.copy()
    payload_dict["variables"] = json.dumps(variables, ensure_ascii=False)
    payload_dict["doc_id"] = "25515916584706508"
    payload_dict["fb_api_req_friendly_name"] = "CommentListComponentsRootQuery"
    payload_dict["__crn"] = "comet.fbweb.CometSinglePostDialogRoute"  # Route riÃªng cho comments

    # Chuyá»ƒn dictionary thÃ nh form-urlencoded string
    payload = urlencode(payload_dict)
    
    # Debug: In ra payload Ä‘á»ƒ kiá»ƒm tra (chá»‰ 500 kÃ½ tá»± Ä‘áº§u)
    print(f"   ðŸ” Payload preview: {payload[:500]}...")

    # Táº¡o headers vá»›i cookies
    headers = {
        "accept": "*/*",
        "accept-encoding": "gzip, deflate",
        "accept-language": "en,vi;q=0.9,en-US;q=0.8",
        "content-type": "application/x-www-form-urlencoded",
        "cookie": cookies,
        "origin": "https://www.facebook.com",
        "priority": "u=1, i",
        "referer": "https://www.facebook.com/photo/?fbid=965661036626847&set=a.777896542069965",
        "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": '"Windows"',
        "sec-fetch-dest": "empty",
        "sec-fetch-mode": "cors",
        "sec-fetch-site": "same-origin",
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
        "x-asbd-id": "359341",
        "x-fb-friendly-name": "CommentListComponentsRootQuery",
        "x-fb-lsd": payload_dict.get("lsd", "")
    }

    url = "https://www.facebook.com/api/graphql/"
    
    # Session vá»›i retry Ä‘á»ƒ háº¡n cháº¿ timeout/connection reset
    session = requests.Session()
    retry_cfg = Retry(
        total=2,
        backoff_factor=0.5,
        status_forcelist=[429, 500, 502, 503, 504],
        allowed_methods=["POST"],
    )
    adapter = HTTPAdapter(max_retries=retry_cfg)
    session.mount("https://", adapter)
    session.mount("http://", adapter)
    
    # Gá»­i payload dÆ°á»›i dáº¡ng form-urlencoded vá»›i headers
    response = session.post(url, data=payload, headers=headers, timeout=20)
    
    return response


# ================================
#   HÃ€M HOÃ€N CHá»ˆNH: Láº¤Y Táº¤T Cáº¢ COMMENTS Tá»ª POST_ID
# ================================
def get_all_comments_by_post_id(post_id, payload_dict, profile_id, cookies):
    """
    HÃ m hoÃ n chá»‰nh Ä‘á»ƒ láº¥y táº¥t cáº£ comments tá»« post_id
    
    Args:
        post_id (str): Facebook ID cá»§a post
        payload_dict (dict): Dictionary chá»©a payload parameters
        profile_id (str): Profile ID
        cookies (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng trong request
        
    Returns:
        list: Danh sÃ¡ch comments vá»›i format [{"id": "...", "text": "...", "author": {...}}, ...]
    """
    # Táº¡o feedback ID tá»« post_id
    feedback_id = create_feedback_id(post_id)
    
    print("\n" + "="*50)
    print(f"ðŸš€ Báº¯t Ä‘áº§u láº¥y comments tá»« Post ID: {post_id}")
    print(f"ðŸ”— Feedback ID: {feedback_id}")
    print("="*50)
    
    all_responses = []  # LÆ°u táº¥t cáº£ response JSON
    all_users = []  # LÆ°u táº¥t cáº£ users tá»« comments
    seen_user_ids = set()  # Set Ä‘á»ƒ track cÃ¡c user id Ä‘Ã£ tháº¥y
    cursors_info = {}  # LÆ°u thÃ´ng tin cursors
    commentsAfterCursor = None  # Cursor Ä‘á»ƒ pagination
    page_number = 1
    
    while True:
        # Check stop/pause trÆ°á»›c má»—i request
        try:
            stop, paused, reason = check_flags(profile_id)
            if stop:
                print(f"ðŸ›‘ Dá»«ng láº¥y comments do stop: {reason}")
                raise RuntimeError(f"EMERGENCY_STOP ({reason})")
            if paused:
                print(f"â¸ï¸ Äang táº¡m dá»«ng ({reason}), chá» tiáº¿p tá»¥c...")
                wait_if_paused(profile_id, sleep_seconds=0.5)
                continue  # Tiáº¿p tá»¥c check sau khi resume
        except RuntimeError:
            raise  # Re-raise RuntimeError Ä‘á»ƒ caller cÃ³ thá»ƒ catch
        except Exception as e:
            print(f"âš ï¸ Lá»—i khi check stop/pause: {e}")
            # Tiáº¿p tá»¥c náº¿u cÃ³ lá»—i check
        
        print(f"\nðŸ“„ Trang {page_number} - Äang gá»­i request...")
        if commentsAfterCursor:
            print(f"   CommentsAfterCursor: {commentsAfterCursor[:50]}...")
        
        # Gá»­i request vá»›i post_id, payload, profile_id, cookies vÃ  commentsAfterCursor
        response = send_request(post_id, payload_dict, profile_id, cookies, commentsAfterCursor)
        
        print(f"   STATUS: {response.status_code}")
        
        if response.status_code != 200:
            print(f"âŒ Lá»—i: Status code {response.status_code}")
            print(f"   ðŸ“‹ Response text (500 kÃ½ tá»± Ä‘áº§u):")
            print(f"   {response.text[:500]}")
            
            # Thá»­ parse JSON Ä‘á»ƒ xem cÃ³ error message khÃ´ng
            try:
                error_json = response.json()
                if "errors" in error_json:
                    print(f"   âŒ Errors tá»« response: {json.dumps(error_json.get('errors'), indent=2, ensure_ascii=True)}")
                else:
                    print(f"   ðŸ“‹ Response JSON: {json.dumps(error_json, indent=2, ensure_ascii=False)[:1000]}")
            except:
                pass
            
            # LÆ°u response Ä‘á»ƒ debug
            with open("error_response_comment.txt", "w", encoding="utf-8") as f:
                f.write(f"Status Code: {response.status_code}\n")
                f.write(f"Headers: {dict(response.headers)}\n")
                f.write(f"\nResponse Text:\n{response.text}")
            print(f"   ðŸ’¾ ÄÃ£ lÆ°u response vÃ o error_response_comment.txt")
            break
        
        # Parse response thÃ nh JSON
        try:
            response_json = response.json()
            
            # LÆ°u response vÃ o list Ä‘á»ƒ lÆ°u táº¥t cáº£ vÃ o má»™t file sau
            all_responses.append(response_json)
            
            # Extract users tá»« response JSON
            extract_users_from_json(response_json, all_users, seen_user_ids)
            
            # Debug: Kiá»ƒm tra cáº¥u trÃºc response
            if "data" not in response_json:
                print(f"   âš ï¸ Response khÃ´ng cÃ³ 'data': {list(response_json.keys())}")
            if "errors" in response_json:
                print(f"   âŒ Response cÃ³ errors: {response_json.get('errors')}")
            
            # TrÃ­ch xuáº¥t page_info tá»« response
            try:
                # Cáº¥u trÃºc response: data.node.comment_rendering_instance_for_feed_location.comments
                node = response_json.get("data", {}).get("node", {})
                comment_rendering = node.get("comment_rendering_instance_for_feed_location", {})
                comments = comment_rendering.get("comments", {})
                edges = comments.get("edges", [])
                page_info = comments.get("page_info", {})
                end_cursor = page_info.get("end_cursor")
                start_cursor = page_info.get("start_cursor")
                has_next_page = page_info.get("has_next_page", False)
                
                print(f"   ðŸ” Debug: Sá»‘ edges trong response: {len(edges)}")
                print(f"   ðŸ”— End cursor: {end_cursor if end_cursor else 'None'}")
                print(f"   ðŸ”— Start cursor: {start_cursor if start_cursor else 'None'}")
                print(f"   ðŸ“„ Has next page: {has_next_page}")
                
                # LÆ°u cursors vÃ o dict (lÆ°u cá»§a trang cuá»‘i cÃ¹ng)
                cursors_info = {
                    "end_cursor": end_cursor,
                    "start_cursor": start_cursor,
                    "has_next_page": has_next_page,
                    "edges_count": len(edges),
                    "page_number": page_number
                }
                
                if len(edges) == 0:
                    print(f"   âš ï¸ KhÃ´ng cÃ³ edges trong response!")
                    print(f"   ðŸ” Debug: Comments keys: {list(comments.keys()) if comments else 'None'}")
                
                # Kiá»ƒm tra cÃ³ trang tiáº¿p theo khÃ´ng
                if not has_next_page:
                    print(f"\nâœ… ÄÃ£ láº¥y háº¿t táº¥t cáº£ comments! (has_next_page = False)")
                    break
                
                if not end_cursor:
                    print(f"\nâš ï¸ KhÃ´ng cÃ³ end_cursor Ä‘á»ƒ tiáº¿p tá»¥c, dá»«ng láº¡i")
                    break
                
                # Cáº­p nháº­t commentsAfterCursor cho láº§n láº·p tiáº¿p theo
                commentsAfterCursor = end_cursor
                page_number += 1
                print(f"   âž¡ï¸ CommentsAfterCursor Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t: {commentsAfterCursor[:50]}...")
                
            except Exception as e:
                print(f"âš ï¸ Lá»—i khi trÃ­ch xuáº¥t page_info: {e}")
                import traceback
                traceback.print_exc()
                break
                
        except json.JSONDecodeError as e:
            print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡")
            print(f"   Chi tiáº¿t: {e}")
            # LÆ°u response Ä‘á»ƒ debug
            with open("response_debug.txt", "w", encoding="utf-8") as f:
                f.write(response.text)
            print(f"   ÄÃ£ lÆ°u response vÃ o response_debug.txt")
            break
    
    # Hiá»ƒn thá»‹ káº¿t quáº£
    print(f"\n" + "="*50)
    print(f"âœ… HoÃ n thÃ nh!")
    print(f"ðŸ“„ Tá»•ng sá»‘ response: {len(all_responses)}")
    
    # Hiá»ƒn thá»‹ cursors info
    if cursors_info:
        print(f"   ðŸ”— End cursor: {cursors_info.get('end_cursor', 'None')}")
        print(f"   ðŸ”— Start cursor: {cursors_info.get('start_cursor', 'None')}")
    
    # Hiá»ƒn thá»‹ users Ä‘Ã£ extract
    if all_users:
        print(f"\nðŸ“‹ Danh sÃ¡ch users (10 Ä‘áº§u tiÃªn):")
        for i, user in enumerate(all_users[:10], 1):
            text_preview = user.get('text', '')[:50] + "..." if len(user.get('text', '')) > 50 else user.get('text', '')
            created_time_vn = user.get('created_time_vn', 'N/A')
            print(f"  {i}. ID: {user['id']}, Name: {user['name']}, Text: {text_preview}, Created: {created_time_vn}")
        if len(all_users) > 10:
            print(f"  ... vÃ  {len(all_users) - 10} users khÃ¡c")
    
    print("="*50)
    
    return all_users


# ================================
#   HÃ€M ÄÆ N GIáº¢N: Láº¤Y COMMENTS Tá»ª CURSOR
# ================================
def get_comments_by_cursor(post_id, payload_dict, profile_id, cookies, cursor=None):
    """
    HÃ m Ä‘Æ¡n giáº£n: truyá»n cursor vÃ o, tráº£ vá» comments vÃ  end_cursor
    
    Args:
        post_id (str): Facebook ID cá»§a post
        payload_dict (dict): Dictionary chá»©a payload parameters
        profile_id (str): Profile ID
        cookies (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng trong request
        cursor (str, optional): Cursor Ä‘á»ƒ láº¥y trang tiáº¿p theo. None náº¿u lÃ  trang Ä‘áº§u tiÃªn
        
    Returns:
        dict: {
            "comments": [{"id": "...", "text": "...", "author": {...}}, ...],
            "end_cursor": "...",
            "has_next_page": bool
        }
    """
    # Gá»­i request
    response = send_request(post_id, payload_dict, profile_id, cookies, cursor)
    
    if response.status_code != 200:
        print(f"âŒ Lá»—i: Status code {response.status_code}")
        return {"comments": [], "end_cursor": None, "has_next_page": False}
    
    # Parse response
    try:
        response_json = response.json()
        node = response_json.get("data", {}).get("node", {})
        comments = node.get("comments", {})
        edges = comments.get("edges", [])
        page_info = comments.get("page_info", {})
        end_cursor = page_info.get("end_cursor")
        has_next_page = page_info.get("has_next_page", False)
        
        # TÃ¡ch láº¥y comments
        comments_list = []
        for edge in edges:
            comment_node = edge.get("node", {})
            comment_id = comment_node.get("id")
            comment_text = comment_node.get("text")
            author = comment_node.get("author", {})
            created_time = comment_node.get("created_time")
            
            # Chuyá»ƒn Ä‘á»•i created_time sang giá» Viá»‡t Nam
            created_time_vn = None
            if created_time:
                created_time_vn = convert_timestamp_to_vietnam_time(created_time)
            
            if comment_id:
                comment_data = {
                    "id": comment_id,
                    "text": comment_text,
                    "author": author
                }
                # ThÃªm created_time_vn náº¿u cÃ³ (chá»‰ lÆ°u giá» Viá»‡t Nam)
                if created_time_vn:
                    comment_data["created_time_vn"] = created_time_vn
                
                comments_list.append(comment_data)
                
                # Print created_time
                author_name = author.get("name", "Unknown") if isinstance(author, dict) else "Unknown"
                text_preview = (comment_text[:50] + "...") if comment_text and len(comment_text) > 50 else (comment_text or "")
                print(f"   ðŸ’¬ Comment ID: {comment_id}, Author: {author_name}, Created: {created_time_vn or 'N/A'}, Text: {text_preview}")
        
        return {
            "comments": comments_list,
            "end_cursor": end_cursor,
            "has_next_page": has_next_page
        }
        
    except json.JSONDecodeError as e:
        print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡: {e}")
        return {"comments": [], "end_cursor": None, "has_next_page": False}
    except Exception as e:
        print(f"âŒ Lá»—i khi parse response: {e}")
        return {"comments": [], "end_cursor": None, "has_next_page": False}


if __name__ == "__main__":
    # VÃ­ dá»¥ sá»­ dá»¥ng hÃ m hoÃ n chá»‰nh vá»›i vÃ²ng láº·p tá»± Ä‘á»™ng
    from get_payload import get_payload_by_profile_id, get_cookies_by_profile_id
    
    profile_id = "b77da63d-af55-43c2-ab7f-364250b20e30"
    payload_dict = get_payload_by_profile_id(profile_id)
    cookies = get_cookies_by_profile_id(profile_id)
    
    if payload_dict and cookies:
        post_id = "2672966333102287"  # Thay Ä‘á»•i Post ID á»Ÿ Ä‘Ã¢y
        comments = get_all_comments_by_post_id(post_id, payload_dict, profile_id, cookies)
        with open("comments.json", "w", encoding="utf-8") as f:
            json.dump(comments, f, ensure_ascii=False, indent=4)


--- END FILE: backend\worker\single_get_comment.py ---

--- START FILE: backend\worker\single_get_reactions.py ---
import requests
from requests.adapters import HTTPAdapter
from urllib3.util.retry import Retry
import json
import base64
from urllib.parse import urlencode
import os
from datetime import datetime
from pathlib import Path

# Import control state Ä‘á»ƒ check stop/pause
try:
    from backend.core.control import check_flags, wait_if_paused
except ImportError:
    try:
        from core.control import check_flags, wait_if_paused
    except ImportError:
        # Fallback: náº¿u khÃ´ng import Ä‘Æ°á»£c thÃ¬ dÃ¹ng dummy functions
        def check_flags(profile_id=None):
            return False, False, ""
        def wait_if_paused(profile_id=None, sleep_seconds=0.5):
            pass

# ====== LÆ¯U Ã ======
# Cookies vÃ  payload Ä‘Æ°á»£c láº¥y tá»« cookies.json vÃ  payload.txt thÃ´ng qua profile_id
# cookies.json cÃ³ cáº¥u trÃºc: {"profile_id": {"cookie": "...", "access_token": "..."}}
# Sá»­ dá»¥ng get_payload.get_payload_by_profile_id(profile_id) Ä‘á»ƒ láº¥y payload
# Sá»­ dá»¥ng get_payload.get_cookies_by_profile_id(profile_id) Ä‘á»ƒ láº¥y cookie

# ====== Táº O FEEDBACK TARGET ID Tá»ª FID ======
def create_feedback_target_id(fid):
    """Chuyá»ƒn Ä‘á»•i fid thÃ nh feedbackTargetID báº±ng base64"""
    s = f"feedback:{fid}"
    feedback_target_id = base64.b64encode(s.encode()).decode()
    return feedback_target_id


# ================================
#   Gá»¬I REQUEST GRAPHQL Vá»šI CURSOR
# ================================
def send_request(feedback_target_id, payload_dict, profile_id, cookies, cursor=None):
    """Gá»­i request GraphQL vá»›i feedbackTargetID vÃ  cursor (náº¿u cÃ³)"""
    
    # Payload dÆ°á»›i dáº¡ng dictionary (tá»« Ä‘iá»ƒn)
    variables = {
        "count": 100,
        "feedbackTargetID": feedback_target_id,
        "reactionID": None,
        "scale": 1,
        "id": feedback_target_id
    }
    
    # ThÃªm cursor náº¿u cÃ³
    if cursor:
        variables["cursor"] = cursor
        print(f"   ðŸ”„ Sá»­ dá»¥ng cursor: {cursor[:50]}...")
    else:
        print(f"   ðŸ”„ KhÃ´ng cÃ³ cursor (trang Ä‘áº§u tiÃªn)")
    
    # Debug: In ra variables Ä‘á»ƒ kiá»ƒm tra
    print(f"   ðŸ“‹ Variables: {json.dumps(variables, ensure_ascii=True)}")
    
    # Sá»­ dá»¥ng payload Ä‘Æ°á»£c truyá»n vÃ o vÃ  thÃªm variables, doc_id, fb_api_req_friendly_name
    payload_dict = payload_dict.copy()
    # If caller provided a forced payload dict under key "__force_payload", use/merge it
    force_payload = payload_dict.pop("__force_payload", None)
    if isinstance(force_payload, dict):
        # merge force_payload into payload_dict (force overrides)
        for k, v in force_payload.items():
            payload_dict[k] = v

    payload_dict["variables"] = json.dumps(variables, ensure_ascii=False)
    payload_dict["doc_id"] = "31470716059194219"
    payload_dict["fb_api_req_friendly_name"] = "CometUFIReactionsDialogTabContentRefetchQuery"

    # Chuyá»ƒn dictionary thÃ nh form-urlencoded string
    payload = urlencode(payload_dict)

    # Táº¡o headers vá»›i cookies
    headers = {
        "accept": "*/*",
        "accept-encoding": "gzip, deflate",
        "accept-language": "en,vi;q=0.9,en-US;q=0.8",
        "content-type": "application/x-www-form-urlencoded",
        "cookie": cookies,
        "origin": "https://www.facebook.com",
        "priority": "u=1, i",
        "referer": "https://www.facebook.com/photo/?fbid=965661036626847&set=a.777896542069965",
        "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": '"Windows"',
        "sec-fetch-dest": "empty",
        "sec-fetch-mode": "cors",
        "sec-fetch-site": "same-origin",
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
        "x-asbd-id": "359341",
        "x-fb-friendly-name": "CommentListComponentsRootQuery",
        "x-fb-lsd": payload_dict.get("lsd", "")
    }

    url = "https://www.facebook.com/api/graphql/"
    
    # Chuáº©n bá»‹ session vá»›i retry Ä‘á»ƒ giáº£m timeout/connection reset
    session = requests.Session()
    retry_cfg = Retry(
        total=2,
        backoff_factor=0.5,
        status_forcelist=[429, 500, 502, 503, 504],
        allowed_methods=["POST"],
    )
    adapter = HTTPAdapter(max_retries=retry_cfg)
    session.mount("https://", adapter)
    session.mount("http://", adapter)
    
    # Gá»­i payload dÆ°á»›i dáº¡ng form-urlencoded vá»›i headers
    response = session.post(url, data=payload, headers=headers, timeout=20)
    
    return response


# ================================
#   HÃ€M HOÃ€N CHá»ˆNH: Láº¤Y Táº¤T Cáº¢ USERS Tá»ª FID
# ================================
def get_all_users_by_fid(fid, payload_dict, profile_id, cookies):
    """
    HÃ m hoÃ n chá»‰nh Ä‘á»ƒ láº¥y táº¥t cáº£ users (id vÃ  name) tá»« FID
    
    Args:
        fid (str): Facebook ID cá»§a post/photo
        payload_dict (dict): Dictionary chá»©a payload parameters
        profile_id (str): Profile ID
        cookies (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng trong request
        
    Returns:
        list: Danh sÃ¡ch users vá»›i format [{"id": "...", "name": "..."}, ...]
    """
    # Táº¡o feedbackTargetID tá»« FID
    feedback_target_id = create_feedback_target_id(fid)
    
    print("\n" + "="*50)
    print(f"ðŸš€ Báº¯t Ä‘áº§u láº¥y users tá»« FID: {fid}")
    print(f"ðŸ”— FeedbackTargetID: {feedback_target_id}")
    print("="*50)
    
    all_users = []
    seen_ids = set()  # Set Ä‘á»ƒ track cÃ¡c id Ä‘Ã£ tháº¥y, trÃ¡nh trÃ¹ng láº·p
    cursor = None
    page_number = 1
    duplicate_count = 0  # Äáº¿m sá»‘ user trÃ¹ng Ä‘Ã£ bá» qua
    
    while True:
        # Check stop/pause trÆ°á»›c má»—i request
        try:
            stop, paused, reason = check_flags(profile_id)
            if stop:
                print(f"ðŸ›‘ Dá»«ng láº¥y reactions do stop: {reason}")
                raise RuntimeError(f"EMERGENCY_STOP ({reason})")
            if paused:
                print(f"â¸ï¸ Äang táº¡m dá»«ng ({reason}), chá» tiáº¿p tá»¥c...")
                wait_if_paused(profile_id, sleep_seconds=0.5)
                continue  # Tiáº¿p tá»¥c check sau khi resume
        except RuntimeError:
            raise  # Re-raise RuntimeError Ä‘á»ƒ caller cÃ³ thá»ƒ catch
        except Exception as e:
            print(f"âš ï¸ Lá»—i khi check stop/pause: {e}")
            # Tiáº¿p tá»¥c náº¿u cÃ³ lá»—i check
        
        print(f"\nðŸ“„ Trang {page_number} - Äang gá»­i request...")
        if cursor:
            print(f"   Cursor: {cursor[:50]}...")
        
        # Gá»­i request vá»›i feedbackTargetID, payload, profile_id, cookies vÃ  cursor
        response = send_request(feedback_target_id, payload_dict, profile_id, cookies, cursor)
        
        print(f"   STATUS: {response.status_code}")

        # Decode response text for inspection (no file saving)
        saved_text = ""
        content_encoding = (response.headers.get("content-encoding") or "").lower()
        if "br" in content_encoding:
            try:
                import brotli
                saved_text = brotli.decompress(response.content).decode("utf-8", errors="replace")
            except Exception as e:
                print(f"   âš ï¸ Brotli decompress failed: {e}")
                try:
                    saved_text = (response.content or b"").decode("utf-8", errors="replace")
                except Exception:
                    saved_text = ""
        else:
            # rely on requests to handle gzip/deflate; fall back to manual decode
            try:
                saved_text = response.text or ""
            except Exception:
                try:
                    saved_text = (response.content or b"").decode("utf-8", errors="replace")
                except Exception:
                    saved_text = ""

        if response.status_code != 200:
            print(f"âŒ Lá»—i: Status code {response.status_code}")
            break
        
        # Parse response thÃ nh JSON
        try:
            response_json = response.json()
            
            # Debug: Kiá»ƒm tra cáº¥u trÃºc response
            if "data" not in response_json:
                print(f"   âš ï¸ Response khÃ´ng cÃ³ 'data': {list(response_json.keys())}")
            if "errors" in response_json:
                print(f"   âŒ Response cÃ³ errors: {response_json.get('errors')}")
            
            # TrÃ­ch xuáº¥t id vÃ  name tá»« má»—i node
            try:
                reactors = response_json.get("data", {}).get("node", {}).get("reactors", {})
                edges = reactors.get("edges", [])
                page_info = reactors.get("page_info", {})
                end_cursor = page_info.get("end_cursor")
                has_next_page = page_info.get("has_next_page", False)
                
                print(f"   ðŸ” Debug: Sá»‘ edges trong response: {len(edges)}")
                if len(edges) == 0:
                    print(f"   âš ï¸ KhÃ´ng cÃ³ edges trong response!")
                    print(f"   ðŸ” Debug: Reactors keys: {list(reactors.keys()) if reactors else 'None'}")
                    print(f"   ðŸ” Debug: Data structure: {json.dumps(response_json.get('data', {}), indent=2, ensure_ascii=True)[:500]}")
                elif len(edges) > 0:
                    # Debug: In ra node Ä‘áº§u tiÃªn Ä‘á»ƒ kiá»ƒm tra
                    first_node = edges[0].get("node", {})
                    first_id = first_node.get("id")
                    first_name = first_node.get("name")
                    print(f"   ðŸ” Debug node Ä‘áº§u tiÃªn: id={first_id}, name={first_name}, Ä‘Ã£ cÃ³ trong seen_ids: {first_id in seen_ids if first_id else 'N/A'}")
                
                page_users = []
                last_cursor = None
                
                for edge in edges:
                    node = edge.get("node", {})
                    node_id = node.get("id")
                    node_name = node.get("name")
                    edge_cursor = edge.get("cursor")  # Láº¥y cursor tá»« edge
                    
                    # Debug: In ra node Ä‘áº§u tiÃªn Ä‘á»ƒ kiá»ƒm tra
                    if len(page_users) == 0 and len(edges) > 0:
                        print(f"   ðŸ” Debug node Ä‘áº§u tiÃªn: id={node_id}, name={node_name}, node_keys={list(node.keys())}")
                    
                    if node_id and node_name:
                        # Kiá»ƒm tra xem id Ä‘Ã£ tá»“n táº¡i chÆ°a
                        if node_id not in seen_ids:
                            seen_ids.add(node_id)
                            page_users.append({
                                "id": node_id,
                                "name": node_name
                            })
                        else:
                            duplicate_count += 1
                    elif not node_id:
                        print(f"   âš ï¸ Node khÃ´ng cÃ³ id: {node}")
                    elif not node_name:
                        print(f"   âš ï¸ Node khÃ´ng cÃ³ name: id={node_id}")
                    
                    # LÆ°u cursor cá»§a edge cuá»‘i cÃ¹ng
                    if edge_cursor:
                        last_cursor = edge_cursor
                
                all_users.extend(page_users)
                
                # Sá»­ dá»¥ng end_cursor tá»« page_info (theo yÃªu cáº§u)
                next_cursor = end_cursor
                
                print(f"   âœ… Láº¥y Ä‘Æ°á»£c {len(page_users)} users má»›i (Tá»•ng: {len(all_users)}, TrÃ¹ng: {duplicate_count})")
                print(f"   ðŸ”— End cursor (page_info): {end_cursor[:50] if end_cursor else 'None'}...")
                print(f"   ðŸ”— Last cursor (edge): {last_cursor[:50] if last_cursor else 'None'}...")
                print(f"   ðŸ”— Next cursor sáº½ dÃ¹ng: {next_cursor[:50] if next_cursor else 'None'}...")
                print(f"   ðŸ“„ Has next page: {has_next_page}")
                
                # Kiá»ƒm tra cÃ³ trang tiáº¿p theo khÃ´ng
                if not has_next_page:
                    print(f"\nâœ… ÄÃ£ láº¥y háº¿t táº¥t cáº£ users! (has_next_page = False)")
                    break
                
                if not next_cursor:
                    print(f"\nâš ï¸ KhÃ´ng cÃ³ cursor Ä‘á»ƒ tiáº¿p tá»¥c, dá»«ng láº¡i")
                    break
                
                # Cáº­p nháº­t cursor cho láº§n láº·p tiáº¿p theo
                cursor = next_cursor
                page_number += 1
                print(f"   âž¡ï¸ Cursor Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t: {cursor[:50]}...")
                
            except Exception as e:
                print(f"âš ï¸ Lá»—i khi trÃ­ch xuáº¥t nodes: {e}")
                break
                
        except json.JSONDecodeError as e:
            print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡")
            print(f"   Chi tiáº¿t: {e}")
            # Attempt to extract dynamic payload values (fb_dtsg, lsd, __spin_r, __spin_t)
            try:
                from get_payload import ensure_payload_from_bad_response, get_payload_by_profile_id, update_payload_file
                print("â„¹ï¸ Thá»±c hiá»‡n headless capture Ä‘á»ƒ láº¥y cÃ¡c giÃ¡ trá»‹ Ä‘á»™ng vÃ  cáº­p nháº­t settings.json/payload.txt...")
                payload_values = ensure_payload_from_bad_response(profile_id, cookies, response_text=saved_text, timeout=8)
                if not payload_values:
                    print("âŒ Headless capture khÃ´ng tráº£ vá» giÃ¡ trá»‹ nÃ o, dá»«ng.")
                    break

                # Update payload.txt with discovered dynamic values
                try:
                    updated = update_payload_file(payload_values)
                    if updated:
                        print("âœ… ÄÃ£ cáº­p nháº­t backend/config/payload.txt tá»« headless capture")
                    else:
                        print("âš ï¸ KhÃ´ng thá»ƒ cáº­p nháº­t backend/config/payload.txt tá»« headless capture")
                except Exception as e_up:
                    print(f"âš ï¸ Lá»—i khi cáº­p nháº­t payload.txt: {e_up}")

                # Rebuild payload_dict from updated payload.txt / settings.json and retry once
                payload_dict = get_payload_by_profile_id(profile_id)
                if payload_dict:
                    print("â„¹ï¸ Thá»­ gá»­i láº¡i request sau khi cáº­p nháº­t payload...")
                    response = send_request(feedback_target_id, payload_dict, profile_id, cookies, cursor)
                    try:
                        response_json = response.json()
                        print("âœ… Retry thÃ nh cÃ´ng, response JSON há»£p lá»‡.")
                        # continue processing with new response_json
                    except Exception as e2:
                        print(f"âŒ Retry váº«n khÃ´ng tráº£ vá» JSON há»£p lá»‡: {e2}")
                        break
                else:
                    print("âŒ KhÃ´ng thá»ƒ táº¡o payload má»›i tá»« payload.txt/settings.json, dá»«ng.")
                    break
            except Exception as ee:
                print(f"âš ï¸ Lá»—i khi cá»‘ gáº¯ng fix báº±ng headless: {ee}")
                break
    
    # Hiá»ƒn thá»‹ káº¿t quáº£
    print(f"\n" + "="*50)
    print(f"âœ… HoÃ n thÃ nh!")
    print(f"ðŸ“Š Tá»•ng sá»‘ users (sau khi lá»c trÃ¹ng): {len(all_users)}")
    print(f"ðŸ”„ Sá»‘ user trÃ¹ng Ä‘Ã£ bá» qua: {duplicate_count}")
    print(f"ðŸ“„ Tá»•ng sá»‘ trang: {page_number}")
    print(f"\nðŸ“‹ Danh sÃ¡ch users (10 Ä‘áº§u tiÃªn):")
    for i, user in enumerate(all_users[:10], 1):
        print(f"  {i}. ID: {user['id']}, Name: {user['name']}")
    if len(all_users) > 10:
        print(f"  ... vÃ  {len(all_users) - 10} users khÃ¡c")
    
    # LÆ°u vÃ o file
    if all_users:
        extracted_data = {
            "users": all_users,
            "total_users": len(all_users),
            "duplicate_users_skipped": duplicate_count,
            "total_pages": page_number,
            "fid": fid,
            "feedback_target_id": feedback_target_id
        }
        
        print(f"\nâœ… ÄÃ£ láº¥y {len(all_users)} users")
    else:
        print("\nâš ï¸ KhÃ´ng cÃ³ users")
    
    print("="*50)
    
    return all_users


# ================================
#   HÃ€M ÄÆ N GIáº¢N: Láº¤Y USERS Tá»ª CURSOR
# ================================
def get_users_by_cursor(fid, payload_dict, profile_id, cookies, cursor=None):
    """
    HÃ m Ä‘Æ¡n giáº£n: truyá»n cursor vÃ o, tráº£ vá» users (id, name) vÃ  end_cursor
    
    Args:
        fid (str): Facebook ID cá»§a post/photo
        payload_dict (dict): Dictionary chá»©a payload parameters
        profile_id (str): Profile ID
        cookies (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng trong request
        cursor (str, optional): Cursor Ä‘á»ƒ láº¥y trang tiáº¿p theo. None náº¿u lÃ  trang Ä‘áº§u tiÃªn
        
    Returns:
        dict: {
            "users": [{"id": "...", "name": "..."}, ...],
            "end_cursor": "...",
            "has_next_page": bool
        }
    """
    # Táº¡o feedbackTargetID tá»« FID
    feedback_target_id = create_feedback_target_id(fid)
    
    # Gá»­i request
    response = send_request(feedback_target_id, payload_dict, profile_id, cookies, cursor)
    
    if response.status_code != 200:
        print(f"âŒ Lá»—i: Status code {response.status_code}")
        return {"users": [], "end_cursor": None, "has_next_page": False}
    
    # Parse response
    try:
        response_json = response.json()
        reactors = response_json.get("data", {}).get("node", {}).get("reactors", {})
        edges = reactors.get("edges", [])
        page_info = reactors.get("page_info", {})
        end_cursor = page_info.get("end_cursor")
        has_next_page = page_info.get("has_next_page", False)
        
        # TÃ¡ch láº¥y users (id vÃ  name)
        users = []
        for edge in edges:
            node = edge.get("node", {})
            node_id = node.get("id")
            node_name = node.get("name")
            
            if node_id and node_name:
                users.append({
                    "id": node_id,
                    "name": node_name
                })
        
        return {
            "users": users,
            "end_cursor": end_cursor,
            "has_next_page": has_next_page
        }
        
    except json.JSONDecodeError as e:
        print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡: {e}")
        return {"users": [], "end_cursor": None, "has_next_page": False}
    except Exception as e:
        print(f"âŒ Lá»—i khi parse response: {e}")
        return {"users": [], "end_cursor": None, "has_next_page": False}


# ================================
#   HÃ€M Gá»ŒI CÅ¨ (giá»¯ láº¡i Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch)
# ================================
def call_graphql(fid=None, profile_id=None):
    """HÃ m wrapper Ä‘á»ƒ gá»i get_all_users_by_fid"""
    if fid is None:
        fid = "965661076626843"  # FID máº·c Ä‘á»‹nh
    
    if profile_id is None:
        profile_id = "031ca13d-e8fa-400c-a603-df57a2806788"  # Profile ID máº·c Ä‘á»‹nh
    
    from get_payload import get_payload_by_profile_id, get_cookies_by_profile_id
    
    payload_dict = get_payload_by_profile_id(profile_id)
    cookies = get_cookies_by_profile_id(profile_id)
    
    if payload_dict and cookies:
        all_users = get_all_users_by_fid(fid, payload_dict, profile_id, cookies)
    else:
        print("âŒ KhÃ´ng thá»ƒ táº¡o payload dictionary hoáº·c láº¥y cookies")
        all_users = []
    
    # Hiá»ƒn thá»‹ káº¿t quáº£
    if all_users:
        print(f"\nâœ… ÄÃ£ láº¥y {len(all_users)} users")
    else:
        print("\nâš ï¸ KhÃ´ng láº¥y Ä‘Æ°á»£c users nÃ o")


if __name__ == "__main__":
    # VÃ­ dá»¥ sá»­ dá»¥ng hÃ m hoÃ n chá»‰nh vá»›i vÃ²ng láº·p tá»± Ä‘á»™ng
    from get_payload import get_payload_by_profile_id, get_cookies_by_profile_id
    
    profile_id = "b77da63d-af55-43c2-ab7f-364250b20e30"
    payload_dict = get_payload_by_profile_id(profile_id)
    cookies = get_cookies_by_profile_id(profile_id)
    
    if payload_dict and cookies:
        fid = "2672966333102287"  # Thay Ä‘á»•i FID á»Ÿ Ä‘Ã¢y
        users = get_all_users_by_fid(fid, payload_dict, profile_id, cookies)

--- END FILE: backend\worker\single_get_reactions.py ---

--- START FILE: backend\worker\__init__.py ---



--- END FILE: backend\worker\__init__.py ---

--- START FILE: frontend\data.json ---
[
  { "id": 1, "type": "type1", "time": "08:30:15" },
  { "id": 2, "type": "type1", "time": "08:30:20" },
  { "id": 3, "type": "type2", "time": "08:30:25" },
  { "id": 4, "type": "type3", "time": "08:30:25" }
]


--- END FILE: frontend\data.json ---

--- START FILE: frontend\index.html ---
<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Há»‡ thá»‘ng QuÃ©t Facebook</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
  <!-- Splash Screen -->
  <div id="splashScreen" class="splash-screen">
    <div class="splash-content">
      <h1 class="splash-title">Há»† THá»NG ADS FACEBOOK</h1>
      <p class="splash-subtitle">Giáº£i phÃ¡p tá»± Ä‘á»™ng hÃ³a â€“ quáº£n lÃ½ & scale quáº£ng cÃ¡o</p>
      <button id="splashStartBtn" class="splash-btn">Báº¯t Ä‘áº§u</button>
    </div>
  </div>

  <div class="container">
    <div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>
    <!-- Toast thÃ´ng bÃ¡o tiáº¿n trÃ¬nh vÃ  sá»‘ bÃ i Ä‘Ã£ quÃ©t -->
    <div id="progressToast" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 10000; max-width: 600px; width: 90%; display: none;">
      <!-- Toast tiáº¿n trÃ¬nh láº¥y thÃ´ng tin -->
      <div id="infoProgressToast" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.3); padding: 20px; margin-bottom: 12px; border: 2px solid #5a67d8; position: relative; overflow: hidden; display: none;">
        <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);"></div>
        <div style="display: flex; align-items: center; gap: 12px;">
          <div style="width: 45px; height: 45px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; flex-shrink: 0;">
            âš¡
          </div>
          <div style="flex: 1; min-width: 0;">
            <div style="font-weight: bold; color: white; font-size: 16px; margin-bottom: 6px;">Äang láº¥y thÃ´ng tin</div>
            <div id="infoProgressToastText" style="color: rgba(255,255,255,0.9); font-size: 14px; margin-bottom: 8px;"></div>
            <div style="width: 100%; height: 8px; background: rgba(255,255,255,0.2); border-radius: 4px; overflow: hidden;">
              <div id="infoProgressToastBar" style="height: 100%; background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%); border-radius: 4px; transition: width 0.3s ease; width: 0%;"></div>
            </div>
          </div>
        </div>
      </div>
      <!-- Toast sá»‘ bÃ i Ä‘Ã£ quÃ©t Ä‘Æ°á»£c -->
      <div id="scanStatsToast" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.3); padding: 20px; border: 2px solid #5a67d8; position: relative; overflow: hidden; display: none;">
        <div style="position: absolute; top: 0; left: 0; right: 0; height: 4px; background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);"></div>
        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
          <div style="width: 45px; height: 45px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; flex-shrink: 0;">
            ðŸ“Š
          </div>
          <div style="font-weight: bold; color: white; font-size: 16px;">Sá»‘ bÃ i Ä‘Ã£ quÃ©t Ä‘Æ°á»£c</div>
        </div>
        <div id="scanStatsToastList" style="background: rgba(255,255,255,0.95); padding: 12px; border-radius: 8px; max-height: 200px; overflow-y: auto;"></div>
      </div>
    </div>
    <header class="header">
      <div class="header-content">
        <h1>Há»† THá»NG ADS FACEBOOK</h1>
        <p class="subtitle">Giáº£i phÃ¡p tá»± Ä‘á»™ng hÃ³a â€“ quáº£n lÃ½ & scale quáº£ng cÃ¡o</p>
      </div>
    </header>

    <div class="layout">
      <div class="right-panel">
        <div class="panel-header">
          <div class="panel-tabs">
            <button id="tabScanList" type="button" class="tab-button active">ðŸ“‹ Káº¿t quáº£</button>
            <button id="tabPostManager" type="button" class="tab-button">ðŸ“   Quáº£n LÃ½ Post</button>
            <button id="tabSettings" type="button" class="tab-button">âš™ï¸ Setting profile</button>
          </div>
          <span id="rowCount" class="badge">0</span>
        </div>

        <!-- View: Danh sÃ¡ch quÃ©t -->
        <div id="scanView">
          <div class="filter-container">
            <div class="filter-group">
              <div class="filter-label">ðŸ” Lá»c theo mÃ u:</div>
              <div class="filter-buttons">
                <button class="filter-btn filter-all active" data-filter="all">
                  <span>Táº¥t cáº£</span>
                </button>
                <button class="filter-btn filter-green" data-filter="type-green">
                  <span class="filter-dot filter-dot-green"></span>
                  <span>Xanh (type1)</span>
                </button>
                <button class="filter-btn filter-yellow" data-filter="type-yellow">
                  <span class="filter-dot filter-dot-yellow"></span>
                  <span>VÃ ng (type2)</span>
                </button>
                <button class="filter-btn filter-red" data-filter="type-red">
                  <span class="filter-dot filter-dot-red"></span>
                  <span>Äá» (type3)</span>
                </button>
              </div>
            </div>

            <div class="filter-group">
              <div class="filter-label">ðŸ“Š Lá»c theo:</div>
              <div class="filter-buttons">
                <button class="filter-btn filter-react" data-filter-react="has">
                  <span>âœ“ CÃ³ React</span>
                </button>
                <button class="filter-btn filter-react" data-filter-react="none">
                  <span>âœ— KhÃ´ng React</span>
                </button>
                <button class="filter-btn filter-comment" data-filter-comment="has">
                  <span>ðŸ’¬ CÃ³ Comment</span>
                </button>
                <button class="filter-btn filter-comment" data-filter-comment="none">
                  <span>âœ— KhÃ´ng Comment</span>
                </button>
              </div>
            </div>
            <div class="filter-group">
              <div class="filter-label">â° Lá»c theo thá»i gian:</div>
              <div class="time-filter-compact">
                <div class="time-filter-inline">
                  <input type="datetime-local" id="timeFilterFrom" class="time-filter-input-compact" placeholder="Tá»«" />
                  <span class="time-filter-separator">â†’</span>
                  <input type="datetime-local" id="timeFilterTo" class="time-filter-input-compact" placeholder="Äáº¿n" />
                  <button id="applyTimeFilterBtn" class="time-filter-btn-compact time-filter-apply-compact"
                    title="Ãp dá»¥ng">
                    <span>âœ“</span>
                  </button>
                  <button id="clearTimeFilterBtn" class="time-filter-btn-compact time-filter-clear-compact" title="XÃ³a">
                    <span>âœ—</span>
                  </button>
                <!-- Export Button - BÃªn pháº£i trong hÃ ng lá»c thá»i gian -->
                <button id="exportExcelBtn" class="btn-success export-btn-inline-time">
                  <span class="btn-icon">ðŸ“Š</span>
                  <span>Xuáº¥t Excel</span>
                </button>
                </div>
              </div>
            </div>

            <!-- Date Range Buttons -->
            <div class="date-range-container">
              <div class="date-range-buttons">
                <button id="todayBtn" class="date-btn" title="Chá»n file data ngÃ y hÃ´m nay">
                  ðŸ“… NgÃ y hÃ´m nay
                </button>
                <button id="threeDaysBtn" class="date-btn" title="Chá»n file data 3 ngÃ y gáº§n nháº¥t">
                  ðŸ“Š 3 ngÃ y
                </button>
              </div>

              <!-- File Selector Dropdown -->
              <div id="fileSelectorContainer" class="file-selector-container hidden">
                <div class="file-selector-header">
                  <span id="fileSelectorTitle">Chá»n file data</span>
                  <button id="closeFileSelector" class="close-btn">âœ•</button>
                </div>
                <div class="file-selector-content">
                  <div id="fileList" class="file-list">
                    <!-- Files will be populated here -->
                  </div>
                  <div class="file-selector-actions">
                    <button id="cancelFileSelection" class="btn-secondary">Há»§y</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="table-container">
            <table id="listTable">
              <thead>
                <tr>
                  <th>ID BÃ i Post</th>
                  <th>ID User</th>
                  <th>Name</th>
                  <th>React</th>
                  <th>Comment</th>
                  <th>Time</th>
                  <th>Type</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div id="emptyState" class="empty">
            <div class="empty-icon">ðŸ“­</div>
            <p>ChÆ°a cÃ³ dá»¯ liá»‡u</p>
            <p class="empty-hint">Nháº¥n "Báº¯t Ä‘áº§u quÃ©t" Ä‘á»ƒ báº¯t Ä‘áº§u</p>
          </div>
        </div>

        <!-- View: Quáº£n lÃ½ post -->
        <div id="postView" style="display:none;">
          <div class="table-container">
            <table id="postTable">
              <thead>
                <tr>
                  <th>ID Post</th>
                  <th>Ná»™i dung</th>
                  <th>Type</th> 
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div id="postEmptyState" class="empty">
            <div class="empty-icon">ðŸ“­</div>
            <p>ChÆ°a cÃ³ dá»¯ liá»‡u post</p>
            <p class="empty-hint">Kiá»ƒm tra láº¡i file JSON trong thÆ° má»¥c post_ids</p>
          </div>
        </div>

        <!-- View: Setting profile -->
        <div id="settingsView" style="display:none;">
          <div class="settings-stack">
            <div class="setting-card">
              <div class="setting-card-header">
                <div>
                  <h4>API Key</h4>

                </div>
              </div>
              <div class="inline-field">
                <input id="settingApiKey" type="text" placeholder="Nháº­p API Key" />
                <button id="saveApiKeyBtn" class="btn-primary" type="button">LÆ°u API Key</button>
              </div>
              <p class="hint">API Key Ä‘Æ°á»£c lÆ°u trÃªn trÃ¬nh duyá»‡t; Ä‘á»•i thÃ¬ nháº­p má»›i rá»“i báº¥m LÆ°u.</p>
            </div>

            <div class="setting-card">
              <div class="setting-card-header">
                <div>
                  <h4>Danh sÃ¡ch profile</h4>
                  <p class="muted">ThÃªm profile_id vÃ  thao tÃ¡c nhanh</p>
                </div>
                <div class="setting-card-actions">
                  <button id="runAllInfoBtn" class="btn-primary" type="button">Láº¥y thÃ´ng tin toÃ n bá»™</button>
                  <button id="runSelectedInfoBtn" class="btn-secondary" type="button">Láº¥y thÃ´ng tin profile Ä‘Ã£ chá»n</button>
                  <button id="scanPostsSettingBtn" class="btn-success" type="button">QuÃ©t bÃ i viáº¿t</button>
                  <button id="scanGroupSettingBtn" class="btn-yellow" type="button">QuÃ©t theo group</button>
                  <button id="autoJoinGroupBtn" class="btn-primary" type="button">Tá»± Ä‘á»™ng tham gia group</button>
                  <button id="feedAccountSettingBtn" class="btn-nuoiacc" type="button">NuÃ´i acc</button>
                  <button id="stopAllSettingBtn" class="btn-danger" type="button">Dá»«ng táº¥t cáº£</button>
                </div>
              </div>
              <div id="feedConfigPanel" class="feed-panel" style="display:none;">
                <div class="feed-panel-row">
                  <label class="feed-radio">
                    <input type="radio" name="feedMode" value="feed" checked />
                    <span>Feed</span>
                  </label>
                  <label class="feed-radio">
                    <input type="radio" name="feedMode" value="search" />
                    <span>Search</span>
                  </label>
                  <div class="feed-duration">
                    <span class="feed-label">Cháº¡y (phÃºt)</span>
                    <input id="feedRunMinutesInput" type="number" min="1" value="30" />
                  </div>
                  <div class="feed-duration">
                    <span class="feed-label">Thá»i gian láº·p láº¡i (phÃºt)</span>
                    <input id="feedRestMinutesInput" type="number" min="0" value="120" />
                  </div>
                </div>
                <div class="feed-panel-row">
                  <textarea id="feedTextInput"
                    placeholder="Nháº­p text. VD: báº¯c ninh , báº¯c giang  |  hoáº·c: tuyá»ƒn dá»¥ng báº¯c ninh , báº¯c giang"></textarea>
                </div>
                <div class="feed-panel-row feed-panel-actions">
                  <button id="feedStartBtn" class="btn-success" type="button">Cháº¡y</button>
                  <button id="feedCancelBtn" class="btn-secondary" type="button">Há»§y</button>
                </div>
                <p class="hint">
                  Rule like: bÃ i pháº£i cÃ³ (tuyá»ƒn dá»¥ng/tuyá»ƒn gáº¥p/tuyá»ƒn nhÃ¢n viÃªn) <b>vÃ </b> cÃ³ (báº¯c ninh <b>hoáº·c</b> báº¯c
                  giang).
                </p>
              </div>

              <!-- Panel: QuÃ©t bÃ i viáº¿t (dÃ¹ng core/browser.py: scan + like + share + báº¯t id) -->
              <div id="scanConfigPanel" class="feed-panel" style="display:none;">
                <div class="feed-panel-row">
                  <label class="feed-radio">
                    <input type="radio" name="scanMode" value="feed" checked />
                    <span>Feed</span>
                  </label>
                  <label class="feed-radio">
                    <input type="radio" name="scanMode" value="search" />
                    <span>Search</span>
                  </label>
                  <div class="feed-duration">
                    <span class="feed-label">Cháº¡y (phÃºt)</span>
                    <input id="scanRunMinutesInput" type="number" min="1" value="30" />
                  </div>
                  <div class="feed-duration">
                    <span class="feed-label">Thá»i gian láº·p láº¡i (phÃºt)</span>
                    <input id="scanRestMinutesInput" type="number" min="0" value="120" />
                  </div>
                </div>
                <div class="feed-panel-row">
                  <textarea id="scanTextInput"
                    placeholder="Nháº­p text. VD: báº¯c ninh , báº¯c giang  |  hoáº·c: tuyá»ƒn dá»¥ng báº¯c ninh , báº¯c giang"></textarea>
                </div>
                <div class="feed-panel-row feed-panel-actions">
                  <button id="scanStartBtn" class="btn-success" type="button">Cháº¡y</button>
                  <button id="scanCancelBtn" class="btn-secondary" type="button">Há»§y</button>
                </div>
                <p class="hint">
                  Rule scan: bÃ i pháº£i cÃ³ keyword máº·c Ä‘á»‹nh (tuyá»ƒn dá»¥ng/lÆ°Æ¡ng/...) <b>vÃ </b> cÃ³ Ã­t nháº¥t 1 cá»¥m tá»« trong
                  text
                  nháº­p (náº¿u cÃ³).
                </p>
              </div>

              <!-- Panel: QuÃ©t theo group (UI only - chÆ°a ná»‘i API) -->
              <div id="groupScanPanel" class="feed-panel" style="display:none;">
                <div class="feed-panel-row">
                  <div class="feed-duration feed-duration-left">
                    <span class="feed-label">Sá»‘ bÃ i viáº¿t theo dÃµi</span>
                    <input id="groupScanPostCountInput" type="number" min="0" value="0" placeholder="VD: 100" />
                  </div>
                  <div class="feed-duration">
                    <span class="feed-label">Tá»« (ngÃ y/giá»)</span>
                    <input id="groupScanStartDateInput" type="datetime-local" />
                  </div>
                  <div class="feed-duration">
                    <span class="feed-label">Äáº¿n (ngÃ y/giá»)</span>
                    <input id="groupScanEndDateInput" type="datetime-local" />
                  </div>
                </div>
                <div class="feed-panel-row">
                  <textarea id="groupScanUrlInput"
                    placeholder="Nháº­p URL group (má»—i dÃ²ng 1 URL). VD:
https://www.facebook.com/groups/tuyendungkisuIT
https://www.facebook.com/groups/abc123"></textarea>
                </div>
                <div class="feed-panel-row feed-panel-actions">
                  <button id="groupScanStartBtn" class="btn-success" type="button">Cháº¡y</button>
                  <button id="groupScanCancelBtn" class="btn-secondary" type="button">ÄÃ³ng</button>
                </div>
                <p class="hint">Chá»‰ UI Ä‘á»ƒ nháº­p URL + khoáº£ng thá»i gian (chÆ°a ná»‘i API).</p>
              </div>

              <div id="profileList" class="profile-list empty-state-box">
                <p class="muted">ChÆ°a cÃ³ profile nÃ o</p>
              </div>

              <div class="add-profile-row">
                <button id="addProfileRowBtn" class="btn-success" type="button">+ ThÃªm profile</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Help button vá»›i tooltip -->
  <button id="helpBtn" class="help-button" title="Xem hÆ°á»›ng dáº«n sá»­ dá»¥ng Ä‘áº§y Ä‘á»§">
    <span>?</span>
  </button>
  <div id="helpTooltip" class="help-tooltip">

    <div class="tooltip-header">
      <h4>ðŸ“– HÆ¯á»šNG DáºªN Sá»¬ Dá»¤NG</h4>
      <button class="tooltip-close">&times;</button>
    </div>
    <div class="tooltip-body">
      <div class="help-content">

        <h3>ðŸ“‹ CÃ¡c Trang/Chá»©c NÄƒng ChÃ­nh</h3>

        <h4>1. ðŸ“‹ Trang Káº¿t Quáº£ (Scan Results)</h4>
        <ul>
          <li><strong>Chá»©c nÄƒng:</strong> Hiá»ƒn thá»‹ dá»¯ liá»‡u Ä‘Ã£ quÃ©t Ä‘Æ°á»£c tá»« Facebook</li>
          <li><strong>CÃ¡c bá»™ lá»c:</strong>
            <ul>
              <li><strong>ðŸ” Lá»c theo mÃ u:</strong> PhÃ¢n loáº¡i dá»¯ liá»‡u theo Ä‘á»™ Æ°u tiÃªn
                <ul>
                  <li>ðŸŸ¢ <strong>Xanh (type1):</strong> Dá»¯ liá»‡u Æ°u tiÃªn cao, dá»¯ liá»‡u Ä‘á»‘i thá»§</li>
                  <li>ðŸŸ¡ <strong>VÃ ng (type2):</strong> Dá»¯ liá»‡u Æ°u tiÃªn trung bÃ¬nh</li>
                  <li>ðŸ”´ <strong>Äá» (type3):</strong> Dá»¯ liá»‡u tá»« tÃ¬m kiáº¿m khÃ¡ch hÃ ng</li>
                </ul>
              </li>
              <li><strong>ðŸ“Š Lá»c theo tÆ°Æ¡ng tÃ¡c:</strong> CÃ³/KhÃ´ng cÃ³ React, Comment</li>
              <li><strong>â° Lá»c theo thá»i gian:</strong> Chá»n khoáº£ng thá»i gian cá»¥ thá»ƒ</li>
            </ul>
          </li>
        </ul>


 
        <h3>ðŸ”„ Quy trÃ¬nh sá»­ dá»¥ng</h3>
        <ol>
          <li><strong>Khá»Ÿi Ä‘á»™ng:</strong> Má»Ÿ trang web vÃ  chá» backend sáºµn sÃ ng</li>
          <li><strong>CÃ i Ä‘áº·t:</strong> Nháº­p API Key vÃ  thÃªm profile</li>
          <li><strong>Cáº¥u hÃ¬nh:</strong> Setting thá»i gian vÃ  Ä‘iá»u kiá»‡n quÃ©t</li>
          <li><strong>Cháº¡y:</strong> Báº¯t Ä‘áº§u quÃ©t vÃ  theo dÃµi káº¿t quáº£</li>
          <li><strong>Xuáº¥t dá»¯ liá»‡u:</strong> Export Excel khi cáº§n phÃ¢n tÃ­ch</li>
        </ol>

        <div class="tooltip-item">
          <span class="tooltip-dot tooltip-green"></span>
          <div>
            <strong>Máº¹o:</strong> Click vÃ o dáº¥u ? báº¥t cá»© lÃºc nÃ o Ä‘á»ƒ xem hÆ°á»›ng dáº«n nÃ y!
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- NÃºt chat Messenger & Zalo -->
  <div class="chat-floating">
    <a href="https://m.me/" target="_blank" rel="noopener noreferrer" class="chat-btn chat-mess" title="Chat Messenger">
      <img src="icon/logo-messenger-inkythuatso-2-01-30-15-47-51.jpg" alt="Messenger" class="chat-img" />
    </a>
    <a href="https://zalo.me/" target="_blank" rel="noopener noreferrer" class="chat-btn chat-zalo" title="Chat Zalo">
      <img src="icon/zalo-icon.png" alt="Zalo" class="chat-img" />
    </a>
  </div>

  <script src="script.js"></script>
</body>

</html>
--- END FILE: frontend\index.html ---

--- START FILE: frontend\script.js ---
// Splash Screen
const splashScreen = document.getElementById('splashScreen');
const splashStartBtn = document.getElementById('splashStartBtn');

// ThÃªm class splash-active khi trang load Ä‘á»ƒ áº©n container
if (splashScreen) {
  document.body.classList.add('splash-active');
}

// áº¨n splash screen khi click nÃºt "Báº¯t Ä‘áº§u"
if (splashStartBtn) {
  splashStartBtn.addEventListener('click', () => {
    if (splashScreen) {
      splashScreen.classList.add('hidden');
      // Cho phÃ©p hiá»ƒn thá»‹ container vÃ  scroll sau khi áº©n splash
      setTimeout(() => {
        document.body.classList.remove('splash-active');
      }, 600); // Äá»£i animation hoÃ n thÃ nh
    }
  });
}

// startBtn vÃ  stopBtn Ä‘Ã£ bá»‹ xÃ³a khá»i left-panel
const runMinutesInput = document.getElementById('runMinutes');
const intervalInput = document.getElementById('interval');
const stopAllBtn = document.getElementById('stopAllBtn');
const pauseAllBtn = document.getElementById('pauseAllBtn');
const tbody = document.querySelector('#listTable tbody');
const emptyState = document.getElementById('emptyState');
const rowCount = document.getElementById('rowCount');
const statusDot = document.getElementById('statusDot');
const backendStatus = document.getElementById('backendStatus');
// Tabs & view cho danh sÃ¡ch quÃ©t / quáº£n lÃ½ post
const tabScanList = document.getElementById('tabScanList');
const tabPostManager = document.getElementById('tabPostManager');
const tabSettings = document.getElementById('tabSettings');
const scanView = document.getElementById('scanView');
const postView = document.getElementById('postView');
const settingsView = document.getElementById('settingsView');
// Báº£ng quáº£n lÃ½ post
const postTableBody = document.querySelector('#postTable tbody');
const postEmptyState = document.getElementById('postEmptyState');
// Setting profile elements
const settingApiKeyInput = document.getElementById('settingApiKey');
const saveApiKeyBtn = document.getElementById('saveApiKeyBtn');
const profileList = document.getElementById('profileList');
// (Preview settings.json Ä‘Ã£ bá»‹ bá» khá»i UI)
const addProfileRowBtn = document.getElementById('addProfileRowBtn');
const autoJoinGroupBtn = document.getElementById('autoJoinGroupBtn');
const stopAllSettingBtn = document.getElementById('stopAllSettingBtn');
const stopSelectedProfilesBtn = document.getElementById('stopSelectedProfilesBtn');
const pauseSelectedProfilesBtn = document.getElementById('pauseSelectedProfilesBtn');
const feedAccountSettingBtn = document.getElementById('feedAccountSettingBtn');
const scanPostsSettingBtn = document.getElementById('scanPostsSettingBtn');
const scanGroupSettingBtn = document.getElementById('scanGroupSettingBtn');
const runAllInfoBtn = document.getElementById('runAllInfoBtn');
const runSelectedInfoBtn = document.getElementById('runSelectedInfoBtn');
const feedConfigPanel = document.getElementById('feedConfigPanel');
const scanConfigPanel = document.getElementById('scanConfigPanel');
const groupScanPanel = document.getElementById('groupScanPanel');
const groupScanUrlInput = document.getElementById('groupScanUrlInput');
const groupScanPostCountInput = document.getElementById('groupScanPostCountInput');
const groupScanStartDateInput = document.getElementById('groupScanStartDateInput');
const groupScanEndDateInput = document.getElementById('groupScanEndDateInput');
const groupScanStartBtn = document.getElementById('groupScanStartBtn');
const groupScanCancelBtn = document.getElementById('groupScanCancelBtn');
const scanTextInput = document.getElementById('scanTextInput');
const scanRunMinutesInput = document.getElementById('scanRunMinutesInput');
const scanRestMinutesInput = document.getElementById('scanRestMinutesInput');
const scanStartBtn = document.getElementById('scanStartBtn');
const scanCancelBtn = document.getElementById('scanCancelBtn');
const feedTextInput = document.getElementById('feedTextInput');
const feedRunMinutesInput = document.getElementById('feedRunMinutesInput');
const feedRestMinutesInput = document.getElementById('feedRestMinutesInput');
const feedStartBtn = document.getElementById('feedStartBtn');
const feedCancelBtn = document.getElementById('feedCancelBtn');

const API_BASE = 'http://localhost:8000';
const SETTINGS_STORAGE_KEY = 'profileSettings';
const toastContainer = document.getElementById('toastContainer');

let counter = 1;
let timerId = null;
let initialLoaded = false;
let dataCheckInterval = null; // Interval Ä‘á»ƒ kiá»ƒm tra dá»¯ liá»‡u má»›i
let loadedPostIds = new Set(); // LÆ°u cÃ¡c post_id Ä‘Ã£ load Ä‘á»ƒ trÃ¡nh trÃ¹ng láº·p
let postsLoaded = false; // ÄÃ£ load dá»¯ liá»‡u quáº£n lÃ½ post hay chÆ°a
let profileState = {
  apiKey: '',
  profiles: {}, // { [profileId]: { cookie: '', access_token: '', fb_dtsg: '', lsd: '', spin_r: '', spin_t: '', groups: string[] } }
  selected: {}, // { [profileId]: true/false } (frontend-only)
};
let addRowEl = null; // Row táº¡m Ä‘á»ƒ nháº­p profile má»›i
let joinGroupPollTimer = null;
let feedPollTimer = null;
let scanBackendPollTimer = null; // Poll tráº¡ng thÃ¡i bot runner Ä‘á»ƒ sync UI sau F5
let isScanning = false; // Tráº¡ng thÃ¡i Ä‘ang quÃ©t
let isPausedAll = false; // Tráº¡ng thÃ¡i pause all (UI)
let lastJobsStatus = null; // cache /jobs/status Ä‘á»ƒ badge khÃ´ng bá»‹ sai khi má»›i má»Ÿ trang

function setPauseAllButtonLabel(paused) {
  if (!pauseAllBtn) return;
  const isPaused = !!paused;
  // Support cáº£ 2 kiá»ƒu: button cÃ³ span icon/text hoáº·c button text thuáº§n
  const icon = pauseAllBtn.querySelector ? pauseAllBtn.querySelector('span.btn-icon') : null;
  const textSpan = pauseAllBtn.querySelector ? pauseAllBtn.querySelector('span:last-child') : null;
  if (icon || textSpan) {
    if (icon) icon.textContent = isPaused ? 'â–¶ï¸' : 'â¸ï¸';
    if (textSpan) textSpan.textContent = isPaused ? 'Tiáº¿p tá»¥c táº¥t cáº£' : 'Táº¡m dá»«ng táº¥t cáº£';
  } else {
    pauseAllBtn.textContent = isPaused ? 'Tiáº¿p tá»¥c táº¥t cáº£' : 'Táº¡m dá»«ng táº¥t cáº£';
  }
}

// stopBtn Ä‘Ã£ bá»‹ xÃ³a khá»i left-panel, cÃ¡c nÃºt stop Ä‘Æ°á»£c xá»­ lÃ½ trong settings tab
// NÃºt dá»«ng luÃ´n enable Ä‘á»ƒ cÃ³ thá»ƒ dá»«ng báº¥t cá»© lÃºc nÃ o
try {
  if (pauseAllBtn) pauseAllBtn.disabled = true;
  // stopAllSettingBtn luÃ´n enable
  if (stopAllSettingBtn) stopAllSettingBtn.disabled = false;
  if (stopSelectedProfilesBtn) stopSelectedProfilesBtn.disabled = true;
  if (pauseSelectedProfilesBtn) pauseSelectedProfilesBtn.disabled = true;
} catch (_) { }

function updateRowCount() {
  const count = tbody.children.length;
  rowCount.textContent = count;
}

// Load dá»¯ liá»‡u quáº£n lÃ½ post tá»« file post_ids
async function loadPostsForManager() {
  if (postsLoaded || !postTableBody) return;
  try {
    // Gá»i API Ä‘á»ƒ láº¥y danh sÃ¡ch post IDs
    const res = await callBackend('/data/post-ids', { method: 'GET' });
    const data = res;

    if (!data.files || data.files.length === 0) {
      postEmptyState && postEmptyState.classList.add('show');
      postsLoaded = true;
      return;
    }

    // Hiá»ƒn thá»‹ tá»«ng post
    data.files.forEach((item) => appendPostRow(item));
    postEmptyState && postEmptyState.classList.remove('show');
    postsLoaded = true;
  } catch (err) {
    console.error('KhÃ´ng táº£i Ä‘Æ°á»£c dá»¯ liá»‡u post_ids:', err);
    postEmptyState && postEmptyState.classList.add('show');
  }
}

function setScanning(isOn) {
  isScanning = isOn;
  // startBtn vÃ  stopBtn Ä‘Ã£ bá»‹ xÃ³a khá»i left-panel
  // Logic quÃ©t Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi cÃ¡c nÃºt trong settings tab
  
  // Disable/enable cÃ¡c nÃºt quÃ©t khÃ¡c khi Ä‘ang quÃ©t
  if (scanStartBtn) {
    scanStartBtn.disabled = isOn;
  }
  if (scanPostsSettingBtn) {
    scanPostsSettingBtn.disabled = isOn;
  }

  // Khi dá»«ng quÃ©t: gá»¡ háº¿t tráº¡ng thÃ¡i loading/spinner á»Ÿ cÃ¡c nÃºt liÃªn quan
  // (trÃ¡nh trÆ°á»ng há»£p backend stop cháº­m lÃ m UI bá»‹ káº¹t, khÃ´ng báº¥m láº¡i Ä‘Æ°á»£c)
  if (!isOn) {
    setButtonLoading(scanStartBtn, false);
    setButtonLoading(scanPostsSettingBtn, false);
    // Dá»«ng poll sá»‘ bÃ i Ä‘Ã£ quÃ©t Ä‘Æ°á»£c
    if (scanStatsInterval) {
      clearInterval(scanStatsInterval);
      scanStatsInterval = null;
    }
    // áº¨n toast sá»‘ bÃ i Ä‘Ã£ quÃ©t
    const scanToast = document.getElementById('scanStatsToast');
    const progressToast = document.getElementById('progressToast');
    if (scanToast) scanToast.style.display = 'none';
    // áº¨n progressToast náº¿u cáº£ 2 toast Ä‘á»u áº©n
    const infoToast = document.getElementById('infoProgressToast');
    if (progressToast && (!infoToast || infoToast.style.display === 'none')) {
      progressToast.style.display = 'none';
    }
  }
  // startBtn Ä‘Ã£ bá»‹ xÃ³a khá»i left-panel, loading Ä‘Æ°á»£c xá»­ lÃ½ bá»Ÿi cÃ¡c nÃºt trong settings
}

function syncRunningLabelsWithPauseState() {
  // Khi PAUSE ALL báº­t, Ä‘á»•i text cÃ¡c nÃºt Ä‘ang "loading" Ä‘á»ƒ user biáº¿t Ä‘ang táº¡m dá»«ng,
  // trÃ¡nh hiá»ƒu nháº§m váº«n "Ä‘ang quÃ©t/Ä‘ang cháº¡y".
  try {
    if (isScanning) {
      // startBtn Ä‘Ã£ bá»‹ xÃ³a, chá»‰ cáº­p nháº­t cÃ¡c nÃºt trong settings

      if (scanStartBtn && scanStartBtn.classList.contains('btn-loading')) {
        scanStartBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang cháº¡y...';
      }
      if (scanPostsSettingBtn && scanPostsSettingBtn.classList.contains('btn-loading')) {
        scanPostsSettingBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang quÃ©t...';
      }
    }

    if (feedPollTimer) {
      if (feedStartBtn && feedStartBtn.classList.contains('btn-loading')) {
        feedStartBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang cháº¡y...';
      }
      if (feedAccountSettingBtn && feedAccountSettingBtn.classList.contains('btn-loading')) {
        feedAccountSettingBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang nuÃ´i acc...';
      }
    }

    if (joinGroupPollTimer) {
      if (autoJoinGroupBtn && autoJoinGroupBtn.classList.contains('btn-loading')) {
        autoJoinGroupBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang auto join...';
      }
    }
  } catch (_) { }
}

function applyControlStateToProfileRows(st) {
  // Äá»“ng bá»™ badge tráº¡ng thÃ¡i cho má»i profile row
  const pausedAll = Boolean(st && st.global_pause);
  const pausedProfiles = new Set(Array.isArray(st && st.paused_profiles) ? st.paused_profiles.map((x) => String(x)) : []);
  const profileStates = (st && typeof st.profile_states === 'object' && st.profile_states) ? st.profile_states : {};
  const jobs = lastJobsStatus || {};
  const botRunning = Boolean(jobs && jobs.bot_running);
  const botProfileIds = new Set(Array.isArray(jobs && jobs.bot_profile_ids) ? jobs.bot_profile_ids.map((x) => String(x)) : []);
  const joinRunning = new Set(Array.isArray(jobs && jobs.join_groups_running) ? jobs.join_groups_running.map((x) => String(x)) : []);
  const feedRunning = new Set(Array.isArray(jobs && jobs.feed_running) ? jobs.feed_running.map((x) => String(x)) : []);
  const sessionRunning = Boolean(
    botRunning
    || joinRunning.size > 0
    || feedRunning.size > 0
  );

  const rows = document.querySelectorAll('.profile-row-wrap');
  rows.forEach((wrap) => {
    const pid = String(wrap.dataset.profileId || '').trim();
    if (!pid) return;
    const badge = wrap.querySelector('.profile-state-badge');

    // --- Effective state ---
    // Default: READY (má»›i vÃ o / chÆ°a cÃ³ job)
    let eff = 'READY';
    // Náº¿u khÃ´ng cÃ³ session nÃ o cháº¡y -> luÃ´n READY
    if (sessionRunning) {
      // Náº¿u Ä‘ang pause (global hoáº·c profile) -> PAUSED
      if (pausedAll || pausedProfiles.has(pid)) {
        eff = 'PAUSED';
      } else {
        // RUNNING náº¿u profile Ä‘ang cÃ³ feed/join hoáº·c runner Ä‘ang cháº¡y vÃ  profile_state RUNNING
        if (feedRunning.has(pid) || joinRunning.has(pid)) {
          eff = 'RUNNING';
        } else if (botRunning) {
          const ps = String(profileStates[pid] || '').toUpperCase();
          // Æ¯u tiÃªn list tá»« backend: bot_profile_ids
          const inBot = botProfileIds.size > 0 ? botProfileIds.has(pid) : false;
          eff = (ps === 'RUNNING' || inBot) ? 'RUNNING' : 'READY';
        } else {
          eff = 'READY';
        }
      }
    }

    if (badge) {
      badge.classList.remove('state-running', 'state-paused', 'state-ready', 'state-idle', 'state-unknown', 'state-stopping', 'state-stopped', 'state-error');
      if (eff === 'PAUSED') badge.classList.add('state-paused');
      else if (eff === 'RUNNING') badge.classList.add('state-running');
      else badge.classList.add('state-ready');
      badge.textContent = (eff === 'READY') ? 'Sáº´N SÃ€NG' : (eff === 'RUNNING') ? 'ÄANG CHáº Y' : 'ÄANG Táº M Dá»ªNG';
    }
  });
}

/**
 * Central function Ä‘á»ƒ quáº£n lÃ½ button states cho pause/stop
 * Äáº£m báº£o logic nháº¥t quÃ¡n vÃ  trÃ¡nh race conditions
 */
function updateStopPauseButtonsByJobs() {
  const jobs = lastJobsStatus || {};
  const botHasProfiles = Array.isArray(jobs && jobs.bot_profile_ids) && jobs.bot_profile_ids.length > 0;
  const sessionRunning = Boolean(
    (jobs && jobs.bot_running && botHasProfiles)
    || (Array.isArray(jobs && jobs.join_groups_running) && jobs.join_groups_running.length > 0)
    || (Array.isArray(jobs && jobs.feed_running) && jobs.feed_running.length > 0)
  );
  const hasSelected = getSelectedProfileIds().length > 0;
  
  // Kiá»ƒm tra info collector Ä‘ang cháº¡y tá»« backend
  let infoCollectorRunning = false;
  try {
    // Check tá»« progress API Ä‘á»ƒ Ä‘áº£m báº£o chÃ­nh xÃ¡c
    // Note: KhÃ´ng dÃ¹ng isInfoCollectorRunning vÃ¬ cÃ³ thá»ƒ bá»‹ out of sync
    // Sáº½ check async trong updateInfoProgress
  } catch (_) { }
  
  // Náº¿u Ä‘ang cháº¡y info collector (local flag) hoáº·c cÃ³ session running thÃ¬ enable buttons
  const shouldEnableButtons = sessionRunning || isInfoCollectorRunning;

  /**
   * Helper function Ä‘á»ƒ set button state má»™t cÃ¡ch nháº¥t quÃ¡n
   */
  function setButtonState(btn, enabled, skipIfLoading = true) {
    if (!btn) return;
    if (skipIfLoading && btn.classList && btn.classList.contains('btn-loading')) {
      return; // Giá»¯ nguyÃªn state náº¿u Ä‘ang loading
    }
    
    btn.disabled = !enabled;
    if (enabled) {
      btn.style.opacity = '1';
      btn.style.pointerEvents = 'auto';
      btn.style.cursor = 'pointer';
    } else {
      btn.style.opacity = '0.5';
      btn.style.pointerEvents = 'none';
      btn.style.cursor = 'not-allowed';
    }
  }

  // stopBtn Ä‘Ã£ bá»‹ xÃ³a khá»i left-panel, chá»‰ cÃ²n stopAllSettingBtn
  // NÃºt dá»«ng luÃ´n enable Ä‘á»ƒ cÃ³ thá»ƒ dá»«ng báº¥t cá»© lÃºc nÃ o
  setButtonState(stopAllSettingBtn, true);

  // PAUSE ALL button
  setButtonState(pauseAllBtn, shouldEnableButtons);

  // Selected profiles buttons (cáº§n cáº£ hasSelected)
  setButtonState(pauseSelectedProfilesBtn, shouldEnableButtons && hasSelected);
  setButtonState(stopSelectedProfilesBtn, shouldEnableButtons && hasSelected);
}

// ==== Settings (frontend-only) ====
async function tryLoadProfileStateFromBackend() {
  try {
    const raw = await callBackendNoAlert('/settings', { method: 'GET' });
    if (!raw) return false;

    const apiKey = raw.API_KEY || raw.api_key || '';
    const profileIds = raw.PROFILE_IDS || raw.profile_ids || {};

    profileState.apiKey = String(apiKey || '').trim();

    // PROFILE_IDS cÃ³ thá»ƒ lÃ  list/string/dict; normalize vá» dict
    const nextProfiles = {};
    if (Array.isArray(profileIds)) {
      profileIds.forEach((pid) => {
        const key = String(pid || '').trim();
        if (key) nextProfiles[key] = { 
          cookie: '', 
          access_token: '', 
          fb_dtsg: '', 
          lsd: '', 
          spin_r: '', 
          spin_t: '',
          groups: []
        };
      });
    } else if (typeof profileIds === 'string') {
      profileIds.split(',').map((s) => s.trim()).filter(Boolean).forEach((pid) => {
        nextProfiles[pid] = { 
          cookie: '', 
          access_token: '', 
          fb_dtsg: '', 
          lsd: '', 
          spin_r: '', 
          spin_t: '',
          groups: []
        };
      });
    } else if (profileIds && typeof profileIds === 'object') {
      Object.entries(profileIds).forEach(([pid, cfg]) => {
        const key = String(pid || '').trim();
        if (!key) return;
        nextProfiles[key] = {
          cookie: (cfg && cfg.cookie) ? String(cfg.cookie) : '',
          access_token: (cfg && (cfg.access_token || cfg.accessToken)) ? String(cfg.access_token || cfg.accessToken) : '',
          fb_dtsg: (cfg && cfg.fb_dtsg) ? String(cfg.fb_dtsg) : '',
          lsd: (cfg && cfg.lsd) ? String(cfg.lsd) : '',
          spin_r: (cfg && cfg.spin_r) ? String(cfg.spin_r) : '',
          spin_t: (cfg && cfg.spin_t) ? String(cfg.spin_t) : '',
          groups: (cfg && Array.isArray(cfg.groups)) ? cfg.groups.map((x) => String(x || '').trim()).filter(Boolean) : [],
        };
      });
    }

    profileState.profiles = nextProfiles;
    // giá»¯ selected náº¿u cÃ³
    if (!profileState.selected || typeof profileState.selected !== 'object') profileState.selected = {};
    localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(profileState));
    return true;
  } catch (err) {
    return false;
  }
}

async function loadProfileState() {
  // Æ¯u tiÃªn láº¥y tá»« backend náº¿u cÃ³
  const loadedFromBackend = await tryLoadProfileStateFromBackend();
  if (loadedFromBackend) {
    if (settingApiKeyInput) settingApiKeyInput.value = profileState.apiKey || '';
    renderProfileList();
    updateSettingsActionButtons();
    return;
  }

  try {
    const stored = localStorage.getItem(SETTINGS_STORAGE_KEY);
    if (stored) {
      const parsed = JSON.parse(stored);
      profileState = {
        apiKey: parsed.apiKey || '',
        profiles: parsed.profiles || {},
        selected: parsed.selected || {},
      };
    }
  } catch (err) {
    console.warn('KhÃ´ng Ä‘á»c Ä‘Æ°á»£c dá»¯ liá»‡u settings tá»« localStorage', err);
  }

  if (settingApiKeyInput) settingApiKeyInput.value = profileState.apiKey || '';
  renderProfileList();
  updateSettingsActionButtons();
}

function saveProfileState() {
  localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(profileState));
}

function getSelectedProfileIds() {
  return Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
}

function updateSettingsActionButtons() {
  const selected = getSelectedProfileIds();
  const hasSelected = selected.length > 0;

  // CÃ¡c nÃºt "hÃ nh Ä‘á»™ng" á»Ÿ Setting profile: yÃªu cáº§u tick Ã­t nháº¥t 1 profile
  const needSelectedBtns = [
    scanPostsSettingBtn,
    scanGroupSettingBtn,
    autoJoinGroupBtn,
    feedAccountSettingBtn,
    stopSelectedProfilesBtn,
    pauseSelectedProfilesBtn,
    runSelectedInfoBtn,
  ].filter(Boolean);

  needSelectedBtns.forEach((b) => {
    // náº¿u Ä‘ang loading thÃ¬ giá»¯ nguyÃªn tráº¡ng thÃ¡i disabled
    if (b.classList && b.classList.contains('btn-loading')) return;
    b.disabled = !hasSelected;
  });

  // CÃ¡c nÃºt ALL (khÃ´ng phá»¥ thuá»™c tick)
  // LÆ°u Ã½: stop/pause ALL sáº½ Ä‘Æ°á»£c enable/disable theo /jobs/status (updateStopPauseButtonsByJobs)
  // nÃªn khÃ´ng set á»Ÿ Ä‘Ã¢y Ä‘á»ƒ trÃ¡nh ghi Ä‘Ã¨ logic.

  // CÃ¡c nÃºt "Cháº¡y" trong cÃ¡c panel cÅ©ng yÃªu cáº§u tick profile
  const runBtns = [feedStartBtn, scanStartBtn, groupScanStartBtn].filter(Boolean);
  runBtns.forEach((b) => {
    if (b.classList && b.classList.contains('btn-loading')) return;
    b.disabled = !hasSelected;
  });

  // Náº¿u khÃ´ng cÃ³ selection thÃ¬ auto Ä‘Ã³ng panel Ä‘á»ƒ trÃ¡nh ngÆ°á»i dÃ¹ng nháº­p rá»“i má»›i biáº¿t khÃ´ng cháº¡y Ä‘Æ°á»£c
  if (!hasSelected) {
    if (feedConfigPanel) feedConfigPanel.style.display = 'none';
    if (scanConfigPanel) scanConfigPanel.style.display = 'none';
    if (groupScanPanel) groupScanPanel.style.display = 'none';
  }

  // Äá»“ng bá»™ enable/disable cho STOP/PAUSE theo tráº¡ng thÃ¡i backend (sessionRunning)
  try { updateStopPauseButtonsByJobs(); } catch (_) { }
}

function showToast(message, type = 'success', ms = 1600) {
  if (!toastContainer) return;
  const el = document.createElement('div');
  el.className = `toast ${type}`;
  el.textContent = message;
  toastContainer.appendChild(el);
  requestAnimationFrame(() => el.classList.add('show'));
  setTimeout(() => {
    el.classList.remove('show');
    setTimeout(() => el.remove(), 220);
  }, ms);
}

function setButtonLoading(btn, isLoading, loadingText) {
  if (!btn) return;
  if (isLoading) {
    if (!btn.dataset.origText) {
      btn.dataset.origText = btn.textContent || '';
    }
    btn.disabled = true;
    btn.classList.add('btn-loading');
    if (loadingText) btn.textContent = loadingText;
  } else {
    btn.disabled = false;
    btn.classList.remove('btn-loading');
    if (btn.dataset.origText) {
      btn.textContent = btn.dataset.origText;
      delete btn.dataset.origText;
    }
  }
}

// (Preview settings.json Ä‘Ã£ bá»‹ bá» khá»i UI)

function createPill(text) {
  const pill = document.createElement('span');
  pill.className = 'pill';
  pill.textContent = text;
  return pill;
}

function setProfileListEmptyStateIfNeeded() {
  if (!profileList) return;
  const hasRow = Boolean(profileList.querySelector('.profile-row:not(.add-profile-form)'));
  if (hasRow) {
    profileList.classList.remove('empty-state-box');
    const p = profileList.querySelector('p.muted');
    if (p && p.textContent && p.textContent.includes('ChÆ°a cÃ³ profile')) {
      // náº¿u Ä‘ang lÃ  empty placeholder thÃ¬ xÃ³a
      profileList.innerHTML = '';
    }
    return;
  }
  profileList.classList.add('empty-state-box');
  profileList.innerHTML = '<p class="muted">ChÆ°a cÃ³ profile nÃ o</p>';
}

function buildProfileRow(initialPid, initialInfo, isNew = false) {
  let currentPid = initialPid;
  const wrap = document.createElement('div');
  wrap.className = 'profile-row-wrap';
  wrap.dataset.profileId = String(currentPid || '').trim();

  const row = document.createElement('div');
  row.className = 'profile-row';

  const selectWrap = document.createElement('div');
  selectWrap.className = 'profile-select';

  const selectCb = document.createElement('input');
  selectCb.type = 'checkbox';
  selectCb.className = 'profile-select-cb';
  selectCb.title = 'Chá»n profile';
  selectCb.checked = Boolean(profileState.selected && profileState.selected[currentPid]);

  const pidInput = document.createElement('input');
  pidInput.className = 'profile-id-input';
  pidInput.type = 'text';
  pidInput.value = currentPid;
  pidInput.addEventListener('change', () => {
    wrap.dataset.profileId = String(pidInput.value || '').trim();
  });

  const actions = document.createElement('div');
  actions.className = 'profile-actions';

  const saveBtn = document.createElement('button');
  saveBtn.type = 'button';
  saveBtn.className = 'btn-success';
  saveBtn.textContent = 'LÆ°u';

  const removeBtn = document.createElement('button');
  removeBtn.type = 'button';
  removeBtn.className = 'btn-danger';
  removeBtn.textContent = 'XÃ³a';

  const groupBtn = document.createElement('button');
  groupBtn.type = 'button';
  groupBtn.className = 'btn-primary';
  groupBtn.textContent = 'ThÃªm Groups';

  // Badge hiá»ƒn thá»‹ tráº¡ng thÃ¡i profile (RUNNING/PAUSED/STOPPED)
  const stateBadge = document.createElement('span');
  stateBadge.className = isNew ? 'profile-state-badge state-ready' : 'profile-state-badge state-idle';
  stateBadge.textContent = isNew ? 'Sáº´N SÃ€NG' : 'IDLE';

  // ===== Group editor panel (div) =====
  const groupPanel = document.createElement('div');
  groupPanel.className = 'group-panel';
  groupPanel.style.display = 'none';

  const groupPanelHeader = document.createElement('div');
  groupPanelHeader.className = 'group-panel-header';
  groupPanelHeader.textContent = 'Danh sÃ¡ch group (má»—i dÃ²ng 1 group)';

  const groupTextarea = document.createElement('textarea');
  groupTextarea.className = 'group-textarea';
  groupTextarea.placeholder = 'DÃ¡n group á»Ÿ Ä‘Ã¢y...\nVD:\nhttps://www.facebook.com/groups/tuyendungkisuIT\n3013041542259942';

  const groupPanelActions = document.createElement('div');
  groupPanelActions.className = 'group-panel-actions';

  const groupSaveBtn = document.createElement('button');
  groupSaveBtn.type = 'button';
  groupSaveBtn.className = 'btn-success';
  groupSaveBtn.textContent = 'LÆ°u groups';

  const groupCloseBtn = document.createElement('button');
  groupCloseBtn.type = 'button';
  groupCloseBtn.className = 'btn-secondary';
  groupCloseBtn.textContent = 'ÄÃ³ng';

  groupPanelActions.appendChild(groupSaveBtn);
  groupPanelActions.appendChild(groupCloseBtn);
  groupPanel.appendChild(groupPanelHeader);
  groupPanel.appendChild(groupTextarea);
  groupPanel.appendChild(groupPanelActions);

  // ===== Token editor panel (div) =====
  const tokenPanel = document.createElement('div');
  tokenPanel.className = 'group-panel';
  tokenPanel.style.display = 'none';

  const tokenPanelHeader = document.createElement('div');
  tokenPanelHeader.className = 'group-panel-header';
  tokenPanelHeader.textContent = 'Nháº­p thÃ´ng tin token cho profile';

  const tokenForm = document.createElement('div');
  tokenForm.style.cssText = 'display: flex; flex-direction: column; gap: 12px; padding: 0; margin-bottom: 0;';

  // Táº¡o 5 input fields
  const createTokenInput = (label, fieldName, placeholder) => {
    const container = document.createElement('div');
    container.style.cssText = 'display: flex; flex-direction: column; gap: 4px; padding: 0 0 8px 0;';
    
    const labelEl = document.createElement('label');
    labelEl.textContent = label;
    labelEl.style.cssText = 'font-weight: 600; color: #2d3748; font-size: 14px;';
    
    const input = document.createElement('input');
    input.type = 'text';
    input.name = fieldName;
    input.placeholder = placeholder;
    input.style.cssText = 'padding: 8px 12px; border: 1px solid #cbd5e0; border-radius: 6px; font-size: 14px; width: 100%; box-sizing: border-box;';
    
    container.appendChild(labelEl);
    container.appendChild(input);
    return { container, input };
  };

  const accessTokenInput = createTokenInput('Access Token', 'access_token', 'Nháº­p access_token...');
  const fbDtsgInput = createTokenInput('FB DTSG', 'fb_dtsg', 'Nháº­p fb_dtsg...');
  const lsdInput = createTokenInput('LSD', 'lsd', 'Nháº­p lsd...');
  const spinRInput = createTokenInput('Spin R', 'spin_r', 'Nháº­p spin_r...');
  const spinTInput = createTokenInput('Spin T', 'spin_t', 'Nháº­p spin_t...');

  tokenForm.appendChild(accessTokenInput.container);
  tokenForm.appendChild(fbDtsgInput.container);
  tokenForm.appendChild(lsdInput.container);
  tokenForm.appendChild(spinRInput.container);
  tokenForm.appendChild(spinTInput.container);

  const tokenPanelActions = document.createElement('div');
  tokenPanelActions.className = 'group-panel-actions';

  const tokenSaveBtn = document.createElement('button');
  tokenSaveBtn.type = 'button';
  tokenSaveBtn.className = 'btn-success';
  tokenSaveBtn.textContent = 'LÆ°u token';

  const tokenCloseBtn = document.createElement('button');
  tokenCloseBtn.type = 'button';
  tokenCloseBtn.className = 'btn-secondary';
  tokenCloseBtn.textContent = 'ÄÃ³ng';

  tokenPanelActions.appendChild(tokenSaveBtn);
  tokenPanelActions.appendChild(tokenCloseBtn);
  tokenPanel.appendChild(tokenPanelHeader);
  tokenPanel.appendChild(tokenForm);
  tokenPanel.appendChild(tokenPanelActions);

  function getLocalGroups(pid) {
    const info = profileState.profiles[pid] || {};
    const gs = info.groups;
    if (Array.isArray(gs)) return gs.map((x) => String(x || '').trim()).filter(Boolean);
    return [];
  }

  function setLocalGroups(pid, groups) {
    if (!profileState.profiles[pid]) {
      profileState.profiles[pid] = { 
        cookie: '', 
        access_token: '', 
        fb_dtsg: '', 
        lsd: '', 
        spin_r: '', 
        spin_t: '',
        groups: [] 
      };
    }
    profileState.profiles[pid].groups = Array.isArray(groups) ? groups : [];
  }

  function updateGroupBtnLabel() {
    const count = getLocalGroups(currentPid).length;
    groupBtn.textContent = count > 0 ? `Groups (${count})` : 'Groups';
  }
  // init label from initialInfo/profileState
  if (initialInfo && Array.isArray(initialInfo.groups)) {
    setLocalGroups(currentPid, initialInfo.groups);
  } else if (!profileState.profiles[currentPid]?.groups) {
    // ensure field exists
    setLocalGroups(currentPid, getLocalGroups(currentPid));
  }
  updateGroupBtnLabel();

  selectCb.addEventListener('change', () => {
    if (!profileState.selected || typeof profileState.selected !== 'object') profileState.selected = {};
    if (selectCb.checked) profileState.selected[currentPid] = true;
    else delete profileState.selected[currentPid];
    saveProfileState();
    updateSettingsActionButtons();
  });

  const cookieBtn = document.createElement('button');
  cookieBtn.type = 'button';
  cookieBtn.className = 'btn-primary';
  cookieBtn.textContent = 'Cáº­p nháº­t cookie';

  const tokenBtn = document.createElement('button');
  tokenBtn.type = 'button';
  tokenBtn.className = 'btn-success';
  tokenBtn.textContent = 'Cáº­p nháº­t token' ;

  groupBtn.addEventListener('click', async () => {
    const isOpen = groupPanel.style.display !== 'none';
    if (isOpen) {
      groupPanel.style.display = 'none';
      return;
    }

    // má»Ÿ panel + load groups tá»« backend Ä‘á»ƒ textarea Ä‘Ãºng dá»¯ liá»‡u hiá»‡n táº¡i
    groupBtn.disabled = true;
    try {
      const settings = await callBackendNoAlert('/settings', { method: 'GET' });
      const profiles = (settings && (settings.PROFILE_IDS || settings.profile_ids)) || {};
      const cfg = (profiles && typeof profiles === 'object') ? profiles[currentPid] : null;
      const rawGroups = cfg && typeof cfg === 'object' ? cfg.groups : null;
      const groups = Array.isArray(rawGroups) ? rawGroups.map((x) => String(x || '').trim()).filter(Boolean) : [];
      setLocalGroups(currentPid, groups);
      saveProfileState();
      updateGroupBtnLabel();
      groupTextarea.value = groups.join('\n');
      groupPanel.style.display = 'block';
      groupTextarea.focus();
    } catch (e) {
      // fallback: hiá»‡n theo local náº¿u backend lá»—i
      const groups = getLocalGroups(currentPid);
      groupTextarea.value = groups.join('\n');
      groupPanel.style.display = 'block';
      showToast('KhÃ´ng load Ä‘Æ°á»£c groups tá»« backend, Ä‘ang dÃ¹ng dá»¯ liá»‡u local.', 'error');
    } finally {
      groupBtn.disabled = false;
    }
  });

  groupCloseBtn.addEventListener('click', () => {
    groupPanel.style.display = 'none';
  });

  groupSaveBtn.addEventListener('click', async () => {
    const nextGroups = String(groupTextarea.value || '')
      .split(/\r?\n/)
      .map((s) => s.trim())
      .filter(Boolean);

    groupSaveBtn.disabled = true;
    try {
      // replace (Ä‘Ã¨ lÃªn cÃ¡i cÅ©)
      const res = await callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}/groups`, {
        method: 'PUT',
        body: JSON.stringify({ groups: nextGroups }),
      });
      const saved = (res && Array.isArray(res.groups)) ? res.groups : nextGroups;
      setLocalGroups(currentPid, saved);
      saveProfileState();
      updateGroupBtnLabel();
      showToast(`ÄÃ£ lÆ°u groups: ${saved.length}`, 'success');
      // LÆ°u xong thÃ¬ Ä‘Ã³ng textarea panel
      groupPanel.style.display = 'none';
    } catch (e) {
      showToast('KhÃ´ng lÆ°u Ä‘Æ°á»£c groups (kiá»ƒm tra FastAPI).', 'error');
    } finally {
      groupSaveBtn.disabled = false;
    }
  });

  saveBtn.addEventListener('click', async () => {
    const nextPid = (pidInput.value || '').replace(/\s+/g, '').trim();
    if (!nextPid) {
      showToast('profile_id khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng', 'error');
      pidInput.value = currentPid;
      pidInput.focus();
      return;
    }
    // normalize hiá»ƒn thá»‹ Ä‘á»ƒ trÃ¡nh dÃ­nh space
    if (pidInput.value !== nextPid) pidInput.value = nextPid;

    const cur = profileState.profiles[currentPid] || { 
      cookie: '', 
      access_token: '', 
      fb_dtsg: '', 
      lsd: '', 
      spin_r: '', 
      spin_t: '',
      groups: [] 
    };
    saveBtn.disabled = true;
    try {
      if (nextPid !== currentPid) {
        // rename = add new -> copy data -> delete old
        await callBackend('/settings/profiles', {
          method: 'POST',
          body: JSON.stringify({ profile_id: nextPid }),
        });
        await callBackend(`/settings/profiles/${encodeURIComponent(nextPid)}`, {
          method: 'PUT',
          body: JSON.stringify({
            cookie: cur.cookie || '',
            access_token: cur.access_token || '',
            fb_dtsg: cur.fb_dtsg || '',
            lsd: cur.lsd || '',
            spin_r: cur.spin_r || '',
            spin_t: cur.spin_t || '',
          }),
        });
        // copy groups sang profile má»›i (trÃ¡nh máº¥t)
        await callBackend(`/settings/profiles/${encodeURIComponent(nextPid)}/groups`, {
          method: 'PUT',
          body: JSON.stringify({ groups: Array.isArray(cur.groups) ? cur.groups : [] }),
        });
        await callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}`, { method: 'DELETE' });

        delete profileState.profiles[currentPid];
        profileState.profiles[nextPid] = { ...cur };
        // chuyá»ƒn checkbox selection sang key má»›i
        if (profileState.selected && profileState.selected[currentPid]) {
          delete profileState.selected[currentPid];
          profileState.selected[nextPid] = true;
        }
        currentPid = nextPid;
        pidInput.value = currentPid;
        selectCb.checked = Boolean(profileState.selected && profileState.selected[currentPid]);
        updateGroupBtnLabel();
      } else {
        await callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}`, {
          method: 'PUT',
          body: JSON.stringify({
            cookie: cur.cookie || '',
            access_token: cur.access_token || '',
            fb_dtsg: cur.fb_dtsg || '',
            lsd: cur.lsd || '',
            spin_r: cur.spin_r || '',
            spin_t: cur.spin_t || '',
          }),
        });
      }

      saveProfileState();
      tokenBtn.textContent = (profileState.profiles[currentPid]?.access_token) ? 'Cáº­p nháº­t token' : 'Láº¥y access_token';
      showToast('ÄÃ£ lÆ°u', 'success');
    } catch (e) {
      showToast('KhÃ´ng lÆ°u Ä‘Æ°á»£c (kiá»ƒm tra FastAPI).', 'error');
      pidInput.value = currentPid;
    } finally {
      saveBtn.disabled = false;
    }
  });

  removeBtn.addEventListener('click', () => {
    if (!confirm(`XÃ³a profile ${currentPid}?`)) return;
    removeBtn.disabled = true;
    callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}`, { method: 'DELETE' })
      .then(() => {
        delete profileState.profiles[currentPid];
        saveProfileState();
        row.remove();
        setProfileListEmptyStateIfNeeded();
        showToast('ÄÃ£ xÃ³a', 'success');
      })
      .catch(() => showToast('KhÃ´ng xÃ³a Ä‘Æ°á»£c (kiá»ƒm tra FastAPI).', 'error'))
      .finally(() => (removeBtn.disabled = false));
  });

  cookieBtn.addEventListener('click', () => {
    cookieBtn.disabled = true;
    showToast('Äang báº­t NST & láº¥y cookie...', 'success', 900);
    const safePid = String(currentPid || '').replace(/\s+/g, '');
    callBackend(`/settings/profiles/${encodeURIComponent(safePid)}/cookie/fetch`, {
      method: 'POST',
      body: JSON.stringify({}),
    })
      .then(() => {
        // Cookie Ä‘Ã£ Ä‘Æ°á»£c backend lÆ°u vÃ o backend/config/settings.json, frontend khÃ´ng lÆ°u/khÃ´ng hiá»ƒn thá»‹
        showToast('ÄÃ£ lÆ°u cookie vÃ o settings.json', 'success');
      })
      .catch(() => showToast('KhÃ´ng láº¥y Ä‘Æ°á»£c cookie (kiá»ƒm tra FastAPI / Ä‘Äƒng nháº­p NST).', 'error'))
      .finally(() => (cookieBtn.disabled = false));
  });

  tokenBtn.addEventListener('click', async () => {
    const isOpen = tokenPanel.style.display !== 'none';
    if (isOpen) {
      tokenPanel.style.display = 'none';
      return;
    }

    // Má»Ÿ panel + load token data tá»« backend
    tokenBtn.disabled = true;
    try {
      const settings = await callBackendNoAlert('/settings', { method: 'GET' });
      const profiles = (settings && (settings.PROFILE_IDS || settings.profile_ids)) || {};
      const cfg = (profiles && typeof profiles === 'object') ? profiles[currentPid] : null;
      
      // Load giÃ¡ trá»‹ hiá»‡n táº¡i vÃ o inputs
      accessTokenInput.input.value = (cfg && cfg.access_token) ? String(cfg.access_token) : '';
      fbDtsgInput.input.value = (cfg && cfg.fb_dtsg) ? String(cfg.fb_dtsg) : '';
      lsdInput.input.value = (cfg && cfg.lsd) ? String(cfg.lsd) : '';
      spinRInput.input.value = (cfg && cfg.spin_r) ? String(cfg.spin_r) : '';
      spinTInput.input.value = (cfg && cfg.spin_t) ? String(cfg.spin_t) : '';
      
      tokenPanel.style.display = 'block';
      accessTokenInput.input.focus();
    } catch (e) {
      // Fallback: load tá»« local state
      const info = profileState.profiles[currentPid] || {};
      accessTokenInput.input.value = info.access_token || '';
      fbDtsgInput.input.value = info.fb_dtsg || '';
      lsdInput.input.value = info.lsd || '';
      spinRInput.input.value = info.spin_r || '';
      spinTInput.input.value = info.spin_t || '';
      tokenPanel.style.display = 'block';
      accessTokenInput.input.focus();
      showToast('KhÃ´ng load Ä‘Æ°á»£c token tá»« backend, Ä‘ang dÃ¹ng dá»¯ liá»‡u local.', 'error');
    } finally {
      tokenBtn.disabled = false;
    }
  });

  tokenCloseBtn.addEventListener('click', () => {
    tokenPanel.style.display = 'none';
  });

  tokenSaveBtn.addEventListener('click', async () => {
    const accessToken = accessTokenInput.input.value.trim();
    const fbDtsg = fbDtsgInput.input.value.trim();
    const lsd = lsdInput.input.value.trim();
    const spinR = spinRInput.input.value.trim();
    const spinT = spinTInput.input.value.trim();

    tokenSaveBtn.disabled = true;
    try {
      await callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}`, {
        method: 'PUT',
        body: JSON.stringify({
          access_token: accessToken,
          fb_dtsg: fbDtsg,
          lsd: lsd,
          spin_r: spinR,
          spin_t: spinT,
        }),
      });
      
      // Update local state
      if (!profileState.profiles[currentPid]) {
        profileState.profiles[currentPid] = { 
          cookie: '', 
          access_token: '', 
          fb_dtsg: '', 
          lsd: '', 
          spin_r: '', 
          spin_t: '',
          groups: [] 
        };
      }
      profileState.profiles[currentPid].access_token = accessToken;
      profileState.profiles[currentPid].fb_dtsg = fbDtsg;
      profileState.profiles[currentPid].lsd = lsd;
      profileState.profiles[currentPid].spin_r = spinR;
      profileState.profiles[currentPid].spin_t = spinT;
      saveProfileState();
      
      tokenBtn.textContent = accessToken ? 'Cáº­p nháº­t token' : 'Láº¥y access_token';
      showToast('ÄÃ£ lÆ°u token', 'success');
      tokenPanel.style.display = 'none';
    } catch (e) {
      showToast('KhÃ´ng lÆ°u token (kiá»ƒm tra FastAPI).', 'error');
    } finally {
      tokenSaveBtn.disabled = false;
    }
  });

  actions.appendChild(stateBadge);
  actions.appendChild(saveBtn);
  actions.appendChild(removeBtn);
  actions.appendChild(groupBtn);
  actions.appendChild(cookieBtn);
  actions.appendChild(tokenBtn);

  selectWrap.appendChild(selectCb);
  row.appendChild(selectWrap);
  row.appendChild(pidInput);
  row.appendChild(actions);
  wrap.appendChild(row);
  wrap.appendChild(groupPanel);
  wrap.appendChild(tokenPanel);
  // init label
  try { updatePauseBtnLabel(); } catch (_) { }
  return wrap;
}

function renderProfileList() {
  if (!profileList) return;
  // náº¿u Ä‘ang cÃ³ row thÃªm má»›i, bá» trÆ°á»›c khi render láº¡i
  if (addRowEl && addRowEl.parentNode) {
    addRowEl.parentNode.removeChild(addRowEl);
    addRowEl = null;
  }
  profileList.innerHTML = '';
  const ids = Object.keys(profileState.profiles || {});
  if (ids.length === 0) {
    profileList.classList.add('empty-state-box');
    profileList.innerHTML = '<p class="muted">ChÆ°a cÃ³ profile nÃ o</p>';
    return;
  }

  profileList.classList.remove('empty-state-box');
  ids.forEach((pid) => {
    const info = profileState.profiles[pid] || {};
    profileList.appendChild(buildProfileRow(pid, info));
  });
  updateSettingsActionButtons();
}

function showAddProfileRow() {
  if (!profileList) return;
  if (addRowEl && addRowEl.parentNode) return;

  addRowEl = document.createElement('div');
  addRowEl.className = 'profile-row add-profile-form';

  const input = document.createElement('input');
  input.type = 'text';
  input.placeholder = 'Nháº­p profile_id (UUID)';

  const saveBtn = document.createElement('button');
  saveBtn.type = 'button';
  saveBtn.className = 'btn-success';
  saveBtn.textContent = 'LÆ°u';
  saveBtn.addEventListener('click', () => {
    const value = (input.value || '').trim();
    if (!value) {
      showToast('Vui lÃ²ng nháº­p profile_id', 'error');
      return;
    }
    callBackend('/settings/profiles', {
      method: 'POST',
      body: JSON.stringify({ profile_id: value }),
    })
      .then(() => {
        if (!profileState.profiles[value]) {
          profileState.profiles[value] = { 
            cookie: '', 
            access_token: '', 
            fb_dtsg: '', 
            lsd: '', 
            spin_r: '', 
            spin_t: '',
            groups: [] 
          };
        }
        saveProfileState();
        // ThÃªm row má»›i mÃ  khÃ´ng render láº¡i toÃ n bá»™ (trÃ¡nh nhÃ¡y)
        if (profileList.classList.contains('empty-state-box')) {
          profileList.classList.remove('empty-state-box');
          profileList.innerHTML = '';
        }
        const newRow = buildProfileRow(value, profileState.profiles[value], true); // true = isNew
        // insert trÆ°á»›c addRowEl Ä‘á»ƒ form váº«n á»Ÿ cuá»‘i
        profileList.insertBefore(newRow, addRowEl);
        // remove form add
        addRowEl.remove();
        addRowEl = null;
      })
      .catch(() => showToast('KhÃ´ng thÃªm Ä‘Æ°á»£c profile (kiá»ƒm tra FastAPI).', 'error'));
  });

  const cancelBtn = document.createElement('button');
  cancelBtn.type = 'button';
  cancelBtn.className = 'btn-secondary';
  cancelBtn.textContent = 'Há»§y';
  cancelBtn.addEventListener('click', () => {
    if (addRowEl && addRowEl.parentNode) {
      addRowEl.parentNode.removeChild(addRowEl);
      addRowEl = null;
    }
  });

  addRowEl.appendChild(input);
  addRowEl.appendChild(saveBtn);
  addRowEl.appendChild(cancelBtn);
  // luÃ´n Ä‘á»ƒ form á»Ÿ cuá»‘i list
  if (profileList.classList.contains('empty-state-box')) {
    profileList.classList.remove('empty-state-box');
    profileList.innerHTML = '';
  }
  profileList.appendChild(addRowEl);
  input.focus();
}

if (saveApiKeyBtn) {
  saveApiKeyBtn.addEventListener('click', () => {
    profileState.apiKey = (settingApiKeyInput?.value || '').trim();
    // LÆ°u local trÆ°á»›c Ä‘á»ƒ khÃ´ng máº¥t dá»¯ liá»‡u náº¿u backend lá»—i
    saveProfileState();

    callBackend('/settings/api-key', {
      method: 'PUT',
      body: JSON.stringify({ api_key: profileState.apiKey }),
    })
      .then(() => showToast('ÄÃ£ lÆ°u API Key', 'success'))
      .catch(() => {
        showToast('KhÃ´ng lÆ°u Ä‘Æ°á»£c API Key (kiá»ƒm tra FastAPI).', 'error');
      });
  });
}

// Cleanup files button
const cleanupFilesBtn = document.getElementById('cleanupFilesBtn');
const cleanupStatus = document.getElementById('cleanupStatus');

if (cleanupFilesBtn) {
  cleanupFilesBtn.addEventListener('click', async () => {
    if (!cleanupStatus) return;

    // Disable button vÃ  hiá»ƒn thá»‹ loading
    cleanupFilesBtn.disabled = true;
    cleanupFilesBtn.textContent = 'Äang dá»n dáº¹p...';
    cleanupStatus.style.display = 'block';
    cleanupStatus.className = 'cleanup-status';
    cleanupStatus.textContent = 'Äang dá»n dáº¹p file cÅ©...';

    try {
      const response = await callBackend('/cleanup/old-files', {
        method: 'POST',
        body: JSON.stringify({ max_days: 3 })
      });

      // Hiá»ƒn thá»‹ káº¿t quáº£
      cleanupStatus.className = 'cleanup-status success';
      cleanupStatus.textContent = `âœ… ${response.message}`;

      // Hiá»ƒn thá»‹ danh sÃ¡ch file Ä‘Ã£ xÃ³a náº¿u cÃ³
      if (response.deleted_files && response.deleted_files.length > 0) {
        cleanupStatus.innerHTML += '<br><small>Files Ä‘Ã£ xÃ³a:</small><ul>';
        response.deleted_files.forEach(filename => {
          cleanupStatus.innerHTML += `<li>${filename}</li>`;
        });
        cleanupStatus.innerHTML += '</ul>';
      }

      showToast(`ÄÃ£ dá»n dáº¹p ${response.deleted_count} file cÅ©`, 'success');

    } catch (error) {
      console.error('Lá»—i khi dá»n dáº¹p file:', error);
      cleanupStatus.className = 'cleanup-status error';
      cleanupStatus.textContent = 'âŒ Lá»—i khi dá»n dáº¹p file cÅ©';
      showToast('Lá»—i khi dá»n dáº¹p file cÅ©', 'error');
    } finally {
      // Reset button
      cleanupFilesBtn.disabled = false;
      cleanupFilesBtn.innerHTML = 'ðŸ—‘ï¸ Dá»n dáº¹p ngay';
    }
  });
}

if (addProfileRowBtn) {
  addProfileRowBtn.addEventListener('click', showAddProfileRow);
}

if (feedAccountSettingBtn) {
  feedAccountSettingBtn.addEventListener('click', () => {
    const selected = getSelectedProfileIds();
    if (selected.length === 0) {
      showToast('HÃ£y tick Ã­t nháº¥t 1 profile trÆ°á»›c.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return;
    }
    if (!feedConfigPanel) {
      showToast('Thiáº¿u UI feedConfigPanel.', 'error');
      return;
    }
    // Náº¿u panel quÃ©t bÃ i viáº¿t Ä‘ang má»Ÿ thÃ¬ táº¯t Ä‘i Ä‘á»ƒ khá»i chá»“ng UI
    if (scanConfigPanel) scanConfigPanel.style.display = 'none';
    // Náº¿u panel quÃ©t theo group Ä‘ang má»Ÿ thÃ¬ táº¯t Ä‘i Ä‘á»ƒ khá»i chá»“ng UI
    if (groupScanPanel) groupScanPanel.style.display = 'none';
    feedConfigPanel.style.display = (feedConfigPanel.style.display === 'none' || !feedConfigPanel.style.display) ? 'block' : 'none';
  });
}

if (feedCancelBtn && feedConfigPanel) {
  feedCancelBtn.addEventListener('click', () => {
    feedConfigPanel.style.display = 'none';
  });
}

if (feedStartBtn) {
  feedStartBtn.addEventListener('click', async () => {
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ nuÃ´i acc.', 'error');
      return;
    }

    const modeEl = document.querySelector('input[name="feedMode"]:checked');
    const mode = modeEl ? String(modeEl.value || 'feed') : 'feed';
    const text = String(feedTextInput?.value || '').trim();
    const runMinutes = parseInt(String(feedRunMinutesInput?.value || '30').trim(), 10);
    const restMinutes = parseInt(String(feedRestMinutesInput?.value || '0').trim(), 10);

    // Feed: cho phÃ©p text rá»—ng (quÃ©t theo keyword máº·c Ä‘á»‹nh). Search: báº¯t buá»™c cÃ³ text.
    if (!text && mode === 'search') {
      showToast('Search cáº§n nháº­p text.', 'error');
      return;
    }
    if (!runMinutes || runMinutes <= 0) {
      showToast('Cháº¡y (phÃºt) khÃ´ng há»£p lá»‡.', 'error');
      return;
    }
    if (!Number.isFinite(restMinutes) || restMinutes < 0) {
      showToast('Nghá»‰ (phÃºt) khÃ´ng há»£p lá»‡.', 'error');
      return;
    }

    setButtonLoading(feedStartBtn, true, 'Äang cháº¡y...');
    setButtonLoading(feedAccountSettingBtn, true, 'Äang nuÃ´i acc...');
    try {
      const res = await callBackend('/feed/start', {
        method: 'POST',
        body: JSON.stringify({
          profile_ids: selected,
          mode,
          text,
          run_minutes: runMinutes,
          rest_minutes: restMinutes,
        }),
      });
      const started = res && Array.isArray(res.started) ? res.started.length : 0;
      const skipped = res && Array.isArray(res.skipped) ? res.skipped.length : 0;
      const loopText = (restMinutes > 0) ? ` (loop: ${runMinutes}p / nghá»‰ ${restMinutes}p)` : '';
      showToast(`ÄÃ£ cháº¡y nuÃ´i acc (${mode})${loopText}: started=${started}, skipped=${skipped}`, 'success', 2600);
      if (feedConfigPanel) feedConfigPanel.style.display = 'none';

      // Náº¿u cháº¡y vÃ²ng láº·p (restMinutes > 0) thÃ¬ coi nhÆ° cháº¡y liÃªn tá»¥c -> khÃ´ng poll "hoÃ n thÃ nh"
      if (restMinutes <= 0) {
        if (feedPollTimer) clearInterval(feedPollTimer);
        feedPollTimer = setInterval(async () => {
          try {
            const st = await callBackendNoAlert('/feed/status', { method: 'GET' });
            const running = (st && Array.isArray(st.running)) ? st.running : [];
            const still = selected.filter((pid) => running.includes(pid));
            if (still.length === 0) {
              clearInterval(feedPollTimer);
              feedPollTimer = null;
              setButtonLoading(feedStartBtn, false);
              setButtonLoading(feedAccountSettingBtn, false);
              showToast('âœ… NuÃ´i acc: HoÃ n thÃ nh', 'success', 2000);
            }
          } catch (e) {
            clearInterval(feedPollTimer);
            feedPollTimer = null;
            setButtonLoading(feedStartBtn, false);
            setButtonLoading(feedAccountSettingBtn, false);
            showToast('KhÃ´ng láº¥y Ä‘Æ°á»£c tráº¡ng thÃ¡i nuÃ´i acc (kiá»ƒm tra FastAPI).', 'error');
          }
        }, 4000);
      }
    } catch (e) {
      setButtonLoading(feedStartBtn, false);
      setButtonLoading(feedAccountSettingBtn, false);
      showToast('KhÃ´ng cháº¡y Ä‘Æ°á»£c nuÃ´i acc (kiá»ƒm tra FastAPI).', 'error');
    }
  });
}

if (autoJoinGroupBtn) {
  autoJoinGroupBtn.addEventListener('click', async () => {
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ auto join group.', 'error');
      return;
    }

    // Spinner + thÃ´ng bÃ¡o
    setButtonLoading(autoJoinGroupBtn, true, 'Äang auto join...');
    try {
      const res = await callBackend('/groups/join', {
        method: 'POST',
        body: JSON.stringify({ profile_ids: selected }),
      });
      const started = res && Array.isArray(res.started) ? res.started.length : 0;
      const skipped = res && Array.isArray(res.skipped) ? res.skipped.length : 0;
      showToast(`ÄÃ£ cháº¡y auto join group: started=${started}, skipped=${skipped}`, 'success', 2200);

      // Poll Ä‘áº¿n khi hoÃ n táº¥t (running khÃ´ng cÃ²n cÃ¡c profile Ä‘Ã£ chá»n)
      if (joinGroupPollTimer) clearInterval(joinGroupPollTimer);
      joinGroupPollTimer = setInterval(async () => {
        try {
          const st = await callBackendNoAlert('/groups/join/status', { method: 'GET' });
          const running = (st && Array.isArray(st.running)) ? st.running : [];
          const still = selected.filter((pid) => running.includes(pid));
          if (still.length === 0) {
            clearInterval(joinGroupPollTimer);
            joinGroupPollTimer = null;
            setButtonLoading(autoJoinGroupBtn, false);
            showToast('âœ… Auto join group: HoÃ n thÃ nh', 'success', 2000);
          }
        } catch (e) {
          // Náº¿u lá»—i poll thÃ¬ dá»«ng poll Ä‘á»ƒ khÃ´ng spam
          clearInterval(joinGroupPollTimer);
          joinGroupPollTimer = null;
          setButtonLoading(autoJoinGroupBtn, false);
          showToast('KhÃ´ng láº¥y Ä‘Æ°á»£c tráº¡ng thÃ¡i auto join (kiá»ƒm tra FastAPI).', 'error');
        }
      }, 4000);
    } catch (e) {
      showToast('KhÃ´ng cháº¡y Ä‘Æ°á»£c auto join group (kiá»ƒm tra FastAPI).', 'error');
      setButtonLoading(autoJoinGroupBtn, false);
    }
  });
}

// NÃºt "QuÃ©t bÃ i viáº¿t" trong tab Setting profile
if (scanPostsSettingBtn) {
  scanPostsSettingBtn.addEventListener('click', () => {
    const selected = getSelectedProfileIds();
    if (selected.length === 0) {
      showToast('HÃ£y tick Ã­t nháº¥t 1 profile trÆ°á»›c.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return;
    }
    if (!scanConfigPanel) {
      showToast('Thiáº¿u UI scanConfigPanel.', 'error');
      return;
    }
    // ÄÃ³ng panel nuÃ´i acc náº¿u Ä‘ang má»Ÿ Ä‘á»ƒ khá»i rá»‘i
    if (feedConfigPanel) feedConfigPanel.style.display = 'none';
    // ÄÃ³ng panel quÃ©t theo group náº¿u Ä‘ang má»Ÿ
    if (groupScanPanel) groupScanPanel.style.display = 'none';
    const isOpen = scanConfigPanel.style.display !== 'none';
    scanConfigPanel.style.display = isOpen ? 'none' : 'block';
  });
}

if (scanCancelBtn && scanConfigPanel) {
  scanCancelBtn.addEventListener('click', () => {
    scanConfigPanel.style.display = 'none';
  });
}

// NÃºt "QuÃ©t theo group" (UI only)
if (scanGroupSettingBtn) {
  scanGroupSettingBtn.addEventListener('click', () => {
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile trÆ°á»›c.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return;
    }
    if (!groupScanPanel) {
      showToast('Thiáº¿u UI groupScanPanel.', 'error');
      return;
    }
    // ÄÃ³ng cÃ¡c panel khÃ¡c Ä‘á»ƒ khá»i chá»“ng UI
    if (feedConfigPanel) feedConfigPanel.style.display = 'none';
    if (scanConfigPanel) scanConfigPanel.style.display = 'none';

    const isOpen = groupScanPanel.style.display !== 'none';
    groupScanPanel.style.display = isOpen ? 'none' : 'block';
    if (!isOpen && groupScanUrlInput) groupScanUrlInput.focus();
  });
}

if (groupScanCancelBtn && groupScanPanel) {
  groupScanCancelBtn.addEventListener('click', () => {
    groupScanPanel.style.display = 'none';
  });
}

// UI only: báº¥m "Cháº¡y" thÃ¬ chá»‰ validate + toast (chÆ°a gá»i API)
if (groupScanStartBtn) {
  groupScanStartBtn.addEventListener('click', () => {
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile trÆ°á»›c.', 'error');
      return;
    }
    const raw = String(groupScanUrlInput?.value || '');
    const urls = raw
      .split(/\r?\n/)
      .map((s) => String(s || '').trim())
      .filter(Boolean);
    const postCount = parseInt(String(groupScanPostCountInput?.value || '0').trim(), 10);
    const startDate = String(groupScanStartDateInput?.value || '').trim();
    const endDate = String(groupScanEndDateInput?.value || '').trim();
    if (urls.length === 0) {
      showToast('Nháº­p Ã­t nháº¥t 1 URL group (má»—i dÃ²ng 1 URL).', 'error');
      return;
    }
    if (!Number.isFinite(postCount) || postCount < 0) {
      showToast('Sá»‘ bÃ i viáº¿t theo dÃµi khÃ´ng há»£p lá»‡.', 'error');
      return;
    }
    if (!startDate || !endDate) {
      showToast('Nháº­p Ä‘á»§ thá»i gian báº¯t Ä‘áº§u vÃ  káº¿t thÃºc.', 'error');
      return;
    }
    const startTs = Date.parse(startDate);
    const endTs = Date.parse(endDate);
    if (!Number.isFinite(startTs) || !Number.isFinite(endTs)) {
      showToast('Thá»i gian khÃ´ng há»£p lá»‡.', 'error');
      return;
    }
    if (startTs > endTs) {
      showToast('Thá»i gian báº¯t Ä‘áº§u pháº£i â‰¤ thá»i gian káº¿t thÃºc.', 'error');
      return;
    }

    showToast(
      `âœ… ÄÃ£ nháº­n ${urls.length} group URL, sá»‘ bÃ i: ${postCount}, tá»« ${startDate} Ä‘áº¿n ${endDate}`,
      'success',
      2400
    );
  });
}

if (scanStartBtn) {
  scanStartBtn.addEventListener('click', async () => {
    // Náº¿u Ä‘ang quÃ©t thÃ¬ khÃ´ng cho báº¥m láº¡i
    if (isScanning) {
      showToast('Äang quÃ©t, vui lÃ²ng Ä‘á»£i hoáº·c báº¥m dá»«ng trÆ°á»›c', 'warning');
      return;
    }
    
    // Náº¿u nÃºt Ä‘ang loading thÃ¬ khÃ´ng cho báº¥m láº¡i
    if (scanStartBtn.classList.contains('btn-loading')) {
      return;
    }
    
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ quÃ©t bÃ i viáº¿t.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return;
    }

    const runMinutes = parseInt(String(scanRunMinutesInput?.value || '0').trim(), 10);
    const restMinutes = parseInt(String(scanRestMinutesInput?.value || '0').trim(), 10);
    const text = String(scanTextInput?.value || '').trim();
    const mode = String(document.querySelector('input[name="scanMode"]:checked')?.value || 'feed').trim().toLowerCase();

    if (mode === 'search' && !text) {
      showToast('Search cáº§n nháº­p text Ä‘á»ƒ search.', 'error');
      return;
    }

    setButtonLoading(scanStartBtn, true, 'Äang cháº¡y...');
    setButtonLoading(scanPostsSettingBtn, true, 'Äang quÃ©t...');
    try {
      await startScanFlow({ runMinutes, restMinutes, text, mode });
      // Ä‘Ã³ng panel sau khi cháº¡y
      if (scanConfigPanel) scanConfigPanel.style.display = 'none';
    } catch (e) {
      showToast('KhÃ´ng cháº¡y Ä‘Æ°á»£c quÃ©t bÃ i viáº¿t (kiá»ƒm tra FastAPI).', 'error');
      setButtonLoading(scanStartBtn, false);
      setButtonLoading(scanPostsSettingBtn, false);
      setScanning(false);
    }
    // KhÃ´ng reset loading á»Ÿ Ä‘Ã¢y vÃ¬ setScanning(true) sáº½ giá»¯ tráº¡ng thÃ¡i
  });
}

/**
 * Helper function Ä‘á»ƒ reset info collector state
 */
function resetInfoCollectorState() {
  isInfoCollectorRunning = false;
  // Reset loading cá»§a cÃ¡c nÃºt info collector
  if (runAllInfoBtn) setButtonLoading(runAllInfoBtn, false);
  if (runSelectedInfoBtn) setButtonLoading(runSelectedInfoBtn, false);
  // Dá»«ng poll tiáº¿n trÃ¬nh
  if (infoProgressInterval) {
    clearInterval(infoProgressInterval);
    infoProgressInterval = null;
  }
  // áº¨n toast tiáº¿n trÃ¬nh
  const infoToast = document.getElementById('infoProgressToast');
  const progressToast = document.getElementById('progressToast');
  if (infoToast) infoToast.style.display = 'none';
  // áº¨n progressToast náº¿u cáº£ 2 toast Ä‘á»u áº©n
  const scanToast = document.getElementById('scanStatsToast');
  if (progressToast && (!scanToast || scanToast.style.display === 'none')) {
    progressToast.style.display = 'none';
  }
}

async function handleStopAll() {
  console.log('[UI] STOP ALL triggered');
  
  // Reset info collector state ngay láº­p tá»©c
  resetInfoCollectorState();
  
  // stop-all cÃ³ thá»ƒ báº¥m tá»« left panel hoáº·c tá»« setting header
  const btns = [stopAllBtn, stopAllSettingBtn].filter(Boolean);
  btns.forEach((b) => setButtonLoading(b, true, 'Äang dá»«ng táº¥t cáº£...'));
  
  try {
    // Æ¯u tiÃªn endpoint má»›i theo spec, fallback endpoint cÅ© Ä‘á»ƒ khá»i vá»¡ UI
    let res = null;
    try {
      res = await callBackend('/control/stop-all', { method: 'POST' });
    } catch (_) {
      res = await callBackend('/jobs/stop-all', { method: 'POST' }); // backward-compat
    }
    const botStopped = res && res.stopped ? Boolean(res.stopped.bot) : false;
    const joinStopped = res && res.stopped && Array.isArray(res.stopped.join_groups) ? res.stopped.join_groups.length : 0;
    const nstOk = res && Array.isArray(res.nst_stop_ok) ? res.nst_stop_ok.length : 0;
    const nstAttempted = res && Array.isArray(res.nst_stop_attempted) ? res.nst_stop_attempted.length : 0;
    const nstAll = res && typeof res.nst_stop_all_ok === 'boolean' ? res.nst_stop_all_ok : false;
    showToast(`ÄÃ£ dá»«ng táº¥t cáº£: bot=${botStopped ? 'OK' : 'NO'}, join_groups=${joinStopped}, NST=${nstOk}/${nstAttempted}${nstAll ? ' +ALL' : ''}`, 'success', 2800);
  } catch (e) {
    showToast('KhÃ´ng dá»«ng Ä‘Æ°á»£c táº¥t cáº£ (kiá»ƒm tra FastAPI).', 'error');
  } finally {
    // Reset UI quÃ©t (trÃ¡nh káº¹t spinner náº¿u user dá»«ng báº±ng stop-all)
    if (timerId) {
      clearInterval(timerId);
      timerId = null;
    }
    if (dataCheckInterval) {
      clearInterval(dataCheckInterval);
      dataCheckInterval = null;
    }
    setScanning(false);
    setButtonLoading(scanStartBtn, false);
    setButtonLoading(scanPostsSettingBtn, false);
    // stopBtn Ä‘Ã£ bá»‹ xÃ³a khá»i left-panel

    btns.forEach((b) => setButtonLoading(b, false));
    if (joinGroupPollTimer) {
      clearInterval(joinGroupPollTimer);
      joinGroupPollTimer = null;
    }
    if (feedPollTimer) {
      clearInterval(feedPollTimer);
      feedPollTimer = null;
    }
    setButtonLoading(autoJoinGroupBtn, false);
    setButtonLoading(feedAccountSettingBtn, false);
    setButtonLoading(feedStartBtn, false);
    if (feedConfigPanel) feedConfigPanel.style.display = 'none';
    
    // Refresh state vÃ  update buttons
    try {
      const jobs = await callBackendNoAlert('/jobs/status', { method: 'GET' });
      if (jobs) lastJobsStatus = jobs;
    } catch (_) { }
    try { await refreshControlState(); } catch (_) { }
    updateStopPauseButtonsByJobs(); // Update buttons sau khi reset state
  }
}

async function handleStopSelectedProfiles() {
  const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
  if (selected.length === 0) {
    showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ dá»«ng.', 'error');
    return;
  }
  if (!stopSelectedProfilesBtn) return;
  if (stopSelectedProfilesBtn.classList.contains('btn-loading')) return;

  // Reset info collector state náº¿u Ä‘ang cháº¡y (cÃ³ thá»ƒ stop info collector)
  resetInfoCollectorState();
  
  console.log(`[UI] STOP selected profiles=${selected.join(',')}`);
  setButtonLoading(stopSelectedProfilesBtn, true, 'Äang dá»«ng...');

  try {
    const res = await callBackend('/control/stop-profiles', {
      method: 'POST',
      body: JSON.stringify({ profile_ids: selected }),
    });

    const okCount = res && Array.isArray(res.nst_ok) ? res.nst_ok.length : 0;
    const failCount = res && Array.isArray(res.nst_fail) ? res.nst_fail.length : 0;
    showToast(`ÄÃ£ dá»«ng ${selected.length} profile (NST ok=${okCount}, fail=${failCount})`, 'success', 2400);

    // Refresh state Ä‘á»ƒ badge vá» Sáº´N SÃ€NG ngay
    try {
      const jobs = await callBackendNoAlert('/jobs/status', { method: 'GET' });
      if (jobs) lastJobsStatus = jobs;
    } catch (_) { }
    try { await refreshControlState(); } catch (_) { }
    updateStopPauseButtonsByJobs(); // Update buttons sau khi refresh state
    // Náº¿u khÃ´ng cÃ²n bot_profile_ids thÃ¬ UI quÃ©t pháº£i vá» "Sáºµn sÃ ng"
    try {
      const botHasProfiles = Array.isArray(lastJobsStatus && lastJobsStatus.bot_profile_ids) && lastJobsStatus.bot_profile_ids.length > 0;
      if (!botHasProfiles) {
        if (dataCheckInterval) { clearInterval(dataCheckInterval); dataCheckInterval = null; }
        setScanning(false);
        setButtonLoading(scanStartBtn, false);
        setButtonLoading(scanPostsSettingBtn, false);
      }
    } catch (_) { }
  } catch (e) {
    showToast('KhÃ´ng dá»«ng Ä‘Æ°á»£c profile Ä‘Ã£ chá»n (kiá»ƒm tra FastAPI).', 'error');
  } finally {
    setButtonLoading(stopSelectedProfilesBtn, false);
    updateStopPauseButtonsByJobs(); // Update buttons sau khi hoÃ n thÃ nh
  }
}

if (stopSelectedProfilesBtn) {
  stopSelectedProfilesBtn.addEventListener('click', handleStopSelectedProfiles);
}

async function handlePauseSelectedProfiles() {
  const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
  if (selected.length === 0) {
    showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ pause.', 'error');
    return;
  }
  if (!pauseSelectedProfilesBtn) return;
  if (pauseSelectedProfilesBtn.classList.contains('btn-loading')) return;

  // Toggle: náº¿u cÃ³ Ã­t nháº¥t 1 profile Ä‘ang paused -> RESUME, ngÆ°á»£c láº¡i -> PAUSE
  const st0 = await callBackendNoAlert('/control/state', { method: 'GET' });
  const pausedSet = new Set(Array.isArray(st0 && st0.paused_profiles) ? st0.paused_profiles.map((x) => String(x)) : []);
  const anyPaused = selected.some((pid) => pausedSet.has(String(pid)));
  const action = anyPaused ? 'RESUME' : 'PAUSE';
  console.log(`[UI] ${action} selected profiles=${selected.join(',')}`);
  setButtonLoading(pauseSelectedProfilesBtn, true, anyPaused ? 'Äang tiáº¿p tá»¥c...' : 'Äang táº¡m dá»«ng...');
  try {
    const endpoint = anyPaused ? '/control/resume-profiles' : '/control/pause-profiles';
    await callBackend(endpoint, { method: 'POST', body: JSON.stringify({ profile_ids: selected }) });
    showToast(anyPaused ? `ÄÃ£ tiáº¿p tá»¥c ${selected.length} profile` : `ÄÃ£ táº¡m dá»«ng ${selected.length} profile`, 'success', 2200);
  } catch (e) {
    showToast('KhÃ´ng pause Ä‘Æ°á»£c profile Ä‘Ã£ tick (kiá»ƒm tra FastAPI).', 'error');
  } finally {
    setButtonLoading(pauseSelectedProfilesBtn, false);
    try { 
      await refreshControlState(); 
      updateStopPauseButtonsByJobs(); // Update buttons sau khi refresh state
    } catch (_) { }
  }
}

if (pauseSelectedProfilesBtn) {
  pauseSelectedProfilesBtn.addEventListener('click', handlePauseSelectedProfiles);
}

async function refreshControlState() {
  try {
    const st = await callBackendNoAlert('/control/state', { method: 'GET' });
    if (!st) return;
    isPausedAll = Boolean(st.global_pause);
    try { updateSettingsActionButtons(); } catch (_) { }
    try { syncRunningLabelsWithPauseState(); } catch (_) { }
    setPauseAllButtonLabel(isPausedAll);
    try { applyControlStateToProfileRows(st); } catch (_) { }
    try { updateStopPauseButtonsByJobs(); } catch (_) { }
    // Update label cá»§a nÃºt pause-selected theo tráº¡ng thÃ¡i paused_profiles
    try {
      if (pauseSelectedProfilesBtn && !pauseSelectedProfilesBtn.classList.contains('btn-loading')) {
        const selected = getSelectedProfileIds();
        const pausedSet = new Set(Array.isArray(st.paused_profiles) ? st.paused_profiles.map((x) => String(x)) : []);
        const anyPaused = selected.some((pid) => pausedSet.has(String(pid)));
        pauseSelectedProfilesBtn.textContent = anyPaused ? 'Tiáº¿p tá»¥c profile Ä‘Ã£ chá»n' : 'Táº¡m dá»«ng profile Ä‘Ã£ chá»n';
      }
    } catch (_) { }
  } catch (_) { }
}

function _clearIntervalSafe(kind) {
  try {
    if (kind === 'scan' && scanBackendPollTimer) clearInterval(scanBackendPollTimer);
    if (kind === 'join' && joinGroupPollTimer) clearInterval(joinGroupPollTimer);
    if (kind === 'feed' && feedPollTimer) clearInterval(feedPollTimer);
  } catch (_) { }
  if (kind === 'scan') scanBackendPollTimer = null;
  if (kind === 'join') joinGroupPollTimer = null;
  if (kind === 'feed') feedPollTimer = null;
}

function startScanBackendPoll({ silent = true } = {}) {
  _clearIntervalSafe('scan');
  scanBackendPollTimer = setInterval(async () => {
    const st = await callBackendNoAlert('/jobs/status', { method: 'GET' });
    if (st) lastJobsStatus = st;
    updateStopPauseButtonsByJobs();
    const botHasProfiles = Array.isArray(st && st.bot_profile_ids) && st.bot_profile_ids.length > 0;
    const running = !!(st && st.bot_running && botHasProfiles);
    if (!running) {
      _clearIntervalSafe('scan');
      if (dataCheckInterval) {
        clearInterval(dataCheckInterval);
        dataCheckInterval = null;
      }
      setScanning(false);
      setButtonLoading(scanStartBtn, false);
      setButtonLoading(scanPostsSettingBtn, false);
      if (!silent) showToast('âœ… QuÃ©t: HoÃ n thÃ nh', 'success', 1800);
    } else {
      syncRunningLabelsWithPauseState();
      try { refreshControlState(); } catch (_) { }
    }
  }, 4000);
}

function startJoinBackendPoll({ silent = true } = {}) {
  _clearIntervalSafe('join');
  joinGroupPollTimer = setInterval(async () => {
    const st = await callBackendNoAlert('/jobs/status', { method: 'GET' });
    if (st) lastJobsStatus = st;
    updateStopPauseButtonsByJobs();
    const running = (st && Array.isArray(st.join_groups_running)) ? st.join_groups_running : [];
    if (running.length === 0) {
      _clearIntervalSafe('join');
      setButtonLoading(autoJoinGroupBtn, false);
      if (!silent) showToast('âœ… Auto join group: HoÃ n thÃ nh', 'success', 1800);
    } else {
      syncRunningLabelsWithPauseState();
      try { refreshControlState(); } catch (_) { }
    }
  }, 4000);
}

function startFeedBackendPoll({ silent = true } = {}) {
  _clearIntervalSafe('feed');
  feedPollTimer = setInterval(async () => {
    const st = await callBackendNoAlert('/jobs/status', { method: 'GET' });
    if (st) lastJobsStatus = st;
    updateStopPauseButtonsByJobs();
    const running = (st && Array.isArray(st.feed_running)) ? st.feed_running : [];
    if (running.length === 0) {
      _clearIntervalSafe('feed');
      setButtonLoading(feedStartBtn, false);
      setButtonLoading(feedAccountSettingBtn, false);
      if (!silent) showToast('âœ… NuÃ´i acc: HoÃ n thÃ nh', 'success', 1800);
    } else {
      syncRunningLabelsWithPauseState();
      try { refreshControlState(); } catch (_) { }
    }
  }, 4000);
}

async function resyncUiFromBackendAfterReload() {
  // Sync pause state trÆ°á»›c Ä‘á»ƒ label chuáº©n
  await refreshControlState();

  const jobs = await callBackendNoAlert('/jobs/status', { method: 'GET' });
  if (!jobs) return;
  lastJobsStatus = jobs;
  updateStopPauseButtonsByJobs();

  // --- Scan (AppRunner) ---
  if (jobs.bot_running) {
    setScanning(true);
    setButtonLoading(scanStartBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang cháº¡y...');
    setButtonLoading(scanPostsSettingBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang quÃ©t...');
    if (!dataCheckInterval) dataCheckInterval = setInterval(checkForNewData, 5000);
    startScanBackendPoll({ silent: true });
  } else {
    setScanning(false);
    setButtonLoading(scanStartBtn, false);
    setButtonLoading(scanPostsSettingBtn, false);
    _clearIntervalSafe('scan');
  }

  // --- Join groups ---
  const joinRunning = Array.isArray(jobs.join_groups_running) ? jobs.join_groups_running : [];
  if (joinRunning.length > 0) {
    setButtonLoading(autoJoinGroupBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang auto join...');
    startJoinBackendPoll({ silent: true });
  } else {
    setButtonLoading(autoJoinGroupBtn, false);
    _clearIntervalSafe('join');
  }

  // --- Feed ---
  const feedRunning = Array.isArray(jobs.feed_running) ? jobs.feed_running : [];
  if (feedRunning.length > 0) {
    setButtonLoading(feedStartBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang cháº¡y...');
    setButtonLoading(feedAccountSettingBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang nuÃ´i acc...');
    startFeedBackendPoll({ silent: true });
  } else {
    setButtonLoading(feedStartBtn, false);
    setButtonLoading(feedAccountSettingBtn, false);
    _clearIntervalSafe('feed');
  }

  syncRunningLabelsWithPauseState();
  // Re-apply control state sau khi Ä‘Ã£ cÃ³ lastJobsStatus Ä‘á»ƒ badge khÃ´ng bá»‹ sai lÃºc vá»«a vÃ o trang
  try { await refreshControlState(); } catch (_) { }
}

async function handlePauseAllToggle() {
  if (!pauseAllBtn) return;
  if (pauseAllBtn.classList.contains('btn-loading')) return;
  
  const wasPaused = isPausedAll;
  
  try {
    if (!wasPaused) {
      console.log('[UI] PAUSE ALL triggered');
      setButtonLoading(pauseAllBtn, true, 'Äang táº¡m dá»«ng...');
      // update UI ngay Ä‘á»ƒ trÃ¡nh user tháº¥y "Ä‘ang quÃ©t" khi Ä‘Ã£ pause
      isPausedAll = true;
      syncRunningLabelsWithPauseState();
      await callBackend('/control/pause-all', { method: 'POST' });
      showToast('ÄÃ£ táº¡m dá»«ng táº¥t cáº£', 'success');
    } else {
      console.log('[UI] RESUME ALL triggered');
      setButtonLoading(pauseAllBtn, true, 'Äang tiáº¿p tá»¥c...');
      isPausedAll = false;
      syncRunningLabelsWithPauseState();
      await callBackend('/control/resume-all', { method: 'POST' });
      showToast('ÄÃ£ tiáº¿p tá»¥c táº¥t cáº£', 'success');
    }
  } catch (e) {
    // Rollback UI state náº¿u cÃ³ lá»—i
    isPausedAll = wasPaused;
    syncRunningLabelsWithPauseState();
    showToast('KhÃ´ng pause/resume Ä‘Æ°á»£c (kiá»ƒm tra FastAPI).', 'error');
  } finally {
    setButtonLoading(pauseAllBtn, false);
    await refreshControlState();
    updateStopPauseButtonsByJobs(); // Update buttons sau khi refresh state
  }
}

if (pauseAllBtn) {
  pauseAllBtn.addEventListener('click', handlePauseAllToggle);
}

if (stopAllBtn) {
  stopAllBtn.addEventListener('click', handleStopAll);
}

if (stopAllSettingBtn) {
  stopAllSettingBtn.addEventListener('click', handleStopAll);
}

function getTypeColorClass(type) {
  const typeLower = String(type).toLowerCase().trim();

  // Xanh cho: scan, success, ok, completed
  if (typeLower === 'type1' || typeLower === 'success' || typeLower === 'ok' || typeLower === 'completed') {
    return 'type-green';
  }

  // VÃ ng cho: retry, warning, pending, processing
  if (typeLower === 'type2' || typeLower === 'warning' || typeLower === 'pending' || typeLower === 'processing') {
    return 'type-yellow';
  }

  // Äá» cho: error, fail, failed, cancel
  if (typeLower === 'type3' || typeLower === 'fail' || typeLower === 'failed' || typeLower === 'cancel') {
    return 'type-red';
  }

  // Máº·c Ä‘á»‹nh: xanh
  return 'type-green';
}

// Map flag -> type cho quáº£n lÃ½ post
function mapFlagToType(flag) {
  const f = String(flag || '').toLowerCase();
  if (f === 'xanh') return 'type1';
  if (f === 'vÃ ng' || f === 'vang') return 'type2';
  if (f === 'Ä‘á»' || f === 'do') return 'type3';
  return 'type1';
}

function appendRow({ id, userId, name, react, comment, time, type }) {
  const tr = document.createElement('tr');
  const typeColorClass = getTypeColorClass(type);
  // React: hiá»ƒn thá»‹ dáº¥u tÃ­ch náº¿u cÃ³, khÃ´ng thÃ¬ Ä‘á»ƒ trá»‘ng
  const reactDisplay = react ? 'âœ“' : '';
  // Link cho ID BÃ i Post vÃ  ID User
  const postIdDisplay = id
    ? `<a href="https://fb.com/${id}" target="_blank" rel="noopener noreferrer" class="id-link">${id}</a>`
    : '';
  const userIdDisplay = userId
    ? `<a href="https://fb.com/${userId}" target="_blank" rel="noopener noreferrer" class="id-link">${userId}</a>`
    : '';
  // Comment: náº¿u cÃ³ comment thÃ¬ hiá»ƒn thá»‹ icon con máº¯t, click má»›i xem ná»™i dung
  const hasComment = !!comment;
  const commentDisplay = hasComment ? '<button class="comment-eye-btn" type="button" title="Xem comment">ðŸ‘</button>' : '';

  // LÆ°u timestamp Ä‘á»ƒ sáº¯p xáº¿p
  const timestamp = parseTime(time || '');
  tr.dataset.timestamp = timestamp;
  tr.dataset.hasReact = react ? 'true' : 'false';
  tr.dataset.hasComment = hasComment ? 'true' : 'false';

  tr.innerHTML = `
    <td>${postIdDisplay}</td>
    <td>${userIdDisplay}</td>
    <td>${name || ''}</td>
    <td>${reactDisplay}</td>
    <td>${commentDisplay}</td>
    <td>${time || ''}</td>
    <td class="type-cell ${typeColorClass}">${type || ''}</td>
  `;
  tr.style.opacity = '0';
  tr.style.transform = 'translateY(-10px)';
  tbody.appendChild(tr);

  // Gáº¯n dá»¯ liá»‡u comment vÃ  sá»± kiá»‡n click cho icon con máº¯t
  if (hasComment) {
    const commentCell = tr.children[4]; // cá»™t Comment
    commentCell.dataset.comment = comment;
    commentCell.dataset.showingText = 'false'; // Tráº¡ng thÃ¡i: false = Ä‘ang hiá»ƒn thá»‹ icon, true = Ä‘ang hiá»ƒn thá»‹ text

    const eyeBtn = commentCell.querySelector('.comment-eye-btn');
    if (eyeBtn) {
      // HÃ m toggle giá»¯a icon vÃ  text
      const toggleComment = (e) => {
        if (e) e.stopPropagation();
        const text = commentCell.dataset.comment || '';
        if (!text) return;

        const isShowingText = commentCell.dataset.showingText === 'true';

        if (isShowingText) {
          // Äang hiá»ƒn thá»‹ text â†’ chuyá»ƒn vá» icon
          commentCell.innerHTML = '<button class="comment-eye-btn" type="button" title="Xem comment">ðŸ‘</button>';
          commentCell.dataset.showingText = 'false';
          // Gáº¯n láº¡i event listener cho icon má»›i
          const newEyeBtn = commentCell.querySelector('.comment-eye-btn');
          if (newEyeBtn) {
            newEyeBtn.addEventListener('click', toggleComment);
          }
        } else {
          // Äang hiá»ƒn thá»‹ icon â†’ chuyá»ƒn sang text
          commentCell.innerHTML = `<span class="comment-text" style="cursor: pointer; color: var(--text-primary);">${text}</span>`;
          commentCell.dataset.showingText = 'true';
          // Gáº¯n event listener cho text Ä‘á»ƒ click láº¡i sáº½ hiá»‡n icon
          const commentText = commentCell.querySelector('.comment-text');
          if (commentText) {
            commentText.addEventListener('click', toggleComment);
          }
        }
      };

      eyeBtn.addEventListener('click', toggleComment);
    }
  }

  // Animation
  setTimeout(() => {
    tr.style.transition = 'all 0.3s ease';
    tr.style.opacity = '1';
    tr.style.transform = 'translateY(0)';
  }, 10);

  emptyState.classList.remove('show');
  updateRowCount();
}

// ThÃªm dÃ²ng cho báº£ng Quáº£n lÃ½ post
function appendPostRow(item) {
  if (!postTableBody) return;
  const flag = item.flag || '';
  const type = mapFlagToType(flag);
  const typeClass = getTypeColorClass(type);
  const tr = document.createElement('tr');
  const postId = item.post_id || '';
  const text = item.text || '';

  const postLink = postId
    ? `<a href="https://fb.com/${postId}" target="_blank" rel="noopener noreferrer" class="id-link">${postId}</a>`
    : '';

  tr.innerHTML = `
    <td>${postLink}</td>
    <td>${text}</td>
    <td class="type-cell ${typeClass}">${type}</td>
  `;

  postTableBody.appendChild(tr);
}

function addGeneratedRow() {
  // Táº¡o type ngáº«u nhiÃªn Ä‘á»ƒ cÃ³ mÃ u sáº¯c Ä‘a dáº¡ng
  const types = ['type1', 'type2', 'type3'];
  const randomType = types[Math.floor(Math.random() * types.length)];
  const names = ['Nguyá»…n VÄƒn A', 'Tráº§n Thá»‹ B', 'LÃª VÄƒn C', 'Pháº¡m Thá»‹ D', 'HoÃ ng VÄƒn E'];
  const randomName = names[Math.floor(Math.random() * names.length)];
  const comments = ['Ráº¥t hay!', 'Cáº£m Æ¡n báº¡n', 'Tuyá»‡t vá»i', 'Äá»“ng Ã½', ''];
  const randomComment = comments[Math.floor(Math.random() * comments.length)];

  appendRow({
    id: counter++,
    userId: `user_${Math.floor(Math.random() * 1000000)}`,
    name: randomName,
    react: Math.random() > 0.3, // 70% cÃ³ react
    comment: randomComment,
    time: new Date().toLocaleTimeString('vi-VN'),
    type: randomType,
  });
}

// HÃ m kiá»ƒm tra vÃ  thÃªm dá»¯ liá»‡u má»›i
async function checkForNewData() {
  try {
    const res = await callBackend('/data/latest-results', { method: 'GET' });
    const data = res.data;

    // Láº¥y táº¥t cáº£ posts tá»« results_by_file
    const allPosts = [];
    Object.values(data.results_by_file || {}).forEach(filePosts => {
      if (Array.isArray(filePosts)) {
        allPosts.push(...filePosts);
      }
    });

    let newCount = 0;
    // Chá»‰ thÃªm nhá»¯ng user má»›i (gá»™p cáº£ react & comment)
    allPosts.forEach((post) => {
      const postId = post.post_id || '';
      if (!postId) return;

      // Map flag thÃ nh type
      let type = 'type1';
      const flag = (post.flag || '').toLowerCase();
      if (flag === 'xanh') {
        type = 'type1';
      } else if (flag === 'vÃ ng' || flag === 'vang') {
        type = 'type2';
      } else if (flag === 'Ä‘á»' || flag === 'do') {
        type = 'type3';
      }

      // Thá»i gian máº·c Ä‘á»‹nh: comment má»›i nháº¥t cá»§a bÃ i (náº¿u cÃ³)
      let defaultTime = new Date().toLocaleTimeString('vi-VN');
      if (post.comments && post.comments.length > 0) {
        const sortedAllComments = [...post.comments].sort((a, b) => {
          const timeA = new Date(a.created_time_vn || 0);
          const timeB = new Date(b.created_time_vn || 0);
          return timeB - timeA;
        });
        if (sortedAllComments[0] && sortedAllComments[0].created_time_vn) {
          defaultTime = sortedAllComments[0].created_time_vn;
        }
      }

      // Gom reactions theo userId
      const reactionsByUser = new Map();
      if (post.reactions && post.reactions.length > 0) {
        post.reactions.forEach((r) => {
          const uid = r && r.id ? String(r.id) : '';
          if (!uid) return;
          reactionsByUser.set(uid, r);
        });
      }

      // Gom comments theo userId (láº¥y comment má»›i nháº¥t cá»§a tá»«ng user)
      const commentsByUser = new Map();
      if (post.comments && post.comments.length > 0) {
        post.comments.forEach((c) => {
          const uid = c && c.id ? String(c.id) : '';
          if (!uid) return;
          const prev = commentsByUser.get(uid);
          if (!prev) {
            commentsByUser.set(uid, c);
          } else {
            const prevTime = new Date(prev.created_time_vn || 0);
            const curTime = new Date(c.created_time_vn || 0);
            if (curTime > prevTime) {
              commentsByUser.set(uid, c);
            }
          }
        });
      }

      // Táº­p táº¥t cáº£ user xuáº¥t hiá»‡n á»Ÿ react hoáº·c comment
      const allUserIds = new Set([
        ...reactionsByUser.keys(),
        ...commentsByUser.keys(),
      ]);

      // Náº¿u khÃ´ng cÃ³ user nÃ o interact, hiá»ƒn thá»‹ post vá»›i thÃ´ng tin owner
      if (allUserIds.size === 0) {
        const owner = post.owning_profile || {};
        const ownerId = owner.id || 'unknown';
        const ownerName = owner.name || 'Unknown User';
        const uniqueKey = `${postId}_${ownerId}`;

        if (!loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: ownerId,
            name: ownerName,
            react: false,
            comment: '',
            time: defaultTime,
            type: type,
          });
          loadedPostIds.add(uniqueKey);
          displayedCount++;
        }
      }

      allUserIds.forEach((uid) => {
        const reaction = reactionsByUser.get(uid);
        const comment = commentsByUser.get(uid);

        const userId = uid;
        const name =
          (reaction && reaction.name) ||
          (comment && comment.name) ||
          '';

        const hasReact = !!reaction;
        const commentText = comment && comment.text ? comment.text : '';
        const time =
          (comment && comment.created_time_vn) ? comment.created_time_vn : defaultTime;

        const uniqueKey = `${postId}_${userId}`;
        if (uniqueKey && !loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: userId,
            name: name,
            react: hasReact,        // chá»‰ tick náº¿u cÃ³ trong reactions
            comment: commentText,   // chá»‰ cÃ³ text náº¿u user cÃ³ comment
            time: time,
            type: type,
          });

          loadedPostIds.add(uniqueKey);
          newCount++;
        }
      });
    });

    if (newCount > 0) {
      console.log(`ÄÃ£ thÃªm ${newCount} dÃ²ng dá»¯ liá»‡u má»›i`);
    }
  } catch (err) {
    console.error('KhÃ´ng kiá»ƒm tra Ä‘Æ°á»£c dá»¯ liá»‡u má»›i:', err);
  }
}

async function loadInitialData() {
  // Reset Ä‘á»ƒ cÃ³ thá»ƒ load láº¡i khi click
  initialLoaded = false;
  // XÃ³a dá»¯ liá»‡u cÅ© trÆ°á»›c khi load má»›i
  tbody.innerHTML = '';
  counter = 1;
  loadedPostIds.clear(); // XÃ³a danh sÃ¡ch post_id Ä‘Ã£ load

  try {
    // Gá»i API Ä‘á»ƒ láº¥y file JSON cÃ³ timestamp lá»›n nháº¥t
    const res = await callBackend('/data/latest-results', { method: 'GET' });
    const data = res.data;
    console.log(`ÄÃ£ load file JSON gáº§n nháº¥t: ${res.filename}, tá»•ng sá»‘ files:`, data.total_files);

    // Láº¥y táº¥t cáº£ posts tá»« results_by_file
    const allPosts = [];
    Object.values(data.results_by_file || {}).forEach(filePosts => {
      if (Array.isArray(filePosts)) {
        allPosts.push(...filePosts);
      }
    });

    console.log(`Tá»•ng sá»‘ posts cáº§n hiá»ƒn thá»‹: ${allPosts.length}`);

    // Chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u sang format cá»§a báº£ng
    let displayedCount = 0;
    allPosts.forEach((post) => {
      const postId = post.post_id || '';
      if (!postId) return; // Bá» qua náº¿u khÃ´ng cÃ³ post_id

      // Map flag thÃ nh type (xanh -> type1, vÃ ng -> type2, Ä‘á» -> type3)
      let type = 'type1'; // máº·c Ä‘á»‹nh
      const flag = (post.flag || '').toLowerCase();
      if (flag === 'xanh') {
        type = 'type1';
      } else if (flag === 'vÃ ng' || flag === 'vang') {
        type = 'type2';
      } else if (flag === 'Ä‘á»' || flag === 'do') {
        type = 'type3';
      }

      // Thá»i gian máº·c Ä‘á»‹nh: comment má»›i nháº¥t cá»§a bÃ i (náº¿u cÃ³)
      let defaultTime = new Date().toLocaleTimeString('vi-VN');
      if (post.comments && post.comments.length > 0) {
        const sortedAllComments = [...post.comments].sort((a, b) => {
          const timeA = new Date(a.created_time_vn || 0);
          const timeB = new Date(b.created_time_vn || 0);
          return timeB - timeA;
        });
        if (sortedAllComments[0] && sortedAllComments[0].created_time_vn) {
          defaultTime = sortedAllComments[0].created_time_vn;
        }
      }

      // Gom reactions theo userId
      const reactionsByUser = new Map();
      if (post.reactions && post.reactions.length > 0) {
        post.reactions.forEach((r) => {
          const uid = r && r.id ? String(r.id) : '';
          if (!uid) return;
          reactionsByUser.set(uid, r);
        });
      }

      // Gom comments theo userId (láº¥y comment má»›i nháº¥t cá»§a tá»«ng user)
      const commentsByUser = new Map();
      if (post.comments && post.comments.length > 0) {
        post.comments.forEach((c) => {
          const uid = c && c.id ? String(c.id) : '';
          if (!uid) return;
          const prev = commentsByUser.get(uid);
          if (!prev) {
            commentsByUser.set(uid, c);
          } else {
            const prevTime = new Date(prev.created_time_vn || 0);
            const curTime = new Date(c.created_time_vn || 0);
            if (curTime > prevTime) {
              commentsByUser.set(uid, c);
            }
          }
        });
      }

      // Táº­p táº¥t cáº£ user xuáº¥t hiá»‡n á»Ÿ react hoáº·c comment
      const allUserIds = new Set([
        ...reactionsByUser.keys(),
        ...commentsByUser.keys(),
      ]);

      // Náº¿u khÃ´ng cÃ³ user nÃ o interact, hiá»ƒn thá»‹ post vá»›i thÃ´ng tin owner
      if (allUserIds.size === 0) {
        const owner = post.owning_profile || {};
        const ownerId = owner.id || 'unknown';
        const ownerName = owner.name || 'Unknown User';
        const uniqueKey = `${postId}_${ownerId}`;

        if (!loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: ownerId,
            name: ownerName,
            react: false,
            comment: '',
            time: defaultTime,
            type: type,
          });
          loadedPostIds.add(uniqueKey);
          displayedCount++;
        }
      }

      allUserIds.forEach((uid) => {
        const reaction = reactionsByUser.get(uid);
        const comment = commentsByUser.get(uid);

        const userId = uid;
        const name =
          (reaction && reaction.name) ||
          (comment && comment.name) ||
          '';

        const hasReact = !!reaction;
        const commentText = comment && comment.text ? comment.text : '';
        const time =
          (comment && comment.created_time_vn) ? comment.created_time_vn : defaultTime;

        const uniqueKey = `${postId}_${userId}`; // Táº¡o key duy nháº¥t cho má»—i cáº·p post-user
        if (uniqueKey && !loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: userId,
            name: name,
            react: hasReact,        // chá»‰ tÃ­ch náº¿u user cÃ³ react
            comment: commentText,   // chá»‰ cÃ³ text náº¿u user cÃ³ comment
            time: time,
            type: type,
          });

          // ÄÃ¡nh dáº¥u Ä‘Ã£ load
          loadedPostIds.add(uniqueKey);
          displayedCount++;
        }
      });
    });

    console.log(`ÄÃ£ hiá»ƒn thá»‹ ${displayedCount} dÃ²ng dá»¯ liá»‡u`);
    initialLoaded = true;
  } catch (err) {
    console.error('KhÃ´ng táº£i Ä‘Æ°á»£c file JSON tá»« API:', err);
    // Fallback: thá»­ load data.json cÅ© (náº¿u API khÃ´ng kháº£ dá»¥ng)
    try {
      const res = await fetch('data.json');
      if (res.ok) {
        const rows = await res.json();
        rows.forEach((row) => {
          appendRow(row);
          counter = Math.max(counter, Number(row.id) + 1);
        });
        initialLoaded = true;
        console.log('ÄÃ£ load fallback data.json');
      }
    } catch (fallbackErr) {
      console.error('KhÃ´ng táº£i Ä‘Æ°á»£c data.json fallback:', fallbackErr);
      showToast('KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u bÃ i viáº¿t Ä‘á»ƒ hiá»ƒn thá»‹', 'error', 4000);
    }
  }

  // Show empty state if no rows
  if (tbody.children.length === 0) {
    emptyState.classList.add('show');
  }
}

// ==========================
// Cáº¢NH BÃO ACCOUNT CÃ“ Váº¤N Äá»€
// ==========================
async function pollAccountStatus() {
  try {
    const res = await callBackendNoAlert('/account/status', { method: 'GET' });
    if (!res || !res.accounts) return;

    const accounts = res.accounts || {};
    Object.keys(accounts).forEach((pid) => {
      const info = accounts[pid];
      if (!info) return;
      if (!info.banned) return;

      const msg = info.message || 'TÃ i khoáº£n cÃ³ váº¥n Ä‘á», hÃ£y kiá»ƒm tra láº¡i báº±ng tay.';
      showToast(`Profile ${pid}: ${msg}`, 'warning', 10000);
    });
  } catch (e) {
    // bá» qua lá»—i, khÃ´ng áº£nh hÆ°á»Ÿng luá»“ng cÅ©
  }
}

// Poll má»—i 45s, hoÃ n toÃ n Ä‘á»™c láº­p, chá»‰ hiá»ƒn thá»‹ thÃ´ng bÃ¡o
try {
  setInterval(pollAccountStatus, 45000);
} catch (_) { }

// Start quÃ©t bÃ i viáº¿t (dÃ¹ng chung cho nÃºt "Báº¯t Ä‘áº§u quÃ©t" vÃ  nÃºt trong tab Setting profile)
async function startScanFlow(options = {}) {
  // Náº¿u Ä‘ang quÃ©t thÃ¬ khÃ´ng cho cháº¡y láº¡i
  if (isScanning) {
    showToast('Äang quÃ©t, vui lÃ²ng Ä‘á»£i hoáº·c báº¥m dá»«ng trÆ°á»›c', 'warning');
    return;
  }
  
  const {
    runMinutes,
    restMinutes,
    text,
    mode,
  } = options || {};
  
  try {
    // Load vÃ  hiá»ƒn thá»‹ táº¥t cáº£ dá»¯ liá»‡u tá»« all_results_summary.json ngay láº­p tá»©c
    // KhÃ´ng cáº§n chá» backend, hiá»ƒn thá»‹ dá»¯ liá»‡u trÆ°á»›c
    await loadInitialData();

    // Náº¿u Ä‘ang cÃ³ interval check data cÅ© thÃ¬ clear trÆ°á»›c Ä‘á»ƒ trÃ¡nh setInterval chá»“ng
    if (dataCheckInterval) {
      clearInterval(dataCheckInterval);
      dataCheckInterval = null;
    }

    // Sau Ä‘Ã³ má»›i cháº¡y backend (náº¿u cáº§n)
    const ok = await triggerBackendRun({ runMinutes, restMinutes, text, mode });
    if (!ok) {
      setScanning(false);
      return;
    }

    // Tá»± Ä‘á»™ng kiá»ƒm tra dá»¯ liá»‡u má»›i má»—i 5 giÃ¢y Ä‘á»ƒ cáº­p nháº­t khi cÃ³ dá»¯ liá»‡u má»›i
    const checkInterval = 5000; // 5 giÃ¢y
    dataCheckInterval = setInterval(checkForNewData, checkInterval);

    setScanning(true);
    
    // Báº¯t Ä‘áº§u poll sá»‘ bÃ i Ä‘Ã£ quÃ©t Ä‘Æ°á»£c
    if (scanStatsInterval) clearInterval(scanStatsInterval);
    updateScanStats(); // Cáº­p nháº­t ngay láº­p tá»©c
    scanStatsInterval = setInterval(updateScanStats, 3000); // Poll má»—i 3 giÃ¢y
    
    // Poll /jobs/status Ä‘á»ƒ sync UI nÃºt dá»«ng/táº¡m dá»«ng + tá»± táº¯t khi backend dá»«ng
    try { startScanBackendPoll({ silent: true }); } catch (_) { }
    try { updateStopPauseButtonsByJobs(); } catch (_) { }
    try { await refreshControlState(); } catch (_) { }
  } catch (err) {
    console.error('Lá»—i trong startScanFlow:', err);
    setScanning(false);
    throw err;
  }
}

// Event listeners cho startBtn vÃ  stopBtn Ä‘Ã£ bá»‹ xÃ³a vÃ¬ left-panel khÃ´ng cÃ²n tá»“n táº¡i

// Xuáº¥t file Excel
const exportExcelBtn = document.getElementById('exportExcelBtn');

function exportToExcel() {
  const table = document.getElementById('listTable');
  const rows = table.querySelectorAll('tr');

  if (rows.length <= 1) {
    alert('KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘á»ƒ xuáº¥t!');
    return;
  }

  // Táº¡o dá»¯ liá»‡u cho Excel
  const data = [];

  // ThÃªm header
  const headerRow = [];
  table.querySelectorAll('thead th').forEach(th => {
    headerRow.push(th.textContent);
  });
  data.push(headerRow);

  // ThÃªm dá»¯ liá»‡u
  table.querySelectorAll('tbody tr').forEach((tr, rowIndex) => {
    const row = [];
    tr.querySelectorAll('td').forEach((td, colIndex) => {
      // Cá»™t thá»© 1 (index 0) lÃ  ID BÃ i Post - táº¡o hyperlink Ä‘áº¿n bÃ i post
      if (colIndex === 0 && td.textContent.trim()) {
        const postId = td.textContent.trim();
        const postUrl = `https://www.facebook.com/${postId}`;
        // Táº¡o hyperlink trong Excel
        row.push({
          t: 's', // string type
          v: postId,
          l: { Target: postUrl, Tooltip: `Xem bÃ i post trÃªn Facebook` }
        });
      }
      // Cá»™t thá»© 2 (index 1) lÃ  ID User - táº¡o hyperlink Ä‘áº¿n profile
      else if (colIndex === 1 && td.textContent.trim()) {
        const userId = td.textContent.trim();
        const profileUrl = `https://www.facebook.com/${userId}`;
        // Táº¡o hyperlink trong Excel
        row.push({
          t: 's', // string type
          v: userId,
          l: { Target: profileUrl, Tooltip: `Xem profile Facebook cá»§a ${userId}` }
        });
      } else {
        row.push(td.textContent);
      }
    });
    data.push(row);
  });

  // Táº¡o workbook vÃ  worksheet
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(data);

  // Äáº·t Ä‘á»™ rá»™ng cá»™t
  ws['!cols'] = [
    { wch: 18 }, // ID BÃ i Post
    { wch: 18 }, // ID User
    { wch: 20 }, // Name
    { wch: 12 }, // React
    { wch: 12 }, // Comment
    { wch: 20 }, // Time
    { wch: 15 }  // Type
  ];

  // ThÃªm worksheet vÃ o workbook
  XLSX.utils.book_append_sheet(wb, ws, 'Danh sÃ¡ch quÃ©t');

  // Táº¡o tÃªn file vá»›i timestamp
  const now = new Date();
  const timestamp = now.toISOString().slice(0, 19).replace(/:/g, '-');
  const filename = `danh_sach_quet_${timestamp}.xlsx`;

  // Xuáº¥t file
  XLSX.writeFile(wb, filename);

  // Hiá»ƒn thá»‹ thÃ´ng bÃ¡o
  const btnText = exportExcelBtn.querySelector('span:last-child');
  const originalText = btnText.textContent;
  btnText.textContent = 'ÄÃ£ xuáº¥t!';
  exportExcelBtn.disabled = true;

  setTimeout(() => {
    btnText.textContent = originalText;
    exportExcelBtn.disabled = false;
  }, 2000);
}

exportExcelBtn.addEventListener('click', exportToExcel);

// ==== FastAPI integration ====

function setBackendStatus(message, isOnline = false) {
  if (backendStatus) {
    backendStatus.textContent = message;
  }
  if (statusDot) {
    statusDot.classList.toggle('online', isOnline);
  }
}

async function callBackend(path, options = {}) {
  const url = `${API_BASE}${path}`;
  const method = (options.method || 'POST').toUpperCase();
  const headers = { ...(options.headers || {}) };
  // Chá»‰ set Content-Type khi cÃ³ body => trÃ¡nh preflight OPTIONS spam cho GET /status
  if (options.body != null && !headers['Content-Type']) {
    headers['Content-Type'] = 'application/json';
  }

  const res = await fetch(url, {
    method,
    headers,
    ...options,
  });

  let data = {};
  try {
    data = await res.json();
  } catch (e) {
    // ignore parse errors, will throw below if not ok
  }

  if (!res.ok) {
    let detail = data.detail || res.statusText || 'Request failed';
    // Náº¿u backend tráº£ detail dáº¡ng object (vd: {message, missing:[...]}) thÃ¬ format láº¡i cho dá»… Ä‘á»c
    try {
      if (detail && typeof detail === 'object') {
        const msg = detail.message ? String(detail.message) : 'Request failed';
        const missing = Array.isArray(detail.missing) ? detail.missing : [];
        if (missing.length > 0) {
          const lines = missing.map((x) => {
            const pid = (x && x.profile_id) ? String(x.profile_id) : '(unknown)';
            const fields = Array.isArray(x && x.missing) ? x.missing.join(', ') : '';
            return `${pid}${fields ? ` thiáº¿u: ${fields}` : ''}`;
          });
          detail = `${msg} ${lines.join(' | ')}`;
        } else {
          detail = msg;
        }
      }
    } catch (_) { }
    throw new Error(String(detail));
  }

  return data;
}

async function callBackendNoAlert(path, options = {}) {
  try {
    return await callBackend(path, options);
  } catch (e) {
    return null;
  }
}

async function triggerBackendRun(options = {}) {
  setBackendStatus('Äang gá»­i lá»‡nh cháº¡y...', false);
  try {
    // Báº¯t buá»™c pháº£i chá»n (tick) profile trÆ°á»›c khi cháº¡y backend
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('HÃ£y tick Ã­t nháº¥t 1 profile á»Ÿ tab "Setting profile" trÆ°á»›c khi cháº¡y.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return false;
    }

    const runMinutes = (options.runMinutes != null) ? Number(options.runMinutes) : Number(runMinutesInput.value);
    // DÃ¹ng luÃ´n "Thá»i gian láº·p láº¡i (phÃºt)" lÃ m thá»i gian nghá»‰ giá»¯a phiÃªn (náº¿u khÃ´ng truyá»n override)
    const restMinutes = (options.restMinutes != null) ? Number(options.restMinutes) : Number(intervalInput.value);
    const text = (options.text != null) ? String(options.text || '').trim() : '';
    const mode = (options.mode != null) ? String(options.mode || '').trim().toLowerCase() : '';
    const payload = {};
    if (Number.isFinite(runMinutes) && runMinutes > 0) {
      payload.run_minutes = runMinutes;
    }
    if (Number.isFinite(restMinutes) && restMinutes > 0) {
      payload.rest_minutes = restMinutes;
    }
    payload.profile_ids = selected;
    if (text) payload.text = text;
    if (mode) payload.mode = mode;

    const data = await callBackend('/run', {
      body: JSON.stringify(payload),
    });
    const pidText = data.pid ? ` (PID ${data.pid})` : '';

    // XÃ¡c nháº­n backend tháº­t sá»± Ä‘ang cháº¡y (trÃ¡nh UI bÃ¡o "Äang quÃ©t" nhÆ°ng runner Ä‘Ã£ thoÃ¡t)
    const deadline = Date.now() + 2500;
    let jobs = null;
    while (Date.now() < deadline) {
      jobs = await callBackendNoAlert('/jobs/status', { method: 'GET' });
      if (jobs && jobs.bot_running) break;
      await new Promise((r) => setTimeout(r, 200));
    }
    if (jobs) lastJobsStatus = jobs;
    try { updateStopPauseButtonsByJobs(); } catch (_) { }

    if (!(jobs && jobs.bot_running)) {
      setBackendStatus(`Backend chÆ°a cháº¡y bot${pidText}`, false);
      showToast('Backend chÆ°a cháº¡y Ä‘Æ°á»£c bot (runner khÃ´ng alive).', 'error', 2200);
      return false;
    }

    setBackendStatus(`Bot Ä‘ang cháº¡y${pidText}`, true);
    return true;
  } catch (err) {
    console.error(err);
    alert('KhÃ´ng gá»i Ä‘Æ°á»£c backend. HÃ£y kiá»ƒm tra FastAPI Ä‘Ã£ cháº¡y chÆ°a.');
    setBackendStatus('Backend lá»—i hoáº·c chÆ°a khá»Ÿi Ä‘á»™ng', false);
    return false;
  } finally {
  }
}

async function sendStopSignal() {
  try {
    console.log('[UI] STOP triggered');
    // /stop Ä‘Ã£ Ä‘Æ°á»£c backend map sang STOP (GLOBAL_EMERGENCY_STOP + Ä‘Ã³ng NST best-effort)
    await callBackend('/stop');
    setBackendStatus('ÄÃ£ gá»­i lá»‡nh dá»«ng backend', false);
  } catch (err) {
    console.warn('KhÃ´ng dá»«ng Ä‘Æ°á»£c backend:', err);
    setBackendStatus('Backend cÃ³ thá»ƒ váº«n Ä‘ang cháº¡y', false);
  }
}

// Thá»­ kiá»ƒm tra tráº¡ng thÃ¡i backend khi táº£i trang
fetch(`${API_BASE}/status`)
  .then((res) => res.json())
  .then((data) => {
    const running = Boolean(data.running);
    setBackendStatus(running ? 'Backend Ä‘ang cháº¡y' : 'Backend chÆ°a cháº¡y', running);
  })
  .catch(() => {
    setBackendStatus('KhÃ´ng káº¿t ná»‘i Ä‘Æ°á»£c FastAPI', false);
  });

// ==== ThÃªm data nhÃ³m - Má»Ÿ file tá»« mÃ¡y tÃ­nh ====

const addGroupDataBtn = document.getElementById('addGroupDataBtn');

// HÃ m xá»­ lÃ½ nÃºt ThÃªm data nhÃ³m - chá»‰ má»Ÿ dialog chá»n file
function handleAddGroupData() {
  // Táº¡o input file áº©n
  const fileInput = document.createElement('input');
  fileInput.type = 'file';
  fileInput.accept = '.json,.xlsx,.xls,.txt,.csv';
  fileInput.style.display = 'none';

  fileInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (file) {
      console.log('File Ä‘Ã£ chá»n:', file.name);
      // Chá»‰ má»Ÿ file, khÃ´ng xá»­ lÃ½ gÃ¬ thÃªm
    }
    // XÃ³a input Ä‘á»ƒ cÃ³ thá»ƒ chá»n láº¡i file cÃ¹ng tÃªn
    fileInput.value = '';
  });

  // Trigger click Ä‘á»ƒ má»Ÿ dialog chá»n file
  document.body.appendChild(fileInput);
  fileInput.click();
  document.body.removeChild(fileInput);
}



// ==== Help Button vá»›i Tooltip ====

const helpBtn = document.getElementById('helpBtn');
const helpTooltip = document.getElementById('helpTooltip');

// Date range buttons
const todayBtn = document.getElementById('todayBtn');
const threeDaysBtn = document.getElementById('threeDaysBtn');

// File selector dropdown
const fileSelectorContainer = document.getElementById('fileSelectorContainer');
const closeFileSelector = document.getElementById('closeFileSelector');
const fileSelectorTitle = document.getElementById('fileSelectorTitle');
const fileList = document.getElementById('fileList');
const cancelFileSelection = document.getElementById('cancelFileSelection');
const tooltipClose = document.querySelector('.tooltip-close');

function toggleHelpTooltip() {
  helpTooltip.classList.toggle('show');
}

function closeHelpTooltip() {
  helpTooltip.classList.remove('show');
}

helpBtn.addEventListener('click', (e) => {
  e.stopPropagation();
  toggleHelpTooltip();
});

tooltipClose.addEventListener('click', closeHelpTooltip);

// ÄÃ³ng tooltip khi click ra ngoÃ i
document.addEventListener('click', (e) => {
  if (!helpBtn.contains(e.target) && !helpTooltip.contains(e.target)) {
    closeHelpTooltip();
  }
});
// ==== Bá»™ lá»c mÃ u sáº¯c, React, Comment vÃ  Sáº¯p xáº¿p ====

const filterButtons = document.querySelectorAll('.filter-btn[data-filter]');
const reactFilterButtons = document.querySelectorAll('.filter-btn[data-filter-react]');
const commentFilterButtons = document.querySelectorAll('.filter-btn[data-filter-comment]');
const timeFilterFrom = document.getElementById('timeFilterFrom');
const timeFilterTo = document.getElementById('timeFilterTo');
const applyTimeFilterBtn = document.getElementById('applyTimeFilterBtn');
const clearTimeFilterBtn = document.getElementById('clearTimeFilterBtn');

// Sá»­ dá»¥ng Set Ä‘á»ƒ lÆ°u cÃ¡c filter Ä‘Ã£ chá»n (cho phÃ©p nhiá»u lá»±a chá»n)
let selectedTypeFilters = new Set(['all']);
let selectedReactFilters = new Set(); // KhÃ´ng cÃ³ "all", rá»—ng = hiá»ƒn thá»‹ táº¥t cáº£
let selectedCommentFilters = new Set(); // KhÃ´ng cÃ³ "all", rá»—ng = hiá»ƒn thá»‹ táº¥t cáº£
let timeFilterFromValue = null; // Thá»i gian báº¯t Ä‘áº§u
let timeFilterToValue = null; // Thá»i gian káº¿t thÃºc

function toggleTypeFilter(filterType) {
  if (filterType === 'all') {
    // Náº¿u click "Táº¥t cáº£", bá» chá»n táº¥t cáº£ vÃ  chá»‰ chá»n "Táº¥t cáº£"
    selectedTypeFilters.clear();
    selectedTypeFilters.add('all');
  } else {
    // Bá» "all" náº¿u chá»n filter cá»¥ thá»ƒ
    selectedTypeFilters.delete('all');

    // Toggle filter
    if (selectedTypeFilters.has(filterType)) {
      selectedTypeFilters.delete(filterType);
    } else {
      selectedTypeFilters.add(filterType);
    }

    // Náº¿u khÃ´ng cÃ²n filter nÃ o Ä‘Æ°á»£c chá»n, tá»± Ä‘á»™ng chá»n "all"
    if (selectedTypeFilters.size === 0) {
      selectedTypeFilters.add('all');
    }
  }
  applyAllFilters();
}

function toggleReactFilter(reactFilter) {
  // Toggle filter (khÃ´ng cÃ³ "all" ná»¯a)
  if (selectedReactFilters.has(reactFilter)) {
    selectedReactFilters.delete(reactFilter);
  } else {
    selectedReactFilters.add(reactFilter);
  }
  applyAllFilters();
}

function toggleCommentFilter(commentFilter) {
  // Toggle filter (khÃ´ng cÃ³ "all" ná»¯a)
  if (selectedCommentFilters.has(commentFilter)) {
    selectedCommentFilters.delete(commentFilter);
  } else {
    selectedCommentFilters.add(commentFilter);
  }
  applyAllFilters();
}

function applyAllFilters() {
  const rows = tbody.querySelectorAll('tr');

  rows.forEach((row) => {
    let shouldShow = true;

    // Filter theo mÃ u (Type) - cÃ³ thá»ƒ chá»n nhiá»u
    if (!selectedTypeFilters.has('all')) {
      const typeCell = row.querySelector('.type-cell');
      let matchesType = false;

      selectedTypeFilters.forEach(filterType => {
        if (typeCell && typeCell.classList.contains(filterType)) {
          matchesType = true;
        }
      });

      if (!matchesType) {
        shouldShow = false;
      }
    }

    // Filter theo React - náº¿u Set rá»—ng thÃ¬ hiá»ƒn thá»‹ táº¥t cáº£
    if (shouldShow && selectedReactFilters.size > 0) {
      const reactCell = row.querySelector('td:nth-child(4)'); // Cá»™t React
      const hasReact = reactCell && reactCell.textContent.trim() === 'âœ“';
      let matchesReact = false;

      selectedReactFilters.forEach(reactFilter => {
        if (reactFilter === 'has' && hasReact) {
          matchesReact = true;
        } else if (reactFilter === 'none' && !hasReact) {
          matchesReact = true;
        }
      });

      if (!matchesReact) {
        shouldShow = false;
      }
    }

    // Filter theo Comment - náº¿u Set rá»—ng thÃ¬ hiá»ƒn thá»‹ táº¥t cáº£
    if (shouldShow && selectedCommentFilters.size > 0) {
      const commentCell = row.querySelector('td:nth-child(5)'); // Cá»™t Comment
      const hasComment = commentCell && commentCell.querySelector('.comment-eye-btn');
      let matchesComment = false;

      selectedCommentFilters.forEach(commentFilter => {
        if (commentFilter === 'has' && hasComment) {
          matchesComment = true;
        } else if (commentFilter === 'none' && !hasComment) {
          matchesComment = true;
        }
      });

      if (!matchesComment) {
        shouldShow = false;
      }
    }

    // Filter theo thá»i gian
    if (shouldShow && (timeFilterFromValue || timeFilterToValue)) {
      const timeCell = row.querySelector('td:nth-child(6)'); // Cá»™t Time
      const timeStr = timeCell ? timeCell.textContent.trim() : '';

      if (timeStr) {
        // Parse timestamp tá»« row hoáº·c tá»« text
        let rowTimestamp = row.dataset.timestamp ? parseInt(row.dataset.timestamp) : 0;
        if (!rowTimestamp) {
          rowTimestamp = parseTime(timeStr);
          row.dataset.timestamp = rowTimestamp; // LÆ°u láº¡i
        }

        // So sÃ¡nh vá»›i khoáº£ng thá»i gian Ä‘Ã£ chá»n
        if (timeFilterFromValue && rowTimestamp < timeFilterFromValue) {
          shouldShow = false;
        }
        if (timeFilterToValue && rowTimestamp > timeFilterToValue) {
          shouldShow = false;
        }
      } else {
        // Náº¿u khÃ´ng cÃ³ thá»i gian vÃ  cÃ³ filter thá»i gian thÃ¬ áº©n
        shouldShow = false;
      }
    }

    if (shouldShow) {
      row.classList.remove('filtered-out');
    } else {
      row.classList.add('filtered-out');
    }
  });

  // Cáº­p nháº­t tráº¡ng thÃ¡i active cá»§a cÃ¡c nÃºt filter mÃ u
  filterButtons.forEach((btn) => {
    const filterType = btn.dataset.filter;
    if (selectedTypeFilters.has(filterType)) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
  });

  // Cáº­p nháº­t tráº¡ng thÃ¡i active cá»§a cÃ¡c nÃºt filter React
  reactFilterButtons.forEach((btn) => {
    const reactFilter = btn.dataset.filterReact;
    if (selectedReactFilters.has(reactFilter)) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
  });

  // Cáº­p nháº­t tráº¡ng thÃ¡i active cá»§a cÃ¡c nÃºt filter Comment
  commentFilterButtons.forEach((btn) => {
    const commentFilter = btn.dataset.filterComment;
    if (selectedCommentFilters.has(commentFilter)) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
  });

  // Kiá»ƒm tra empty state
  const visibleRows = Array.from(rows).filter(row => !row.classList.contains('filtered-out'));
  if (visibleRows.length === 0 && rows.length > 0) {
    emptyState.classList.add('show');
  } else {
    emptyState.classList.remove('show');
  }
}

// Ãp dá»¥ng filter theo thá»i gian
function applyTimeFilter() {
  const fromValue = timeFilterFrom ? timeFilterFrom.value : '';
  const toValue = timeFilterTo ? timeFilterTo.value : '';

  // Chuyá»ƒn Ä‘á»•i tá»« datetime-local format (YYYY-MM-DDTHH:mm) sang timestamp
  if (fromValue) {
    timeFilterFromValue = new Date(fromValue).getTime();
  } else {
    timeFilterFromValue = null;
  }

  if (toValue) {
    // ThÃªm 1 ngÃ y vÃ  trá»« 1ms Ä‘á»ƒ bao gá»“m cáº£ ngÃ y cuá»‘i
    const toDate = new Date(toValue);
    toDate.setHours(23, 59, 59, 999);
    timeFilterToValue = toDate.getTime();
  } else {
    timeFilterToValue = null;
  }

  // Ãp dá»¥ng filter
  applyAllFilters();

  // Cáº­p nháº­t tráº¡ng thÃ¡i nÃºt
  if (applyTimeFilterBtn) {
    if (timeFilterFromValue || timeFilterToValue) {
      applyTimeFilterBtn.classList.add('active');
    } else {
      applyTimeFilterBtn.classList.remove('active');
    }
  }
}

// XÃ³a filter thá»i gian
function clearTimeFilter() {
  if (timeFilterFrom) timeFilterFrom.value = '';
  if (timeFilterTo) timeFilterTo.value = '';
  timeFilterFromValue = null;
  timeFilterToValue = null;

  // Ãp dá»¥ng láº¡i filter
  applyAllFilters();

  // Cáº­p nháº­t tráº¡ng thÃ¡i nÃºt
  if (applyTimeFilterBtn) {
    applyTimeFilterBtn.classList.remove('active');
  }
}

// HÃ m parse time tá»« string sang Date object
function parseTime(timeStr) {
  if (!timeStr) return 0;

  // Thá»­ parse cÃ¡c format thá»i gian phá»• biáº¿n
  // Format: "HH:mm:ss" hoáº·c "HH:mm" hoáº·c "dd/MM/yyyy HH:mm:ss"
  const now = new Date();

  // Náº¿u cÃ³ format Ä‘áº§y Ä‘á»§ vá»›i ngÃ y
  if (timeStr.includes('/')) {
    const parts = timeStr.split(' ');
    if (parts.length >= 2) {
      const datePart = parts[0].split('/');
      const timePart = parts[1].split(':');
      if (datePart.length === 3 && timePart.length >= 2) {
        const year = parseInt(datePart[2]);
        const month = parseInt(datePart[1]) - 1;
        const day = parseInt(datePart[0]);
        const hour = parseInt(timePart[0]);
        const minute = parseInt(timePart[1]);
        const second = timePart[2] ? parseInt(timePart[2]) : 0;
        return new Date(year, month, day, hour, minute, second).getTime();
      }
    }
  }

  // Náº¿u chá»‰ cÃ³ giá»:phÃºt:giÃ¢y
  if (timeStr.includes(':')) {
    const parts = timeStr.split(':');
    if (parts.length >= 2) {
      const hour = parseInt(parts[0]) || 0;
      const minute = parseInt(parts[1]) || 0;
      const second = parts[2] ? parseInt(parts[2]) : 0;
      const date = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hour, minute, second);
      return date.getTime();
    }
  }

  // Fallback: thá»­ parse trá»±c tiáº¿p
  const parsed = Date.parse(timeStr);
  return isNaN(parsed) ? 0 : parsed;
}

// Khá»Ÿi táº¡o: set tráº¡ng thÃ¡i active cho cÃ¡c nÃºt "Táº¥t cáº£"
function initializeFilters() {
  applyAllFilters();
}

// ThÃªm event listener cho cÃ¡c nÃºt filter mÃ u
filterButtons.forEach((btn) => {
  btn.addEventListener('click', () => {
    const filterType = btn.dataset.filter;
    if (filterType) {
      toggleTypeFilter(filterType);
    }
  });
});

// ThÃªm event listener cho cÃ¡c nÃºt filter React
reactFilterButtons.forEach((btn) => {
  btn.addEventListener('click', () => {
    const reactFilter = btn.dataset.filterReact;
    if (reactFilter) {
      toggleReactFilter(reactFilter);
    }
  });
});

// ThÃªm event listener cho cÃ¡c nÃºt filter Comment
commentFilterButtons.forEach((btn) => {
  btn.addEventListener('click', () => {
    const commentFilter = btn.dataset.filterComment;
    if (commentFilter) {
      toggleCommentFilter(commentFilter);
    }
  });
});

// ThÃªm event listener cho filter thá»i gian
if (applyTimeFilterBtn) {
  applyTimeFilterBtn.addEventListener('click', () => {
    applyTimeFilter();
  });
}

if (clearTimeFilterBtn) {
  clearTimeFilterBtn.addEventListener('click', () => {
    clearTimeFilter();
  });
}

// Cho phÃ©p Ã¡p dá»¥ng filter khi nháº¥n Enter trong input
if (timeFilterFrom) {
  timeFilterFrom.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      applyTimeFilter();
    }
  });
}

// Flag Ä‘á»ƒ track khi Ä‘ang cháº¡y info collector
let isInfoCollectorRunning = false;
let scanStatsInterval = null;
let infoProgressInterval = null;

// HÃ m Ä‘á»ƒ cáº­p nháº­t sá»‘ bÃ i Ä‘Ã£ quÃ©t Ä‘Æ°á»£c
async function updateScanStats() {
  try {
    const res = await callBackendNoAlert('/info/scan-stats', { method: 'GET' });
    if (!res || !res.stats) return;
    
    const stats = res.stats;
    const toast = document.getElementById('scanStatsToast');
    const list = document.getElementById('scanStatsToastList');
    const progressToast = document.getElementById('progressToast');
    
    if (!toast || !list || !progressToast) return;
    
    const selected = getSelectedProfileIds();
    if (selected.length === 0 && Object.keys(stats).length === 0) {
      toast.style.display = 'none';
      // áº¨n progressToast náº¿u cáº£ 2 toast Ä‘á»u áº©n
      const infoToast = document.getElementById('infoProgressToast');
      if (!infoToast || infoToast.style.display === 'none') {
        progressToast.style.display = 'none';
      }
      return;
    }
    
    // Chá»‰ hiá»ƒn thá»‹ cÃ¡c profile Ä‘Ã£ chá»n hoáº·c táº¥t cáº£ náº¿u khÃ´ng cÃ³ profile nÃ o Ä‘Æ°á»£c chá»n
    const profilesToShow = selected.length > 0 ? selected : Object.keys(stats);
    
    let html = '';
    for (const pid of profilesToShow) {
      const count = stats[pid] || 0;
      html += `<div style="margin: 6px 0; padding: 12px; background: white; border-radius: 8px; border-left: 4px solid #667eea; box-shadow: 0 2px 4px rgba(0,0,0,0.1); display: flex; align-items: center; gap: 10px;">
        <span style="font-size: 20px;">ðŸ“</span>
        <div style="flex: 1;">
          <div style="font-weight: 600; color: #2d3748; font-size: 13px; margin-bottom: 2px;">${pid}</div>
          <div style="color: #667eea; font-weight: bold; font-size: 16px;">ÄÃ£ quÃ©t Ä‘Æ°á»£c ${count} bÃ i</div>
        </div>
      </div>`;
    }
    
    if (html) {
      list.innerHTML = html;
      toast.style.display = 'block';
      progressToast.style.display = 'block';
    } else {
      toast.style.display = 'none';
      // áº¨n progressToast náº¿u cáº£ 2 toast Ä‘á»u áº©n
      const infoToast = document.getElementById('infoProgressToast');
      if (!infoToast || infoToast.style.display === 'none') {
        progressToast.style.display = 'none';
      }
    }
  } catch (e) {
    // Ignore errors
  }
}

// HÃ m Ä‘á»ƒ cáº­p nháº­t tiáº¿n trÃ¬nh láº¥y thÃ´ng tin
async function updateInfoProgress() {
  try {
    const res = await callBackendNoAlert('/info/progress', { method: 'GET' });
    if (!res) {
      // Náº¿u khÃ´ng cÃ³ response, reset state
      if (isInfoCollectorRunning) {
        resetInfoCollectorState();
        updateStopPauseButtonsByJobs();
      }
      return;
    }
    
    const toast = document.getElementById('infoProgressToast');
    const text = document.getElementById('infoProgressToastText');
    const progressBar = document.getElementById('infoProgressToastBar');
    const progressToast = document.getElementById('progressToast');
    
    if (!toast || !text || !progressToast) return;
    
    // Sync isInfoCollectorRunning vá»›i backend state
    const backendRunning = Boolean(res.is_running);
    if (isInfoCollectorRunning !== backendRunning) {
      isInfoCollectorRunning = backendRunning;
      if (!backendRunning) {
        // Backend Ä‘Ã£ dá»«ng, reset state
        resetInfoCollectorState();
      }
      updateStopPauseButtonsByJobs();
    }
    
    if (res.is_running && res.total > 0) {
      const current = res.current || 0;
      const total = res.total || 0;
      const file = res.current_file || '';
      const percentage = total > 0 ? Math.round((current / total) * 100) : 0;
      
      text.textContent = `ÄÃ£ xá»­ lÃ½ ${current}/${total} bÃ i${file ? ` â€¢ File: ${file}` : ''}`;
      
      // Cáº­p nháº­t progress bar
      if (progressBar) {
        progressBar.style.width = `${percentage}%`;
      }
      
      toast.style.display = 'block';
      progressToast.style.display = 'block';
    } else {
      toast.style.display = 'none';
      // Reset progress bar
      if (progressBar) {
        progressBar.style.width = '0%';
      }
      // áº¨n progressToast náº¿u cáº£ 2 toast Ä‘á»u áº©n
      const scanToast = document.getElementById('scanStatsToast');
      if (!scanToast || scanToast.style.display === 'none') {
        progressToast.style.display = 'none';
      }
    }
  } catch (e) {
    // Náº¿u cÃ³ lá»—i khi check progress, cÃ³ thá»ƒ backend Ä‘Ã£ dá»«ng
    if (isInfoCollectorRunning) {
      resetInfoCollectorState();
      updateStopPauseButtonsByJobs();
    }
  }
}

async function runInfoCollector(mode = 'all') {
  const isSelected = mode === 'selected';
  const btn = isSelected ? runSelectedInfoBtn : runAllInfoBtn;
  const selected = getSelectedProfileIds();

  if (isSelected && selected.length === 0) {
    showToast('Chá»n (tick) Ã­t nháº¥t 1 profile trÆ°á»›c.', 'error');
    try { switchTab('settings'); } catch (_) { }
    return;
  }

  // ÄÃ¡nh dáº¥u Ä‘ang cháº¡y
  isInfoCollectorRunning = true;
  
  setButtonLoading(btn, true, 'Äang láº¥y thÃ´ng tin...');
  
  // Báº¯t Ä‘áº§u poll tiáº¿n trÃ¬nh
  if (infoProgressInterval) clearInterval(infoProgressInterval);
  updateInfoProgress(); // Cáº­p nháº­t ngay láº­p tá»©c
  infoProgressInterval = setInterval(updateInfoProgress, 2000); // Poll má»—i 2 giÃ¢y
  
  // Update buttons Ä‘á»ƒ enable pause/stop buttons
  updateStopPauseButtonsByJobs();
  
  try {
    const body = { mode: isSelected ? 'selected' : 'all' };
    if (isSelected) body.profiles = selected;
    const res = await callBackend('/info/run', {
      method: 'POST',
      body: JSON.stringify(body),
    });
    const summary = res && res.summary ? res.summary : null;
    const msgParts = [];
    msgParts.push(isSelected ? `ÄÃ£ cháº¡y cho ${body.profiles.length} profile` : 'ÄÃ£ cháº¡y láº¥y thÃ´ng tin toÃ n bá»™');
    if (summary && typeof summary.total_posts_processed === 'number') {
      msgParts.push(`posts: ${summary.total_posts_processed}`);
    }
    showToast(msgParts.join(' | '), 'success', 2200);

    // Tá»± Ä‘á»™ng táº£i láº¡i danh sÃ¡ch quÃ©t vá»›i dá»¯ liá»‡u má»›i nháº¥t theo timestamp
    try {
      await loadInitialData();
      showToast('ÄÃ£ cáº­p nháº­t danh sÃ¡ch quÃ©t vá»›i dá»¯ liá»‡u má»›i nháº¥t', 'info', 1500);
    } catch (loadErr) {
      console.warn('KhÃ´ng thá»ƒ táº£i láº¡i danh sÃ¡ch quÃ©t:', loadErr);
      // KhÃ´ng hiá»‡n lá»—i cho user vÃ¬ chá»©c nÄƒng chÃ­nh Ä‘Ã£ thÃ nh cÃ´ng
    }

    // Reset flag sau khi hoÃ n thÃ nh thÃ nh cÃ´ng
    resetInfoCollectorState();
  } catch (e) {
    console.error('Error in runInfoCollector:', e);
    // Kiá»ƒm tra náº¿u lÃ  lá»—i "khÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t"
    const errorMsg = (e?.message || e?.detail || String(e) || '').toLowerCase();
    if (errorMsg.includes('khÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t') || 
        errorMsg.includes('khong co du lieu bai viet') ||
        errorMsg.includes('no data') ||
        errorMsg.includes('empty')) {
      showToast('KhÃ´ng cÃ³ dá»¯ liá»‡u bÃ i viáº¿t Ä‘á»ƒ xá»­ lÃ½', 'error', 4000);
    } else {
      const displayMsg = e?.message || e?.detail || 'KhÃ´ng cháº¡y Ä‘Æ°á»£c láº¥y thÃ´ng tin (check backend).';
      showToast(displayMsg, 'error', 3000);
    }
    // Reset flag khi cÃ³ lá»—i
    resetInfoCollectorState();
  } finally {
    setButtonLoading(btn, false);
    // Update buttons sau khi reset state
    updateStopPauseButtonsByJobs();
  }
}

if (runAllInfoBtn) {
  runAllInfoBtn.addEventListener('click', () => runInfoCollector('all'));
}

if (runSelectedInfoBtn) {
  runSelectedInfoBtn.addEventListener('click', () => runInfoCollector('selected'));
}

if (timeFilterTo) {
  timeFilterTo.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      applyTimeFilter();
    }
  });
}

// ==== Tabs: Danh sÃ¡ch quÃ©t / Quáº£n lÃ½ post / Setting profile ====
const tabConfig = {
  scan: { btn: tabScanList, view: scanView },
  post: { btn: tabPostManager, view: postView },
  settings: { btn: tabSettings, view: settingsView },
};

const ACTIVE_TAB_KEY = 'activeTab';

function switchTab(key) {
  Object.entries(tabConfig).forEach(([k, { btn, view }]) => {
    if (!btn || !view) return;
    const isActive = k === key;
    btn.classList.toggle('active', isActive);
    view.style.display = isActive ? 'block' : 'none';
  });

  if (key === 'post') {
    loadPostsForManager();
  }

  // nhá»› tab Ä‘ang má»Ÿ Ä‘á»ƒ khÃ´ng bá»‹ nháº£y vá» tab Ä‘áº§u
  try {
    localStorage.setItem(ACTIVE_TAB_KEY, key);
  } catch (e) {
    // ignore
  }
}

if (tabScanList) tabScanList.addEventListener('click', async (e) => {
  // Chá»‰ chuyá»ƒn tab khi ngÆ°á»i dÃ¹ng tháº­t sá»± báº¥m tab; khÃ´ng auto chuyá»ƒn á»Ÿ nÆ¡i khÃ¡c
  e.preventDefault();
  switchTab('scan');

  // Khi click vÃ o tab danh sÃ¡ch quÃ©t, tá»± Ä‘á»™ng load láº¡i dá»¯ liá»‡u má»›i nháº¥t theo timestamp
  try {
    await loadInitialData();
  } catch (err) {
    console.warn('KhÃ´ng thá»ƒ load dá»¯ liá»‡u khi click tab danh sÃ¡ch quÃ©t:', err);
  }
});
if (tabPostManager) tabPostManager.addEventListener('click', () => switchTab('post'));
if (tabSettings) tabSettings.addEventListener('click', () => switchTab('settings'));

// ============
// Date Range Buttons Logic
// ============

// Function Ä‘á»ƒ load data tá»« file cá»¥ thá»ƒ
async function loadDataFromFile(filename) {
  console.log('Loading data from file:', filename);

  try {
    // Reset data
    tbody.innerHTML = '';
    counter = 1;
    loadedPostIds.clear();
    initialLoaded = false;

    // Gá»i API Ä‘á»ƒ láº¥y data tá»« file cá»¥ thá»ƒ
    const res = await callBackend('/data/latest-results', {
      method: 'POST',
      body: JSON.stringify({
        filename: filename
      })
    });

    const data = res.data;
    console.log(`ÄÃ£ load data tá»« file: ${filename}`);

    // Xá»­ lÃ½ data giá»‘ng nhÆ° loadInitialData
    const allPosts = [];
    Object.values(data.results_by_file || {}).forEach(filePosts => {
      if (Array.isArray(filePosts)) {
        allPosts.push(...filePosts);
      }
    });

    console.log(`Tá»•ng sá»‘ posts: ${allPosts.length}`);

    let displayedCount = 0;
    allPosts.forEach((post) => {
      const postId = post.post_id || '';
      if (!postId) return;

      // Map flag
      let type = 'type1';
      const flag = (post.flag || '').toLowerCase();
      if (flag === 'xanh') type = 'type1';
      else if (flag === 'vÃ ng' || flag === 'vang') type = 'type2';
      else if (flag === 'Ä‘á»' || flag === 'do') type = 'type3';

      // Xá»­ lÃ½ reactions vÃ  comments
      const reactionsByUser = new Map();
      const commentsByUser = new Map();

      if (post.reactions && Array.isArray(post.reactions)) {
        post.reactions.forEach((r) => {
          const uid = r && r.id ? String(r.id) : '';
          if (!uid) return;
          reactionsByUser.set(uid, r);
        });
      }

      if (post.comments && Array.isArray(post.comments)) {
        post.comments.forEach((c) => {
          const uid = c && c.id ? String(c.id) : '';
          if (!uid) return;
          const prev = commentsByUser.get(uid);
          if (!prev) {
            commentsByUser.set(uid, c);
          } else {
            const prevTime = new Date(prev.created_time_vn || 0);
            const curTime = new Date(c.created_time_vn || 0);
            if (curTime > prevTime) {
              commentsByUser.set(uid, c);
            }
          }
        });
      }

      // Thá»i gian máº·c Ä‘á»‹nh
      let defaultTime = new Date().toLocaleTimeString('vi-VN');

      // Táº­p táº¥t cáº£ user
      const allUserIds = new Set([
        ...reactionsByUser.keys(),
        ...commentsByUser.keys(),
      ]);

      // Náº¿u khÃ´ng cÃ³ user nÃ o interact, hiá»ƒn thá»‹ post vá»›i thÃ´ng tin owner
      if (allUserIds.size === 0) {
        const owner = post.owning_profile || {};
        const ownerId = owner.id || 'unknown';
        const ownerName = owner.name || 'Unknown User';
        const uniqueKey = `${postId}_${ownerId}`;

        if (!loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: ownerId,
            name: ownerName,
            react: false,
            comment: '',
            time: defaultTime,
            type: type,
          });
          loadedPostIds.add(uniqueKey);
          displayedCount++;
        }
      }

      allUserIds.forEach((uid) => {
        const reaction = reactionsByUser.get(uid);
        const comment = commentsByUser.get(uid);

        const userId = uid;
        const name = (reaction && reaction.name) || (comment && comment.name) || '';

        const hasReact = !!reaction;
        const commentText = comment && comment.text ? comment.text : '';
        const time = (comment && comment.created_time_vn) ? comment.created_time_vn : defaultTime;

        const uniqueKey = `${postId}_${userId}`;
        if (!loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: userId,
            name: name,
            react: hasReact,
            comment: commentText,
            time: time,
            type: type,
          });
          loadedPostIds.add(uniqueKey);
          displayedCount++;
        }
      });
    });

    console.log(`ÄÃ£ hiá»ƒn thá»‹ ${displayedCount} dÃ²ng dá»¯ liá»‡u tá»« file ${filename}`);
    initialLoaded = true;

    // Show empty state if no rows
    if (tbody.children.length === 0) {
      emptyState.classList.add('show');
    } else {
      emptyState.classList.remove('show');
    }

  } catch (err) {
    console.error('KhÃ´ng táº£i Ä‘Æ°á»£c data tá»« file:', err);
    showToast('KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u tá»« file Ä‘Ã£ chá»n', 'error', 4000);
  }
}

// Function Ä‘á»ƒ show dropdown vá»›i danh sÃ¡ch files
async function showFileSelector(rangeType, fromDate, toDate) {
  console.log('Showing file selector for:', rangeType, 'from:', fromDate, 'to:', toDate);

  try {
    // Set title
    let title = '';
    if (rangeType === 'today') title = 'Chá»n file data ngÃ y hÃ´m nay';
    else if (rangeType === '3days') title = 'Chá»n file data 3 ngÃ y gáº§n nháº¥t';
    fileSelectorTitle.textContent = title;

    // Gá»i API Ä‘á»ƒ láº¥y danh sÃ¡ch files
    const res = await callBackend('/data/files-in-range', {
      method: 'POST',
      body: JSON.stringify({
        from_timestamp: Math.floor(fromDate.getTime() / 1000),
        to_timestamp: Math.floor(toDate.getTime() / 1000)
      })
    });

    const files = res.files || [];
    console.log(`TÃ¬m tháº¥y ${files.length} file trong khoáº£ng thá»i gian`);

    // Populate file list
    fileList.innerHTML = '';

    if (files.length === 0) {
      fileList.innerHTML = '<div style="padding: 20px; text-align: center; color: #6b7280;">KhÃ´ng tÃ¬m tháº¥y file nÃ o trong khoáº£ng thá»i gian nÃ y</div>';
    } else {
      files.forEach((file, index) => {
        const fileItem = document.createElement('button');
        fileItem.className = 'file-item';
        fileItem.innerHTML = `
          <div class="file-name">${file.filename}</div>
          <div class="file-info">${file.date_formatted}</div>
        `;

        fileItem.addEventListener('click', async () => {
          // Load data from selected file
          await loadDataFromFile(file.filename);
          fileSelectorContainer.classList.add('hidden');

          // Update active button
          [todayBtn, threeDaysBtn].forEach(btn => btn.classList.remove('active'));
          if (rangeType === 'today') todayBtn.classList.add('active');
          else if (rangeType === '3days') threeDaysBtn.classList.add('active');
        });

        fileList.appendChild(fileItem);
      });
    }

    // Show dropdown
    fileSelectorContainer.classList.remove('hidden');

  } catch (err) {
    console.error('KhÃ´ng thá»ƒ load danh sÃ¡ch files:', err);
    showToast('KhÃ´ng thá»ƒ táº£i danh sÃ¡ch files', 'error', 4000);
  }
}

// Function Ä‘á»ƒ set khoáº£ng thá»i gian cho cÃ¡c nÃºt preset
function setDateRange(days) {
  const now = new Date();
  const toDate = new Date(now);
  const fromDate = new Date(now);

  if (days === 'today') {
    // Tá»« 00:00 hÃ´m nay Ä‘áº¿n hiá»‡n táº¡i
    fromDate.setHours(0, 0, 0, 0);
  } else {
    // Tá»« N ngÃ y trÆ°á»›c Ä‘áº¿n hiá»‡n táº¡i
    fromDate.setDate(fromDate.getDate() - days);
  }

  return { fromDate, toDate };
}

// Function Ä‘á»ƒ load data theo khoáº£ng thá»i gian (legacy - khÃ´ng dÃ¹ng ná»¯a)
async function loadDataByDateRange(fromDate, toDate) {
  console.log('Loading data from:', fromDate, 'to:', toDate);

  try {
    // Reset data
    tbody.innerHTML = '';
    counter = 1;
    loadedPostIds.clear();
    initialLoaded = false;

    // Gá»i API Ä‘á»ƒ láº¥y file JSON theo khoáº£ng thá»i gian
    const res = await callBackend('/data/by-date-range', {
      method: 'POST',
      body: JSON.stringify({
        from_timestamp: Math.floor(fromDate.getTime() / 1000),
        to_timestamp: Math.floor(toDate.getTime() / 1000)
      })
    });

    const data = res.data;
    console.log(`ÄÃ£ load file JSON theo khoáº£ng thá»i gian:`, data.total_files);

    // Xá»­ lÃ½ data giá»‘ng nhÆ° loadInitialData
    const allPosts = [];
    Object.values(data.results_by_file || {}).forEach(filePosts => {
      if (Array.isArray(filePosts)) {
        allPosts.push(...filePosts);
      }
    });

    console.log(`Tá»•ng sá»‘ posts trong khoáº£ng thá»i gian: ${allPosts.length}`);

    let displayedCount = 0;
    allPosts.forEach((post) => {
      const postId = post.post_id || '';
      if (!postId) return;

      // Map flag
      let type = 'type1';
      const flag = (post.flag || '').toLowerCase();
      if (flag === 'xanh') type = 'type1';
      else if (flag === 'vÃ ng' || flag === 'vang') type = 'type2';
      else if (flag === 'Ä‘á»' || flag === 'do') type = 'type3';

      // Xá»­ lÃ½ reactions vÃ  comments
      const reactionsByUser = new Map();
      const commentsByUser = new Map();

      if (post.reactions && Array.isArray(post.reactions)) {
        post.reactions.forEach((r) => {
          const uid = r && r.id ? String(r.id) : '';
          if (!uid) return;
          reactionsByUser.set(uid, r);
        });
      }

      if (post.comments && Array.isArray(post.comments)) {
        post.comments.forEach((c) => {
          const uid = c && c.id ? String(c.id) : '';
          if (!uid) return;
          const prev = commentsByUser.get(uid);
          if (!prev) {
            commentsByUser.set(uid, c);
          } else {
            const prevTime = new Date(prev.created_time_vn || 0);
            const curTime = new Date(c.created_time_vn || 0);
            if (curTime > prevTime) {
              commentsByUser.set(uid, c);
            }
          }
        });
      }

      // Thá»i gian máº·c Ä‘á»‹nh
      let defaultTime = new Date().toLocaleTimeString('vi-VN');

      // Táº­p táº¥t cáº£ user
      const allUserIds = new Set([
        ...reactionsByUser.keys(),
        ...commentsByUser.keys(),
      ]);

      // Náº¿u khÃ´ng cÃ³ user nÃ o interact, hiá»ƒn thá»‹ post vá»›i thÃ´ng tin owner
      if (allUserIds.size === 0) {
        const owner = post.owning_profile || {};
        const ownerId = owner.id || 'unknown';
        const ownerName = owner.name || 'Unknown User';
        const uniqueKey = `${postId}_${ownerId}`;

        if (!loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: ownerId,
            name: ownerName,
            react: false,
            comment: '',
            time: defaultTime,
            type: type,
          });
          loadedPostIds.add(uniqueKey);
          displayedCount++;
        }
      }

      allUserIds.forEach((uid) => {
        const reaction = reactionsByUser.get(uid);
        const comment = commentsByUser.get(uid);

        const userId = uid;
        const name = (reaction && reaction.name) || (comment && comment.name) || '';

        const hasReact = !!reaction;
        const commentText = comment && comment.text ? comment.text : '';
        const time = (comment && comment.created_time_vn) ? comment.created_time_vn : defaultTime;

        const uniqueKey = `${postId}_${userId}`;
        if (!loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: userId,
            name: name,
            react: hasReact,
            comment: commentText,
            time: time,
            type: type,
          });
          loadedPostIds.add(uniqueKey);
          displayedCount++;
        }
      });
    });

    console.log(`ÄÃ£ hiá»ƒn thá»‹ ${displayedCount} dÃ²ng dá»¯ liá»‡u theo khoáº£ng thá»i gian`);
    initialLoaded = true;

    // Show empty state if no rows
    if (tbody.children.length === 0) {
      emptyState.classList.add('show');
    } else {
      emptyState.classList.remove('show');
    }

  } catch (err) {
    console.error('KhÃ´ng táº£i Ä‘Æ°á»£c data theo khoáº£ng thá»i gian:', err);
    showToast('KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u theo khoáº£ng thá»i gian', 'error', 4000);
  }
}

// Function Ä‘á»ƒ set khoáº£ng thá»i gian cho cÃ¡c nÃºt preset
function setDateRange(days) {
  const now = new Date();
  const toDate = new Date(now);
  const fromDate = new Date(now);

  if (days === 'today') {
    // Tá»« 00:00 hÃ´m nay Ä‘áº¿n hiá»‡n táº¡i
    fromDate.setHours(0, 0, 0, 0);
  } else {
    // Tá»« N ngÃ y trÆ°á»›c Ä‘áº¿n hiá»‡n táº¡i
    fromDate.setDate(fromDate.getDate() - days);
  }

  return { fromDate, toDate };
}

// Event listeners cho date buttons
if (todayBtn) {
  todayBtn.addEventListener('click', async () => {
    const { fromDate, toDate } = setDateRange('today');
    await showFileSelector('today', fromDate, toDate);
  });
}

if (threeDaysBtn) {
  threeDaysBtn.addEventListener('click', async () => {
    const { fromDate, toDate } = setDateRange(3);
    await showFileSelector('3days', fromDate, toDate);
  });
}


// Event listeners cho file selector
if (closeFileSelector) {
  closeFileSelector.addEventListener('click', () => {
    fileSelectorContainer.classList.add('hidden');
  });
}

if (cancelFileSelection) {
  cancelFileSelection.addEventListener('click', () => {
    fileSelectorContainer.classList.add('hidden');
  });
}

// Click outside Ä‘á»ƒ Ä‘Ã³ng file selector
document.addEventListener('click', (e) => {
  if (!fileSelectorContainer.contains(e.target) &&
      !e.target.matches('.date-btn')) {
    fileSelectorContainer.classList.add('hidden');
  }
});

// Khá»Ÿi táº¡o: luÃ´n vÃ o tab danh sÃ¡ch quÃ©t + load state profile
let initialTab = 'scan';
try {
  const saved = localStorage.getItem(ACTIVE_TAB_KEY);
  if (saved && tabConfig[saved]) initialTab = saved;
} catch (e) {
  // ignore
}
switchTab(initialTab);
// Khá»Ÿi táº¡o: load state profile rá»“i sync UI theo backend (Ä‘á»ƒ F5 khÃ´ng bá»‹ lá»‡ch tráº¡ng thÃ¡i)
(async () => {
  try {
    await loadProfileState();
  } catch (_) { }
  try {
    await resyncUiFromBackendAfterReload();
  } catch (_) { }
  try {
    // Tá»± Ä‘á»™ng load danh sÃ¡ch quÃ©t vá»›i JSON má»›i nháº¥t theo timestamp
    await loadInitialData();
  } catch (err) {
    console.warn('KhÃ´ng thá»ƒ load danh sÃ¡ch quÃ©t lÃºc khá»Ÿi táº¡o:', err);
  }
})();
// Khá»Ÿi táº¡o filter vá»›i tráº¡ng thÃ¡i máº·c Ä‘á»‹nh
initializeFilters();

--- END FILE: frontend\script.js ---

--- START FILE: frontend\style.css ---
* {
  box-sizing: border-box;
  margin    : 0;
  padding   : 0;
}

:root {
  --primary       : #6366f1;
  --primary-dark  : #4f46e5;
  --danger        : #ef4444;
  --danger-dark   : #dc2626;
  --success       : #10b981;
  --orange        : #f97316;
  --orange-dark   : #ea580c;
  --pause         : #0ea5a4;
  --pause-dark    : #0f766e;
  --bg-gradient   : linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --card-bg       : #ffffff;
  --text-primary  : #1f2937;
  --text-secondary: #6b7280;
  --border        : #e5e7eb;
  --shadow        : 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg     : 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

body {
  font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  background : var(--bg-gradient);
  height     : 100vh;
  overflow   : hidden;
  padding    : 12px;
  color      : var(--text-primary);
  line-height: 1.6;
}

body.splash-active {
  overflow: hidden;
}

/* Splash Screen */
.splash-screen {
  position       : fixed;
  top            : 0;
  left           : 0;
  width          : 100%;
  height         : 100%;
  background     : linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
  background-size: 400% 400%;
  animation      : gradientShift 15s ease infinite;
  display        : flex;
  align-items    : center;
  justify-content: center;
  z-index        : 10000;
  transition     : opacity 0.6s ease, visibility 0.6s ease;
}

.splash-screen.hidden {
  opacity   : 0;
  visibility: hidden;
}

@keyframes gradientShift {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}

.splash-content {
  text-align: center;
  animation : fadeInUp 0.8s ease-out;
}

.splash-title {
  font-size     : 48px;
  font-weight   : 700;
  color         : white;
  margin        : 0 0 16px 0;
  text-shadow   : 0 4px 20px rgba(0, 0, 0, 0.3);
  letter-spacing: 2px;
  animation     : titleGlow 2s ease-in-out infinite alternate;
}

@keyframes titleGlow {
  from {
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), 0 0 30px rgba(255, 255, 255, 0.2);
  }

  to {
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), 0 0 40px rgba(255, 255, 255, 0.4);
  }
}

.splash-subtitle {
  font-size  : 18px;
  color      : rgba(255, 255, 255, 0.9);
  margin     : 0 0 40px 0;
  font-weight: 400;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.splash-btn {
  padding        : 16px 48px;
  font-size      : 18px;
  font-weight    : 600;
  color          : white;
  background     : rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
  border         : 2px solid rgba(255, 255, 255, 0.3);
  border-radius  : 50px;
  cursor         : pointer;
  transition     : all 0.3s ease;
  box-shadow     : 0 8px 32px rgba(0, 0, 0, 0.2);
  text-transform : uppercase;
  letter-spacing : 1px;
}

.splash-btn:hover {
  background  : rgba(255, 255, 255, 0.3);
  border-color: rgba(255, 255, 255, 0.5);
  transform   : translateY(-3px) scale(1.05);
  box-shadow  : 0 12px 40px rgba(0, 0, 0, 0.3);
}

.splash-btn:active {
  transform: translateY(-1px) scale(1.02);
}

/* áº¨n container khi splash Ä‘ang hiá»ƒn thá»‹ */
body.splash-active .container {
  opacity       : 0;
  pointer-events: none;
}

.container {
  width         : 100%;
  max-width     : 100%;
  margin        : 0 auto;
  padding       : 0 12px 12px;
  height        : 100%;
  display       : flex;
  flex-direction: column;
}

/* Header */
.header {
  background     : rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-radius  : 16px;
  padding        : 2px;
  margin-bottom  : 18px;
  box-shadow     : 0 12px 30px rgba(0, 0, 0, 0.08);
  text-align     : center;
  animation      : slideDown 0.5s ease-out;
  position       : relative;
}

.header-content h1 {
  font-size  : 28px;
  font-weight: 700;
  color      : var(--text-primary);

  background             : var(--bg-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip        : text;
}

.subtitle {
  color      : var(--text-secondary);
  font-size  : 14px;
  font-weight: 500;
}

/* Color Legend */
.color-legend {
  display        : flex;
  gap            : 20px;
  align-items    : center;
  flex-wrap      : wrap;
  justify-content: center;
  margin-bottom  : 16px;
  padding        : 10px 16px;
  background     : #f9fafb;
  border-radius  : 8px;
  border         : 1px dashed var(--border);
  font-size      : 12px;
}

.legend-item {
  display    : flex;
  align-items: center;
  gap        : 6px;
  font-size  : 13px;
  font-weight: 500;
}

.legend-dot {
  width        : 12px;
  height       : 12px;
  border-radius: 50%;
  display      : inline-block;
  box-shadow   : 0 2px 4px rgba(0, 0, 0, 0.2);
}

.legend-green {
  background: #10b981;
}

.legend-yellow {
  background: #f59e0b;
}

.legend-red {
  background: #ef4444;
}

.legend-text {
  color      : var(--text-primary);
  white-space: nowrap;
}

/* Layout */
.layout {
  display        : flex;
  flex-direction : column;
  align-items    : stretch;
  flex           : 1;
  min-height     : 0;
  overflow       : hidden;
  width          : 100%;
  padding        : 20px 38px; /* 20px trÃªn/dÆ°á»›i, 38px trÃ¡i/pháº£i (â‰ˆ1cm) */
  gap            : 16px;
}

/* Panel */
.right-panel {
  background   : var(--card-bg);
  border-radius: 16px;
  box-shadow   : var(--shadow-lg);
  overflow     : hidden;
  animation    : fadeInUp 0.6s ease-out;
  transition   : transform 0.3s ease, box-shadow 0.3s ease;
}

/* CSS cho left-panel Ä‘Ã£ bá»‹ xÃ³a */

.right-panel {
  min-height: 0;
  height    : 100%;
  width     : 100%;
  overflow-y: auto;
  flex      : 1;
}

/* Right panel: giá»¯ tab/header Ä‘á»©ng im, chá»‰ cuá»™n pháº§n ná»™i dung bÃªn dÆ°á»›i */
.right-panel .panel-header {
  position  : sticky;
  top       : 0;
  z-index   : 50;
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.08);
}

/* Thu nhá» scrollbar cho right-panel cho gá»n (giá»‘ng left-panel) */
.right-panel::-webkit-scrollbar {
  width: 8px;
}

.right-panel::-webkit-scrollbar-track {
  background: transparent;
}

.right-panel::-webkit-scrollbar-thumb {
  background   : rgba(99, 102, 241, 0.35);
  border-radius: 999px;
}

.right-panel::-webkit-scrollbar-thumb:hover {
  background: rgba(99, 102, 241, 0.55);
}

/* CSS cho left-panel Ä‘Ã£ bá»‹ xÃ³a */

.panel-header {
  background     : linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding        : 20px 24px;
  display        : flex;
  justify-content: space-between;
  align-items    : center;
}

.panel-header h3 {
  color      : white;
  font-size  : 18px;
  font-weight: 600;
  margin     : 0;
  display    : flex;
  align-items: center;
  gap        : 8px;
}

.badge {
  background     : rgba(255, 255, 255, 0.2);
  color          : white;
  padding        : 4px 12px;
  border-radius  : 12px;
  font-size      : 12px;
  font-weight    : 600;
  backdrop-filter: blur(10px);
}

.panel-body {
  padding: 24px;
}

/* Fields */
.field {
  margin-bottom: 20px;
}

.field:last-child {
  margin-bottom: 0;
}

.field label {
  display      : flex;
  align-items  : center;
  gap          : 8px;
  margin-bottom: 10px;
  font-weight  : 600;
  font-size    : 14px;
  color        : var(--text-primary);
}

.label-icon {
  font-size: 16px;
}

.field input {
  width        : 100%;
  padding      : 12px 16px;
  border       : 2px solid var(--border);
  border-radius: 10px;
  font-size    : 15px;
  transition   : all 0.3s ease;
  background   : #f9fafb;
  color        : var(--text-primary);
}

.field input:focus {
  outline     : none;
  border-color: var(--primary);
  background  : white;
  box-shadow  : 0 0 0 4px rgba(99, 102, 241, 0.1);
  transform   : translateY(-1px);
}

.field input::placeholder {
  color: #9ca3af;
}

/* Buttons */
button {
  width          : 100%;
  padding        : 16px 24px;
  border         : none;
  border-radius  : 12px;
  font-size      : 16px;
  font-weight    : 600;
  cursor         : pointer;
  transition     : all 0.3s ease;
  display        : flex;
  align-items    : center;
  justify-content: center;
  gap            : 8px;
  position       : relative;
  overflow       : hidden;
}

/* Loading state (spinner) */
.btn-loading {
  opacity: 0.9;
  cursor : not-allowed;
}

.btn-loading::after {
  content         : "";
  width           : 14px;
  height          : 14px;
  border-radius   : 50%;
  border          : 2px solid rgba(255, 255, 255, 0.55);
  border-top-color: rgba(255, 255, 255, 1);
  animation       : btnSpin 0.9s linear infinite;
}

@keyframes btnSpin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

button::before {
  content      : '';
  position     : absolute;
  top          : 50%;
  left         : 50%;
  width        : 0;
  height       : 0;
  border-radius: 50%;
  background   : rgba(255, 255, 255, 0.3);
  transform    : translate(-50%, -50%);
  transition   : width 0.6s, height 0.6s;
}

button:hover::before {
  width : 300px;
  height: 300px;
}

button:active {
  transform: scale(0.98);
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color     : white;
  box-shadow: 0 4px 14px 0 rgba(99, 102, 241, 0.4);
}

.btn-primary:hover {
  box-shadow: 0 6px 20px 0 rgba(99, 102, 241, 0.5);
  transform : translateY(-2px);
}

.btn-primary:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
  transform : none;
}

.btn-danger {
  background: linear-gradient(135deg, var(--danger) 0%, var(--danger-dark) 100%);
  color     : white;
  box-shadow: 0 4px 14px 0 rgba(239, 68, 68, 0.4);
}

.btn-danger:hover {
  box-shadow: 0 6px 20px 0 rgba(239, 68, 68, 0.5);
  transform : translateY(-2px);
}

.btn-danger:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
  transform : none;
}

.btn-success {
  background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
  color     : white;
  box-shadow: 0 4px 14px 0 rgba(16, 185, 129, 0.4);
}

.btn-success:hover {
  box-shadow: 0 6px 20px 0 rgba(16, 185, 129, 0.5);
  transform : translateY(-2px);
}

.btn-success:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
  transform : none;
}

/* Stop selected (khÃ¡c mÃ u Stop all) */
.btn-orange {
  background: linear-gradient(135deg, var(--orange) 0%, var(--orange-dark) 100%);
  color     : white;
  box-shadow: 0 4px 14px 0 rgba(249, 115, 22, 0.4);
}

.btn-orange:hover {
  box-shadow: 0 6px 20px 0 rgba(249, 115, 22, 0.5);
  transform : translateY(-2px);
}

.btn-orange:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
  transform : none;
}

.btn-icon {
  font-size: 16px;
}

.status-line {
  display      : flex;
  align-items  : center;
  gap          : 12px;
  margin-top   : 12px;
  padding      : 12px;
  border       : 1px dashed var(--border);
  border-radius: 12px;
  background   : #f9fafb;
}

.status-text-group {
  display       : flex;
  flex-direction: column;
  gap           : 2px;
}

.status-dot {
  width        : 12px;
  height       : 12px;
  border-radius: 50%;
  background   : var(--danger);
  box-shadow   : 0 0 0 4px rgba(239, 68, 68, 0.15);
}

.status-dot.online {
  background: var(--success);
  box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.2);
  animation : pulse 2s infinite;
}

.status-label {
  font-weight: 700;
  color      : var(--text-primary);
  font-size  : 13px;
}

.status-text {
  color    : var(--text-secondary);
  font-size: 13px;
}

/* Filter Container */
.filter-container {
  margin-bottom : 16px;
  padding       : 12px 16px;
  background    : #f9fafb;
  border-radius : 10px;
  border        : 1px solid var(--border);
  display       : flex;
  flex-direction: column;
  gap           : 12px;
}

.filter-group {
  display       : flex;
  flex-direction: column;
  gap           : 8px;
}

.filter-group {
  padding-bottom: 12px;
}

.filter-group:not(:last-child) {
  border-bottom : 1px dashed var(--border);
}

/* Time Filter - Compact Single Row - Beautiful Design */
.time-filter-compact {
  margin-top: 6px;
}

.time-filter-inline {
  display      : inline-flex;
  align-items  : center;
  gap          : 5px;
  background   : linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
  border       : 1.5px solid var(--border);
  border-radius: 8px;
  padding      : 5px 7px;
  max-width    : fit-content;
  box-shadow   : 0 2px 6px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);
  transition   : all 0.3s ease;
}

.time-filter-inline:hover {
  border-color: var(--primary);
  box-shadow  : 0 4px 12px rgba(99, 102, 241, 0.12), 0 2px 4px rgba(0, 0, 0, 0.06);
}

.time-filter-input-compact {
  width        : 135px;
  padding      : 6px 8px;
  border       : 1px solid rgba(99, 102, 241, 0.2);
  border-radius: 6px;
  font-size    : 12px;
  background   : white;
  color        : var(--text-primary);
  transition   : all 0.25s ease;
  font-family  : inherit;
  box-shadow   : 0 1px 2px rgba(0, 0, 0, 0.04);
}

.time-filter-input-compact:hover {
  border-color: var(--primary);
  box-shadow  : 0 2px 4px rgba(99, 102, 241, 0.15);
  transform   : translateY(-1px);
}

.time-filter-input-compact:focus {
  outline     : none;
  border-color: var(--primary);
  background  : white;
  box-shadow  : 0 0 0 3px rgba(99, 102, 241, 0.1), 0 2px 6px rgba(99, 102, 241, 0.2);
  transform   : translateY(-1px);
}

.time-filter-input-compact::placeholder {
  color     : #9ca3af;
  font-size : 11px;
  font-style: italic;
}

.time-filter-separator {
  color      : var(--primary);
  font-size  : 12px;
  font-weight: 700;
  padding    : 0 2px;
  flex-shrink: 0;
  opacity    : 0.6;
  transition : opacity 0.2s ease;
}

.time-filter-inline:hover .time-filter-separator {
  opacity: 1;
}

.time-filter-btn-compact {
  width          : 32px;
  height         : 32px;
  padding        : 0;
  border         : none;
  border-radius  : 6px;
  font-size      : 13px;
  font-weight    : 700;
  cursor         : pointer;
  transition     : all 0.25s ease;
  display        : flex;
  align-items    : center;
  justify-content: center;
  flex-shrink    : 0;
  box-shadow     : 0 2px 4px rgba(0, 0, 0, 0.1);
}

.time-filter-apply-compact {
  background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
  color     : white;
}

.time-filter-apply-compact:hover {
  background: linear-gradient(135deg, #059669 0%, var(--success) 100%);
  transform : translateY(-2px) scale(1.05);
  box-shadow: 0 4px 8px rgba(16, 185, 129, 0.4);
}

.time-filter-apply-compact:active {
  transform: translateY(0) scale(1);
}

.time-filter-apply-compact.active {
  background: linear-gradient(135deg, #047857 0%, #059669 100%);
  box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3), 0 4px 12px rgba(16, 185, 129, 0.4);
  animation : pulseSuccess 2s ease-in-out infinite;
}

@keyframes pulseSuccess {

  0%,
  100% {
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3), 0 4px 12px rgba(16, 185, 129, 0.4);
  }

  50% {
    box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.4), 0 6px 16px rgba(16, 185, 129, 0.5);
  }
}

.time-filter-clear-compact {
  background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
  color     : var(--text-secondary);
  border    : 1px solid var(--border);
}

.time-filter-clear-compact:hover {
  background  : linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
  color       : var(--danger);
  border-color: var(--danger);
  transform   : translateY(-2px) scale(1.05);
  box-shadow  : 0 4px 8px rgba(239, 68, 68, 0.2);
}

.time-filter-clear-compact:active {
  transform: translateY(0) scale(1);
}

/* Responsive */
@media (max-width: 768px) {
  .time-filter-inline {
    flex-wrap: wrap;
  }

  .time-filter-input-compact {
    min-width: 120px;
  }
}

.filter-label {
  font-size    : 13px;
  font-weight  : 600;
  color        : var(--text-primary);
  margin-bottom: 0;
}

.filter-buttons {
  display  : flex;
  gap      : 8px;
  flex-wrap: wrap;
}

.filter-btn {
  width        : auto;
  padding      : 10px 20px;
  font-size    : 14px;
  font-weight  : 600;
  border       : 2px solid var(--border);
  background   : white;
  color        : var(--text-primary);
  border-radius: 8px;
  cursor       : pointer;
  transition   : all 0.3s ease;
  display      : flex;
  align-items  : center;
  gap          : 6px;
}

.filter-btn:hover {
  border-color: var(--primary);
  transform   : translateY(-1px);
  box-shadow  : 0 2px 8px rgba(99, 102, 241, 0.2);
}

.filter-btn.active {
  background  : linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color       : white;
  border-color: var(--primary);
  box-shadow  : 0 2px 8px rgba(99, 102, 241, 0.3);
}

.filter-btn.filter-green.active {
  background  : linear-gradient(135deg, #10b981 0%, #059669 100%);
  border-color: #10b981;
  box-shadow  : 0 2px 8px rgba(16, 185, 129, 0.3);
}

.filter-btn.filter-yellow.active {
  background  : linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  border-color: #f59e0b;
  box-shadow  : 0 2px 8px rgba(245, 158, 11, 0.3);
}

.filter-btn.filter-red.active {
  background  : linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
  border-color: #ef4444;
  box-shadow  : 0 2px 8px rgba(239, 68, 68, 0.3);
}

.filter-dot {
  width        : 10px;
  height       : 10px;
  border-radius: 50%;
  display      : inline-block;
  box-shadow   : 0 1px 3px rgba(0, 0, 0, 0.2);
}

.filter-dot-green {
  background: #10b981;
}

.filter-dot-yellow {
  background: #f59e0b;
}

.filter-dot-red {
  background: #ef4444;
}

.filter-btn.active .filter-dot {
  background: white;
}

tbody tr.filtered-out {
  display: none;
}

/* Table */
.table-container {
  overflow-x   : auto;
  border-radius: 12px;
  border       : 1px solid var(--border);
  margin       : 0 10px;
}

/* Tabs trong header bÃªn pháº£i */
.panel-tabs {
  display: flex;
  gap    : 8px;
}

.tab-button {
  width        : auto;
  padding      : 8px 14px;
  border-radius: 999px;
  border       : none;
  background   : rgba(255, 255, 255, 0.15);
  color        : #e5e7eb;
  font-size    : 13px;
  font-weight  : 600;
  cursor       : pointer;
  display      : inline-flex;
  align-items  : center;
  gap          : 6px;
  transition   : background 0.2s ease, color 0.2s ease, transform 0.1s ease;
}

.tab-button:hover {
  background: rgba(255, 255, 255, 0.25);
  transform : translateY(-1px);
}

.tab-button.active {
  background: #ffffff;
  color     : #111827;
}

/* Settings view */
.settings-stack {
  display       : flex;
  flex-direction: column;
  gap           : 14px;
  padding       : 10px;
}

.setting-card {
  background    : #f9fafb;
  border        : 1px solid var(--border);
  border-radius : 12px;
  padding       : 16px;
  display       : flex;
  flex-direction: column;
  gap           : 12px;
}

.feed-panel {
  padding      : 12px;
  border       : 1px dashed var(--border);
  border-radius: 10px;
  background   : #ffffff;
}

.feed-panel-row {
  display      : flex;
  gap          : 10px;
  align-items  : center;
  margin-bottom: 10px;
}

.feed-panel-row:last-child {
  margin-bottom: 0;
}

.feed-radio {
  display    : inline-flex;
  gap        : 6px;
  align-items: center;
  font-size  : 13px;
  font-weight: 600;
  color      : var(--text-primary);
}

.feed-duration {
  margin-left: auto;
  display    : inline-flex;
  gap        : 6px;
  align-items: center;
}

.feed-duration-left {
  margin-left: 0;
}

.feed-label {
  font-size  : 12px;
  color      : var(--text-secondary);
  font-weight: 700;
}

#feedDurationInput {
  width        : 70px;
  height       : 32px;
  padding      : 6px 10px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  font-size    : 13px;
}

#feedTextInput {
  width        : 100%;
  min-height   : 64px;
  resize       : vertical;
  padding      : 10px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  font-size    : 13px;
}

#scanTextInput,
#groupScanUrlInput {
  width        : 100%;
  min-height   : 96px;
  resize       : vertical;
  padding      : 10px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  font-size    : 13px;
  line-height  : 1.35;
}

.feed-panel-actions {
  justify-content: flex-end;
}

.feed-panel-actions button {
  width    : auto;
  min-width: 90px;
  height   : 32px;
  padding  : 6px 12px;
  font-size: 13px;
}

.setting-card-header {
  display        : flex;
  justify-content: space-between;
  align-items    : center;
  gap            : 8px;
}

.setting-card h4 {
  margin   : 0;
  font-size: 16px;
}

.muted {
  color    : var(--text-secondary);
  font-size: 13px;
  margin   : 0;
}

.inline-field {
  display: flex;
  gap    : 10px;
}

.inline-field input {
  flex: 1;
}

/* Settings: lÃ m input + button tháº¥p láº¡i (chá»‰ trong tab Setting profile) */
#settingsView .inline-field input,
#settingsView .add-profile-form input {
  height       : 34px;
  padding      : 6px 10px;
  font-size    : 13px;
  border-width : 1px;
  border-radius: 10px;
}

#settingsView .profile-id-input {
  height       : 34px;
  padding      : 6px 10px;
  flex         : 1;
  /* Äƒn toÃ n bá»™ pháº§n cÃ²n láº¡i */
  min-width    : 0;
  font-size    : 13px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  background   : #ffffff;
}

#settingsView button {
  width        : auto;
  height       : 34px;
  padding      : 6px 12px;
  font-size    : 13px;
  border-radius: 10px;
}

#settingsView .inline-field button {
  flex     : 0 0 auto;
  min-width: 120px;
}

.setting-card-actions {
  display: flex;
  gap    : 16px;
}

.setting-card-actions button {
  padding    : 16px 24px;
  font-size  : 16px;
  font-weight: 600;
  min-width  : 160px;
}

/* Settings: disable state rÃµ rÃ ng khi chÆ°a tick profile */
#settingsView .setting-card-actions button:disabled,
#settingsView .feed-panel button:disabled {
  opacity   : 0.55;
  cursor    : not-allowed;
  box-shadow: none !important;
  filter    : saturate(0.75);
}

.profile-list {
  display       : flex;
  flex-direction: column;
  gap           : 10px;
}

/* Settings: danh sÃ¡ch profile cuá»™n ná»™i bá»™ (khÃ´ng kÃ©o dÃ i trang) */
#settingsView #profileList.profile-list {
  max-height         : min(55vh, 520px);
  overflow-y         : auto;
  padding-right      : 6px;
  /* chá»«a chá»— cho scrollbar */
  overscroll-behavior: contain;
  scrollbar-width    : thin;
  /* Firefox */
  scrollbar-color    : rgba(100, 116, 139, 0.55) transparent;
}

#settingsView #profileList.profile-list::-webkit-scrollbar {
  width: 10px;
}

#settingsView #profileList.profile-list::-webkit-scrollbar-track {
  background: transparent;
}

#settingsView #profileList.profile-list::-webkit-scrollbar-thumb {
  background-color: rgba(100, 116, 139, 0.55);
  border-radius   : 999px;
  border          : 3px solid transparent;
  background-clip : content-box;
}

.profile-row-wrap {
  display       : flex;
  flex-direction: column;
  gap           : 8px;
}

.profile-row {
  display      : flex;
  align-items  : center;
  gap          : 8px;
  padding      : 10px 12px;
  background   : #ffffff;
  border       : 1px solid var(--border);
  border-radius: 10px;
}

.profile-select {
  flex           : 0 0 auto;
  display        : flex;
  align-items    : center;
  justify-content: center;
}

.profile-select-cb {
  width : 16px;
  height: 16px;
  cursor: pointer;
}

.group-panel {
  padding      : 10px 12px 12px 12px;
  background   : #f9fafb;
  border       : 1px dashed var(--border);
  border-radius: 10px;
  overflow     : visible;
}

.group-panel-header {
  font-size    : 12px;
  font-weight  : 700;
  color        : var(--text-primary);
  margin-bottom: 8px;
}

.group-textarea {
  width        : 100%;
  min-height   : 120px;
  resize       : vertical;
  padding      : 10px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  font-size    : 12px;
  background   : #ffffff;
  color        : var(--text-primary);
  outline      : none;
}

.group-textarea:focus {
  border-color: var(--primary);
  box-shadow  : 0 0 0 4px rgba(99, 102, 241, 0.1);
}

.group-panel-actions {
  display        : flex;
  gap            : 8px;
  justify-content: flex-end;
  margin-top     : 12px;
  padding        : 0;
  width          : 100%;
  box-sizing     : border-box;
}


.profile-row .profile-id {
  flex       : 1 1 40%;
  font-weight: 700;
  font-size  : 14px;
  word-break : break-all;
}

.profile-row .profile-actions {
  display        : flex;
  gap            : 8px;
  flex-wrap      : wrap;
  justify-content: flex-end;
}

.profile-state-badge {
  display        : inline-flex;
  align-items    : center;
  justify-content: center;
  padding        : 6px 10px;
  border-radius  : 10px;
  font-weight    : 800;
  font-size      : 12px;
  min-width      : 84px;
  white-space    : nowrap;
  color          : #fff;
  box-shadow     : 0 2px 6px rgba(0, 0, 0, 0.12);
}

.profile-state-badge.state-running { background: #10b981; } /* green */
.profile-state-badge.state-paused  { background: rgb(157, 168, 0); } /* yellow */
.profile-state-badge.state-ready   { background: #64748b; } /* slate */

.profile-row .profile-actions button {
  width    : auto;
  flex     : 0 0 auto;
  min-width: 70px;
  height   : 30px;
  padding  : 4px 10px;
  font-size: 12px;
}

.add-profile-row {
  margin-top: 8px;
}

.add-profile-row button {
  width: 100%;
}

.add-profile-form {
  background  : #f8fafc;
  border-style: dashed;
  gap         : 8px;
}

.add-profile-form input {
  flex         : 1 1 60%;
  padding      : 12px 14px;
  border       : 1px solid var(--border);
  border-radius: 8px;
}

.add-profile-form button {
  min-width: 80px;
  height   : 30px;
  padding  : 4px 10px;
  font-size: 12px;
}

.empty-state-box {
  border       : 1px dashed var(--border);
  border-radius: 10px;
  padding      : 12px;
  text-align   : center;
}

.hint {
  font-size: 12px;
  color    : var(--text-secondary);
}

/* Toast (thay cho alert Ä‘á»ƒ khÃ´ng nhÃ¡y UI) */
.toast-container {
  position      : fixed;
  top           : 14px;
  left          : 50%;
  transform     : translateX(-50%);
  display       : flex;
  flex-direction: column;
  gap           : 8px;
  z-index       : 2000;
  pointer-events: none;
}

.toast {
  pointer-events: none;
  min-width     : 260px;
  max-width     : min(520px, calc(100vw - 24px));
  background    : rgba(17, 24, 39, 0.92);
  color         : #fff;
  border-radius : 12px;
  padding       : 10px 12px;
  box-shadow    : 0 10px 30px rgba(0, 0, 0, 0.25);
  font-size     : 13px;
  line-height   : 1.35;
  opacity       : 0;
  transform     : translateY(-6px);
  transition    : opacity 180ms ease, transform 180ms ease;
}

.toast.show {
  opacity  : 1;
  transform: translateY(0);
}

.toast.success {
  background: rgba(16, 185, 129, 0.92);
}

.toast.error {
  background: rgba(239, 68, 68, 0.92);
}

#settingsPreview {
  width        : 100%;
  padding      : 12px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  background   : #0b1021;
  color        : #e5e7eb;
  font-family  : "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
  font-size    : 13px;
  resize       : vertical;
}

table {
  width          : 100%;
  border-collapse: collapse;
  font-size      : 14px;
  background     : white;
}

/* Tá»‘i Æ°u báº£ng Quáº£n lÃ½ post Ä‘á»ƒ háº¡n cháº¿ scroll ngang */
#postTable {
  table-layout: fixed;
}

#postTable th:nth-child(1) {
  width: 22%;
}

#postTable th:nth-child(2) {
  width: 58%;
}

#postTable th:nth-child(3) {
  width: 20%;
}

#postTable td:nth-child(2) {
  white-space: normal;
  word-break : break-word;
}

/* RiÃªng pháº§n Quáº£n lÃ½ post: áº©n háº³n thanh scroll ngang cho gá»n */
#postView .table-container {
  overflow-x        : auto;
  scrollbar-width   : none;
  /* Firefox */
  -ms-overflow-style: none;
  /* IE/Edge cÅ© */
}

#postView .table-container::-webkit-scrollbar {
  display: none;
  /* Chrome/Safari */
}

thead {
  background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
}

th {
  padding       : 16px;
  text-align    : left;
  font-weight   : 700;
  color         : var(--text-primary);
  text-transform: uppercase;
  font-size     : 12px;
  letter-spacing: 0.5px;
  border-bottom : 2px solid var(--border);
}

td {
  padding      : 16px;
  border-bottom: 1px solid var(--border);
  color        : var(--text-primary);
}

/* Link cho ID (ID BÃ i Post, ID User) */
.id-link {
  color          : #2563eb;
  text-decoration: none;
  font-weight    : 500;
}

.id-link:hover {
  text-decoration: underline;
}

/* Type column colors */
td.type-cell {
  font-weight: 600;
  text-align : center;
}

td.type-cell.type-green {
  background: #49ee98;
  color     : #065f46;
}

td.type-cell.type-yellow {
  background: #e9d47d;
  color     : #92400e;
}

td.type-cell.type-red {
  background: #ed7b7b;
  color     : #991b1b;
}

tbody tr {
  transition: all 0.2s ease;
}

tbody tr:hover {
  background: #f9fafb;
  transform : scale(1.01);
}

tbody tr:last-child td {
  border-bottom: none;
}

/* Empty State */
.empty {
  text-align: center;
  padding   : 60px 20px;
  color     : var(--text-secondary);
  display   : none;
}

.empty.show {
  display: block;
}

.empty-icon {
  font-size    : 64px;
  margin-bottom: 16px;
  opacity      : 0.5;
}

.empty p {
  font-size    : 16px;
  font-weight  : 600;
  margin-bottom: 8px;
  color        : var(--text-primary);
}

.empty-hint {
  font-size  : 14px;
  color      : var(--text-secondary);
  font-weight: 400;
}

/* Animations */
@keyframes slideDown {
  from {
    opacity  : 0;
    transform: translateY(-20px);
  }

  to {
    opacity  : 1;
    transform: translateY(0);
  }
}

@keyframes fadeInUp {
  from {
    opacity  : 0;
    transform: translateY(20px);
  }

  to {
    opacity  : 1;
    transform: translateY(0);
  }
}

@keyframes pulse {

  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.5;
  }
}

/* Modal */
.modal {
  position       : fixed;
  top            : 0;
  left           : 0;
  right          : 0;
  bottom         : 0;
  background     : rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
  display        : flex;
  align-items    : center;
  justify-content: center;
  z-index        : 1000;
  opacity        : 0;
  transition     : opacity 0.3s ease;
  pointer-events : none;
}

.modal.show {
  opacity       : 1;
  pointer-events: all;
}

.modal-content {
  background    : var(--card-bg);
  border-radius : 16px;
  box-shadow    : var(--shadow-lg);
  width         : 90%;
  max-width     : 500px;
  max-height    : 90vh;
  overflow      : hidden;
  display       : flex;
  flex-direction: column;
  transform     : scale(0.9) translateY(20px);
  transition    : transform 0.3s ease;
}

.modal.show .modal-content {
  transform: scale(1) translateY(0);
}

.modal-header {
  background     : linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding        : 20px 24px;
  display        : flex;
  justify-content: space-between;
  align-items    : center;
}

.modal-header h3 {
  color      : white;
  font-size  : 18px;
  font-weight: 600;
  margin     : 0;
}

.modal-close {
  background     : rgba(255, 255, 255, 0.2);
  border         : none;
  color          : white;
  font-size      : 24px;
  width          : 32px;
  height         : 32px;
  border-radius  : 50%;
  cursor         : pointer;
  display        : flex;
  align-items    : center;
  justify-content: center;
  transition     : all 0.3s ease;
  padding        : 0;
  line-height    : 1;
}

.modal-close:hover {
  background: rgba(255, 255, 255, 0.3);
  transform : rotate(90deg);
}

.modal-body {
  padding   : 24px;
  overflow-y: auto;
  flex      : 1;
}

.modal-body textarea {
  width        : 100%;
  padding      : 12px 16px;
  border       : 2px solid var(--border);
  border-radius: 10px;
  font-size    : 15px;
  transition   : all 0.3s ease;
  background   : #f9fafb;
  color        : var(--text-primary);
  font-family  : inherit;
  resize       : vertical;
}

.modal-body textarea:focus {
  outline     : none;
  border-color: var(--primary);
  background  : white;
  box-shadow  : 0 0 0 4px rgba(99, 102, 241, 0.1);
}

.modal-footer {
  padding        : 20px 24px;
  border-top     : 1px solid var(--border);
  display        : flex;
  gap            : 12px;
  justify-content: flex-end;
}

.modal-footer button {
  width    : auto;
  min-width: 100px;
  padding  : 10px 20px;
}

.btn-secondary {
  background: rgb(255, 255, 255);
  color     : rgb(0, 0, 0);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.btn-nuoiacc {
  background: rgb(0, 192, 26);
  color     : rgb(255, 255, 255);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.btn-yellow {
  background: rgb(157, 168, 0);
  color     : rgb(255, 255, 255);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.btn-yellow:hover {
  background: #e5e7eb;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

/* Pause selected (khÃ¡c mÃ u Pause all) */
.btn-pause {
  background: rgb(14, 165, 164);
  color     : rgb(255, 255, 255);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.btn-pause:hover {
  background: #e5e7eb;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.btn-nuoiacc:hover {
  background: #e5e7eb;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.btn-secondary:hover {
  background: #e5e7eb;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.btn-secondary:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
}

/* Help Button */
.help-button {
  position       : fixed;
  top            : 24px;
  right          : 36px;
  width          : 48px;
  height         : 48px;
  border-radius  : 50%;
  background     : linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color          : white;
  border         : none;
  font-size      : 24px;
  font-weight    : 700;
  cursor         : pointer;
  box-shadow     : 0 4px 14px 0 rgba(99, 102, 241, 0.4);
  transition     : all 0.3s ease;
  z-index        : 999;
  display        : flex;
  align-items    : center;
  justify-content: center;
  line-height    : 1;
}

.help-button:hover {
  transform : scale(1.1);
  box-shadow: 0 6px 20px 0 rgba(99, 102, 241, 0.6);
}

.help-button:active {
  transform: scale(0.95);
}

/* Help Tooltip */
.help-tooltip {
  position      : fixed;
  top           : 90px;
  right         : 24px;
  width         : 500px;
  max-height    : 70vh;
  background    : var(--card-bg);
  border-radius : 12px;
  box-shadow    : var(--shadow-lg);
  z-index       : 1000;
  opacity       : 0;
  transform     : translateY(-10px);
  transition    : all 0.3s ease;
  pointer-events: none;
  border        : 1px solid var(--border);
}

.help-tooltip.show {
  opacity       : 1;
  transform     : translateY(0);
  pointer-events: all;
}

.tooltip-header {
  background     : linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding        : 16px 20px;
  border-radius  : 12px 12px 0 0;
  display        : flex;
  justify-content: space-between;
  align-items    : center;
}

.tooltip-header h4 {
  color      : white;
  font-size  : 16px;
  font-weight: 600;
  margin     : 0;
}

.tooltip-close {
  background     : rgba(255, 255, 255, 0.2);
  border         : none;
  color          : white;
  font-size      : 20px;
  width          : 28px;
  height         : 28px;
  border-radius  : 50%;
  cursor         : pointer;
  display        : flex;
  align-items    : center;
  justify-content: center;
  transition     : all 0.3s ease;
  padding        : 0;
  line-height    : 1;
}

.tooltip-close:hover {
  background: rgba(255, 255, 255, 0.3);
  transform : rotate(90deg);
}

.tooltip-body {
  padding: 20px;
  max-height: calc(70vh - 80px);
  overflow-y: auto;
}

.help-content {
  font-size: 13px;
  line-height: 1.5;
}

.help-content h3 {
  color: var(--primary);
  margin-top: 20px;
  margin-bottom: 10px;
  font-size: 16px;
}

.help-content h4 {
  color: var(--primary-dark);
  margin-top: 15px;
  margin-bottom: 8px;
  font-size: 14px;
}

.help-content ul, .help-content ol {
  margin-left: 20px;
  margin-bottom: 10px;
}

.help-content li {
  margin-bottom: 4px;
}

.help-content code {
  background: rgba(0,0,0,0.1);
  padding: 2px 4px;
  border-radius: 3px;
  font-family: monospace;
}

.tooltip-item {
  display      : flex;
  align-items  : flex-start;
  gap          : 12px;
  margin-bottom: 16px;
}

.tooltip-item:last-child {
  margin-bottom: 0;
}

.tooltip-dot {
  width        : 16px;
  height       : 16px;
  border-radius: 50%;
  display      : inline-block;
  flex-shrink  : 0;
  margin-top   : 2px;
  box-shadow   : 0 2px 4px rgba(0, 0, 0, 0.2);
}

.tooltip-green {
  background: #10b981;
}

.tooltip-yellow {
  background: #f59e0b;
}

.tooltip-red {
  background: #ef4444;
}

.tooltip-item div {
  flex       : 1;
  font-size  : 14px;
  line-height: 1.5;
  color      : var(--text-primary);
}

.tooltip-item strong {
  color      : var(--text-primary);
  font-weight: 600;
}

/* NÃºt xem comment (icon con máº¯t) */
.comment-eye-btn {
  background   : transparent;
  border       : none;
  cursor       : pointer;
  font-size    : 20px;
  line-height  : 1;
  padding      : 6px 8px;
  border-radius: 6px;
  transition   : background 0.2s ease, transform 0.1s ease;
}

.comment-eye-btn:hover {
  background: rgba(148, 163, 184, 0.15);
  transform : scale(1.05);
}

/* Text comment cÃ³ thá»ƒ click Ä‘á»ƒ áº©n */
.comment-text {
  cursor       : pointer;
  color        : var(--text-primary);
  padding      : 4px 8px;
  border-radius: 6px;
  transition   : background 0.2s ease;
  display      : inline-block;
  word-break   : break-word;
  max-width    : 100%;
}

.comment-text:hover {
  background: rgba(148, 163, 184, 0.1);
}

td:nth-child(5) {
  text-align: center;
}

/* Floating chat buttons (Messenger & Zalo) */
.chat-floating {
  position      : fixed;
  right         : 24px;
  bottom        : 24px;
  display       : flex;
  flex-direction: column;
  gap           : 10px;
  z-index       : 900;
}

.chat-btn {
  width          : 68px;
  height         : 68px;
  border-radius  : 50%;
  display        : flex;
  align-items    : center;
  justify-content: center;
  color          : #ffffff;
  font-weight    : 700;
  font-size      : 18px;
  text-decoration: none;
  box-shadow     : 0 6px 18px rgba(15, 23, 42, 0.45);
  transition     : transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
  opacity        : 0.95;
}

.chat-btn:hover {
  transform : translateY(-2px) scale(1.03);
  box-shadow: 0 10px 25px rgba(15, 23, 42, 0.55);
  opacity   : 1;
}

.chat-mess {
  background: linear-gradient(135deg, #f8f8f8 0%, #ffffff 100%);
}

.chat-zalo {
  background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%);
}

.chat-icon {
  width  : 50px;
  height : 50px;
  display: block;
}

/* Icon Messenger: vÃ²ng trÃ²n gradient + tia sÃ©t */
.chat-icon-mess {
  position     : relative;
  border-radius: 50%;
  background   : radial-gradient(circle at 30% 0, #ffffff 0, #ffffff 8%, transparent 20%),
    radial-gradient(circle at 30% 0, #ff7cf8 0, #ff7cf8 25%, transparent 55%),
    radial-gradient(circle at 70% 100%, #00c6ff 0, #0078ff 40%, #4b00ff 90%);
}

.chat-icon-mess::before {
  content      : '';
  position     : absolute;
  left         : 9px;
  top          : 11px;
  width        : 14px;
  height       : 8px;
  border-radius: 999px;
  border       : 2px solid #ffffff;
  border-top   : none;
  transform    : rotate(10deg);
}

.chat-icon-mess::after {
  content      : '';
  position     : absolute;
  left         : 13px;
  top          : 11px;
  width        : 6px;
  height       : 8px;
  border-right : 2px solid #ffffff;
  border-bottom: 2px solid #ffffff;
  transform    : rotate(25deg);
}

/* Icon Zalo: chá»¯ Z trong khung bo trÃ²n */
.chat-icon-zalo {
  position       : relative;
  border-radius  : 12px;
  background     : white;
  font-weight    : 700;
  font-size      : 13px;
  color          : #0066ff;
  display        : flex;
  align-items    : center;
  justify-content: center;
  font-family    : system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

.chat-icon-zalo::before {
  content: 'Z';
}

/* áº¢nh Zalo tháº­t */
.chat-img {
  width        : 50px;
  height       : 50px;
  display      : block;
  border-radius: 12px;
  object-fit   : cover;
}

/* Responsive */
@media (max-width: 1024px) {
  .layout {
    padding: 15px 28px; /* Giáº£m padding trÃªn/dÆ°á»›i, giá»¯ khoáº£ng 0.75cm hai bÃªn */
  }
}

@media (max-width: 768px) {
  .layout {
    padding: 10px 19px; /* Giáº£m padding trÃªn/dÆ°á»›i, giá»¯ khoáº£ng 0.5cm hai bÃªn */
  }
}

@media (max-width: 768px) {
  body {
    padding: 12px;
  }

  .header {
    padding: 20px;
  }

  .header-content h1 {
    font-size: 24px;
  }

  .panel-body {
    padding: 20px;
  }

  th,
  td {
    padding  : 12px;
    font-size: 13px;
  }

  .splash-title {
    font-size     : 32px;
    letter-spacing: 1px;
  }

  .splash-subtitle {
    font-size    : 16px;
    margin-bottom: 30px;
  }

  .splash-btn {
    padding  : 14px 36px;
    font-size: 16px;
  }
}


#scanRunMinutesInput {
  border-radius: 5px;
  border       : 1px solid var(--border);
  padding      : 4px;
}

#scanRestMinutesInput {
  border-radius: 5px;
  border       : 1px solid var(--border);
  padding      : 4px;
}

#feedRunMinutesInput {
  border-radius: 5px;
  border       : 1px solid var(--border);
  padding      : 4px;
}

#feedRestMinutesInput {
  border-radius: 5px;
  border       : 1px solid var(--border);
  padding      : 4px;
}

/* Date Range Buttons & Picker */
.date-range-container {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-left: auto;
  margin-right: 16px;
}

.date-range-buttons {
  display: flex;
  gap: 8px;
}

.date-btn {
  padding: 10px 16px;
  border: 1px solid var(--border);
  background: white;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
  color: var(--text-primary);
}

.date-btn:hover {
  background: #f8fafc;
  border-color: var(--primary);
  color: var(--primary);
}

.date-btn:active,
.date-btn.active {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

.file-selector-container {
  position: absolute;
  top: 60px;
  right: 16px;
  background: white;
  border-radius: 8px;
  box-shadow: var(--shadow-lg);
  border: 1px solid var(--border);
  min-width: 350px;
  max-width: 500px;
  max-height: 400px;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transform: translateY(-10px);
  transition: all 0.3s ease;
}

.file-selector-container:not(.hidden) {
  opacity: 1;
  visibility: visible;
  transform: translateY(0);
}

.file-selector-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  border-bottom: 1px solid var(--border);
  background: #f8fafc;
  border-radius: 8px 8px 0 0;
}

.file-selector-header span {
  font-weight: 600;
  color: var(--text-primary);
}

.file-selector-content {
  padding: 0;
}

.file-list {
  max-height: 300px;
  overflow-y: auto;
  padding: 8px 0;
}

.file-item {
  display: block;
  width: 100%;
  padding: 12px 20px;
  border: none;
  background: none;
  text-align: left;
  cursor: pointer;
  transition: all 0.2s ease;
  border-bottom: 1px solid #f0f0f0;
}

.file-item:hover {
  background: #f8fafc;
}

.file-item:last-child {
  border-bottom: none;
}

.file-item.selected {
  background: var(--primary);
  color: white;
}

.file-name {
  font-weight: 500;
  font-size: 14px;
  margin-bottom: 4px;
}

.file-info {
  font-size: 12px;
  color: #6b7280;
  opacity: 0.8;
}

.file-selector-actions {
  padding: 16px 20px;
  border-top: 1px solid var(--border);
  background: #f8fafc;
}

.file-selector-actions button {
  width: 100%;
  padding: 10px 16px;
  border: none;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

/* Responsive */
@media (max-width: 768px) {
  .date-range-container {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
    margin-left: 0;
    margin-right: 0;
  }

  .date-range-buttons {
    justify-content: center;
  }

  .date-btn {
    flex: 1;
    text-align: center;
  }
}

/* groupScanUrlInput Ä‘Ã£ dÃ¹ng chung style textarea á»Ÿ phÃ­a trÃªn */

/* ===== CLEANUP FILES ===== */
.cleanup-info {
  margin-top: 10px;
}

.cleanup-info .hint {
  margin: 0 0 10px 0;
  font-size: 14px;
  color: #666;
}

.cleanup-status {
  padding: 10px;
  border-radius: 6px;
  margin-top: 10px;
  font-size: 14px;
}

.cleanup-status.success {
  background-color: #d4edda;
  color: #155724;
  border: 1px solid #c3e6cb;
}

.cleanup-status.error {
  background-color: #f8d7da;
  color: #721c24;
  border: 1px solid #f5c6cb;
}

/* Export Button - Inline with time filter */
.export-btn-inline-time {
  padding: 12px 16px;
  font-size: 16px;
  font-weight: 500;
  border-radius: 6px;
  background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
  color: white;
  transition: all 0.2s ease;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  width: 200px; /* â‰ˆ7.5cm */
  justify-content: center;
  margin-left: 1190px; /* â‰ˆ30cm (tÄƒng 3cm) */
  box-shadow: 0 2px 6px rgba(16, 185, 129, 0.15);
  border: none;
}

.export-btn-inline-time:hover {
  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.25);
  transform: translateY(-1px);
}

.export-btn-inline-time:active {
  transform: translateY(0);
}
--- END FILE: frontend\style.css ---

