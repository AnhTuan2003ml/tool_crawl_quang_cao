=== PROJECT CONTEXT EXPORT ===

PROJECT STRUCTURE:
tool_crawl_quang_cao/
    readme.md
    backend/
        .gitignore
        main.py
        requirements.txt
        test.py
        app/
            api.py
            __init__.py
        config/
            cloneM.txt
            cookies.json
            groups.json
            payload.txt
            settings.json
        core/
            browser.py
            control.py
            join_groups.py
            nst.py
            runner.py
            scraper.py
            search_worker.py
            settings.py
            utils.py
        data/
            987870664956102_posts_2025-12-8_to_2025-12-14.json
            runtime_control.json
            post_ids/
                031ca13d-e8fa-400c-a603-df57a2806788.json
                621e1f5d-0c42-481e-9ddd-7abaafce68ed.json
            results/
                all_results_summary.json
        worker/
            check_cookies.py
            get_all_info.py
            get_id.py
            get_payload.py
            get_post_from_page.py
            single_get_comment.py
            single_get_reactions.py
    frontend/
        data.json
        index.html
        script.js
        style.css
        icon/
            Icon_of_Zalo.svg.webp
            logo-messenger-inkythuatso-2-01-30-15-47-51.jpg
            zalo-icon.png

==================================================

--- START FILE: backend\main.py ---
from core.runner import AppRunner

if __name__ == "__main__":
    AppRunner().run()

--- END FILE: backend\main.py ---

--- START FILE: backend\test.py ---
import time
from core.nst import connect_profile
from core.browser import FBController
from core.settings import get_settings


def test_check_resolution():
    profile_list = get_settings().profile_ids
    profile_id = profile_list[0].strip()
    
    if not profile_id:
        print("âŒ Lá»—i: KhÃ´ng tÃ¬m tháº¥y PROFILE_IDS")
        return

    print(f"ðŸ§ª Äang test Profile: {profile_id}")

    try:
        ws_url = connect_profile(profile_id)
        fb = FBController(ws_url)
        fb.profile_id = profile_id
        
        # Káº¿t ná»‘i
        fb.connect() 
        
        # --- [ÄOáº N KIá»‚M TRA QUAN TRá»ŒNG] ---
        # 1. Láº¥y thÃ´ng sá»‘ kÃ­ch thÆ°á»›c viewport thá»±c táº¿
        vp = fb.page.viewport_size
        print(f"\nðŸ“Š KÃCH THÆ¯á»šC MÃ€N HÃŒNH HIá»†N Táº I: {vp}")
        
        if vp and vp['width'] == 1920 and vp['height'] == 1080:
            print("âœ… OK! ÄÃ£ Full HD 1920x1080.")
        else:
            print("âš ï¸ Cáº¢NH BÃO: MÃ n hÃ¬nh chÆ°a Full HD! Bot cÃ³ thá»ƒ bá»‹ lá»—i giao diá»‡n mobile.")

        # 2. Má»Ÿ Facebook vÃ  chá»¥p áº£nh báº±ng chá»©ng
        print("ðŸš€ Äang vÃ o Facebook Ä‘á»ƒ chá»¥p áº£nh...")
        fb.goto("https://www.facebook.com")
        time.sleep(5)
        
        fb.page.screenshot(path="debug_resolution.png")
        print("ðŸ“¸ ÄÃ£ lÆ°u áº£nh: debug_resolution.png (Sáº¿p má»Ÿ lÃªn xem cÃ³ bá»‹ bÃ© khÃ´ng)\n")
        # -----------------------------------

        # (Pháº§n sau giá»¯ nguyÃªn logic share cÅ© Ä‘á»ƒ test tiáº¿p...)
        # ...

    except Exception as e:
        print(f"âŒ Lá»—i: {e}")
    finally:
        print("ðŸ›‘ ÄÃ³ng trÃ¬nh duyá»‡t...")
        try:
            if fb.browser: fb.browser.close()
            if fb.play: fb.play.stop()
        except: pass

if __name__ == "__main__":
    test_check_resolution()
--- END FILE: backend\test.py ---

--- START FILE: backend\app\api.py ---
from multiprocessing import Process
import time
from typing import Optional, Any, Dict
from pathlib import Path
import json
import os
import tempfile
import threading
import re
from urllib.parse import quote_plus
from concurrent.futures import ThreadPoolExecutor, as_completed

from fastapi import Body, FastAPI, HTTPException
from fastapi.middleware.cors import CORSMiddleware
from pydantic import BaseModel

from core.settings import SETTINGS_PATH
from core.nst import connect_profile, stop_profile, stop_all_browsers
from core.browser import FBController
from core import control as control_state
from core.scraper import SimpleBot
from core.settings import get_settings

app = FastAPI(title="NST Tool API", version="1.0.0")

# Cho phÃ©p frontend (file tÄ©nh) gá»i API qua localhost
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Bot processes (má»—i profile 1 process Ä‘á»™c láº­p RUN/REST)
_bot_lock = threading.Lock()
_bot_processes: Dict[str, Process] = {}
_settings_lock = threading.Lock()
_join_groups_lock = threading.Lock()
_join_groups_processes: Dict[str, Process] = {}
_feed_lock = threading.Lock()
_feed_processes: Dict[str, Process] = {}


def _hard_stop_everything(reason: str = "") -> dict:
    """
    STOP kiá»ƒu "fresh start":
    - Signal STOP ngay (set_global_emergency_stop=True) Ä‘á»ƒ cÃ¡c loop thoÃ¡t náº¿u cÃ²n sá»‘ng
    - ÄÃ³ng toÃ n bá»™ NST browser
    - Terminate runner/join/feed processes (Ä‘Ã³ng háº³n, khÃ´ng giá»¯ sleep)
    - Reset runtime_control.json vá» máº·c Ä‘á»‹nh (Sáº´N SÃ€NG)
    """
    global _bot_processes

    print("=" * 60)
    print(f"ðŸ›‘ [HARD_STOP] {reason}".strip())
    print("=" * 60)

    # 1) Signal STOP
    try:
        control_state.set_global_emergency_stop(True)
    except Exception:
        pass

    # 2) Close all NST browsers
    nst_ok = False
    nst_err = None
    try:
        nst_ok = bool(stop_all_browsers())
    except Exception as e:
        nst_err = str(e)
        print(f"âš ï¸ stop_all_browsers lá»—i: {e}")

    # 3) Kill bot processes
    bot_killed: list[str] = []
    try:
        with _bot_lock:
            for pid, proc in list(_bot_processes.items()):
                try:
                    if proc and proc.is_alive():
                        proc.terminate()
                        proc.join(timeout=3)
                        bot_killed.append(pid)
                except Exception:
                    pass
                _bot_processes.pop(pid, None)
    except Exception:
        pass

    # 4) Kill join groups processes
    join_killed: list[str] = []
    try:
        with _join_groups_lock:
            _prune_join_group_processes()
            for pid, proc in list(_join_groups_processes.items()):
                try:
                    if proc and proc.is_alive():
                        proc.terminate()
                        proc.join(timeout=3)
                        join_killed.append(pid)
                except Exception:
                    pass
                _join_groups_processes.pop(pid, None)
    except Exception:
        pass

    # 5) Kill feed processes
    feed_killed: list[str] = []
    try:
        with _feed_lock:
            _prune_feed_processes()
            for pid, proc in list(_feed_processes.items()):
                try:
                    if proc and proc.is_alive():
                        proc.terminate()
                        proc.join(timeout=3)
                        feed_killed.append(pid)
                except Exception:
                    pass
                _feed_processes.pop(pid, None)
    except Exception:
        pass

    # 6) Reset runtime state vá» máº·c Ä‘á»‹nh (Ä‘á»ƒ láº§n sau báº¥m cháº¡y lÃ  "má»›i hoÃ n toÃ n")
    try:
        control_state.reset_all_state()
    except Exception:
        # fallback: Ã­t nháº¥t clear emergency stop Ä‘á»ƒ UI khÃ´ng bá»‹ káº¹t
        try:
            control_state.reset_emergency_stop(clear_stopped_profiles=True)
        except Exception:
            pass

    return {
        "status": "ok",
        "nst_stop_all_ok": nst_ok,
        "nst_error": nst_err,
        "bot_killed": bot_killed,
        "join_killed": join_killed,
        "feed_killed": feed_killed,
    }


def _prune_bot_processes() -> None:
    dead = []
    for pid, proc in list(_bot_processes.items()):
        try:
            if not proc.is_alive():
                dead.append(pid)
        except Exception:
            dead.append(pid)
    for pid in dead:
        _bot_processes.pop(pid, None)


def _run_bot_profile_loop(
    profile_id: str,
    run_minutes: int,
    rest_minutes: int,
    text: str,
    mode: str,
) -> None:
    """
    Worker Ä‘á»™c láº­p cho 1 profile:
    - cháº¡y RUN_MINUTES (active time, pause freeze)
    - ngá»§ REST_MINUTES (pause freeze)
    - láº·p láº¡i cho tá»›i khi STOP (global hoáº·c stop theo profile)
    """
    pid = str(profile_id or "").strip()
    if not pid:
        return

    cfg = get_settings()
    target_url = cfg.target_url
    m = str(mode or "feed").strip().lower()
    if m not in ("feed", "search"):
        m = "feed"
    t = str(text or "").strip()
    if m == "search" and t:
        q = quote_plus(t)
        target_url = f"https://www.facebook.com/search/posts/?q={q}"

    run_m = int(run_minutes or 0)
    rest_m = int(rest_minutes or 0)
    if run_m <= 0:
        run_m = int(getattr(cfg, "run_minutes", 30) or 30)
    if rest_m <= 0:
        rest_m = int(getattr(cfg, "rest_minutes", 120) or 120)

    duration_seconds = max(1, run_m * 60)
    rest_seconds = max(1, rest_m * 60)

    while True:
        # STOP/PAUSE trÆ°á»›c khi báº¯t Ä‘áº§u phiÃªn
        stop, paused, reason = control_state.check_flags(pid)
        if stop:
            print(f"ðŸ›‘ [{pid}] STOP trÆ°á»›c khi start loop ({reason})")
            try:
                control_state.set_profile_state(pid, "STOPPED")
            except Exception:
                pass
            return
        if paused:
            print(f"â¸ï¸ [{pid}] PAUSED trÆ°á»›c khi start loop ({reason})")
            control_state.wait_if_paused(pid, sleep_seconds=0.5)

        fb: Optional[FBController] = None
        try:
            control_state.set_profile_state(pid, "RUNNING")
        except Exception:
            pass

        try:
            ws = connect_profile(pid)
            fb = FBController(ws)
            fb.profile_id = pid
            # tuyá»‡t Ä‘á»‘i Ä‘á»™c láº­p: chá»‰ xá»­ lÃ½ trong profile nÃ y
            try:
                fb.all_profile_ids = [pid]
            except Exception:
                pass
            # filter text náº¿u cÃ³
            try:
                if t:
                    parts = []
                    for chunk in t.replace("\n", ",").split(","):
                        s = " ".join(str(chunk).strip().split())
                        if s:
                            parts.append(s)
                    seen = set()
                    user_keywords = []
                    for x in parts:
                        k = x.lower()
                        if k in seen:
                            continue
                        seen.add(k)
                        user_keywords.append(x)
                    fb.user_keywords = user_keywords
            except Exception:
                pass
            fb.connect()
            bot = SimpleBot(fb)
            bot.run(target_url, duration=duration_seconds)
        except RuntimeError as e:
            # STOP/BROWSER_CLOSED => thoÃ¡t phiÃªn
            if "EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e):
                print(f"ðŸ›‘ [{pid}] Dá»«ng bot ({e})")
            else:
                raise
        except Exception as e:
            print(f"âŒ Lá»—i á»Ÿ profile {pid}: {e}")
            try:
                control_state.set_profile_state(pid, "ERROR")
            except Exception:
                pass
        finally:
            # Ä‘Ã³ng playwright + NST profile best-effort
            try:
                if fb and getattr(fb, "page", None):
                    try:
                        fb.page.close()
                    except Exception:
                        pass
            except Exception:
                pass
            try:
                if fb and getattr(fb, "browser", None) and getattr(fb.browser, "contexts", None):
                    for ctx in list(fb.browser.contexts):
                        try:
                            ctx.close()
                        except Exception:
                            pass
            except Exception:
                pass
            try:
                if fb and getattr(fb, "browser", None):
                    try:
                        fb.browser.close()
                    except Exception:
                        pass
            except Exception:
                pass
            try:
                if fb and getattr(fb, "play", None):
                    try:
                        fb.play.stop()
                    except Exception:
                        pass
            except Exception:
                pass
            try:
                stop_profile(pid)
            except Exception:
                pass

        # Check stop sau khi káº¿t thÃºc phiÃªn
        stop, paused, reason = control_state.check_flags(pid)
        if stop:
            print(f"ðŸ›‘ [{pid}] STOP sau phiÃªn ({reason}) -> thoÃ¡t loop")
            try:
                control_state.set_profile_state(pid, "STOPPED")
            except Exception:
                pass
            return

        # REST (Ä‘á»™c láº­p theo profile) - pause freeze
        slept = 0
        while slept < rest_seconds:
            stop, paused, reason = control_state.check_flags(pid)
            if stop:
                print(f"ðŸ›‘ [{pid}] STOP trong REST ({reason}) -> thoÃ¡t")
                try:
                    control_state.set_profile_state(pid, "STOPPED")
                except Exception:
                    pass
                return
            if paused:
                control_state.wait_if_paused(pid, sleep_seconds=0.5)
                continue
            time.sleep(1)
            slept += 1


def _run_join_groups_worker(profile_id: str, groups: list[str]) -> None:
    """Worker cháº¡y join groups cho 1 profile (Ä‘á»ƒ cháº¡y song song nhiá»u profile)."""
    try:
        from core.join_groups import run_batch_join_from_list
        run_batch_join_from_list(profile_id, groups)
    except Exception as exc:
        print(f"âŒ Join groups worker lá»—i ({profile_id}): {exc}")


def _run_feed_worker(
    profile_id: str,
    mode: str,
    text: str,
    run_minutes: int,
    rest_minutes: int,
    all_profile_ids: Optional[list[str]] = None,
) -> None:
    """
    Worker cháº¡y nuÃ´i acc (feed/search & like) cho 1 profile theo vÃ²ng láº·p:
    cháº¡y run_minutes -> táº¯t -> nghá»‰ rest_minutes -> láº·p láº¡i.
    Náº¿u rest_minutes <= 0 thÃ¬ chá»‰ cháº¡y 1 láº§n.
    """
    try:
        from core.search_worker import feed_and_like, search_and_like
        m = str(mode or "feed").strip().lower()
        run_m = int(run_minutes or 0)
        rest_m = int(rest_minutes or 0)
        if run_m <= 0:
            run_m = 30

        while True:
            # STOP/PAUSE checkpoint
            stop, paused, reason = control_state.check_flags(profile_id)
            if stop:
                print(f"ðŸ›‘ [FEED] {profile_id} EMERGENCY_STOP ({reason}) -> dá»«ng worker")
                break
            if paused:
                print(f"â¸ï¸ [FEED] {profile_id} PAUSED ({reason}) -> sleep")
                control_state.wait_if_paused(profile_id, sleep_seconds=0.5)

            if m == "search":
                search_and_like(profile_id, text or "", duration_minutes=run_m, all_profile_ids=all_profile_ids)
            else:
                feed_and_like(profile_id, text or "", duration_minutes=run_m, all_profile_ids=all_profile_ids)

            if rest_m <= 0:
                break

            # nghá»‰ rá»“i cháº¡y láº¡i (process cÃ³ thá»ƒ bá»‹ terminate bá»Ÿi stop-all)
            import time as _t
            # sleep theo chunk Ä‘á»ƒ váº«n dá»«ng Ä‘Æ°á»£c ngay
            slept = 0
            while slept < rest_m * 60:
                stop, paused, reason = control_state.check_flags(profile_id)
                if stop:
                    print(f"ðŸ›‘ [FEED] {profile_id} EMERGENCY_STOP trong sleep ({reason}) -> dá»«ng")
                    return
                if paused:
                    _t.sleep(1)
                    continue
                _t.sleep(1)
                slept += 1
    except Exception as exc:
        print(f"âŒ Feed worker lá»—i ({profile_id}): {exc}")


def _close_fb_controller_best_effort(fb: Optional[FBController], profile_id: str) -> None:
    """
    ÄÃ³ng sáº¡ch tab/context playwright + yÃªu cáº§u NST stop (giá»‘ng logic trong cookie fetch).
    """
    try:
        if fb and getattr(fb, "page", None):
            try:
                fb.page.close()
            except Exception:
                pass
    except Exception:
        pass
    try:
        if fb and getattr(fb, "browser", None) and getattr(fb.browser, "contexts", None):
            for ctx in list(fb.browser.contexts):
                try:
                    ctx.close()
                except Exception:
                    pass
    except Exception:
        pass
    try:
        if fb and getattr(fb, "browser", None):
            try:
                fb.browser.close()
            except Exception:
                pass
    except Exception:
        pass
    try:
        if fb and getattr(fb, "play", None):
            try:
                fb.play.stop()
            except Exception:
                pass
    except Exception:
        pass

    # Best-effort: yÃªu cáº§u NST stop/close browser instance cá»§a profile
    try:
        stop_profile(profile_id)
    except Exception:
        pass


def _force_close_nst_tabs_for_profile(profile_id: str) -> dict:
    """
    Force Ä‘Ã³ng tab NST theo Ä‘Ãºng kiá»ƒu cookie:
    connect -> attach CDP -> close page/context/browser/play -> stop_profile
    """
    pid = _norm_profile_id(profile_id)
    if not pid:
        return {"profile_id": profile_id, "ok": False, "reason": "empty_profile_id"}

    fb: Optional[FBController] = None
    connected = False
    try:
        ws = connect_profile(pid)
        fb = FBController(ws)
        fb.profile_id = pid
        fb.connect()
        connected = True
        return {"profile_id": pid, "ok": True, "connected": True}
    except Exception as exc:
        # Náº¿u connect fail váº«n cá»‘ stop_profile á»Ÿ finally
        return {"profile_id": pid, "ok": False, "connected": connected, "reason": str(exc)}
    finally:
        _close_fb_controller_best_effort(fb, pid)


def _norm_profile_id(value: str) -> str:
    """Chuáº©n hoÃ¡ profile_id: bá» toÃ n bá»™ whitespace (trÃ¡nh lá»—i dÃ­nh space khi copy/paste)."""
    return re.sub(r"\s+", "", str(value or "")).strip()


class RunRequest(BaseModel):
    run_minutes: Optional[int] = None
    rest_minutes: Optional[int] = None
    profile_ids: Optional[list[str]] = None
    # text filter cho scan bÃ i viáº¿t (dÃ¹ng trong core/browser.py)
    text: Optional[str] = None
    # mode cho scan bÃ i viáº¿t: "feed" | "search"
    mode: Optional[str] = None


## NOTE: AppRunner mode Ä‘Ã£ Ä‘Æ°á»£c thay báº±ng bot per-profile Ä‘á»™c láº­p (xem _run_bot_profile_loop)


@app.get("/health")
def health_check() -> dict:
    return {"status": "ok"}


@app.post("/run")
def run_bot(payload: Optional[RunRequest] = Body(None)) -> dict:
    """
    Start bot per-profile Ä‘á»™c láº­p (má»—i profile 1 process loop RUN/REST).
    """
    # start per-profile bot processes (Ä‘á»™c láº­p)

    run_minutes = payload.run_minutes if payload else None
    rest_minutes = payload.rest_minutes if payload else None
    profile_ids = payload.profile_ids if payload else None
    text = payload.text if payload else None
    mode = payload.mode if payload else None

    # Validate profile_ids (báº¯t buá»™c chá»n profile nhÆ° UI)
    if not profile_ids:
        raise HTTPException(status_code=400, detail="profile_ids rá»—ng")
    pids = [_norm_profile_id(x) for x in (profile_ids or [])]
    pids = [p for p in pids if p]
    if not pids:
        raise HTTPException(status_code=400, detail="profile_ids khÃ´ng há»£p lá»‡")

    # Náº¿u user báº¥m CHáº Y mÃ  trÆ°á»›c Ä‘Ã³ Ä‘Ã£ STOP, auto reset STOP Ä‘á»ƒ job cháº¡y Ä‘Æ°á»£c.
    # Chá»‰ resume/clear STOPPED cho Ä‘Ãºng cÃ¡c profile Ä‘Æ°á»£c yÃªu cáº§u cháº¡y.
    try:
        stop, _paused, reason = control_state.check_flags(None)
        if stop:
            print(f"ðŸŸ¡ [/run] GLOBAL_EMERGENCY_STOP Ä‘ang báº­t ({reason}) -> auto reset Ä‘á»ƒ cháº¡y")
            control_state.reset_emergency_stop(clear_stopped_profiles=False)
        # Náº¿u profile Ä‘ang bá»‹ stop riÃªng láº» thÃ¬ clear Ä‘á»ƒ cháº¡y Ä‘Æ°á»£c
        control_state.resume_profiles(pids)
    except Exception as _e:
        pass

    # Dá»n state cÅ© trong runtime_control: chá»‰ giá»¯ profile_states cá»§a Ä‘Ãºng pids Ä‘ang cháº¡y
    try:
        def _keep_only_selected(st: dict) -> None:
            ps = st.get("profile_states")
            if not isinstance(ps, dict):
                ps = {}
            keep = {pid: ps.get(pid) or "RUNNING" for pid in pids}
            st["profile_states"] = keep
            # remove paused/stopped ngoÃ i danh sÃ¡ch Ä‘Æ°á»£c cháº¡y (trÃ¡nh hiá»‡n profile láº¡)
            st["paused_profiles"] = [x for x in (st.get("paused_profiles") or []) if str(x) in set(pids)]
            st["stopped_profiles"] = [x for x in (st.get("stopped_profiles") or []) if str(x) in set(pids)]
        control_state._update(_keep_only_selected)  # type: ignore[attr-defined]
    except Exception:
        pass

    # âœ… Cháº·n cháº¡y náº¿u báº¥t ká»³ profile nÃ o thiáº¿u cookie/access_token
    _validate_profiles_requirements(pids, require_cookie=True, require_access_token=True)

    m = str(mode or "feed").strip().lower()
    if m not in ("feed", "search"):
        m = "feed"
    # Search báº¯t buá»™c cÃ³ text Ä‘á»ƒ search
    if m == "search" and not str(text or "").strip():
        raise HTTPException(status_code=400, detail="Search cáº§n text")

    started: list[str] = []
    skipped: list[dict] = []
    run_m = int(run_minutes or 0) if payload else 0
    rest_m = int(rest_minutes or 0) if payload else 0
    txt = str(text or "")
    md = str(m or "feed")

    with _bot_lock:
        _prune_bot_processes()
        for pid in pids:
            existing = _bot_processes.get(pid)
            if existing and existing.is_alive():
                skipped.append({"profile_id": pid, "reason": "already_running"})
                continue
            proc = Process(
                target=_run_bot_profile_loop,
                args=(pid, run_m, rest_m, txt, md),
                daemon=True,
            )
            proc.start()
            _bot_processes[pid] = proc
            started.append(pid)

    return {"status": "ok", "started": started, "skipped": skipped, "running": list(_bot_processes.keys())}


@app.post("/stop")
def stop_bot() -> dict:
    """
    STOP (fresh start):
    - ÄÃ³ng háº³n má»i thá»© (NST + kill runner/jobs)
    - Reset runtime_control.json vá» máº·c Ä‘á»‹nh
    - Láº§n sau báº¥m cháº¡y sáº½ tÃ­nh láº¡i RUN/REST tá»« Ä‘áº§u (PAUSE má»›i lÃ  cÃ¡i giá»¯ timer)
    """
    return _hard_stop_everything(reason="/stop")


@app.get("/status")
def status() -> dict:
    with _bot_lock:
        _prune_bot_processes()
        running = [pid for pid, proc in _bot_processes.items() if proc and proc.is_alive()]
    return {"running": len(running) > 0, "bot_profile_ids": running}


@app.get("/settings")
def get_settings_json() -> dict:
    """
    Tráº£ ná»™i dung file backend/config/settings.json Ä‘á»ƒ frontend hiá»ƒn thá»‹.
    """
    path: Path = SETTINGS_PATH
    if not path.exists():
        raise HTTPException(status_code=404, detail=f"KhÃ´ng tÃ¬m tháº¥y settings.json: {path}")

    try:
        with path.open(encoding="utf-8") as f:
            raw = json.load(f)
    except json.JSONDecodeError as exc:
        raise HTTPException(status_code=400, detail=f"settings.json khÃ´ng há»£p lá»‡: {exc}") from exc
    except Exception as exc:
        raise HTTPException(status_code=500, detail=f"KhÃ´ng Ä‘á»c Ä‘Æ°á»£c settings.json: {exc}") from exc

    return raw


def _read_settings_raw() -> Dict[str, Any]:
    path: Path = SETTINGS_PATH
    if not path.exists():
        raise HTTPException(status_code=404, detail=f"KhÃ´ng tÃ¬m tháº¥y settings.json: {path}")
    try:
        with path.open(encoding="utf-8") as f:
            raw = json.load(f)
    except json.JSONDecodeError as exc:
        raise HTTPException(status_code=400, detail=f"settings.json khÃ´ng há»£p lá»‡: {exc}") from exc
    except Exception as exc:
        raise HTTPException(status_code=500, detail=f"KhÃ´ng Ä‘á»c Ä‘Æ°á»£c settings.json: {exc}") from exc

    if not isinstance(raw, dict):
        raise HTTPException(status_code=400, detail="settings.json pháº£i lÃ  object")
    return raw


def _validate_profiles_requirements(
    profile_ids: list[str],
    *,
    require_cookie: bool = True,
    require_access_token: bool = True,
) -> None:
    """
    Náº¿u cÃ³ profile thiáº¿u cookie/access_token (theo require_*), sáº½ raise 400 vÃ  KHÃ”NG cho start job.
    """
    raw = _read_settings_raw()
    profiles = raw.get("PROFILE_IDS") or {}
    if not isinstance(profiles, dict):
        profiles = {}

    missing_list: list[dict] = []
    for pid in profile_ids:
        cfg = profiles.get(pid)
        missing: list[str] = []
        if not isinstance(cfg, dict):
            # profile chÆ°a tá»“n táº¡i trong settings.json
            if require_cookie:
                missing.append("cookie")
            if require_access_token:
                missing.append("access_token")
        else:
            if require_cookie and not str(cfg.get("cookie") or "").strip():
                missing.append("cookie")
            if require_access_token and not str(cfg.get("access_token") or cfg.get("accessToken") or "").strip():
                missing.append("access_token")

        if missing:
            missing_list.append({"profile_id": pid, "missing": missing})

    if missing_list:
        raise HTTPException(
            status_code=400,
            detail={
                "message": "Thiáº¿u cáº¥u hÃ¬nh profile (cookie/access_token). HÃ£y cáº­p nháº­t trÆ°á»›c khi cháº¡y.",
                "missing": missing_list,
            },
        )


def _atomic_write_json(path: Path, data: Dict[str, Any]) -> None:
    """
    Ghi JSON an toÃ n: write temp file cÃ¹ng thÆ° má»¥c rá»“i replace.
    """
    directory = str(path.parent)
    os.makedirs(directory, exist_ok=True)

    fd, tmp_path = tempfile.mkstemp(prefix="settings_", suffix=".json", dir=directory)
    try:
        with os.fdopen(fd, "w", encoding="utf-8") as f:
            json.dump(data, f, ensure_ascii=False, indent=2)
            f.write("\n")
        os.replace(tmp_path, str(path))
    except Exception:
        try:
            os.remove(tmp_path)
        except Exception:
            pass
        raise


def _merge_group_ids(existing: Any, new_items: list[str]) -> list[str]:
    """Merge + de-dupe group ids, giá»¯ thá»© tá»± (existing trÆ°á»›c)."""
    base: list[str] = []
    if isinstance(existing, list):
        base = [str(x).strip() for x in existing if str(x).strip()]
    elif isinstance(existing, str):
        base = [s.strip() for s in existing.split(",") if s.strip()]

    seen: set[str] = set()
    merged: list[str] = []
    for gid in base + new_items:
        gid2 = str(gid or "").strip()
        if not gid2 or gid2 in seen:
            continue
        seen.add(gid2)
        merged.append(gid2)
    return merged


def _write_settings_raw(raw: Dict[str, Any]) -> None:
    try:
        _atomic_write_json(SETTINGS_PATH, raw)
    except Exception as exc:
        raise HTTPException(status_code=500, detail=f"KhÃ´ng ghi Ä‘Æ°á»£c settings.json: {exc}") from exc


class ApiKeyPayload(BaseModel):
    api_key: str


class ProfileCreatePayload(BaseModel):
    profile_id: str


class ProfileUpdatePayload(BaseModel):
    cookie: Optional[str] = None
    access_token: Optional[str] = None


class ProfileGroupsPayload(BaseModel):
    # CÃ³ thá»ƒ truyá»n 1 group hoáº·c nhiá»u group (append).
    group_id: Optional[str] = None
    group_ids: Optional[list[str]] = None


class ProfileGroupsReplacePayload(BaseModel):
    # Replace hoÃ n toÃ n groups cá»§a profile. Cho phÃ©p rá»—ng Ä‘á»ƒ xoÃ¡ háº¿t.
    groups: Optional[list[str]] = None


class JoinGroupsRequest(BaseModel):
    profile_ids: list[str]


class JoinGroupsStopRequest(BaseModel):
    # náº¿u khÃ´ng truyá»n -> stop táº¥t cáº£
    profile_ids: Optional[list[str]] = None


class FeedStartRequest(BaseModel):
    profile_ids: list[str]
    mode: str = "feed"  # "feed" | "search"
    text: str = ""      # input text (Ä‘á»‹a Ä‘iá»ƒm, hoáº·c query search)
    # backward-compat: giá»¯ field cÅ© náº¿u frontend cÅ© cÃ²n gá»i
    filter_text: str = ""
    run_minutes: int = 30
    rest_minutes: int = 0


class FeedStopRequest(BaseModel):
    profile_ids: Optional[list[str]] = None


@app.put("/settings/api-key")
def update_api_key(payload: ApiKeyPayload) -> dict:
    with _settings_lock:
        raw = _read_settings_raw()
        raw["API_KEY"] = str(payload.api_key or "").strip()
        _write_settings_raw(raw)
        return {"status": "ok"}


@app.post("/settings/profiles")
def add_profile(payload: ProfileCreatePayload) -> dict:
    pid = _norm_profile_id(payload.profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS")
        if profiles is None or isinstance(profiles, list) or isinstance(profiles, str):
            # Náº¿u Ä‘ang format cÅ©, convert sang dict
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        # Táº¡o profile má»›i: luÃ´n cÃ³ cookie/access_token/groups (groups trá»‘ng)
        cur = profiles.get(pid)
        if cur is None or not isinstance(cur, dict):
            cur = {}
            profiles[pid] = cur
        cur.setdefault("cookie", "")
        cur.setdefault("access_token", "")
        cur.setdefault("groups", [])
        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)
        return {"status": "ok"}


@app.put("/settings/profiles/{profile_id}")
def update_profile(profile_id: str, payload: ProfileUpdatePayload) -> dict:
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if isinstance(profiles, list) or isinstance(profiles, str):
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        cur = profiles.get(pid)
        if cur is None:
            profiles[pid] = {}
            cur = profiles[pid]
        if not isinstance(cur, dict):
            cur = {}
            profiles[pid] = cur

        if payload.cookie is not None:
            cur["cookie"] = str(payload.cookie)
        if payload.access_token is not None:
            cur["access_token"] = str(payload.access_token)

        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)
        return {"status": "ok"}


@app.post("/settings/profiles/{profile_id}/groups")
def add_or_sync_profile_groups(profile_id: str, payload: ProfileGroupsPayload) -> dict:
    """
    Cáº­p nháº­t groups cho 1 profile:
    - hoáº·c truyá»n group_id / group_ids Ä‘á»ƒ append vÃ o PROFILE_IDS[pid].groups
    """
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    new_groups: list[str] = []
    if payload.group_ids:
        new_groups.extend([str(x or "").strip() for x in payload.group_ids])
    if payload.group_id:
        new_groups.append(str(payload.group_id or "").strip())
    new_groups = [g for g in new_groups if g]

    if not new_groups:
        raise HTTPException(status_code=400, detail="Thiáº¿u group_id/group_ids")

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if isinstance(profiles, list) or isinstance(profiles, str):
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        cur = profiles.get(pid)
        if cur is None or not isinstance(cur, dict):
            cur = {}
            profiles[pid] = cur

        merged = _merge_group_ids(cur.get("groups"), new_groups)

        cur["groups"] = merged
        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)

        return {"status": "ok", "profile_id": pid, "groups": merged}


@app.put("/settings/profiles/{profile_id}/groups")
def replace_profile_groups(profile_id: str, payload: ProfileGroupsReplacePayload) -> dict:
    """
    Ghi Ä‘Ã¨ toÃ n bá»™ groups cá»§a 1 profile (Ä‘Ãºng yÃªu cáº§u: trong textarea cÃ³ gÃ¬ thÃ¬ Ä‘Ã¨ lÃªn cÃ¡i cÅ©).
    """
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    raw_groups = payload.groups if payload and payload.groups is not None else []
    if not isinstance(raw_groups, list):
        raise HTTPException(status_code=400, detail="groups pháº£i lÃ  list")

    cleaned: list[str] = []
    seen: set[str] = set()
    for item in raw_groups:
        s = str(item or "").strip()
        if not s:
            continue
        # de-dupe Ä‘á»ƒ trÃ¡nh spam
        if s in seen:
            continue
        seen.add(s)
        cleaned.append(s)

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if isinstance(profiles, list) or isinstance(profiles, str):
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        cur = profiles.get(pid)
        if cur is None or not isinstance(cur, dict):
            cur = {}
            profiles[pid] = cur

        cur["groups"] = cleaned
        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)
        return {"status": "ok", "profile_id": pid, "groups": cleaned}


def _prune_join_group_processes() -> None:
    """Dá»n cÃ¡c process Ä‘Ã£ cháº¡y xong khá»i map."""
    dead = []
    for pid, proc in list(_join_groups_processes.items()):
        try:
            if not proc.is_alive():
                dead.append(pid)
        except Exception:
            dead.append(pid)
    for pid in dead:
        _join_groups_processes.pop(pid, None)


def _prune_feed_processes() -> None:
    dead = []
    for pid, proc in list(_feed_processes.items()):
        try:
            if not proc.is_alive():
                dead.append(pid)
        except Exception:
            dead.append(pid)
    for pid in dead:
        _feed_processes.pop(pid, None)


@app.post("/groups/join")
def auto_join_groups(payload: JoinGroupsRequest) -> dict:
    """
    Cháº¡y auto join group cho cÃ¡c profile Ä‘Ã£ chá»n (má»—i profile 1 process â†’ cháº¡y song song).
    Groups láº¥y tá»« settings.json: PROFILE_IDS[pid].groups
    """
    # Náº¿u user báº¥m join mÃ  trÆ°á»›c Ä‘Ã³ Ä‘Ã£ STOP, auto reset STOP Ä‘á»ƒ job cháº¡y Ä‘Æ°á»£c.
    try:
        stop, _paused, reason = control_state.check_flags(None)
        if stop:
            print(f"ðŸŸ¡ [/groups/join] GLOBAL_EMERGENCY_STOP Ä‘ang báº­t ({reason}) -> auto reset Ä‘á»ƒ join")
            control_state.reset_emergency_stop(clear_stopped_profiles=False)
    except Exception:
        pass

    if not payload.profile_ids:
        raise HTTPException(status_code=400, detail="profile_ids rá»—ng")

    pids = [_norm_profile_id(x) for x in payload.profile_ids]
    pids = [p for p in pids if p]
    if not pids:
        raise HTTPException(status_code=400, detail="profile_ids khÃ´ng há»£p lá»‡")

    # Clear STOPPED cho Ä‘Ãºng cÃ¡c profile Ä‘Æ°á»£c yÃªu cáº§u join
    try:
        control_state.resume_profiles(pids)
    except Exception:
        pass

    # âœ… Join group chá»‰ cáº§n cookie (khÃ´ng báº¯t access_token)
    _validate_profiles_requirements(pids, require_cookie=True, require_access_token=False)

    started: list[str] = []
    skipped: list[dict] = []

    with _join_groups_lock:
        _prune_join_group_processes()

        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if not isinstance(profiles, dict):
            profiles = {}

        for pid in pids:
            # skip náº¿u Ä‘ang cháº¡y
            existing = _join_groups_processes.get(pid)
            if existing and existing.is_alive():
                skipped.append({"profile_id": pid, "reason": "already_running"})
                continue

            cfg = profiles.get(pid)
            if not isinstance(cfg, dict):
                skipped.append({"profile_id": pid, "reason": "profile_not_found"})
                continue

            groups = cfg.get("groups")
            if not isinstance(groups, list):
                groups = []
            groups = [str(g or "").strip() for g in groups if str(g or "").strip()]

            if len(groups) == 0:
                skipped.append({"profile_id": pid, "reason": "no_groups"})
                continue

            proc = Process(
                target=_run_join_groups_worker,
                args=(pid, groups),
                daemon=True,
            )
            proc.start()
            _join_groups_processes[pid] = proc
            started.append(pid)

    return {
        "status": "ok",
        "started": started,
        "skipped": skipped,
        "running": list(_join_groups_processes.keys()),
    }


@app.post("/groups/join/stop")
def stop_auto_join_groups(payload: Optional[JoinGroupsStopRequest] = Body(None)) -> dict:
    """
    Dá»«ng auto join group:
    - KhÃ´ng truyá»n payload -> dá»«ng táº¥t cáº£
    - CÃ³ profile_ids -> dá»«ng theo danh sÃ¡ch
    """
    target: Optional[list[str]] = None
    if payload and payload.profile_ids is not None:
        target = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
        target = [p for p in target if p]

    stopped: list[str] = []
    not_running: list[str] = []

    with _join_groups_lock:
        _prune_join_group_processes()
        keys = list(_join_groups_processes.keys())
        to_stop = keys if target is None else [p for p in target if p in _join_groups_processes]

        # terminate processes
        for pid in to_stop:
            proc = _join_groups_processes.get(pid)
            if not proc:
                continue
            try:
                if proc.is_alive():
                    proc.terminate()
                    proc.join(timeout=5)
            except Exception:
                pass
            _join_groups_processes.pop(pid, None)
            stopped.append(pid)

        if target is not None:
            for pid in target:
                if pid not in stopped:
                    not_running.append(pid)

    # Best-effort: yÃªu cáº§u NST stop/close browser instance cá»§a profile (giá»‘ng luá»“ng láº¥y cookie)
    for pid in stopped:
        try:
            stop_profile(pid)
        except Exception:
            pass

    return {"status": "ok", "stopped": stopped, "not_running": not_running}


@app.get("/groups/join/status")
def join_groups_status() -> dict:
    """Tráº¡ng thÃ¡i join-groups Ä‘ang cháº¡y."""
    with _join_groups_lock:
        _prune_join_group_processes()
        running = []
        for pid, proc in _join_groups_processes.items():
            try:
                if proc.is_alive():
                    running.append(pid)
            except Exception:
                pass
    return {"running": running}


@app.get("/feed/status")
def feed_status() -> dict:
    """Tráº¡ng thÃ¡i nuÃ´i acc (feed) Ä‘ang cháº¡y."""
    with _feed_lock:
        _prune_feed_processes()
        running: list[str] = []
        for pid, proc in _feed_processes.items():
            try:
                if proc.is_alive():
                    running.append(pid)
            except Exception:
                pass
    return {"running": running}


@app.post("/feed/start")
def feed_start(payload: FeedStartRequest) -> dict:
    """Cháº¡y nuÃ´i acc (feed & like) cho cÃ¡c profile Ä‘Ã£ chá»n (má»—i profile 1 process)."""
    if not payload.profile_ids:
        raise HTTPException(status_code=400, detail="profile_ids rá»—ng")

    pids = [_norm_profile_id(x) for x in payload.profile_ids]
    pids = [p for p in pids if p]
    if not pids:
        raise HTTPException(status_code=400, detail="profile_ids khÃ´ng há»£p lá»‡")

    # Náº¿u user báº¥m NUÃ”I ACC mÃ  trÆ°á»›c Ä‘Ã³ Ä‘Ã£ STOP, auto reset STOP Ä‘á»ƒ job cháº¡y Ä‘Æ°á»£c.
    try:
        stop, _paused, reason = control_state.check_flags(None)
        if stop:
            print(f"ðŸŸ¡ [/feed/start] GLOBAL_EMERGENCY_STOP Ä‘ang báº­t ({reason}) -> auto reset Ä‘á»ƒ cháº¡y")
            control_state.reset_emergency_stop(clear_stopped_profiles=False)
        control_state.resume_profiles(pids)
    except Exception:
        pass

    # âœ… Cháº·n cháº¡y náº¿u báº¥t ká»³ profile nÃ o thiáº¿u cookie/access_token
    _validate_profiles_requirements(pids, require_cookie=True, require_access_token=True)

    run_minutes = int(payload.run_minutes or 0)
    if run_minutes <= 0:
        raise HTTPException(status_code=400, detail="run_minutes pháº£i > 0")
    rest_minutes = int(payload.rest_minutes or 0)
    if rest_minutes < 0:
        raise HTTPException(status_code=400, detail="rest_minutes pháº£i >= 0")

    started: list[str] = []
    skipped: list[dict] = []
    mode = str(payload.mode or "feed").strip().lower()
    text = str(payload.text or "").strip()
    # backward-compat
    if not text and getattr(payload, "filter_text", None):
        text = str(payload.filter_text or "").strip()
    # Cho phÃ©p text rá»—ng náº¿u mode=feed (sáº½ chá»‰ filter theo keyword máº·c Ä‘á»‹nh)
    if not text and mode == "search":
        raise HTTPException(status_code=400, detail="text rá»—ng (search cáº§n text)")

    with _feed_lock:
        _prune_feed_processes()
        for pid in pids:
            existing = _feed_processes.get(pid)
            if existing and existing.is_alive():
                skipped.append({"profile_id": pid, "reason": "already_running"})
                continue

            proc = Process(
                target=_run_feed_worker,
                args=(pid, mode, text, run_minutes, rest_minutes, pids),
                daemon=True,
            )
            proc.start()
            _feed_processes[pid] = proc
            started.append(pid)

    return {"status": "ok", "started": started, "skipped": skipped, "running": list(_feed_processes.keys())}


@app.post("/feed/stop")
def feed_stop(payload: Optional[FeedStopRequest] = Body(None)) -> dict:
    """Dá»«ng nuÃ´i acc (feed) theo list profile_ids hoáº·c dá»«ng táº¥t cáº£ náº¿u khÃ´ng truyá»n."""
    target: Optional[list[str]] = None
    if payload and payload.profile_ids is not None:
        target = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
        target = [p for p in target if p]

    stopped: list[str] = []
    with _feed_lock:
        _prune_feed_processes()
        keys = list(_feed_processes.keys())
        to_stop = keys if target is None else [p for p in target if p in _feed_processes]
        for pid in to_stop:
            proc = _feed_processes.get(pid)
            try:
                if proc and proc.is_alive():
                    proc.terminate()
                    proc.join(timeout=5)
            except Exception:
                pass
            _feed_processes.pop(pid, None)
            stopped.append(pid)

    for pid in stopped:
        try:
            stop_profile(pid)
        except Exception:
            pass

    return {"status": "ok", "stopped": stopped}


@app.get("/jobs/status")
def jobs_status() -> dict:
    """Tráº¡ng thÃ¡i chung (Ä‘á»ƒ UI hiá»ƒn thá»‹/diagnose)."""
    with _bot_lock:
        _prune_bot_processes()
        bot_running_pids = []
        for pid, proc in _bot_processes.items():
            try:
                if proc.is_alive():
                    bot_running_pids.append(pid)
            except Exception:
                pass
    is_bot_running = len(bot_running_pids) > 0
    with _join_groups_lock:
        _prune_join_group_processes()
        join_running = []
        for pid, proc in _join_groups_processes.items():
            try:
                if proc.is_alive():
                    join_running.append(pid)
            except Exception:
                pass
    with _feed_lock:
        _prune_feed_processes()
        feed_running = []
        for pid, proc in _feed_processes.items():
            try:
                if proc.is_alive():
                    feed_running.append(pid)
            except Exception:
                pass
    return {
        "bot_running": is_bot_running,
        "bot_pid": None,
        "bot_profile_ids": bot_running_pids,
        "join_groups_running": join_running,
        "feed_running": feed_running,
    }


@app.post("/jobs/stop-all")
def stop_all_jobs() -> dict:
    """
    Dá»«ng táº¥t cáº£ tÃ¡c vá»¥ ná»n (dÃ¹ng chung cho auto join group + sau nÃ y nuÃ´i acc).
    """
    # Legacy endpoint: váº«n map vá» hard stop (fresh start) cho Ä‘Ãºng spec má»›i
    return _hard_stop_everything(reason="/jobs/stop-all")


# ==============================================================================
# CONTROL API (STOP / PAUSE / RESUME) - theo spec Boss
# ==============================================================================

class ProfileControlPayload(BaseModel):
    profile_id: str


class ProfilesControlPayload(BaseModel):
    profile_ids: list[str]


class ResetStopPayload(BaseModel):
    clear_stopped_profiles: bool = False


@app.get("/control/state")
def control_get_state() -> dict:
    return control_state.get_state()


@app.post("/control/stop-all")
def control_stop_all() -> dict:
    """
    STOP ALL = dá»«ng kháº©n cáº¥p.
    - set GLOBAL_EMERGENCY_STOP=true (Æ°u tiÃªn cao nháº¥t)
    - best-effort: Ä‘Ã³ng toÃ n bá»™ NST browser
    - KHÃ”NG há»i confirm, KHÃ”NG delay
    """
    return _hard_stop_everything(reason="/control/stop-all")


@app.post("/control/pause-all")
def control_pause_all() -> dict:
    print("[UI] PAUSE ALL triggered")
    st = control_state.set_global_pause(True)
    return {"status": "ok", "state": st}


@app.post("/control/resume-all")
def control_resume_all() -> dict:
    print("[UI] RESUME ALL triggered")
    st = control_state.set_global_pause(False)
    return {"status": "ok", "state": st}


@app.post("/control/pause-profile")
def control_pause_profile(payload: ProfileControlPayload) -> dict:
    pid = _norm_profile_id(payload.profile_id)
    print(f"[UI] PAUSE profile_id={pid}")
    st = control_state.pause_profile(pid)
    return {"status": "ok", "state": st, "profile_id": pid}


@app.post("/control/resume-profile")
def control_resume_profile(payload: ProfileControlPayload) -> dict:
    pid = _norm_profile_id(payload.profile_id)
    print(f"[UI] RESUME profile_id={pid}")
    st = control_state.resume_profile(pid)
    return {"status": "ok", "state": st, "profile_id": pid}


@app.post("/control/stop-profiles")
def control_stop_profiles(payload: ProfilesControlPayload) -> dict:
    """
    STOP theo danh sÃ¡ch profile (dÃ¹ng cho UI: tick profile -> báº¥m dá»«ng).
    - Set stopped_profiles cho tá»«ng pid
    - Best-effort: Ä‘Ã³ng NST browser cho Ä‘Ãºng cÃ¡c pid Ä‘Ã³
    """
    global _bot_processes
    pids = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
    pids = [p for p in pids if p]
    print(f"[UI] STOP profiles={pids}")

    st = control_state.stop_profiles(pids)

    # Terminate bot process Ä‘Ãºng profile (Ä‘á»™c láº­p), khÃ´ng áº£nh hÆ°á»Ÿng profile khÃ¡c
    try:
        with _bot_lock:
            _prune_bot_processes()
            for pid in pids:
                proc = _bot_processes.get(pid)
                try:
                    if proc and proc.is_alive():
                        proc.terminate()
                        proc.join(timeout=3)
                except Exception:
                    pass
                _bot_processes.pop(pid, None)
    except Exception:
        pass

    nst_ok: list[str] = []
    nst_fail: list[dict] = []
    for pid in pids:
        try:
            ok = bool(stop_profile(pid))
            if ok:
                nst_ok.append(pid)
            else:
                nst_fail.append({"profile_id": pid, "reason": "stop_profile_returned_false"})
        except Exception as e:
            nst_fail.append({"profile_id": pid, "reason": str(e)})

    return {"status": "ok", "state": st, "stopped_profiles": pids, "nst_ok": nst_ok, "nst_fail": nst_fail}


@app.post("/control/pause-profiles")
def control_pause_profiles(payload: ProfilesControlPayload) -> dict:
    pids = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
    pids = [p for p in pids if p]
    print(f"[UI] PAUSE profiles={pids}")
    st = control_state.pause_profiles(pids)
    return {"status": "ok", "state": st, "paused_profiles": pids}


@app.post("/control/resume-profiles")
def control_resume_profiles(payload: ProfilesControlPayload) -> dict:
    pids = [_norm_profile_id(x) for x in (payload.profile_ids or [])]
    pids = [p for p in pids if p]
    print(f"[UI] RESUME profiles={pids}")
    st = control_state.resume_profiles(pids)
    return {"status": "ok", "state": st, "resumed_profiles": pids}


@app.post("/control/reset-stop")
def control_reset_stop(payload: Optional[ResetStopPayload] = Body(None)) -> dict:
    """
    Reset emergency stop Ä‘á»ƒ há»‡ thá»‘ng cháº¡y láº¡i Ä‘Æ°á»£c.
    - clear_stopped_profiles=true: xoÃ¡ luÃ´n stopped_profiles (Ä‘á»ƒ profile khÃ´ng bá»‹ giá»¯ STOPPED)
    """
    clear_stopped = bool(payload.clear_stopped_profiles) if payload else False
    print(f"[UI] RESET STOP (clear_stopped_profiles={clear_stopped})")
    st = control_state.reset_emergency_stop(clear_stopped_profiles=clear_stopped)
    return {"status": "ok", "state": st}

@app.delete("/settings/profiles/{profile_id}")
def delete_profile(profile_id: str) -> dict:
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    with _settings_lock:
        raw = _read_settings_raw()
        profiles = raw.get("PROFILE_IDS") or {}
        if isinstance(profiles, list) or isinstance(profiles, str):
            profiles = {}
        if not isinstance(profiles, dict):
            raise HTTPException(status_code=400, detail="PROFILE_IDS pháº£i lÃ  object")

        if pid in profiles:
            del profiles[pid]
        raw["PROFILE_IDS"] = profiles
        _write_settings_raw(raw)
        return {"status": "ok"}


@app.post("/settings/profiles/{profile_id}/cookie/fetch")
def fetch_and_save_cookie(profile_id: str) -> dict:
    """
    Káº¿t ná»‘i NST profile -> láº¥y cookie tá»« browser context -> lÆ°u vÃ o settings.json.
    """
    pid = _norm_profile_id(profile_id)
    if not pid:
        raise HTTPException(status_code=400, detail="profile_id rá»—ng")

    try:
        ws = connect_profile(pid)
    except Exception as exc:
        # NST chÆ°a cháº¡y / API key sai / profile_id sai
        raise HTTPException(status_code=502, detail=str(exc)) from exc
    fb = FBController(ws)
    fb.profile_id = pid
    fb.connect()
    try:
        # Ä‘áº£m báº£o context Ä‘Ã£ cÃ³ session/cookie
        try:
            fb.goto("https://www.facebook.com/")
            fb.page.wait_for_timeout(1200)
        except Exception:
            pass

        cookie_string = fb.save_cookies()
        if not cookie_string:
            raise HTTPException(status_code=400, detail="KhÃ´ng láº¥y Ä‘Æ°á»£c cookie (cÃ³ thá»ƒ chÆ°a Ä‘Äƒng nháº­p)")
        return {"status": "ok", "profile_id": pid, "cookie": cookie_string}
    finally:
        # ÄÃ³ng sáº¡ch tab/context playwright
        try:
            if fb.page:
                try:
                    fb.page.close()
                except Exception:
                    pass
        except Exception:
            pass
        try:
            if fb.browser and getattr(fb.browser, "contexts", None):
                for ctx in list(fb.browser.contexts):
                    try:
                        ctx.close()
                    except Exception:
                        pass
        except Exception:
            pass
        try:
            if fb.browser:
                fb.browser.close()
        except Exception:
            pass
        try:
            if fb.play:
                fb.play.stop()
        except Exception:
            pass

        # Best-effort: yÃªu cáº§u NST stop/close browser instance cá»§a profile
        try:
            stop_profile(pid)
        except Exception:
            pass

--- END FILE: backend\app\api.py ---

--- START FILE: backend\app\__init__.py ---
"""
App package cho FastAPI endpoints.
"""

--- END FILE: backend\app\__init__.py ---

--- START FILE: backend\config\cookies.json ---
{
    "621e1f5d-0c42-481e-9ddd-7abaafce68ed": "sb=HNY6aQAFB_tf42A4id6xhZpQ; ps_l=1; ps_n=1; datr=G9Y6adLzWpqwDfxsQ9kDerdz; c_user=100044138143352; fr=1sdSEslpqAyTeQJRg.AWecLBOqLRd9jSYgfcVNhdVagXptDWnkGg5RMoL6VBtPGvPW1w0.BpQA9M..AAA.0.0.BpQA-V.AWc8U6FSz3sU_m0w9h0kbUhYY0c; xs=46%3A14pMRvXIIAuMgQ%3A2%3A1765698119%3A-1%3A-1%3A%3AAcx4Q2xf_Z48p7fK-6DplMRlaF9HHUbLt8q1DksDmgQ; wd=1920x911;"
}
--- END FILE: backend\config\cookies.json ---

--- START FILE: backend\config\groups.json ---
{
  "621e1f5d-0c42-481e-9ddd-7abaafce68ed": [
    {
      "page_id": "988098777982558",
      "url_page": "https://www.facebook.com/groups/tuyendungkisuIT"
    }
  ]
}

--- END FILE: backend\config\groups.json ---

--- START FILE: backend\config\settings.json ---
{
  "API_KEY": "7a43ee33-9f15-434d-a1b6-6d1b5809f935",
  "HEADLESS": false,
  "TARGET_URL": "https://facebook.com",
  "PROFILE_IDS": {
    "621e1f5d-0c42-481e-9ddd-7abaafce68ed": {
      "access_token": "EAAAAAYsX7TsBPkK1ZBRjlt5wPp0ZBTRmXixZCJr0OAtEG2JQ2di0i1mtCIsuGvriF2cLviSV5GOl2taLMWi3K5SJb3bg5yxOOBPGMxkBadOT1mwkVjf2UujZB012zzVUiQYpD9fDzvUtB1KtT4ZB8DHDwJLmikXoB6K7OzXRdfj3as5gc9SFQK2vNNB2fUmPZBvMrUeNC06jP0Oi9Ra5r44pSBBYvSm2iJUDoKK6EVAqbmhAZDZD",
      "cookie": "sb=HNY6aQAFB_tf42A4id6xhZpQ; ps_l=1; ps_n=1; datr=G9Y6adLzWpqwDfxsQ9kDerdz; c_user=100044138143352; fr=1AmhOzEsYwJm1z3F8.AWe1G4zFeIdltu_6mo02ef034OWbfWO3HXIKnZHiXgEXzm41vC0.BpQlRC..AAA.0.0.BpQlSK.AWcCt14dZZqeCwKbuvG3d3nDtq0; xs=46%3A14pMRvXIIAuMgQ%3A2%3A1765698119%3A-1%3A-1%3A%3AAcz0K0TW7XYT1T9uPpb9lyO9fUsqaeA59CgEI6TisFc; wd=929x883;",
      "groups": [
        "https://www.facebook.com/groups/tuyendungkisuIT"
      ]
    },
    "a": {
      "cookie": "",
      "access_token": "",
      "groups": []
    }
  },
  "RUN_MINUTES": 30,
  "REST_MINUTES": 120
}

--- END FILE: backend\config\settings.json ---

--- START FILE: backend\core\browser.py ---
import time
import random
from playwright.sync_api import sync_playwright
import json
import re
from urllib.parse import urlparse, parse_qs, unquote
import os
import sys
from core.settings import get_settings, SETTINGS_PATH
from core import control as control_state
# ==============================================================================
# JS TOOLS & HELPER FUNCTIONS
# ==============================================================================
current_dir = os.path.dirname(os.path.abspath(__file__))
parent_dir = os.path.dirname(current_dir)
worker_path = os.path.join(parent_dir, 'worker')

if worker_path not in sys.path:
    sys.path.append(worker_path)

# Import hÃ m láº¥y thÃ´ng tin an toÃ n
try:
    from get_id import get_id_from_url
except ImportError:
    try:
        from worker.get_id import get_id_from_url
    except:
        print("âš ï¸ Cáº£nh bÃ¡o: KhÃ´ng import Ä‘Æ°á»£c worker/get_id.py")
        get_id_from_url = None


JS_EXPAND_SCRIPT = """
(node) => {
    if (!node) return 0;

    const keywords = ["Xem thÃªm", "See more"];
    let clickedCount = 0;

    // ðŸ”’ Chá»‰ tÃ¬m trong ná»™i dung bÃ i viáº¿t
    const scopes = [
        '[data-ad-preview="message"]',
        '[data-ad-rendering-role="story_message"]',
        '.userContent'
    ];

    let target = null;
    for (const sel of scopes) {
        const found = node.querySelector(sel);
        if (found) {
            target = found;
            break;
        }
    }

    if (!target) return 0;

    const buttons = Array.from(
        target.querySelectorAll('[role="button"]')
    );

    for (const btn of buttons) {
        const text = btn.innerText ? btn.innerText.trim() : "";
        if (!keywords.includes(text)) continue;

        const rect = btn.getBoundingClientRect();

        // â— Chá»‰ click náº¿u nÃºt Ä‘ang náº±m trong viewport
        if (rect.top < 0 || rect.bottom > window.innerHeight) continue;

        if (btn.offsetWidth > 0 && btn.offsetHeight > 0) {
            btn.click();
            btn.style.border = "2px solid red";
            clickedCount++;
        }
    }

    return clickedCount;
}
"""

JS_CHECK_AND_HIGHLIGHT_SCOPED = """
([node, keywords]) => { 
    if (!node || !keywords || keywords.length === 0) return false;
    
    // [Cá»°C Ká»² QUAN TRá»ŒNG] 
    // Chá»‰ Ä‘á»‹nh chÃ­nh xÃ¡c cÃ¡c selector bao bá»c ná»™i dung bÃ i viáº¿t mÃ  Sáº¿p Ä‘Ã£ cung cáº¥p.
    // Bot sáº½ chá»‰ hoáº¡t Ä‘á»™ng bÃªn trong cÃ¡c tháº» nÃ y.
    const strictSelectors = [
        '[data-ad-preview="message"]',              // Æ¯u tiÃªn 1: Chuáº©n Ads
        '[data-ad-rendering-role="story_message"]', // Æ¯u tiÃªn 2: Wrapper cá»§a message
        '.userContent'                              // Æ¯u tiÃªn 3: CÃ¡c dáº¡ng bÃ i cÅ©
    ];

    let targetScope = null;

    // 1. TÃ¬m Ä‘Ãºng cÃ¡i há»™p ná»™i dung
    for (const selector of strictSelectors) {
        const found = node.querySelector(selector);
        if (found) {
            targetScope = found;
            break;
        }
    }

    // [CHá»T CHáº¶N]
    // Náº¿u khÃ´ng tÃ¬m tháº¥y cÃ¡i há»™p ná»™i dung nÃ y -> Coi nhÆ° khÃ´ng pháº£i bÃ i viáº¿t há»£p lá»‡ -> RETURN FALSE NGAY.
    // Äiá»u nÃ y Ä‘áº£m báº£o khÃ´ng bao giá» quÃ©t nháº§m tÃªn Page hay Header bÃªn ngoÃ i.
    if (!targetScope) return false;

    // 2. Logic quÃ©t vÃ  highlight (Chá»‰ cháº¡y trong targetScope)
    const sortedKeywords = keywords.sort((a, b) => b.length - a.length);
    const pattern = new RegExp(`(${sortedKeywords.join('|')})`, 'gi');
    let foundCount = 0;

    function highlightTextNode(textNode) {
        const text = textNode.nodeValue;
        if (!pattern.test(text)) return;
        
        const fragment = document.createDocumentFragment();
        const parts = text.split(pattern);
        parts.forEach(part => {
            if (pattern.test(part)) {
                const span = document.createElement('span');
                // Style cho dá»… nhÃ¬n khi debug
                Object.assign(span.style, {
                    backgroundColor: 'yellow', color: 'red', fontWeight: 'bold',
                    border: '2px solid red', padding: '2px', zIndex: '9999'
                });
                span.innerText = part;
                fragment.appendChild(span);
                foundCount++;
            } else {
                fragment.appendChild(document.createTextNode(part));
            }
            pattern.lastIndex = 0; 
        });
        textNode.parentNode.replaceChild(fragment, textNode);
    }

    const walker = document.createTreeWalker(targetScope, NodeFilter.SHOW_TEXT, {
        acceptNode: n => {
            // Váº«n giá»¯ bá»™ lá»c tháº» rÃ¡c Ä‘á»ƒ sáº¡ch sáº½ nháº¥t cÃ³ thá»ƒ
            if (['SCRIPT', 'STYLE', 'NOSCRIPT', 'BUTTON', 'INPUT'].includes(n.parentNode.nodeName)) {
                return NodeFilter.FILTER_REJECT;
            }
            if (n.parentNode.isContentEditable) return NodeFilter.FILTER_REJECT;
            return NodeFilter.FILTER_ACCEPT;
        }
    });

    const textNodes = [];
    while (walker.nextNode()) textNodes.push(walker.currentNode);
    textNodes.forEach(highlightTextNode);
    
    return foundCount > 0;
}
"""

def extract_facebook_post_id(url: str):
    if not url: return None
    try: url = unquote(url)
    except: pass
    
    patterns = [
        r"(pfbid[A-Za-z0-9]+)", 
        r"/posts/(\d+)", 
        r"/videos/(\d+)", 
        r"/reel/(\d+)",
        r"story_fbid=(\d+)", 
        r"fbid=(\d+)",
        r"id=(\d+)"
    ]
    for p in patterns:
        m = re.search(p, url)
        if m: return m.group(1)
        
    qs = parse_qs(urlparse(url).query)
    for k in ["story_fbid", "fbid", "id"]:
        if k in qs: return qs[k][0]
    return None

def parse_graphql_payload(post_data):
    """PhÃ¢n tÃ­ch data gá»­i Ä‘i Ä‘á»ƒ tÃ¬m biáº¿n 'url'."""
    if not post_data: return None
    variables_str = None
    
    try:
        if isinstance(post_data, str):
            json_body = json.loads(post_data)
        else:
            json_body = post_data
        variables_str = json.dumps(json_body.get("variables", {}))
    except:
        try:
            qs = parse_qs(post_data)
            if "variables" in qs:
                variables_str = qs["variables"][0]
        except: pass

    if variables_str and '"url":' in variables_str:
        match = re.search(r'"url"\s*:\s*"([^"]+)"', variables_str)
        if match:
            raw_url = match.group(1)
            return raw_url.replace(r"\/", "/")
            
    return None


class FBController:
    def __init__(self, ws_url):
        self.ws_url = ws_url
        self.browser = None
        self.page = None
        self.play = None
        self.profile_id = "unknown"
        # keyword filter thÃªm tá»« UI (Setting profile -> QuÃ©t bÃ i viáº¿t)
        # náº¿u rá»—ng => chá»‰ lá»c theo job_keywords máº·c Ä‘á»‹nh
        self.user_keywords = []
        cfg = get_settings()
        self.all_profile_ids = cfg.profile_ids
        # Chá»‰ báº¯t URL payload tá»« request
        self.captured_payload_url = None
        
        self.job_keywords = [
            "tuyá»ƒn dá»¥ng", "tuyá»ƒn nhÃ¢n viÃªn", "tuyá»ƒn gáº¥p", "viá»‡c lÃ m", "tuyá»ƒn",
            "lÆ°Æ¡ng", "phá»ng váº¥n", "há»“ sÆ¡",
            "full-time", "part-time", "thá»±c táº­p", "káº¿ toÃ¡n", "may máº·c", "kcn" ,"á»¨ng viÃªn " , "á»¨ng tuyá»ƒn"
        ]
        # cache nháº¹ Ä‘á»ƒ trÃ¡nh spam IO khi check control liÃªn tá»¥c
        self._last_control_check_ts = 0.0
        self._last_control_snapshot = (False, False, "")

    def control_checkpoint(self, where: str = "") -> None:
        """
        Æ¯u tiÃªn flag theo spec:
          1) GLOBAL_EMERGENCY_STOP -> STOP NGAY
          2) GLOBAL_PAUSE -> SLEEP
          3) PAUSED_PROFILES[pid] -> SLEEP
        """
        now = time.time()
        if now - float(getattr(self, "_last_control_check_ts", 0.0)) > 0.35:
            self._last_control_check_ts = now
            self._last_control_snapshot = control_state.check_flags(getattr(self, "profile_id", None))

        stop, paused, reason = self._last_control_snapshot

        if stop:
            try:
                control_state.set_profile_state(self.profile_id, "STOPPED")
            except Exception:
                pass
            print(f"ðŸ›‘ [STOP] {self.profile_id} @ {where} ({reason})")
            raise RuntimeError("EMERGENCY_STOP")

        if paused:
            try:
                control_state.set_profile_state(self.profile_id, "PAUSED")
            except Exception:
                pass
            if where:
                print(f"â¸ï¸ [PAUSE] {self.profile_id} @ {where} ({reason})")
            # chá» Ä‘áº¿n khi háº¿t pause hoáº·c emergency stop
            control_state.wait_if_paused(self.profile_id, sleep_seconds=0.5)
            try:
                control_state.set_profile_state(self.profile_id, "RUNNING")
            except Exception:
                pass

    def connect(self):
        self.play = sync_playwright().start()
        self.browser = self.play.chromium.connect_over_cdp(self.ws_url)
        context = self.browser.contexts[0]
        self.page = context.pages[0]
        
        self.start_network_sniffer()
        
        try:
            viewport = self.page.viewport_size
            self.page.mouse.click(viewport['width']/2, viewport['height']/2)
        except: pass

    def goto(self, url):
        self.page.goto(url, timeout=0)

    # ===================== [CORE] NETWORK SNIFFER =====================
    def start_network_sniffer(self):
        print("ðŸ›°  ÄÃ£ kÃ­ch hoáº¡t Sniffer: Cháº¿ Ä‘á»™ báº¯t Payload URL...")

        # Báº®T URL Tá»ª REQUEST (chá»‰ báº¯t URL cÃ³ chá»©a "share")
        def on_request(request):
            if "facebook.com/api/graphql" in request.url and request.method == "POST":
                try:
                    raw_url = parse_graphql_payload(request.post_data)
                    if raw_url:
                        # Chá»‰ lÆ°u náº¿u URL cÃ³ chá»©a "share" (vÃ­ dá»¥: https://www.facebook.com/share/p/1HYNUE6FzL/)
                        if "/share/" in raw_url:
                            self.captured_payload_url = raw_url
                            print(f"ðŸ”— [DEBUG] Báº¯t Ä‘Æ°á»£c Share URL: {raw_url}")
                except: pass

        self.page.on("request", on_request)

    # ===================== SHARE & CHá»œ ID (LOGIC Má»šI) =====================
    def share_center_ad(self, post_handle, post_type):
            
        try:
            self.control_checkpoint("before_share")
            viewport = self.page.viewport_size
            height = viewport['height'] if viewport else 800
            escape_step = height * 0.35  # ðŸ‘ˆ THOÃT MODULE RÃC
            print("ðŸš€ Share â†’ báº¯t Payload URL â†’ gá»i get_id_from_url")

            self.captured_payload_url = None

            share_btn = post_handle.query_selector(
                'xpath=.//div[@data-ad-rendering-role="share_button"]/ancestor::div[@role="button"]'
            )
            if not share_btn:
                print("âš ï¸ KhÃ´ng tÃ¬m tháº¥y nÃºt Share")
                self.scroll_past_post(post_handle)
                time.sleep(random.uniform(0.12, 0.13))
                return False

            self.bring_element_into_view_smooth(share_btn)
            self.page.wait_for_timeout(300)
            share_btn.click()

            # Äá»£i báº¯t Ä‘Æ°á»£c payload URL
            for _ in range(50):
                self.control_checkpoint("after_share_click_wait_payload")
                if self.captured_payload_url:
                    # Gá»i get_id_from_url trá»±c tiáº¿p tá»« URL payload
                    if get_id_from_url:
                        try:
                            self.control_checkpoint("before_get_id_from_url")
                            print(f"ðŸ“¥ Äang gá»i get_id_from_url vá»›i URL: {self.captured_payload_url}")
                            details = get_id_from_url(self.captured_payload_url, self.profile_id)
                            if details and details.get("post_id"):
                                self.save_post_id_from_details(details, post_type)
                                self.page.keyboard.press("Escape")
                                return True
                            else:
                                print("âš ï¸ KhÃ´ng láº¥y Ä‘Æ°á»£c post_id tá»« get_id_from_url")
                        except Exception as e:
                            # KhÃ´ng Ä‘Æ°á»£c nuá»‘t STOP/PAUSE
                            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                                raise
                            print(f"âŒ Lá»—i khi gá»i get_id_from_url: {e}")
                    break
                self.page.wait_for_timeout(150)

            print("âš ï¸ KhÃ´ng láº¥y Ä‘Æ°á»£c Payload URL")
            self.page.keyboard.press("Escape")
            return False

        except Exception as e:
            # KhÃ´ng Ä‘Æ°á»£c nuá»‘t STOP/PAUSE
            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                raise
            print(f"âŒ share_center_ad lá»—i: {e}")
            self.page.keyboard.press("Escape")
            return False

    # ===================== CÃC HÃ€M KHÃC GIá»® NGUYÃŠN =====================
    def save_post_id_from_details(self, details, post_type):
        """
        LÆ°u post tá»« dict details tráº£ vá» tá»« get_id_from_url
        details chá»©a: post_id, owning_profile, post_text
        """
        try:
            post_id = details.get("post_id")
            if not post_id:
                print("âš ï¸ KhÃ´ng cÃ³ post_id trong details")
                return False
                
            folder = "data/post_ids"
            os.makedirs(folder, exist_ok=True)
            filepath = f"{folder}/{self.profile_id}.json"

            data = []
            if os.path.exists(filepath):
                try:
                    with open(filepath, "r", encoding="utf8") as f:
                        data = json.load(f)
                except:
                    data = []

            # 1. TrÃ¡nh trÃ¹ng ID (Check cáº£ format cÅ© post_id vÃ  má»›i id)
            for item in data:
                existing_id = item.get("id") or item.get("post_id")
                if existing_id == post_id:
                    print(f"ðŸ” ID {post_id} Ä‘Ã£ tá»“n táº¡i -> bá» qua.")
                    return False

            # 2. Format dá»¯ liá»‡u JSON theo yÃªu cáº§u
            # Map flag: green -> xanh, yellow -> vÃ ng
            flag_vn = "xanh" if post_type == "green" else "vÃ ng" if post_type == "yellow" else post_type
            
            # Láº¥y thÃ´ng tin tá»« káº¿t quáº£ worker tráº£ vá»
            post_text = details.get("post_text", "")
            owning_profile = details.get("owning_profile", {})

            record = {
                "id": post_id,
                "flag": flag_vn,
                "text": post_text,
                "owning_profile": owning_profile
            }

            data.append(record)

            with open(filepath, "w", encoding="utf8") as f:
                json.dump(data, f, indent=2, ensure_ascii=False)

            print(f"ðŸ’¾ ÄÃ£ lÆ°u Post {post_id} | Chá»§ bÃ i: {owning_profile.get('name', 'N/A')}")
            
            return True
        except Exception as e:
            print(f"âŒ Lá»—i save_post_id_from_details: {e}")
            return False


    def scan_while_scrolling(self):
        try:
            viewport = self.page.viewport_size
            height = viewport['height'] if viewport else 800

            normal_step = height * 0.12
            escape_step = height * 0.35  # ðŸ‘ˆ THOÃT MODULE RÃC

            print("â¬‡ï¸ Scan theo center-post (LOCK khi tháº¥y xanh)")

            while True:
                self.control_checkpoint("before_scroll_loop")
                post = self.get_center_post()

                # =========================
                # âŒ KHÃ”NG PHáº¢I POST â†’ THOÃT NGAY
                # =========================
                if not post:
                    # Ä‘ang Ä‘á»©ng trÃªn ref / káº¿t báº¡n / module rÃ¡c
                    self.control_checkpoint("before_escape_wheel")
                    self.page.mouse.wheel(0, escape_step)
                    time.sleep(random.uniform(0.12, 0.13))
                    continue

                # =========================
                # POST ÄÃƒ Xá»¬ LÃ â†’ Äáº¨Y RA KHá»ŽI VIEW
                # =========================
                if self.check_post_is_processed(post):
                    try:
                        self.control_checkpoint("before_normal_wheel")
                        self.page.mouse.wheel(0, normal_step)
                    except Exception as e:
                        error_msg = str(e).lower()
                        if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                            raise RuntimeError("BROWSER_CLOSED") from e
                        raise
                    time.sleep(random.uniform(0.08, 0.15))
                    continue

                # =========================
                # LOCK POST Há»¢P Lá»†
                # =========================
                is_ad = self.check_current_post_is_ad(post)

                if is_ad:
                    print("ðŸŸ¥ ADS detected (center-post)")
                    return post, "green"
                else:
                    print("ðŸŸ¨ BÃ i thÆ°á»ng detected (center-post)")
                    return post, "yellow"

        except Exception as e:
            error_msg = str(e).lower()
            # Náº¿u browser/page Ä‘Ã£ bá»‹ Ä‘Ã³ng thÃ¬ raise exception Ä‘áº·c biá»‡t Ä‘á»ƒ bot dá»«ng
            if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                print(f"ðŸ›‘ Browser Ä‘Ã£ bá»‹ Ä‘Ã³ng trong scan_while_scrolling -> Raise exception")
                raise RuntimeError("BROWSER_CLOSED") from e
            print(f"âš ï¸ Lá»—i scan: {e}")
            return None, None

    def like_current_post(self, post_handle):
        print("â¤ï¸ Äang thá»±c hiá»‡n Like bÃ i viáº¿t nÃ y...")
        try:
            self.control_checkpoint("before_like")
            element = post_handle.as_element()
            if not element: return False
            already_liked = element.query_selector('div[role="button"][aria-label="Gá»¡ ThÃ­ch"], div[role="button"][aria-label="Remove Like"]')
            if already_liked:
                print("âš ï¸ BÃ i nÃ y Ä‘Ã£ Like rá»“i -> Bá» qua.")
                return False
            selector = 'div[role="button"][aria-label="ThÃ­ch"], div[role="button"][aria-label="Like"]'
            like_btn = element.query_selector(selector)
            if like_btn:
                self.bring_element_into_view_smooth(like_btn)
                time.sleep(0.5)
                self.control_checkpoint("before_like_click")
                like_btn.click()
                self.control_checkpoint("after_like_click")
                print("âœ… ÄÃ£ Báº¥m Like thÃ nh cÃ´ng!")
                return True
            else:
                print("âš ï¸ KhÃ´ng tÃ¬m tháº¥y nÃºt Like phÃ¹ há»£p.")
                return False
        except Exception as e:
            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                raise
            print(f"âŒ Lá»—i Like: {e}")
            return False

    


    def get_center_post(self):
        try:
            return self.page.evaluate_handle("""
                () => {
                    const x = window.innerWidth / 2;
                    const y = window.innerHeight * 0.45;
                    const el = document.elementFromPoint(x, y);
                    if (!el) return null;

                    // =========================
                    // 1. CHECK CONTEXT: SEARCH PAGE?
                    // =========================
                    const isSearchPage = !!document.querySelector(
                        'h1, span'
                    ) && [...document.querySelectorAll('h1, span')]
                        .some(e => e.innerText?.trim() === 'Káº¿t quáº£ tÃ¬m kiáº¿m');

                    // =========================
                    // 2. CHá»ŒN CONTAINER PHÃ™ Há»¢P
                    // =========================
                    const POST_SELECTOR = isSearchPage
                        ? 'div.x78zum5.xdt5ytf'   // search page
                        : 'div.x1lliihq';         // home / feed

                    let cur = el.closest(POST_SELECTOR);

                    while (cur) {
                        // âœ… PHáº¢I CÃ“ LIKE BUTTON â†’ má»›i lÃ  post tháº­t
                        const hasLike = cur.querySelector(
                            'div[aria-label="ThÃ­ch"], div[aria-label="Like"],' +
                            'div[aria-label="Gá»¡ ThÃ­ch"], div[aria-label="Remove Like"]'
                        );

                        if (hasLike) {
                            cur.style.outline = "4px solid #00ff00";
                            cur.setAttribute('data-center-post', 'true'); // ðŸ”’ MARK
                            return cur;
                        }

                        cur = cur.parentElement?.closest(POST_SELECTOR);
                    }

                    return null;
                }
            """)
        except:
            return None

    def check_current_post_is_ad(self, post_handle):
        if not post_handle or not post_handle.as_element(): return False
        return post_handle.evaluate("""
            (post) => {
                if (post.getAttribute('data-bot-processed') === 'true') return false;
                const checkAnchors = (element) => {
                    if (!element) return false;
                    const anchors = Array.from(element.querySelectorAll('a[href*="__cft__"]'));
                    for (const a of anchors) {
                        const href = a.getAttribute('href');
                        if (!href) continue;
                        if (href.includes('__tn__')) continue;
                        let m = href.match(/__cft__\\[0\\]=([^&#]+)/) || href.match(/__cft__%5B0%5D=([^&#]+)/);
                        if (m && m[1]) return true; 
                    }
                    return false;
                };
                if (checkAnchors(post)) { post.style.outline = "5px solid red"; return true; }
                if (post.parentElement && checkAnchors(post.parentElement)) { post.style.outline = "5px solid red"; return true; }
                if (post.parentElement && post.parentElement.parentElement && checkAnchors(post.parentElement.parentElement)) { post.style.outline = "5px solid red"; return true; }
                return false;
            }
        """)

    def mark_post_as_processed(self, post_handle):
        try:
            post_handle.evaluate("""(post) => {
                post.setAttribute('data-bot-processed', 'true');
                post.style.outline = "5px solid gray"; 
                post.style.opacity = "0.7";
            }""")
            print("ðŸ ÄÃ£ Ä‘Ã¡nh dáº¥u bÃ i viáº¿t: DONE.")
        except: pass
        
    def save_cookies(self):
        """
        Láº¥y cookie tá»« browser context vÃ  lÆ°u tháº³ng vÃ o:
        backend/config/settings.json -> PROFILE_IDS[profile_id]["cookie"]
        Tráº£ vá» cookie_string.
        """
        try:
            print("ðŸª Äang trÃ­ch xuáº¥t Cookie (Key=ID, Value=String)...")
            
            # 1. Láº¥y toÃ n bá»™ cookies
            all_cookies = self.page.context.cookies()
            if not all_cookies:
                print("âš ï¸ ChÆ°a Ä‘Äƒng nháº­p.")
                return None

            # 2. Danh sÃ¡ch cÃ¡c trÆ°á»ng cáº§n láº¥y (ÄÃºng thá»© tá»± Sáº¿p gá»­i)
            target_keys = [
                "sb", "ps_l", "ps_n", "datr", "c_user", 
                "ar_debug", "fr", "xs", "wd"
            ]
            
            # Táº¡o map Ä‘á»ƒ tra cá»©u
            cookie_map = {c['name']: c['value'] for c in all_cookies}
            
            # 3. GhÃ©p chuá»—i string
            cookie_parts = []
            for key in target_keys:
                if key in cookie_map:
                    cookie_parts.append(f"{key}={cookie_map[key]}")
            
            # Táº¡o chuá»—i káº¿t quáº£ (náº¿u cÃ³ dá»¯ liá»‡u)
            if cookie_parts:
                cookie_string = "; ".join(cookie_parts) + ";"
            else:
                cookie_string = ""

            # 4. LÆ°u vÃ o settings.json theo Ä‘Ãºng profile_id
            try:
                if not SETTINGS_PATH.exists():
                    print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y settings.json: {SETTINGS_PATH}")
                    return cookie_string

                with SETTINGS_PATH.open("r", encoding="utf-8") as f:
                    raw = json.load(f)

                if not isinstance(raw, dict):
                    raw = {}

                profiles = raw.get("PROFILE_IDS")
                if profiles is None or isinstance(profiles, (list, str)):
                    profiles = {}
                if not isinstance(profiles, dict):
                    profiles = {}

                pid = str(self.profile_id or "").strip()
                if not pid:
                    print("âš ï¸ profile_id rá»—ng, khÃ´ng ghi vÃ o settings.json")
                    return cookie_string

                cfg = profiles.get(pid)
                if not isinstance(cfg, dict):
                    cfg = {}
                cfg["cookie"] = cookie_string
                profiles[pid] = cfg
                raw["PROFILE_IDS"] = profiles

                # ghi file
                with SETTINGS_PATH.open("w", encoding="utf-8") as f:
                    json.dump(raw, f, indent=2, ensure_ascii=False)
                    f.write("\n")

                print(f"âœ… ÄÃ£ cáº­p nháº­t cookie vÃ o settings.json cho profile_id={pid}")
            except Exception as e:
                print(f"âš ï¸ KhÃ´ng ghi Ä‘Æ°á»£c cookie vÃ o settings.json: {e}")

            return cookie_string
            
        except Exception as e:
            print(f"âŒ Lá»—i lÆ°u cookies: {e}")
            return None
        
    def process_post(self, post_handle, post_type):
        """
        post_type: 'green' (ads) | 'yellow' (normal)
        """
        viewport = self.page.viewport_size
        if viewport: height = viewport['height']
        else: height = 800 
        try:
            self.control_checkpoint("before_process_post")
            print(f"ðŸ§  Xá»­ lÃ½ bÃ i viáº¿t type={post_type}")

            # 1. Expand ná»™i dung
            expanded = self.page.evaluate(JS_EXPAND_SCRIPT, post_handle)
            if expanded > 0:
                print(f"ðŸ“– ÄÃ£ má»Ÿ {expanded} 'Xem thÃªm'")
                time.sleep(1.2)

            # 2. Check keyword (chung cho cáº£ ads & thÆ°á»ng)
            has_keyword = self.page.evaluate(
                JS_CHECK_AND_HIGHLIGHT_SCOPED,
                [post_handle, self.job_keywords]
            )

            if not has_keyword:
                print("âŒ KhÃ´ng cÃ³ keyword -> skip bÃ i")

                # 1. ÄÃ¡nh dáº¥u Ä‘Ã£ xá»­ lÃ½
                self.mark_post_as_processed(post_handle)

                # 2. ðŸš¨ Äáº¨Y POST RA KHá»ŽI VIEWPORT (QUAN TRá»ŒNG)
                try:
                    viewport = self.page.viewport_size
                    height = viewport['height'] if viewport else 800
                    self.page.mouse.wheel(0, height * 0.4)
                except Exception as e:
                    error_msg = str(e).lower()
                    if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                        raise RuntimeError("BROWSER_CLOSED") from e
                    pass

                return False

            print("âœ… CÃ³ keyword")

            # 2b. Náº¿u user nháº­p text (Setting profile -> QuÃ©t bÃ i viáº¿t) thÃ¬ báº¯t buá»™c
            # bÃ i pháº£i cÃ³ Ã­t nháº¥t 1 trong cÃ¡c tá»«/cá»¥m tá»« Ä‘Ã³ (lá»c giá»‘ng NuÃ´i acc).
            if getattr(self, "user_keywords", None):
                try:
                    has_user_text = self.page.evaluate(
                        JS_CHECK_AND_HIGHLIGHT_SCOPED,
                        [post_handle, self.user_keywords]
                    )
                except Exception:
                    has_user_text = False
                if not has_user_text:
                    print("âŒ KhÃ´ng Ä‘áº¡t text nháº­p -> skip bÃ i")

                    # ÄÃ¡nh dáº¥u Ä‘Ã£ xá»­ lÃ½ + Ä‘áº©y ra khá»i view
                    self.mark_post_as_processed(post_handle)
                    try:
                        viewport = self.page.viewport_size
                        height = viewport['height'] if viewport else 800
                        self.page.mouse.wheel(0, height * 0.4)
                    except Exception as e:
                        error_msg = str(e).lower()
                        if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                            raise RuntimeError("BROWSER_CLOSED") from e
                        pass
                    return False

            # 3. Like
            self.like_current_post(post_handle)
            self.control_checkpoint("after_like")

            # 4. Share Ä‘á»ƒ báº¯t ID
            ok = self.share_center_ad(post_handle, post_type)
            self.control_checkpoint("after_share")
            if not ok:
                self.mark_post_as_processed(post_handle)
                print("âš ï¸ KhÃ´ng báº¯t Ä‘Æ°á»£c ID -> skip")
                return False
            # 5. LÆ°u ID + flag

            # 6. Mark processed
            self.mark_post_as_processed(post_handle)
            

            return True

        except Exception as e:
            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                raise
            print(f"âŒ Lá»—i process_post: {e}")
            return False

    def check_post_is_processed(self, post_handle):
        """Kiá»ƒm tra attribute data-bot-processed Ä‘á»ƒ trÃ¡nh quÃ©t láº¡i"""
        try:
            return post_handle.evaluate("(post) => post.getAttribute('data-bot-processed') === 'true'")
        except:
            return False
    
    def bring_element_into_view_smooth(self, element):
        """
        Kiá»ƒm tra element (nÃºt Share) cÃ³ trong mÃ n hÃ¬nh khÃ´ng.
        Náº¿u khÃ´ng, cuá»™n chuá»™t nháº¹ nhÃ ng tá»›i nÃ³ (KhÃ´ng dÃ¹ng scroll_into_view gÃ¢y giáº­t).
        """
        try:
            box = element.bounding_box()
            if not box: return False # Element chÆ°a render

            viewport = self.page.viewport_size
            vh = None
            try:
                if viewport and isinstance(viewport, dict):
                    vh = viewport.get('height')
            except Exception:
                vh = None

            # Fallback: Ä‘Ã´i khi connect qua CDP => viewport_size = None
            if not vh:
                try:
                    vh = self.page.evaluate("() => window.innerHeight") or 800
                except Exception:
                    vh = 800
            
            # Tá»a Ä‘á»™ Y cá»§a element so vá»›i Ä‘á»‰nh mÃ n hÃ¬nh hiá»‡n táº¡i
            element_y = box['y']
            element_height = box['height']

            # Kiá»ƒm tra: NÃºt cÃ³ náº±m lá»t thá»m trong mÃ n hÃ¬nh khÃ´ng?
            # (Cho phÃ©p lá» trÃªn 100px, lá» dÆ°á»›i 100px Ä‘á»ƒ cháº¯c cháº¯n click Ä‘Æ°á»£c)
            is_in_view = (element_y > 100) and (element_y + element_height < vh - 100)

            if is_in_view:
                return True # Äang Ä‘áº¹p rá»“i, khÃ´ng cáº§n cuá»™n

            # Náº¿u nÃºt náº±m dÆ°á»›i Ä‘Ã¡y mÃ n hÃ¬nh -> Cáº§n cuá»™n xuá»‘ng
            if element_y > vh - 100:
                # TÃ­nh khoáº£ng cÃ¡ch cáº§n cuá»™n: ÄÆ°a nÃºt lÃªn vá»‹ trÃ­ khoáº£ng 70% mÃ n hÃ¬nh
                scroll_distance = element_y - (vh * 0.7)
                print(f"    -> ðŸ”½ NÃºt Share bá»‹ che, cuá»™n xuá»‘ng {int(scroll_distance)}px")
                
                # Cuá»™n mÆ°á»£t
                self.page.mouse.wheel(0, scroll_distance)
                time.sleep(0.5) # Chá» render láº¡i
                return True
            
            return True
        except Exception as e:
            # Log nháº¹ Ä‘á»ƒ khÃ´ng spam, lá»—i thÆ°á»ng do viewport null / element detach
            print(f"âš ï¸ Lá»—i tÃ­nh toÃ¡n cuá»™n: {e}")
            return False

    def scroll_past_post(self, post_handle):
        """
        Cuá»™n qua bÃ i viáº¿t hiá»‡n táº¡i má»™t cÃ¡ch thÃ´ng minh.
        - BÃ i ngáº¯n: Cuá»™n Ã­t.
        - BÃ i dÃ i: Cuá»™n nhiá»u.
        -> TrÃ¡nh viá»‡c dÃ¹ng PageDown bá»‹ trÃ´i bÃ i.
        """
        try:
            box = post_handle.bounding_box()
            if not box:
                # Fallback náº¿u khÃ´ng láº¥y Ä‘Æ°á»£c kÃ­ch thÆ°á»›c -> DÃ¹ng PageDown
                self.page.keyboard.press("PageDown")
                return

            post_height = box['height']
            post_y = box['y']
            
            # Chiáº¿n thuáº­t: Cuá»™n sao cho ÄÃY bÃ i viáº¿t hiá»‡n táº¡i trÃ´i lÃªn mÃ©p trÃªn mÃ n hÃ¬nh
            # Cá»™ng thÃªm 50px padding Ä‘á»ƒ tÃ¡ch biá»‡t bÃ i sau
            scroll_distance = post_y + post_height + 50
            
            # Náº¿u khoáº£ng cÃ¡ch quÃ¡ lá»›n (bÃ i siÃªu dÃ i), chia nhá» ra cuá»™n cho Ä‘á»¡ sá»‘c
            if scroll_distance > 2000:
                steps = 3
                step_dist = scroll_distance / steps
                for _ in range(steps):
                    self.page.mouse.wheel(0, step_dist)
                    time.sleep(0.1)
            else:
                self.page.mouse.wheel(0, scroll_distance)
                
            print(f"    -> ðŸ“‰ ÄÃ£ cuá»™n qua bÃ i (height={int(post_height)}px)")
            time.sleep(1) # Chá» bÃ i má»›i load

        except Exception as e:
            print(f"âš ï¸ Lá»—i scroll_past_post: {e}")
            self.page.keyboard.press("PageDown")
--- END FILE: backend\core\browser.py ---

--- START FILE: backend\core\control.py ---
import json
import threading
import time
from dataclasses import dataclass
from datetime import datetime, timezone
from pathlib import Path
from typing import Any, Dict, Optional, Tuple


BASE_DIR = Path(__file__).resolve().parents[1]  # backend/
CONTROL_STATE_PATH = BASE_DIR / "data" / "runtime_control.json"

_lock = threading.Lock()


def _now_iso() -> str:
    return datetime.now(timezone.utc).isoformat()


def _atomic_write_json(path: Path, data: Dict[str, Any]) -> None:
    path.parent.mkdir(parents=True, exist_ok=True)
    tmp = path.with_suffix(".tmp")
    with tmp.open("w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
        f.write("\n")
    tmp.replace(path)


def _default_state() -> Dict[str, Any]:
    return {
        "global_emergency_stop": False,
        "global_pause": False,
        "paused_profiles": [],
        "stopped_profiles": [],  # STOP theo profile (dá»«ng ngay profile Ä‘Ã³)
        "profile_states": {},  # {profile_id: RUNNING|PAUSED|STOPPED|ERROR}
        "updated_at": _now_iso(),
    }


def load_state() -> Dict[str, Any]:
    """
    Äá»c state tá»« file runtime_control.json.
    Best-effort: náº¿u file lá»—i/khÃ´ng tá»“n táº¡i -> tráº£ default.
    """
    try:
        if not CONTROL_STATE_PATH.exists():
            return _default_state()
        with CONTROL_STATE_PATH.open("r", encoding="utf-8") as f:
            raw = json.load(f)
        if not isinstance(raw, dict):
            return _default_state()
        # Merge default keys Ä‘á»ƒ trÃ¡nh thiáº¿u field
        base = _default_state()
        base.update(raw)
        # normalize
        if not isinstance(base.get("paused_profiles"), list):
            base["paused_profiles"] = []
        if not isinstance(base.get("stopped_profiles"), list):
            base["stopped_profiles"] = []
        if not isinstance(base.get("profile_states"), dict):
            base["profile_states"] = {}
        base["updated_at"] = _now_iso()
        return base
    except Exception:
        return _default_state()


def save_state(state: Dict[str, Any]) -> None:
    state = dict(state or {})
    state.setdefault("paused_profiles", [])
    state.setdefault("stopped_profiles", [])
    state.setdefault("profile_states", {})
    state["updated_at"] = _now_iso()
    _atomic_write_json(CONTROL_STATE_PATH, state)


def get_state() -> Dict[str, Any]:
    with _lock:
        return load_state()


def _update(mutator) -> Dict[str, Any]:
    with _lock:
        st = load_state()
        mutator(st)
        save_state(st)
        return st


def reset_all_state() -> Dict[str, Any]:
    """
    Reset toÃ n bá»™ runtime state vá» máº·c Ä‘á»‹nh (Sáº´N SÃ€NG).
    DÃ¹ng cho STOP kiá»ƒu "fresh start".
    """
    def _m(st: Dict[str, Any]) -> None:
        st.clear()
        st.update(_default_state())
    return _update(_m)


def set_global_emergency_stop(value: bool) -> Dict[str, Any]:
    def _m(st: Dict[str, Any]) -> None:
        st["global_emergency_stop"] = bool(value)
        if value:
            # Khi STOP ALL: clear pause + Ä‘Æ°a táº¥t cáº£ profile_states vá» STOPPED Ä‘á»ƒ trÃ¡nh "RUNNING" rÃ¡c
            st["global_pause"] = False
            st["paused_profiles"] = []
            ps = st.get("profile_states")
            if not isinstance(ps, dict):
                ps = {}
            for k in list(ps.keys()):
                ps[k] = "STOPPED"
            st["profile_states"] = ps

    return _update(_m)


def set_global_pause(value: bool) -> Dict[str, Any]:
    def _m(st: Dict[str, Any]) -> None:
        st["global_pause"] = bool(value)

    return _update(_m)


def reset_emergency_stop(*, clear_stopped_profiles: bool = False) -> Dict[str, Any]:
    """
    Reset GLOBAL_EMERGENCY_STOP vá» false Ä‘á»ƒ há»‡ thá»‘ng cháº¡y láº¡i Ä‘Æ°á»£c.
    Optionally clear stopped_profiles (Ä‘á»ƒ profile khÃ´ng bá»‹ giá»¯ STOPPED).
    """
    def _m(st: Dict[str, Any]) -> None:
        st["global_emergency_stop"] = False
        if clear_stopped_profiles:
            st["stopped_profiles"] = []
            # khÃ´ng force Ä‘á»•i profile_states náº¿u caller muá»‘n giá»¯ audit;
            # nhÆ°ng náº¿u Ä‘ang STOPPED mÃ  clear_stopped_profiles thÃ¬ set RUNNING Ä‘á»ƒ dá»… hiá»ƒu.
            ps = st.get("profile_states")
            if isinstance(ps, dict):
                for k in list(ps.keys()):
                    if str(ps.get(k) or "").upper() == "STOPPED":
                        ps[k] = "RUNNING"

    return _update(_m)


def pause_profile(profile_id: str) -> Dict[str, Any]:
    pid = str(profile_id or "").strip()
    if not pid:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        paused = set([str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()])
        paused.add(pid)
        st["paused_profiles"] = sorted(paused)
        # pause khÃ´ng tá»± clear STOP; náº¿u Ä‘ang STOP thÃ¬ váº«n STOP
        # state chá»‰ lÃ  "Ä‘á»‹nh danh", process tháº­t sá»± sáº½ tá»± update theo loop
        st.setdefault("profile_states", {})
        st["profile_states"][pid] = "PAUSED"

    return _update(_m)


def resume_profile(profile_id: str) -> Dict[str, Any]:
    pid = str(profile_id or "").strip()
    if not pid:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        paused = [str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()]
        paused = [x for x in paused if x != pid]
        st["paused_profiles"] = paused
        # resume sáº½ clear STOP theo profile (Ä‘á»ƒ cháº¡y láº¡i Ä‘Æ°á»£c)
        stopped = [str(x).strip() for x in (st.get("stopped_profiles") or []) if str(x).strip()]
        stopped = [x for x in stopped if x != pid]
        st["stopped_profiles"] = stopped
        st.setdefault("profile_states", {})
        st["profile_states"][pid] = "RUNNING"

    return _update(_m)


def stop_profiles(profile_ids: list[str]) -> Dict[str, Any]:
    """
    STOP theo profile: add vÃ o stopped_profiles + set state STOPPED.
    """
    ids = []
    for x in (profile_ids or []):
        s = str(x or "").strip()
        if s:
            ids.append(s)

    if not ids:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        stopped = set([str(x).strip() for x in (st.get("stopped_profiles") or []) if str(x).strip()])
        for pid in ids:
            stopped.add(pid)
        st["stopped_profiles"] = sorted(stopped)
        # remove khá»i paused Ä‘á»ƒ trÃ¡nh state mÃ¢u thuáº«n
        paused = [str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()]
        paused = [p for p in paused if p not in stopped]
        st["paused_profiles"] = paused
        st.setdefault("profile_states", {})
        for pid in ids:
            st["profile_states"][pid] = "STOPPED"

    return _update(_m)


def pause_profiles(profile_ids: list[str]) -> Dict[str, Any]:
    ids = []
    for x in (profile_ids or []):
        s = str(x or "").strip()
        if s:
            ids.append(s)
    if not ids:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        paused = set([str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()])
        for pid in ids:
            paused.add(pid)
        st["paused_profiles"] = sorted(paused)
        st.setdefault("profile_states", {})
        for pid in ids:
            # náº¿u profile Ä‘ang STOPPED thÃ¬ giá»¯ STOPPED
            cur = str(st["profile_states"].get(pid) or "").upper()
            if cur != "STOPPED":
                st["profile_states"][pid] = "PAUSED"

    return _update(_m)


def resume_profiles(profile_ids: list[str]) -> Dict[str, Any]:
    ids = []
    for x in (profile_ids or []):
        s = str(x or "").strip()
        if s:
            ids.append(s)
    if not ids:
        return get_state()

    def _m(st: Dict[str, Any]) -> None:
        paused = [str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()]
        paused = [p for p in paused if p not in set(ids)]
        st["paused_profiles"] = paused
        # resume cÅ©ng clear STOP theo profile (Ä‘á»ƒ profile cháº¡y láº¡i Ä‘Æ°á»£c)
        stopped = [str(x).strip() for x in (st.get("stopped_profiles") or []) if str(x).strip()]
        stopped = [p for p in stopped if p not in set(ids)]
        st["stopped_profiles"] = stopped
        st.setdefault("profile_states", {})
        for pid in ids:
            st["profile_states"][pid] = "RUNNING"

    return _update(_m)


def set_profile_state(profile_id: str, state: str) -> Dict[str, Any]:
    pid = str(profile_id or "").strip()
    if not pid:
        return get_state()
    s = str(state or "").strip().upper()
    if s not in {"RUNNING", "PAUSED", "STOPPED", "ERROR"}:
        s = "ERROR"

    def _m(st: Dict[str, Any]) -> None:
        st.setdefault("profile_states", {})
        st["profile_states"][pid] = s

    return _update(_m)


def check_flags(profile_id: Optional[str] = None) -> Tuple[bool, bool, str]:
    """
    Return: (emergency_stop, paused, pause_reason)
    Priority:
      1) emergency_stop
      2) global_pause
      3) paused_profiles[pid]
    """
    st = get_state()
    if bool(st.get("global_emergency_stop")):
        return True, False, "GLOBAL_EMERGENCY_STOP"

    pid = str(profile_id or "").strip()

    # STOP theo profile (Æ°u tiÃªn hÆ¡n pause)
    stopped_set = set([str(x).strip() for x in (st.get("stopped_profiles") or []) if str(x).strip()])
    if pid and pid in stopped_set:
        return True, False, "STOPPED_PROFILE"

    if bool(st.get("global_pause")):
        return False, True, "GLOBAL_PAUSE"

    paused_set = set([str(x).strip() for x in (st.get("paused_profiles") or []) if str(x).strip()])
    if pid and pid in paused_set:
        return False, True, "PAUSED_PROFILE"

    return False, False, ""


def wait_if_paused(profile_id: Optional[str], sleep_seconds: float = 0.5) -> None:
    """
    Náº¿u PAUSE -> sleep + check flag liÃªn tá»¥c.
    Náº¿u emergency_stop -> raise RuntimeError Ä‘á»ƒ caller thoÃ¡t ngay.
    """
    pid = str(profile_id or "").strip()
    while True:
        stop, paused, _reason = check_flags(pid)
        if stop:
            raise RuntimeError("EMERGENCY_STOP")
        if not paused:
            return
        time.sleep(max(0.2, float(sleep_seconds)))



--- END FILE: backend\core\control.py ---

--- START FILE: backend\core\join_groups.py ---
import sys
import os
import json
import time
import random
import re
from pathlib import Path

# --- SETUP ÄÆ¯á»œNG DáºªN Äá»‚ IMPORT CORE ---
current_dir = os.path.dirname(os.path.abspath(__file__))
parent_dir = os.path.dirname(current_dir)
sys.path.append(parent_dir)

from core.nst import connect_profile
from core.nst import stop_profile
from core.browser import FBController
from core import control as control_state

# Worker láº¥y page_id/post_id tá»« URL (dÃ¹ng cookie theo profile_id trong settings.json)
try:
    from worker.get_id import get_id_from_url
except Exception:
    try:
        from get_id import get_id_from_url
    except Exception:
        get_id_from_url = None

# LÆ°u mapping group -> page_id theo profile_id
GROUPS_JSON_PATH = Path(parent_dir) / "config" / "groups.json"
GROUPS_LOCK_PATH = Path(str(GROUPS_JSON_PATH) + ".lock")


def _normalize_group_url(raw: str) -> str:
    s = str(raw or "").strip()
    if not s:
        return ""
    if re.match(r"^https?://", s, flags=re.IGNORECASE):
        return s
    if s.lower().startswith("facebook.com/") or s.lower().startswith("www.facebook.com/"):
        return "https://" + s
    if "/groups/" in s:
        if s.startswith("/"):
            return "https://www.facebook.com" + s
        return "https://www.facebook.com/" + s.lstrip("/")
    return f"https://www.facebook.com/groups/{s}"


def _acquire_groups_lock(timeout_seconds: float = 60.0, poll: float = 0.1):
    """
    Lock file Ä‘Æ¡n giáº£n (cross-platform): táº¡o file .lock báº±ng O_EXCL Ä‘á»ƒ chá»‘ng ghi Ä‘Ã¨ khi nhiá»u process cÃ¹ng ghi.
    """
    start = time.time()
    while True:
        try:
            fd = os.open(str(GROUPS_LOCK_PATH), os.O_CREAT | os.O_EXCL | os.O_RDWR)
            return fd
        except FileExistsError:
            # timeout_seconds <= 0 => chá» vÃ´ háº¡n
            if timeout_seconds and timeout_seconds > 0 and (time.time() - start >= timeout_seconds):
                return None
            time.sleep(poll)
        except Exception:
            return None


def _release_groups_lock(fd) -> None:
    try:
        if fd is not None:
            try:
                os.close(fd)
            except Exception:
                pass
        try:
            if GROUPS_LOCK_PATH.exists():
                GROUPS_LOCK_PATH.unlink()
        except Exception:
            pass
    except Exception:
        pass


def _read_groups_json() -> dict:
    try:
        if not GROUPS_JSON_PATH.exists():
            return {}
        raw = GROUPS_JSON_PATH.read_text(encoding="utf-8").strip()
        if not raw:
            return {}
        data = json.loads(raw)
        return data if isinstance(data, dict) else {}
    except Exception:
        return {}


def _write_groups_json(data: dict) -> None:
    GROUPS_JSON_PATH.parent.mkdir(parents=True, exist_ok=True)
    tmp = Path(str(GROUPS_JSON_PATH) + ".tmp")
    tmp.write_text(json.dumps(data, indent=2, ensure_ascii=False) + "\n", encoding="utf-8")
    os.replace(str(tmp), str(GROUPS_JSON_PATH))


def save_group_page_id(profile_id: str, page_id: str, url_page: str) -> bool:
    """
    LÆ°u vÃ o backend/config/groups.json theo format:
    {
      "<profile_id>": [
        {"page_id": "...", "url_page": "..."}
      ]
    }
    """
    pid = str(profile_id or "").strip()
    pg = str(page_id or "").strip()
    urlp = str(url_page or "").strip()
    if not pid or not pg or not urlp:
        return False

    fd = _acquire_groups_lock()
    if fd is None:
        # KhÃ´ng cÃ³ lock => khÃ´ng ghi Ä‘á»ƒ trÃ¡nh race condition khi cháº¡y Ä‘a process
        print(f"âš ï¸ [groups.json] KhÃ´ng láº¥y Ä‘Æ°á»£c lock trong thá»i gian chá» -> bá» qua ghi (profile_id={pid})")
        return False
    try:
        data = _read_groups_json()
        arr = data.get(pid)
        if not isinstance(arr, list):
            arr = []

        # chá»‘ng trÃ¹ng theo page_id
        updated = False
        for item in arr:
            if isinstance(item, dict) and str(item.get("page_id") or "").strip() == pg:
                item["url_page"] = urlp
                updated = True
                break

        if not updated:
            arr.append({"page_id": pg, "url_page": urlp})

        data[pid] = arr
        _write_groups_json(data)
        return True
    finally:
        _release_groups_lock(fd)

class GroupJoiner(FBController):
    """
    Class chuyÃªn dá»¥ng Ä‘á»ƒ Ä‘i xin vÃ o nhÃ³m
    """
    def join_group(self, group_id):
        # STOP/PAUSE checkpoint
        try:
            self.control_checkpoint("join_group_start")
        except RuntimeError:
            raise
        raw = str(group_id or "").strip()
        if not raw:
            print("âš ï¸ group rá»—ng, bá» qua")
            return False

        url = _normalize_group_url(raw)
        print(f"\nðŸš€ Äang truy cáº­p nhÃ³m: {group_id}")
        print(f"ðŸ”— Link: {url}")
        
        try:
            self.control_checkpoint("before_goto_group")
            self.goto(url)
            time.sleep(random.uniform(3, 5)) # Chá» load trang

            # 1. Kiá»ƒm tra xem Ä‘Ã£ tham gia chÆ°a
            is_joined = self.page.query_selector('div[aria-label="ÄÃ£ tham gia"], div[aria-label="Má»i"]')
            if is_joined:
                print(f"âœ… [SKIP] ÄÃ£ lÃ  thÃ nh viÃªn cá»§a nhÃ³m {group_id}")
                # coi nhÆ° "thÃ nh cÃ´ng" Ä‘á»ƒ váº«n láº¥y page_id vÃ  lÆ°u groups.json
                return True

            # 2. TÃ¬m nÃºt "Tham gia nhÃ³m"
            join_btn_selector = 'div[aria-label="Tham gia nhÃ³m"][role="button"]'
            join_btn = self.page.query_selector(join_btn_selector)

            if not join_btn:
                join_btn = self.page.get_by_text("Tham gia nhÃ³m", exact=True).first
            
            if join_btn:
                print("point ðŸ‘‰ TÃ¬m tháº¥y nÃºt 'Tham gia nhÃ³m'. Äang click...")
                self.control_checkpoint("before_click_join_group")
                join_btn.click()
                
                # ======================================================
                # [Má»šI] áº¤N ESC 2 Láº¦N Äá»‚ Táº®T POPUP CÃ‚U Há»ŽI / Ná»˜I QUY
                # ======================================================
                # Thay sleep cá»©ng báº±ng auto-wait popup/dialog
                # ======================================================
                try:
                    # Chá» popup dialog (náº¿u cÃ³) rá»“i Ä‘Ã³ng
                    self.page.wait_for_selector('div[role="dialog"]', timeout=3000)
                    self.page.keyboard.press("Escape")
                except:
                    pass
                
                try:
                    # Chá» UI cáº­p nháº­t sau khi Ä‘Ã³ng popup (khÃ´ng sleep cá»©ng)
                    self.page.wait_for_timeout(800)
                except:
                    pass
                
                # 3. Kiá»ƒm tra láº¡i tráº¡ng thÃ¡i
                # Náº¿u nÃºt chuyá»ƒn thÃ nh "Há»§y yÃªu cáº§u" hoáº·c "ÄÃ£ tham gia" -> ThÃ nh cÃ´ng
                check_success = None
                try:
                    # chá» UI cáº­p nháº­t tá»‘i Ä‘a 6s (Ä‘á»¡ sai do load cháº­m)
                    self.page.wait_for_selector('div[aria-label="Há»§y yÃªu cáº§u"], div[aria-label="ÄÃ£ tham gia"]', timeout=6000)
                    check_success = self.page.query_selector('div[aria-label="Há»§y yÃªu cáº§u"], div[aria-label="ÄÃ£ tham gia"]')
                except Exception:
                    check_success = self.page.query_selector('div[aria-label="Há»§y yÃªu cáº§u"], div[aria-label="ÄÃ£ tham gia"]')

                if check_success:
                    print(f"âœ… ÄÃ£ gá»­i yÃªu cáº§u tham gia / Ä‘Ã£ tham gia: {group_id}")
                    return True

                # Náº¿u váº«n chÆ°a tháº¥y Ä‘á»•i tráº¡ng thÃ¡i -> coi lÃ  chÆ°a join thÃ nh cÃ´ng (thÆ°á»ng do cÃ¢u há»i báº¯t buá»™c)
                print(f"âš ï¸ Click join nhÆ°ng chÆ°a tháº¥y Ä‘á»•i tráº¡ng thÃ¡i (cÃ³ thá»ƒ cáº§n tráº£ lá»i cÃ¢u há»i): {group_id}")
                return False
            else:
                print(f"âŒ KhÃ´ng tÃ¬m tháº¥y nÃºt tham gia (CÃ³ thá»ƒ nhÃ³m kÃ­n, bá»‹ cháº·n, hoáº·c layout khÃ¡c).")
                return False

        except Exception as e:
            if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                raise
            print(f"âŒ Lá»—i khi xá»­ lÃ½ nhÃ³m {group_id}: {e}")
            return False

def run_batch_join_from_list(profile_id, group_ids):
    """
    Cháº¡y join group cho 1 profile vá»›i danh sÃ¡ch group truyá»n trá»±c tiáº¿p (list).
    DÃ¹ng cho API (Ä‘a luá»“ng/Ä‘a process).
    """
    try:
        items = list(group_ids or [])
    except Exception:
        items = []

    # Clean
    cleaned = []
    for gid in items:
        s = str(gid or "").strip()
        if s:
            cleaned.append(s)

    if not cleaned:
        print("âš ï¸ Danh sÃ¡ch group rá»—ng.")
        return

    print(f"ðŸ“‹ TÃ¬m tháº¥y {len(cleaned)} nhÃ³m cáº§n tham gia.")

    # 2. Káº¿t ná»‘i Profile
    try:
        # STOP/PAUSE checkpoint trÆ°á»›c connect
        stop, paused, reason = control_state.check_flags(profile_id)
        if stop:
            print(f"ðŸ›‘ [JOIN] EMERGENCY_STOP trÆ°á»›c khi connect ({reason})")
            return
        if paused:
            print(f"â¸ï¸ [JOIN] PAUSED trÆ°á»›c khi connect ({reason})")
            control_state.wait_if_paused(profile_id, sleep_seconds=0.5)

        print(f"ðŸ”Œ Äang káº¿t ná»‘i profile {profile_id}...")
        ws_url = connect_profile(profile_id)
        fb = GroupJoiner(ws_url)
        fb.profile_id = profile_id
        fb.connect()
        
        # 3. Cháº¡y vÃ²ng láº·p
        for idx, gid in enumerate(cleaned):
            # STOP/PAUSE checkpoint trÆ°á»›c má»—i group
            stop, paused, reason = control_state.check_flags(profile_id)
            if stop:
                print(f"ðŸ›‘ [JOIN] {profile_id} EMERGENCY_STOP ({reason}) -> dá»«ng")
                break
            if paused:
                print(f"â¸ï¸ [JOIN] {profile_id} PAUSED ({reason}) -> sleep")
                control_state.wait_if_paused(profile_id, sleep_seconds=0.5)

            # 3a) Join group (hoáº·c skip náº¿u Ä‘Ã£ join)
            url = _normalize_group_url(gid)
            joined_ok = False
            try:
                joined_ok = bool(fb.join_group(url))
            except Exception as e:
                if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                    raise
                print(f"âš ï¸ Lá»—i join_group: {e}")
                joined_ok = False

            # 3b) Chá»‰ khi join thÃ nh cÃ´ng/Ä‘Ã£ lÃ  member -> láº¥y page_id vÃ  lÆ°u groups.json
            if joined_ok and get_id_from_url and url:
                try:
                    fb.control_checkpoint("before_get_id_from_url_group")
                    res = get_id_from_url(url, profile_id)
                    if isinstance(res, dict) and res.get("url_type") == "group":
                        page_id = str(res.get("page_id") or "").strip()
                        if page_id:
                            ok = save_group_page_id(profile_id, page_id, url)
                            if ok:
                                print(f"ðŸ’¾ ÄÃ£ lÆ°u group: profile_id={profile_id} page_id={page_id}")
                            else:
                                print(f"âš ï¸ KhÃ´ng lÆ°u Ä‘Æ°á»£c groups.json (profile_id={profile_id}, page_id={page_id})")
                except Exception as e:
                    if isinstance(e, RuntimeError) and ("EMERGENCY_STOP" in str(e) or "BROWSER_CLOSED" in str(e)):
                        raise
                    print(f"âš ï¸ Lá»—i get_id_from_url khi join group: {e}")
            
            # Nghá»‰ ngáº«u nhiÃªn (trá»« khi lÃ  group cuá»‘i)
            if idx < len(cleaned) - 1:
                sleep_time = random.uniform(10, 20) 
                print(f"ðŸ’¤ Nghá»‰ {sleep_time:.1f}s trÆ°á»›c khi qua nhÃ³m tiáº¿p theo...")
                # sleep theo chunk Ä‘á»ƒ váº«n stop/pause Ä‘Æ°á»£c ngay
                slept = 0.0
                while slept < sleep_time:
                    stop, paused, reason = control_state.check_flags(profile_id)
                    if stop:
                        print(f"ðŸ›‘ [JOIN] {profile_id} EMERGENCY_STOP trong sleep ({reason}) -> dá»«ng")
                        raise RuntimeError("EMERGENCY_STOP")
                    if paused:
                        control_state.wait_if_paused(profile_id, sleep_seconds=0.5)
                    time.sleep(0.5)
                    slept += 0.5
            
    except Exception as e:
        print(f"âŒ Lá»—i káº¿t ná»‘i/browser: {e}")
    finally:
        print("ðŸ HoÃ n táº¥t danh sÃ¡ch.")
        # ÄÃ³ng sáº¡ch tab/context playwright + stop NST profile (best-effort)
        try:
            if 'fb' in locals() and fb:
                try:
                    if getattr(fb, "page", None):
                        try:
                            fb.page.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "browser", None) and getattr(fb.browser, "contexts", None):
                        for ctx in list(fb.browser.contexts):
                            try:
                                ctx.close()
                            except Exception:
                                pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "browser", None):
                        try:
                            fb.browser.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "play", None):
                        try:
                            fb.play.stop()
                        except Exception:
                            pass
                except Exception:
                    pass
        finally:
            try:
                stop_profile(profile_id)
            except Exception:
                pass

def run_batch_join(profile_id, json_file_path):
    # 1. Äá»c file JSON
    try:
        with open(json_file_path, "r", encoding="utf-8") as f:
            group_ids = json.load(f)
        
        if not group_ids:
            print("âš ï¸ File JSON rá»—ng.")
            return
            
        print(f"ðŸ“‹ TÃ¬m tháº¥y {len(group_ids)} nhÃ³m cáº§n tham gia.")
        
    except Exception as e:
        print(f"âŒ Lá»—i Ä‘á»c file JSON: {e}")
        return

    run_batch_join_from_list(profile_id, group_ids)

if __name__ == "__main__":
    # --- Cáº¤U HÃŒNH ---
    MY_PROFILE_ID = "621e1f5d-0c42-481e-9ddd-7abaafce68ed" 
    JSON_PATH = os.path.join(parent_dir, "data", "groups.json")
    
    run_batch_join(MY_PROFILE_ID, JSON_PATH)
--- END FILE: backend\core\join_groups.py ---

--- START FILE: backend\core\nst.py ---
import requests
import json
import urllib.parse  # Cáº§n cÃ¡i nÃ y Ä‘á»ƒ mÃ£ hÃ³a User-Agent cÃ³ dáº¥u cÃ¡ch
from typing import Optional, Any

from core.settings import reload_settings

def _get_runtime_settings():
    """
    NST API key/headless cÃ³ thá»ƒ Ä‘á»•i trong lÃºc backend Ä‘ang cháº¡y.
    VÃ¬ get_settings() cÃ³ cache, dÃ¹ng reload_settings() Ä‘á»ƒ láº¥y giÃ¡ trá»‹ má»›i nháº¥t.
    """
    try:
        return reload_settings()
    except Exception:
        # fallback: váº«n cá»‘ Ä‘á»c cache náº¿u reload lá»—i
        from core.settings import get_settings
        return get_settings()
NST_BASE_URLS = [
    "http://127.0.0.1:8848/api/v2",
    "http://127.0.0.1:8848/api/v1",
    "http://127.0.0.1:8848/api",
]


def _nst_request(method: str, path: str, timeout: int = 15, headers: Optional[dict] = None, data: Optional[Any] = None) -> Optional[Any]:
    """
    Gá»i NST local API. Tráº£ vá» JSON náº¿u parse Ä‘Æ°á»£c, None náº¿u lá»—i.
    """
    for base in NST_BASE_URLS:
        url = f"{base}{path}"
        try:
            print(f"      ðŸ”— Thá»­: {method} {url}")
            if data is not None:
                print(f"         â†’ Body: {data}")
            resp = requests.request(method, url, timeout=timeout, headers=headers, json=data if data is not None else None)
            print(f"         â†’ Status: {resp.status_code}")
            try:
                json_data = resp.json()
                print(f"         â†’ Response: {json_data}")
                return json_data
            except Exception as json_err:
                text_data = {"status_code": resp.status_code, "text": resp.text[:200]}
                print(f"         â†’ Response (khÃ´ng pháº£i JSON): {text_data}")
                return text_data
        except Exception as req_err:
            print(f"         âŒ Lá»—i request: {req_err}")
            continue
    print(f"      âš ï¸ KhÃ´ng endpoint nÃ o thÃ nh cÃ´ng cho {method} {path}")
    return None


def stop_profile(profile_id: str) -> bool:
    """
    Dá»«ng browser instance cá»§a profile báº±ng DELETE /api/v2/browsers/{profile_id}
    """
    pid = str(profile_id or "").strip()
    if not pid:
        print(f"   âš ï¸ [stop_profile] profile_id rá»—ng")
        return False

    print(f"   ðŸ” [stop_profile] Äang dá»«ng profile: {pid}")
    
    cfg = _get_runtime_settings()
    api_key = str(getattr(cfg, "api_key", "") or "").strip()
    hdr = {
        "x-api-key": api_key,
        "Content-Type": "application/json"
    } if api_key else {"Content-Type": "application/json"}
    
    # DÃ¹ng DELETE /browsers/{profile_id} (base URL Ä‘Ã£ cÃ³ /api/v2)
    path = f"/browsers/{pid}"
    
    print(f"   ðŸ“‹ API Key: {'CÃ³' if api_key else 'KhÃ´ng cÃ³'}")
    print(f"   ðŸ“‹ Endpoint: DELETE {path}")
    
    data = _nst_request("DELETE", path, headers=hdr)
    if not data:
        print(f"   âŒ [stop_profile] KhÃ´ng cÃ³ response tá»« NST")
        return False
    
    # Kiá»ƒm tra káº¿t quáº£
    if isinstance(data, dict):
        # Idempotent: náº¿u browser instance khÃ´ng tá»“n táº¡i thÃ¬ coi nhÆ° Ä‘Ã£ dá»«ng rá»“i
        msg_lower = str(data.get("msg") or data.get("message") or "").lower()
        if data.get("code") == 400 and "browser instance not found" in msg_lower:
            print(f"   âœ… [stop_profile] Browser Ä‘Ã£ Ä‘Ã³ng sáºµn / khÃ´ng tá»“n táº¡i (code=400). Coi nhÆ° thÃ nh cÃ´ng.")
            return True

        if data.get("err") is False:
            print(f"   âœ… [stop_profile] THÃ€NH CÃ”NG! err=False")
            return True
        status_lower = str(data.get("status", "")).lower()
        if status_lower in {"ok", "success", "stopped", "closed"}:
            print(f"   âœ… [stop_profile] THÃ€NH CÃ”NG! status={status_lower}")
            return True
        if data.get("code") in (0, 200):
            print(f"   âœ… [stop_profile] THÃ€NH CÃ”NG! code={data.get('code')}")
            return True
        print(f"   âš ï¸ [stop_profile] KhÃ´ng match Ä‘iá»u kiá»‡n thÃ nh cÃ´ng (err={data.get('err')}, status={data.get('status')}, code={data.get('code')})")
    else:
        print(f"   âš ï¸ [stop_profile] Response khÃ´ng pháº£i dict: {type(data)}")
    
    return False


def stop_all_browsers() -> bool:
    """
    ÄÃ³ng toÃ n bá»™ browser NST báº±ng DELETE /api/v2/browsers vá»›i body lÃ  array cÃ¡c profile_id.
    """
    print("   ðŸ” [stop_all_browsers] Báº¯t Ä‘áº§u Ä‘Ã³ng toÃ n bá»™ NST browser...")
    
    cfg = _get_runtime_settings()
    api_key = str(getattr(cfg, "api_key", "") or "").strip()
    hdr = {
        "x-api-key": api_key,
        "Content-Type": "application/json"
    } if api_key else {"Content-Type": "application/json"}
    
    print(f"   ðŸ“‹ API Key: {'CÃ³' if api_key else 'KhÃ´ng cÃ³'}")
    
    # Láº¥y danh sÃ¡ch profile_id tá»« settings
    try:
        from core.settings import get_settings
        settings = get_settings()
        profile_ids = []
        
        # Láº¥y tá»« PROFILE_IDS (cÃ³ thá»ƒ lÃ  dict hoáº·c list)
        profile_data = getattr(settings, "profile_ids", None)
        if isinstance(profile_data, dict):
            profile_ids = list(profile_data.keys())
        elif isinstance(profile_data, list):
            profile_ids = profile_data
        elif isinstance(profile_data, str):
            profile_ids = [p.strip() for p in profile_data.split(",") if p.strip()]
        
        profile_ids = [str(pid).strip() for pid in profile_ids if str(pid).strip()]
        
        if not profile_ids:
            print(f"   âš ï¸ [stop_all_browsers] KhÃ´ng tÃ¬m tháº¥y profile_id nÃ o trong settings")
            # Váº«n thá»­ gá»i vá»›i array rá»—ng
            profile_ids = []
    except Exception as e:
        print(f"   âš ï¸ [stop_all_browsers] Lá»—i khi láº¥y profile_ids: {e}")
        profile_ids = []
    
    print(f"   ðŸ“‹ Sá»‘ profile sáº½ Ä‘Ã³ng: {len(profile_ids)}")
    if profile_ids:
        print(f"   ðŸ“‹ Profile IDs: {profile_ids}")
    
    # DÃ¹ng DELETE /browsers vá»›i body lÃ  JSON array cÃ¡c profile_id (base URL Ä‘Ã£ cÃ³ /api/v2)
    path = "/browsers"
    payload = profile_ids  # requests sáº½ tá»± Ä‘á»™ng convert list thÃ nh JSON array
    
    print(f"   ðŸ“‹ Endpoint: DELETE {path}")
    print(f"   ðŸ“‹ Body: {payload}")
    
    data = _nst_request("DELETE", path, headers=hdr, data=payload)
    if not data:
        print(f"   âŒ [stop_all_browsers] KhÃ´ng cÃ³ response tá»« NST")
        return False
    
    # Kiá»ƒm tra káº¿t quáº£
    if isinstance(data, dict):
        # Idempotent: náº¿u khÃ´ng cÃ³ browser instance nÃ o thÃ¬ coi nhÆ° Ä‘Ã£ Ä‘Ã³ng háº¿t
        msg_lower = str(data.get("msg") or data.get("message") or "").lower()
        if data.get("code") == 400 and "browser instance not found" in msg_lower:
            print(f"   âœ… [stop_all_browsers] Browser Ä‘Ã£ Ä‘Ã³ng sáºµn / khÃ´ng tá»“n táº¡i (code=400). Coi nhÆ° thÃ nh cÃ´ng.")
            return True

        if data.get("err") is False:
            print(f"   âœ… [stop_all_browsers] THÃ€NH CÃ”NG! err=False")
            return True
        status_lower = str(data.get("status", "")).lower()
        if status_lower in {"ok", "success", "stopped", "closed"}:
            print(f"   âœ… [stop_all_browsers] THÃ€NH CÃ”NG! status={status_lower}")
            return True
        if data.get("code") in (0, 200):
            print(f"   âœ… [stop_all_browsers] THÃ€NH CÃ”NG! code={data.get('code')}")
            return True
        print(f"   âš ï¸ [stop_all_browsers] KhÃ´ng match Ä‘iá»u kiá»‡n thÃ nh cÃ´ng (err={data.get('err')}, status={data.get('status')}, code={data.get('code')})")
    else:
        print(f"   âš ï¸ [stop_all_browsers] Response khÃ´ng pháº£i dict: {type(data)}")
    
    return False

def connect_profile(profile_id: str):
    cfg = _get_runtime_settings()
    api_key = str(getattr(cfg, "api_key", "") or "").strip()
    headless = bool(getattr(cfg, "headless", False))
    # Cáº¥u hÃ¬nh chuáº©n theo JS máº«u: DÃ¹ng fingerprint Ä‘á»ƒ fake User-Agent
    # KHÃ”NG dÃ¹ng 'args' Ä‘á»ƒ trÃ¡nh bá»‹ hiá»‡n UI
    config = {
        "headless": headless,
        "autoClose": True,
        "fingerprint": {
            # User-Agent xá»‹n Ä‘á»ƒ qua máº·t Facebook
            "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",
            "hardwareConcurrency": 8,
            "deviceMemory": 8
        }
    }

    # MÃ£ hÃ³a config thÃ nh chuá»—i an toÃ n cho URL (vÃ¬ User-Agent cÃ³ dáº¥u cÃ¡ch)
    encoded_config = urllib.parse.quote(json.dumps(config))

    # Connect váº«n Æ°u tiÃªn v2 vÃ¬ Ä‘ang dÃ¹ng á»•n Ä‘á»‹nh
    url = f"http://127.0.0.1:8848/api/v2/connect/{profile_id}?x-api-key={api_key}&config={encoded_config}"

    print(f"ðŸš€ Má»Ÿ profile {profile_id} (headless={headless})")

    # Thá»­ káº¿t ná»‘i
    try:
        resp = requests.get(url, timeout=20)
        data = resp.json()

        if data.get("err"):
            # Tráº£ lá»—i rÃµ hÆ¡n Ä‘á»ƒ debug (profile khÃ´ng tá»“n táº¡i / api key sai / NST chÆ°a sáºµn sÃ ng)
            # NST thÆ°á»ng tráº£ key: {err: true, msg: "...", code: ...}
            msg = data.get("msg") or data.get("message") or data.get("error") or data.get("err")
            raise Exception(f"âŒ NST Error: {msg} | raw={data}")

        ws = data["data"]["webSocketDebuggerUrl"]
        print(f"ðŸ”Œ WebSocket: {ws}")
        return ws
        
    except Exception as e:
        print(f"âŒ Lá»—i káº¿t ná»‘i: {e}")
        raise e
--- END FILE: backend\core\nst.py ---

--- START FILE: backend\core\runner.py ---
import time  # [Cáº§n thÃªm thÆ° viá»‡n nÃ y Ä‘á»ƒ Ä‘áº¿m giá»]
from multiprocessing import Process
from typing import Optional, Sequence
from urllib.parse import quote_plus

from core.browser import FBController
from core.nst import connect_profile
from core.scraper import SimpleBot
from core.settings import get_settings
from core.utils import clean_profile_list
from core import control as control_state


class AppRunner:
    def __init__(
        self,
        run_minutes: Optional[int] = None,
        rest_minutes: Optional[int] = None,
        profile_ids: Optional[Sequence[str]] = None,
        text: Optional[str] = None,
        mode: Optional[str] = None,
    ):
        cfg = get_settings()
        self.target_url = cfg.target_url
        # Cho phÃ©p override danh sÃ¡ch profile tá»« API (/run) Ä‘á»ƒ khÃ´ng cháº¡y háº¿t.
        base_profiles = profile_ids if profile_ids is not None else cfg.profile_ids
        self.profiles = clean_profile_list(base_profiles)
        self.text = str(text or "").strip()
        self.mode = str(mode or "feed").strip().lower()
        if self.mode not in ("feed", "search"):
            self.mode = "feed"

        # Náº¿u lÃ  search => target_url sáº½ lÃ  trang search posts.
        # Váº«n dÃ¹ng core/browser.py Ä‘á»ƒ scan/like/share/báº¯t id.
        if self.mode == "search" and self.text:
            q = quote_plus(self.text)
            self.target_url = f"https://www.facebook.com/search/posts/?q={q}"

        # Æ¯u tiÃªn giÃ¡ trá»‹ truyá»n tá»« API; fallback cáº¥u hÃ¬nh; cuá»‘i cÃ¹ng lÃ  default.
        self.RUN_MINUTES = self._coerce_positive_int(
            run_minutes,
            cfg.run_minutes,
            default=30,
        )
        # REST_MINUTES máº·c Ä‘á»‹nh 120p (tÆ°Æ¡ng Ä‘Æ°Æ¡ng 2h nhÆ° cáº¥u hÃ¬nh cÅ©)
        self.REST_MINUTES = self._coerce_positive_int(
            rest_minutes,
            cfg.rest_minutes,
            default=120,
        )

    @staticmethod
    def _coerce_positive_int(value, fallback=None, default=0):
        """
        Tráº£ vá» sá»‘ nguyÃªn dÆ°Æ¡ng; náº¿u khÃ´ng há»£p lá»‡ dÃ¹ng fallback, cuá»‘i cÃ¹ng dÃ¹ng default.
        """
        for candidate in (value, fallback, default):
            try:
                num = int(candidate)
                if num > 0:
                    return num
            except (TypeError, ValueError):
                continue
        return default

    def worker(self, profile_id):
        """HÃ m xá»­ lÃ½ cho tá»«ng profile (Process con)"""
        # tráº¡ng thÃ¡i profile
        try:
            control_state.set_profile_state(profile_id, "RUNNING")
        except Exception:
            pass
        try:
            # STOP/PAUSE check trÆ°á»›c khi connect
            stop, paused, reason = control_state.check_flags(profile_id)
            if stop:
                print(f"ðŸ›‘ [{profile_id}] EMERGENCY_STOP trÆ°á»›c khi connect ({reason})")
                try:
                    control_state.set_profile_state(profile_id, "STOPPED")
                except Exception:
                    pass
                return
            if paused:
                print(f"â¸ï¸ [{profile_id}] PAUSED trÆ°á»›c khi connect ({reason})")
                control_state.wait_if_paused(profile_id, sleep_seconds=0.5)

            # 1. Káº¿t ná»‘i NST
            ws = connect_profile(profile_id)

            # 2. Khá»Ÿi táº¡o trÃ¬nh duyá»‡t
            fb = FBController(ws)
            fb.profile_id = profile_id
            # âœ… Chá»‰ dispatch/get_id trong pháº¡m vi cÃ¡c profile Ä‘ang cháº¡y (Ä‘Ã£ chá»n),
            # trÃ¡nh loop toÃ n bá»™ PROFILE_IDS trong settings.json gÃ¢y log "thiáº¿u cookie".
            try:
                fb.all_profile_ids = list(self.profiles or [])
            except Exception:
                fb.all_profile_ids = [profile_id]
            # Filter thÃªm theo text nháº­p tá»« UI (náº¿u cÃ³)
            try:
                raw = self.text
                if raw:
                    # TÃ¡ch theo dáº¥u pháº©y / xuá»‘ng dÃ²ng, giá»¯ nguyÃªn cá»¥m tá»« (VD "hÃ  ná»™i")
                    parts = []
                    for chunk in raw.replace("\n", ",").split(","):
                        s = " ".join(str(chunk).strip().split())
                        if s:
                            parts.append(s)
                    # unique giá»¯ thá»© tá»±
                    seen = set()
                    user_keywords = []
                    for x in parts:
                        k = x.lower()
                        if k in seen:
                            continue
                        seen.add(k)
                        user_keywords.append(x)
                    fb.user_keywords = user_keywords
                    if user_keywords:
                        print(f"ðŸ”Ž [{profile_id}] Scan filter text: {user_keywords}")
            except Exception:
                pass
            fb.connect()

            # 3. Cháº¡y bot tÆ°Æ¡ng tÃ¡c
            bot = SimpleBot(fb)
            
            # Äá»•i thá»i gian cháº¡y sang giÃ¢y
            duration_seconds = self.RUN_MINUTES * 60
            
            # Bot sáº½ tá»± thoÃ¡t vÃ²ng láº·p sau khi Ä‘á»§ thá»i gian
            bot.run(self.target_url, duration=duration_seconds) 

            print(f"âœ… [{profile_id}] ÄÃ£ cháº¡y Ä‘á»§ {self.RUN_MINUTES} phÃºt. Äang táº¯t trÃ¬nh duyá»‡t...")
            
            # [Quan trá»ng] ÄÃ³ng trÃ¬nh duyá»‡t sáº¡ch sáº½ Ä‘á»ƒ giáº£i phÃ³ng RAM
            try:
                if fb.browser: fb.browser.close()
                if fb.play: fb.play.stop()
            except: pass
            
        except Exception as e:
            print(f"âŒ Lá»—i á»Ÿ profile {profile_id}: {e}")
            try:
                control_state.set_profile_state(profile_id, "ERROR")
            except Exception:
                pass
        finally:
            # náº¿u Ä‘ang emergency stop thÃ¬ set STOPPED
            try:
                stop, _paused, _reason = control_state.check_flags(profile_id)
                if stop:
                    control_state.set_profile_state(profile_id, "STOPPED")
            except Exception:
                pass

    def run(self):
        """HÃ m Ä‘iá»u phá»‘i chÃ­nh (VÃ²ng láº·p vÄ©nh cá»­u)"""
        
        # Äá»•i thá»i gian nghá»‰ sang giÃ¢y
        rest_seconds = self.REST_MINUTES * 60
        
        print(f"âˆž KÃ­ch hoáº¡t cháº¿ Ä‘á»™ nuÃ´i tuáº§n hoÃ n: Cháº¡y {self.RUN_MINUTES}p -> Nghá»‰ {self.REST_MINUTES}p")

        while True:
            # STOP ALL: thoÃ¡t ngay
            stop, _paused, _reason = control_state.check_flags(None)
            if stop:
                print("ðŸ›‘ [RUNNER] EMERGENCY_STOP -> thoÃ¡t vÃ²ng láº·p AppRunner")
                break

            print("="*60)
            print(f"â–¶ï¸ [START] Báº¯t Ä‘áº§u phiÃªn cháº¡y má»›i lÃºc {time.strftime('%H:%M:%S')}")
            print("="*60)

            # 1. Khá»Ÿi cháº¡y dÃ n profile
            processes = []
            for pid in self.profiles:
                p = Process(target=self.worker, args=(pid,))
                p.start()
                processes.append(p)

            # 2. Chá» táº¥t cáº£ cÃ¡c profile cháº¡y xong (Háº¿t 30 phÃºt tá»¥i nÃ³ sáº½ tá»± dá»«ng)
            for p in processes:
                p.join()

            # 3. TÃ­nh toÃ¡n thá»i gian thá»©c dáº­y
            wake_up_time = time.time() + rest_seconds
            wake_up_str = time.strftime('%H:%M:%S', time.localtime(wake_up_time))

            print("\n" + "="*60)
            print(f"ðŸ’¤ [SLEEP] Xong phiÃªn nÃ y. Bot sáº½ ngá»§ {self.REST_MINUTES} phÃºt.")
            print(f"â° Dá»± kiáº¿n cháº¡y láº¡i vÃ o lÃºc: {wake_up_str}")
            print("="*60 + "\n")
            
            # 4. Bot Ä‘i ngá»§
            # sleep theo chunk Ä‘á»ƒ váº«n check Ä‘Æ°á»£c STOP/PAUSE
            slept = 0
            while slept < rest_seconds:
                stop, paused, _reason = control_state.check_flags(None)
                if stop:
                    print("ðŸ›‘ [RUNNER] EMERGENCY_STOP trong lÃºc sleep -> thoÃ¡t")
                    return
                # pause all: váº«n cho runner sá»‘ng nhÆ°ng khÃ´ng cháº¡y phiÃªn má»›i
                if paused:
                    time.sleep(1)
                    continue
                time.sleep(1)
                slept += 1
--- END FILE: backend\core\runner.py ---

--- START FILE: backend\core\scraper.py ---
import time
import random
import os
from core import control as control_state

class SimpleBot:
    def __init__(self, fb):
        self.fb = fb 

    def _sleep_with_pause_check(self, total_seconds, profile_id, active_time_list, last_check_time_list):
        """
        Sleep nhÆ°ng check pause: chá»‰ tÃ­nh thá»i gian khÃ´ng pause vÃ o active_time.
        active_time_list vÃ  last_check_time_list lÃ  list Ä‘á»ƒ pass by reference.
        """
        remaining = total_seconds
        chunk = 0.5  # Sleep theo chunk 0.5s Ä‘á»ƒ check pause thÆ°á»ng xuyÃªn
        
        while remaining > 0:
            sleep_chunk = min(chunk, remaining)
            
            # Check pause TRÆ¯á»šC sleep: náº¿u Ä‘ang pause thÃ¬ khÃ´ng sleep, chá»‰ Ä‘á»£i
            stop, paused_before, _reason = control_state.check_flags(profile_id)
            if stop:
                raise RuntimeError("EMERGENCY_STOP")
            
            if paused_before:
                # Äang pause: khÃ´ng sleep, chá»‰ Ä‘á»£i vÃ  khÃ´ng tÃ­nh vÃ o active_time
                time.sleep(sleep_chunk)
                last_check_time_list[0] = time.time()
                remaining -= sleep_chunk
                continue
            
            # KhÃ´ng pause: sleep vÃ  tÃ­nh vÃ o active_time
            start_chunk = time.time()
            time.sleep(sleep_chunk)
            end_chunk = time.time()
            actual_elapsed = end_chunk - start_chunk
            
            # Check pause SAU sleep: náº¿u pause trong lÃºc sleep thÃ¬ khÃ´ng tÃ­nh
            stop, paused_after, _reason = control_state.check_flags(profile_id)
            if stop:
                raise RuntimeError("EMERGENCY_STOP")
            
            # Chá»‰ cá»™ng vÃ o active_time náº¿u khÃ´ng pause cáº£ trÆ°á»›c vÃ  sau
            if not paused_after:
                active_time_list[0] += actual_elapsed
            
            last_check_time_list[0] = end_chunk
            remaining -= sleep_chunk

    def run(self, url, duration=None):
        print(f"ðŸš€ Äang truy cáº­p: {url}")
        self.fb.goto(url) 
        
        # Track "active time" (chá»‰ tÄƒng khi khÃ´ng pause) thay vÃ¬ wall clock time
        # DÃ¹ng list Ä‘á»ƒ pass by reference cho helper function
        active_time_list = [0.0]
        last_check_time_list = [time.time()]
        profile_id = getattr(self.fb, 'profile_id', None)
        
        while True:
            try:
                # STOP/PAUSE checkpoint (Æ°u tiÃªn STOP ALL)
                try:
                    if hasattr(self.fb, "control_checkpoint"):
                        self.fb.control_checkpoint("before_loop")
                except RuntimeError as ce:
                    if "EMERGENCY_STOP" in str(ce) or "BROWSER_CLOSED" in str(ce):
                        print("ðŸ›‘ Dá»«ng bot do control flag / browser closed")
                        break
                    raise

                # Chá»‰ báº¯t Ä‘áº§u Ä‘o elapsed SAU checkpoint (vÃ¬ checkpoint cÃ³ thá»ƒ wait khi pause)
                now = time.time()
                elapsed_since_last_check = now - last_check_time_list[0]
                last_check_time_list[0] = now

                # Check pause: náº¿u khÃ´ng pause thÃ¬ cá»™ng thá»i gian Ä‘Ã£ trÃ´i qua vÃ o active_time
                stop, paused, _reason = control_state.check_flags(profile_id)
                if stop:
                    print("ðŸ›‘ Dá»«ng bot do STOP flag")
                    break
                
                # Chá»‰ tÄƒng active_time khi KHÃ”NG pause (Ä‘Ã³ng bÄƒng timer khi pause)
                if paused:
                    # Náº¿u váº«n Ä‘ang pause (hiáº¿m), reset má»‘c thá»i gian Ä‘á»ƒ khÃ´ng cá»™ng dá»“n
                    last_check_time_list[0] = time.time()
                    continue
                active_time_list[0] += elapsed_since_last_check
                
                # 1. Kiá»ƒm tra thá»i gian cháº¡y (dÃ¹ng active_time thay vÃ¬ wall clock)
                if duration and active_time_list[0] >= duration:
                    print(f"â³ Háº¿t giá» cháº¡y (Ä‘Ã£ cháº¡y {active_time_list[0]:.1f}s / {duration}s).")
                    break
                
                # ============================================================
                # CHIáº¾N THUáº¬T: SCAN & SCROLL (Äá»’NG Bá»˜)
                # ============================================================
                
                # Bot cuá»™n vÃ  tráº£ vá» bÃ i viáº¿t (náº¿u cÃ³) cÃ¹ng loáº¡i (green/yellow)
                post, post_type = self.fb.scan_while_scrolling()

                if post:
                    self.fb.process_post(post, post_type)

                    delay = random.uniform(5.0, 8.0)
                    print(f"ðŸ˜´ Nghá»‰ sau khi xá»­ lÃ½ bÃ i {delay:.1f}s")
                    # Sleep vá»›i pause check: chá»‰ tÃ­nh thá»i gian khÃ´ng pause vÃ o active_time
                    self._sleep_with_pause_check(delay, profile_id, active_time_list, last_check_time_list)
                else:
                    delay = random.uniform(3.0, 5.0)
                    print(f"ðŸ˜´ KhÃ´ng cÃ³ bÃ i â€“ nghá»‰ {delay:.1f}s")
                    # Sleep vá»›i pause check
                    self._sleep_with_pause_check(delay, profile_id, active_time_list, last_check_time_list)



                # Random mouse move nháº¹ cho Ä‘á»¡ bá»‹ check bot
                
            
            except RuntimeError as e:
                # Náº¿u lÃ  exception Ä‘áº·c biá»‡t BROWSER_CLOSED thÃ¬ dá»«ng ngay
                if "BROWSER_CLOSED" in str(e) or "EMERGENCY_STOP" in str(e):
                    print(f"ðŸ›‘ Dá»«ng bot ngay láº­p tá»©c ({e})")
                    break
                raise  # Re-raise náº¿u khÃ´ng pháº£i BROWSER_CLOSED
            except Exception as e:
                error_msg = str(e).lower()
                # Náº¿u browser/page Ä‘Ã£ bá»‹ Ä‘Ã³ng thÃ¬ dá»«ng luÃ´n
                if any(keyword in error_msg for keyword in ["closed", "disconnected", "target page", "context or browser"]):
                    print(f"ðŸ›‘ Browser Ä‘Ã£ bá»‹ Ä‘Ã³ng -> Dá»«ng bot")
                    break
                print(f"âš ï¸ Lá»—i scan: {e}")
                # Sleep vá»›i pause check cho lá»—i
                self._sleep_with_pause_check(2.0, profile_id, active_time_list, last_check_time_list)
--- END FILE: backend\core\scraper.py ---

--- START FILE: backend\core\search_worker.py ---
import sys
import os
import urllib.parse
import time
import re
import random
from typing import Optional

# --- SETUP ÄÆ¯á»œNG DáºªN Äá»‚ IMPORT CORE ---
current_dir = os.path.dirname(os.path.abspath(__file__))
parent_dir = os.path.dirname(current_dir)
sys.path.append(parent_dir)

from core.nst import connect_profile
from core.nst import stop_profile
from core.browser import FBController, JS_EXPAND_SCRIPT, JS_CHECK_AND_HIGHLIGHT_SCOPED
from core.scraper import SimpleBot

# ==============================================================================
# "HÃ€NH VI NGÆ¯á»œI THáº¬T": thi thoáº£ng má»Ÿ ThÃ´ng bÃ¡o rá»“i Back (8â€“15 phÃºt/láº§n)
# ==============================================================================
def _random_notification_interval_seconds() -> int:
    return random.randint(12 * 60 , 15 * 60 )


def click_notifications_button(fb: FBController) -> bool:
    """
    Click nÃºt 'ThÃ´ng bÃ¡o' trÃªn Facebook (top bar).
    Æ¯u tiÃªn role + aria-label, khÃ´ng dÃ¹ng class Ä‘á»™ng.
    """
    if not fb or not getattr(fb, "page", None):
        return False

    page = fb.page

    # Æ¯u tiÃªn role=button + aria-label
    try:
        btn = page.get_by_role(
            "button",
            name=re.compile(r"(ThÃ´ng bÃ¡o|Notifications)", re.IGNORECASE),
        )
        if btn.count() > 0:
            btn.first.click(timeout=3000)
            return True
    except Exception:
        pass

    # Fallback: querySelector
    try:
        clicked = page.evaluate(
            """
            () => {
                const el = document.querySelector(
                    '[role="button"][aria-label^="ThÃ´ng bÃ¡o"], [role="button"][aria-label^="Notifications"]'
                );
                if (el) { el.click(); return true; }
                return false;
            }
            """
        )
        return bool(clicked)
    except Exception:
        return False


def get_notifications_panel(page):
    """
    Láº¥y scope panel ThÃ´ng bÃ¡o (dialog).
    Náº¿u khÃ´ng tÃ¬m Ä‘Æ°á»£c thÃ¬ fallback vá» page.
    """
    try:
        panel = page.locator(
            'div[role="dialog"][aria-label^="ThÃ´ng bÃ¡o"], div[role="dialog"][aria-label^="Notifications"]'
        )
        if panel.count() > 0:
            return panel.first
    except Exception:
        pass

    return page


def click_random_notification(fb: FBController) -> bool:
    """
    Giáº£ Ä‘á»‹nh panel ThÃ´ng bÃ¡o Ä‘Ã£ má»Ÿ.
    Click ngáº«u nhiÃªn 1 thÃ´ng bÃ¡o há»£p lá»‡.
    """
    if not fb or not getattr(fb, "page", None):
        return False

    page = fb.page
    panel = get_notifications_panel(page)

    try:
        links = panel.locator('div[role="listitem"] a[role="link"]')
        count = links.count()
        if count == 0:
            print("âš ï¸ KhÃ´ng cÃ³ thÃ´ng bÃ¡o nÃ o Ä‘á»ƒ click")
            return False

        def skip(href: Optional[str]) -> bool:
            if not href:
                return True
            h = str(href).strip()
            return (
                h == "/notifications/"
                or h.startswith("/notifications/?")
                or "facebook.com/notifications" in h
            )

        for _ in range(min(10, count)):
            idx = random.randint(0, count - 1)
            link = links.nth(idx)
            try:
                href = link.get_attribute("href")
            except Exception:
                href = None
            if skip(href):
                continue

            print(f"ðŸ”” Click thÃ´ng bÃ¡o random: {href}")
            link.click(timeout=5000)
            return True

        print("âš ï¸ KhÃ´ng tÃ¬m Ä‘Æ°á»£c thÃ´ng bÃ¡o há»£p lá»‡")
        return False

    except Exception as e:
        print(f"âŒ Lá»—i click_random_notification: {e}")
        return False


def open_notifications_random_then_back(
    fb: FBController,
    wait_seconds: Optional[int] = None,
    reload_after_back: bool = False,
) -> bool:
    """
    Flow hoÃ n chá»‰nh:
    - Má»Ÿ ThÃ´ng bÃ¡o
    - Click random 1 thÃ´ng bÃ¡o
    - Äá»£i (10â€“15s hoáº·c custom)
    - Back
    - (Tuá»³ chá»n) Reload Ä‘á»ƒ reset feed state (chá»‰ nÃªn dÃ¹ng cho Feed)
    """
    if not fb or not getattr(fb, "page", None):
        return False

    page = fb.page

    if not click_notifications_button(fb):
        print("âš ï¸ KhÃ´ng má»Ÿ Ä‘Æ°á»£c ThÃ´ng bÃ¡o")
        return False

    # Chá» panel render
    try:
        page.wait_for_timeout(5000)
    except Exception:
        time.sleep(5)

    if not click_random_notification(fb):
        return False

    delay = int(wait_seconds) if wait_seconds is not None else random.randint(10, 15)
    print(f"â³ Äá»£i {delay}s rá»“i back")
    try:
        page.wait_for_timeout(delay * 1000)
    except Exception:
        time.sleep(delay)

    # ===== BACK =====
    try:
        page.go_back(timeout=0)
    except Exception:
        try:
            page.keyboard.press("Alt+ArrowLeft")
        except Exception:
            print("âš ï¸ go_back fail")
            return False

    # ===== RELOAD (chá»‰ cho Feed náº¿u báº­t) =====
    if not reload_after_back:
        return True

    try:
        print("ðŸ”„ Reload feed Ä‘á»ƒ reset state")
        time.sleep(random.uniform(1.5, 3.0))  # human-like
        page.reload(wait_until="domcontentloaded")
        page.wait_for_timeout(3000)
        return True
    except Exception as e:
        print(f"âš ï¸ Reload fail: {e}")
        return False


class HumanLikeBot(SimpleBot):
    """
    Káº¿ thá»«a SimpleBot Ä‘á»ƒ gáº¯n nhá»‹p má»Ÿ ThÃ´ng bÃ¡o 8â€“15 phÃºt/láº§n,
    CHá»ˆ trigger sau khi Ä‘Ã£ xá»­ lÃ½ xong 1 post + nghá»‰ tá»± nhiÃªn.
    """
    def run(self, url, duration=None):
        print(f"ðŸš€ Äang truy cáº­p: {url}")
        self.fb.goto(url)

        start_time = time.time()
        next_notify_time = time.time() + _random_notification_interval_seconds()

        while True:
            try:
                if duration and (time.time() - start_time > duration):
                    print("â³ Háº¿t giá» cháº¡y.")
                    break

                post, post_type = self.fb.scan_while_scrolling()

                if post:
                    self.fb.process_post(post, post_type)

                    delay = random.uniform(5.0, 8.0)
                    print(f"ðŸ˜´ Nghá»‰ sau khi xá»­ lÃ½ bÃ i {delay:.1f}s")
                    time.sleep(delay)

                    # ===== ÄIá»‚M CHá»T: chá»‰ má»Ÿ thÃ´ng bÃ¡o sau DONE + nghá»‰ =====
                    if time.time() >= next_notify_time:
                        # Chá»‰ reload sau khi back náº¿u Ä‘ang cháº¡y Feed (trang chá»§).
                        is_feed = str(url or "").strip().rstrip("/") == "https://www.facebook.com"
                        open_notifications_random_then_back(self.fb, reload_after_back=is_feed)
                        next_notify_time = time.time() + _random_notification_interval_seconds()
                else:
                    delay = random.uniform(3.0, 5.0)
                    print(f"ðŸ˜´ KhÃ´ng cÃ³ bÃ i â€“ nghá»‰ {delay:.1f}s")
                    time.sleep(delay)

            except Exception as e:
                print(f"âŒ Lá»—i vÃ²ng láº·p: {e}")
                time.sleep(2)

def _parse_location_terms(raw_text: str, strip_terms: Optional[list[str]] = None) -> list[str]:
    """
    User input dáº¡ng: "báº¯c ninh , báº¯c giang" hoáº·c "tuyá»ƒn dá»¥ng báº¯c ninh , báº¯c giang"
    => tráº£ vá» ["báº¯c ninh", "báº¯c giang"]
    """
    text = str(raw_text or "").strip().lower()
    if not text:
        return []

    parts = [p.strip() for p in re.split(r"[,;\n]+", text) if p.strip()]
    out: list[str] = []
    seen: set[str] = set()
    strip_terms = strip_terms or []

    for part in parts:
        cleaned = part
        # remove "job keywords" khá»i input náº¿u user dÃ­nh vÃ o location
        for term in strip_terms:
            t = str(term or "").strip().lower()
            if not t:
                continue
            cleaned = cleaned.replace(t, " ")
        cleaned = re.sub(r"\s+", " ", cleaned).strip()
        if not cleaned:
            continue
        if cleaned in seen:
            continue
        seen.add(cleaned)
        out.append(cleaned)

    return out

# ==============================================================================
# CLASS CONTROLLER Má»šI (CHá»ˆ LIKE, KHÃ”NG SHARE/SAVE)
# ==============================================================================
class SearchBotController(FBController):
    """
    Káº¿ thá»«a FBController nhÆ°ng sá»­a láº¡i hÃ m process_post
    Ä‘á»ƒ chá»‰ thá»±c hiá»‡n hÃ nh Ä‘á»™ng Like, bá» qua Share vÃ  Save ID.
    """
    def process_post(self, post_handle, post_type):
        try:
            print(f"ðŸ§  [FilterMode] Äang soi bÃ i viáº¿t (type={post_type})...")

            # 1. Expand ná»™i dung (Ä‘á»ƒ check keyword cho chuáº©n)
            self.page.evaluate(JS_EXPAND_SCRIPT, post_handle)

            required_locations: list[str] = getattr(self, "required_locations", []) or []
            # 2) DÃ¹ng Ä‘Ãºng hÃ m cÃ³ sáºµn cá»§a browser.py (JS_CHECK_AND_HIGHLIGHT_SCOPED)
            # - has_job_keyword: cÃ³ Ã­t nháº¥t 1 keyword máº·c Ä‘á»‹nh (job_keywords) trong Ná»˜I DUNG BÃ€I
            # - has_location_term: cÃ³ Ã­t nháº¥t 1 cá»¥m text user nháº­p (required_locations) trong Ná»˜I DUNG BÃ€I
            # => CHá»ˆ LIKE KHI (job_keyword) AND (location_term)
            has_job_keyword = self.page.evaluate(
                JS_CHECK_AND_HIGHLIGHT_SCOPED,
                [post_handle, self.job_keywords]
            )
            # Náº¿u user khÃ´ng nháº­p text (feed mode), thÃ¬ bá» qua Ä‘iá»u kiá»‡n location (coi nhÆ° pass)
            has_location_term = True if not required_locations else self.page.evaluate(
                JS_CHECK_AND_HIGHLIGHT_SCOPED,
                [post_handle, required_locations]
            )

            has_keyword = bool(has_job_keyword and has_location_term)

            if not has_keyword:
                print("âŒ KhÃ´ng Ä‘áº¡t Ä‘iá»u kiá»‡n (cáº§n keyword máº·c Ä‘á»‹nh + cÃ³ 1 trong text nháº­p) -> Bá» qua")
                self.mark_post_as_processed(post_handle)
                
                
                
                return False

            print("âœ… BÃ i Ä‘áº¡t Ä‘iá»u kiá»‡n (keyword máº·c Ä‘á»‹nh + text nháº­p)!")

            # Like theo xÃ¡c suáº¥t giá»‘ng ngÆ°á»i dÃ¹ng:
            # - Vá»›i má»—i bÃ i "Ä‘Ãºng", random 1 tá»‰ lá»‡ trong khoáº£ng 40%..60%
            # - Sau Ä‘Ã³ roll Ä‘á»ƒ quyáº¿t Ä‘á»‹nh cÃ³ Like hay khÃ´ng
            p = random.uniform(0.40, 0.60)
            roll = random.random()
            should_like = roll < p
            print(f"ðŸŽ² [LikeProb] p={p:.2f} roll={roll:.2f} -> {'LIKE' if should_like else 'SKIP'}")
            if should_like:
                # like_current_post tá»± bá» qua náº¿u bÃ i Ä‘Ã£ Like
            self.like_current_post(post_handle)

            # 4. ÄÃ¡nh dáº¥u Ä‘Ã£ xá»­ lÃ½ (Äá»ƒ bot lÆ°á»›t tiáº¿p bÃ i sau)
            self.mark_post_as_processed(post_handle)
            
            return True

        except Exception as e:
            print(f"âŒ Lá»—i process_post: {e}")
            return False

# ==============================================================================
# HÃ€M 1: TÃŒM KIáº¾M & LIKE (Trang Search)
# ==============================================================================
def search_and_like(profile_id: str, search_text: str, duration_minutes: int = 30, all_profile_ids=None):
    """Nháº­p tá»« khÃ³a -> VÃ o trang Search -> LÆ°á»›t & Like bÃ i cÃ³ tá»« khÃ³a"""
    try:
        # 1. Táº¡o URL TÃ¬m kiáº¿m
        encoded_query = urllib.parse.quote_plus(search_text)
        target_url = f"https://www.facebook.com/search/posts?q={encoded_query}"
        
        print(f"ðŸ” [Search] Tá»« khÃ³a: '{search_text}'")
        print(f"ðŸ”— Link: {target_url}")

        _run_bot_logic(profile_id, target_url, search_text, duration_minutes, all_profile_ids=all_profile_ids)

    except Exception as e:
        print(f"âŒ Lá»—i search_and_like: {e}")

# ==============================================================================
# HÃ€M 2: LÆ¯á»šT NEWFEED & LIKE (Trang Chá»§)
# ==============================================================================
def feed_and_like(profile_id: str, filter_text: str, duration_minutes: int = 30, all_profile_ids=None):
    """VÃ o trang chá»§ (Feed) -> LÆ°á»›t -> Chá»‰ Like bÃ i nÃ o chá»©a filter_text"""
    try:
        # 1. URL lÃ  Trang chá»§
        target_url = "https://www.facebook.com/"
        
        print(f"ðŸ  [Feed] LÆ°á»›t News Feed tÃ¬m tá»« khÃ³a: '{filter_text}'")
        
        _run_bot_logic(profile_id, target_url, filter_text, duration_minutes, all_profile_ids=all_profile_ids)

    except Exception as e:
        print(f"âŒ Lá»—i feed_and_like: {e}")

# ==============================================================================
# HÃ€M CHáº Y CHUNG (CORE LOGIC)
# ==============================================================================
def _run_bot_logic(profile_id, url, raw_text, duration_minutes, all_profile_ids=None):
    try:
        # 1. Káº¿t ná»‘i
        print(f"ðŸš€ Äang má»Ÿ profile: {profile_id}")
        ws_url = connect_profile(profile_id)
        
        # DÃ¹ng Controller Ä‘Ã£ cáº¯t bá» Share/Save
        fb = SearchBotController(ws_url)
        fb.profile_id = profile_id
        # âœ… giá»›i háº¡n dispatch/get_id chá»‰ trong cÃ¡c profile Ä‘ang cháº¡y (Ä‘Ã£ chá»n)
        try:
            if all_profile_ids:
                fb.all_profile_ids = list(all_profile_ids)
            else:
                fb.all_profile_ids = [profile_id]
        except Exception:
            fb.all_profile_ids = [profile_id]
        fb.connect()

        # 2. Setup filter rules
        # - Feed: cho phÃ©p raw_text rá»—ng => khÃ´ng lá»c location, chá»‰ dÃ¹ng job_keywords máº·c Ä‘á»‹nh
        # - Náº¿u user cÃ³ nháº­p raw_text nhÆ°ng parse ra rá»—ng (vd chá»‰ nháº­p "tuyá»ƒn dá»¥ng") thÃ¬ coi nhÆ° sai input
        raw_text_str = str(raw_text or "").strip()
        if not raw_text_str:
            locations = []
        else:
            # text nháº­p chá»‰ dÃ¹ng lÃ m "location terms" (OR), tÃ¡ch theo dáº¥u pháº©y
            locations = _parse_location_terms(raw_text_str, strip_terms=getattr(fb, "job_keywords", []))
            # Náº¿u user chá»‰ nháº­p keyword (vd: "tuyá»ƒn dá»¥ng") thÃ¬ locations cÃ³ thá»ƒ rá»—ng sau khi strip.
            # Khi Ä‘Ã³: khÃ´ng lá»c location, váº«n cháº¡y bÃ¬nh thÆ°á»ng theo job_keywords máº·c Ä‘á»‹nh.
            if not locations:
                print("â„¹ï¸ KhÃ´ng cÃ³ location tá»« input -> chá»‰ dÃ¹ng keyword máº·c Ä‘á»‹nh Ä‘á»ƒ lá»c.")

        fb.required_locations = locations
        if locations:
            print(f"âœ… Filter location (OR): {locations}")
        else:
            print("âœ… Filter location: (none) -> chá»‰ dÃ¹ng keyword máº·c Ä‘á»‹nh")
        print(f"âœ… Filter job keywords (default): {getattr(fb, 'job_keywords', [])}")
        
        # 3. Cháº¡y Bot (human-like: thá»‰nh thoáº£ng má»Ÿ thÃ´ng bÃ¡o)
        bot = HumanLikeBot(fb)
        print(f"â–¶ï¸ Báº¯t Ä‘áº§u lÆ°á»›t trong {duration_minutes} phÃºt...")
        duration_seconds = duration_minutes * 60
        
        bot.run(url, duration=duration_seconds)
        
    except Exception as e:
        print(f"âŒ Lá»—i Runner: {e}")
    finally:
        print("ðŸ›‘ Káº¿t thÃºc.")
        # ÄÃ³ng sáº¡ch tab/context playwright + stop NST (giá»‘ng join group / cookie)
        try:
            if 'fb' in locals() and fb:
                try:
                    if getattr(fb, "page", None):
                        try:
                            fb.page.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "browser", None) and getattr(fb.browser, "contexts", None):
                        for ctx in list(fb.browser.contexts):
                            try:
                                ctx.close()
                            except Exception:
                                pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "browser", None):
                        try:
                            fb.browser.close()
                        except Exception:
                            pass
                except Exception:
                    pass
                try:
                    if getattr(fb, "play", None):
                        try:
                            fb.play.stop()
                        except Exception:
                            pass
                except Exception:
                    pass
        finally:
            try:
                stop_profile(profile_id)
            except Exception:
                pass

if __name__ == "__main__":
    # Module nÃ y Ä‘Æ°á»£c gá»i qua FastAPI (/feed/start). KhÃ´ng cháº¡y standalone.
    pass
--- END FILE: backend\core\search_worker.py ---

--- START FILE: backend\core\settings.py ---
import json
from dataclasses import dataclass, field
from functools import lru_cache
from pathlib import Path
from typing import List, Any, Dict

# ÄÆ°á»ng dáº«n cá»‘ Ä‘á»‹nh Ä‘á»ƒ Ä‘á»c cáº¥u hÃ¬nh
SETTINGS_PATH = Path(__file__).resolve().parent.parent / "config" / "settings.json"


def _parse_bool(value: Any) -> bool:
    if isinstance(value, bool):
        return value
    if value is None:
        return False
    if isinstance(value, (int, float)):
        return bool(value)
    if isinstance(value, str):
        return value.strip().lower() in {"1", "true", "yes", "y", "on"}
    return False


def _coerce_positive_int(value: Any, default: int) -> int:
    try:
        num = int(value)
        return num if num > 0 else default
    except (TypeError, ValueError):
        return default


def _parse_profile_ids(value: Any) -> List[str]:
    """
    Tráº£ vá» danh sÃ¡ch profile_id.
    Há»— trá»£ cáº£ format cÅ© (list/string) vÃ  format má»›i (dict {id: {...}}).
    """
    if isinstance(value, dict):
        items = value.keys()
    elif isinstance(value, list):
        items = value
    elif isinstance(value, str):
        items = value.split(",")
    else:
        return []

    return [str(item).strip() for item in items if str(item).strip()]


def _parse_profile_configs(value: Any) -> Dict[str, Any]:
    """
    LÆ°u láº¡i toÃ n bá»™ cáº¥u hÃ¬nh profile (cookie, access_token, ...)
    Ä‘á»ƒ cÃ³ thá»ƒ dÃ¹ng vá» sau.
    """
    if isinstance(value, dict):
        return {str(k).strip(): v for k, v in value.items() if str(k).strip()}

    # Fallback cho format cÅ©: chá»‰ táº¡o map rá»—ng tá»« danh sÃ¡ch id
    ids = _parse_profile_ids(value)
    return {pid: {} for pid in ids}


@dataclass
class Settings:
    api_key: str
    headless: bool = False
    target_url: str = "https://facebook.com"
    profile_ids: List[str] = field(default_factory=list)
    profile_configs: Dict[str, Any] = field(default_factory=dict)
    run_minutes: int = 30
    rest_minutes: int = 120


@lru_cache(maxsize=1)
def get_settings() -> Settings:
    """
    Äá»c vÃ  cache cáº¥u hÃ¬nh tá»« settings.json.
    Gá»i get_settings.cache_clear() náº¿u cáº§n reload.
    """
    if not SETTINGS_PATH.exists():
        raise FileNotFoundError(f"KhÃ´ng tÃ¬m tháº¥y file cáº¥u hÃ¬nh: {SETTINGS_PATH}")

    with SETTINGS_PATH.open(encoding="utf-8") as f:
        try:
            raw = json.load(f)
        except json.JSONDecodeError as exc:
            raise ValueError(f"settings.json khÃ´ng há»£p lá»‡: {exc}") from exc

    return Settings(
        api_key=str(raw.get("API_KEY", "")),
        headless=_parse_bool(raw.get("HEADLESS", False)),
        target_url=str(raw.get("TARGET_URL", "https://facebook.com")),
        profile_ids=_parse_profile_ids(raw.get("PROFILE_IDS", [])),
        profile_configs=_parse_profile_configs(raw.get("PROFILE_IDS", {})),
        run_minutes=_coerce_positive_int(raw.get("RUN_MINUTES", 30), 30),
        rest_minutes=_coerce_positive_int(raw.get("REST_MINUTES", 120), 120),
    )


def reload_settings() -> Settings:
    """XÃ³a cache vÃ  Ä‘á»c láº¡i settings.json (dÃ¹ng khi file Ä‘á»•i ná»™i dung)."""
    get_settings.cache_clear()
    return get_settings()



--- END FILE: backend\core\settings.py ---

--- START FILE: backend\core\utils.py ---


import re

def extract_uid_from_url(url):
    """
    Chuyá»ƒn Ä‘á»•i link profile thÃ nh UID hoáº·c Username
    VÃ­ dá»¥: 
    - https://www.facebook.com/profile.php?id=10001234 -> 10001234
    - https://www.facebook.com/zuck?comment_id=... -> zuck
    """
    if not url: return None
    
    # TrÆ°á»ng há»£p 1: profile.php?id=12345
    match_id = re.search(r'profile\.php\?id=(\d+)', url)
    if match_id:
        return match_id.group(1)
        
    # TrÆ°á»ng há»£p 2: facebook.com/username
    # Loáº¡i bá» cÃ¡c tham sá»‘ rÃ¡c sau dáº¥u ? hoáº·c &
    clean_url = url.split('?')[0].split('&')[0]
    parts = clean_url.rstrip('/').split('/')
    
    # Láº¥y pháº§n cuá»‘i cÃ¹ng (username)
    if parts:
        user_part = parts[-1]
        if user_part not in ['facebook.com', 'www.facebook.com', '']:
            return user_part
            
    return None

def clean_profile_list(raw):
    """Chuáº©n hÃ³a danh sÃ¡ch profile tá»« string hoáº·c list."""
    if not raw:
        return []

    items = raw if isinstance(raw, list) else str(raw).split(",")
    return [str(p).strip() for p in items if str(p).strip()]
--- END FILE: backend\core\utils.py ---

--- START FILE: backend\data\987870664956102_posts_2025-12-8_to_2025-12-14.json ---
{
  "page_id": "987870664956102",
  "profile_id": "031ca13d-e8fa-400c-a603-df57a2806788",
  "start_date": "2025-12-8",
  "end_date": "2025-12-14",
  "total_posts": 357,
  "posts": [
    {
      "id": "987870664956102_2221332461609910",
      "created_time": "2025-12-12 15:00:15"
    },
    {
      "id": "987870664956102_2219977891745367",
      "created_time": "2025-12-10 20:41:59"
    },
    {
      "id": "987870664956102_2223069191436237",
      "created_time": "2025-12-14 20:59:52"
    },
    {
      "id": "987870664956102_2222234478186375",
      "created_time": "2025-12-13 18:52:21"
    },
    {
      "id": "987870664956102_2223061854770304",
      "created_time": "2025-12-14 20:47:16"
    },
    {
      "id": "987870664956102_2223061061437050",
      "created_time": "2025-12-14 20:46:04"
    },
    {
      "id": "987870664956102_2223026591440497",
      "created_time": "2025-12-14 19:50:30"
    },
    {
      "id": "987870664956102_2222999008109922",
      "created_time": "2025-12-14 19:12:17"
    },
    {
      "id": "987870664956102_2223004988109324",
      "created_time": "2025-12-14 19:21:31"
    },
    {
      "id": "987870664956102_2221126961630460",
      "created_time": "2025-12-12 08:17:44"
    },
    {
      "id": "987870664956102_2220355671707589",
      "created_time": "2025-12-11 08:28:30"
    },
    {
      "id": "987870664956102_2221443454932144",
      "created_time": "2025-12-12 18:17:50"
    },
    {
      "id": "987870664956102_2222920021451154",
      "created_time": "2025-12-14 16:53:04"
    },
    {
      "id": "987870664956102_2221175261625630",
      "created_time": "2025-12-12 09:51:22"
    },
    {
      "id": "987870664956102_2222905581452598",
      "created_time": "2025-12-14 16:26:33"
    },
    {
      "id": "987870664956102_2222884351454721",
      "created_time": "2025-12-14 15:47:32"
    },
    {
      "id": "987870664956102_2222889764787513",
      "created_time": "2025-12-14 15:57:36"
    },
    {
      "id": "987870664956102_2222870231456133",
      "created_time": "2025-12-14 15:23:08"
    },
    {
      "id": "987870664956102_2222849951458161",
      "created_time": "2025-12-14 14:41:37"
    },
    {
      "id": "987870664956102_2222842844792205",
      "created_time": "2025-12-14 14:26:46"
    },
    {
      "id": "987870664956102_2222841534792336",
      "created_time": "2025-12-14 14:24:21"
    },
    {
      "id": "987870664956102_2222840054792484",
      "created_time": "2025-12-14 14:21:07"
    },
    {
      "id": "987870664956102_2222839988125824",
      "created_time": "2025-12-14 14:20:59"
    },
    {
      "id": "987870664956102_2222796614796828",
      "created_time": "2025-12-14 12:49:50"
    },
    {
      "id": "987870664956102_2222796381463518",
      "created_time": "2025-12-14 12:49:22"
    },
    {
      "id": "987870664956102_2220064411736715",
      "created_time": "2025-12-10 22:52:07"
    },
    {
      "id": "987870664956102_2222681128141710",
      "created_time": "2025-12-14 08:59:05"
    },
    {
      "id": "987870664956102_2222665621476594",
      "created_time": "2025-12-14 08:28:18"
    },
    {
      "id": "987870664956102_2222352054841284",
      "created_time": "2025-12-13 22:00:01"
    },
    {
      "id": "987870664956102_2221913088218514",
      "created_time": "2025-12-13 08:31:09"
    },
    {
      "id": "987870664956102_2221603944916095",
      "created_time": "2025-12-12 22:24:12"
    },
    {
      "id": "987870664956102_2222396841503472",
      "created_time": "2025-12-13 23:12:30"
    },
    {
      "id": "987870664956102_2221191348290688",
      "created_time": "2025-12-12 10:19:49"
    },
    {
      "id": "987870664956102_2222346764841813",
      "created_time": "2025-12-13 21:51:39"
    },
    {
      "id": "987870664956102_2222299901513166",
      "created_time": "2025-12-13 20:38:07"
    },
    {
      "id": "987870664956102_2222339138175909",
      "created_time": "2025-12-13 21:39:20"
    },
    {
      "id": "987870664956102_2222339118175911",
      "created_time": "2025-12-13 21:39:20"
    },
    {
      "id": "987870664956102_2222337708176052",
      "created_time": "2025-12-13 21:37:03"
    },
    {
      "id": "987870664956102_2218202551922901",
      "created_time": "2025-12-08 14:01:50"
    },
    {
      "id": "987870664956102_2222192501523906",
      "created_time": "2025-12-13 17:36:15"
    },
    {
      "id": "987870664956102_2221950124881477",
      "created_time": "2025-12-13 09:42:29"
    },
    {
      "id": "987870664956102_2219200671823089",
      "created_time": "2025-12-09 20:22:19"
    },
    {
      "id": "987870664956102_2219762835100206",
      "created_time": "2025-12-10 14:28:56"
    },
    {
      "id": "987870664956102_2221542678255555",
      "created_time": "2025-12-12 20:53:30"
    },
    {
      "id": "987870664956102_2222177478192075",
      "created_time": "2025-12-13 17:07:48"
    },
    {
      "id": "987870664956102_2222175578192265",
      "created_time": "2025-12-13 17:04:33"
    },
    {
      "id": "987870664956102_2222162884860201",
      "created_time": "2025-12-13 16:40:27"
    },
    {
      "id": "987870664956102_2222157591527397",
      "created_time": "2025-12-13 16:30:43"
    },
    {
      "id": "987870664956102_2219095108500312",
      "created_time": "2025-12-09 17:31:15"
    },
    {
      "id": "987870664956102_2222072274869262",
      "created_time": "2025-12-13 13:42:01"
    },
    {
      "id": "987870664956102_2219072628502560",
      "created_time": "2025-12-09 16:52:54"
    },
    {
      "id": "987870664956102_2222125701530586",
      "created_time": "2025-12-13 15:32:42"
    },
    {
      "id": "987870664956102_2222122371530919",
      "created_time": "2025-12-13 15:26:38"
    },
    {
      "id": "987870664956102_2222122158197607",
      "created_time": "2025-12-13 15:26:17"
    },
    {
      "id": "987870664956102_2222114318198391",
      "created_time": "2025-12-13 15:09:41"
    },
    {
      "id": "987870664956102_2222113264865163",
      "created_time": "2025-12-13 15:07:39"
    },
    {
      "id": "987870664956102_2222112681531888",
      "created_time": "2025-12-13 15:06:19"
    },
    {
      "id": "987870664956102_2222110211532135",
      "created_time": "2025-12-13 15:01:53"
    },
    {
      "id": "987870664956102_2221855784890911",
      "created_time": "2025-12-13 06:29:30"
    },
    {
      "id": "987870664956102_2219623875114102",
      "created_time": "2025-12-10 09:41:45"
    },
    {
      "id": "987870664956102_2222091721533984",
      "created_time": "2025-12-13 14:22:03"
    },
    {
      "id": "987870664956102_2222077681535388",
      "created_time": "2025-12-13 13:53:10"
    },
    {
      "id": "987870664956102_2221974134879076",
      "created_time": "2025-12-13 10:25:43"
    },
    {
      "id": "987870664956102_2222076564868833",
      "created_time": "2025-12-13 13:50:33"
    },
    {
      "id": "987870664956102_2221401418269681",
      "created_time": "2025-12-12 17:08:33"
    },
    {
      "id": "987870664956102_2218016978608125",
      "created_time": "2025-12-08 08:00:25"
    },
    {
      "id": "987870664956102_2222001011543055",
      "created_time": "2025-12-13 11:16:22"
    },
    {
      "id": "987870664956102_2222024054874084",
      "created_time": "2025-12-13 12:01:10"
    },
    {
      "id": "987870664956102_2222023304874159",
      "created_time": "2025-12-13 11:59:26"
    },
    {
      "id": "987870664956102_2222019704874519",
      "created_time": "2025-12-13 11:52:23"
    },
    {
      "id": "987870664956102_2221184824958007",
      "created_time": "2025-12-12 10:08:32"
    },
    {
      "id": "987870664956102_2221960798213743",
      "created_time": "2025-12-13 10:02:09"
    },
    {
      "id": "987870664956102_2222005201542636",
      "created_time": "2025-12-13 11:24:07"
    },
    {
      "id": "987870664956102_2222001248209698",
      "created_time": "2025-12-13 11:16:45"
    },
    {
      "id": "987870664956102_2221994738210349",
      "created_time": "2025-12-13 11:04:46"
    },
    {
      "id": "987870664956102_2220529005023589",
      "created_time": "2025-12-11 14:10:17"
    },
    {
      "id": "987870664956102_2221962774880212",
      "created_time": "2025-12-13 10:05:50"
    },
    {
      "id": "987870664956102_2221960028213820",
      "created_time": "2025-12-13 10:00:45"
    },
    {
      "id": "987870664956102_2221955811547575",
      "created_time": "2025-12-13 09:52:55"
    },
    {
      "id": "987870664956102_2221953661547790",
      "created_time": "2025-12-13 09:48:58"
    },
    {
      "id": "987870664956102_2221950094881480",
      "created_time": "2025-12-13 09:42:25"
    },
    {
      "id": "987870664956102_2221949841548172",
      "created_time": "2025-12-13 09:42:02"
    },
    {
      "id": "987870664956102_2221944604882029",
      "created_time": "2025-12-13 09:31:33"
    },
    {
      "id": "987870664956102_2218829488526874",
      "created_time": "2025-12-09 09:03:53"
    },
    {
      "id": "987870664956102_2221940258215797",
      "created_time": "2025-12-13 09:23:00"
    },
    {
      "id": "987870664956102_2221318718277951",
      "created_time": "2025-12-12 14:33:58"
    },
    {
      "id": "987870664956102_2220437165032773",
      "created_time": "2025-12-11 11:05:39"
    },
    {
      "id": "987870664956102_2221922328217590",
      "created_time": "2025-12-13 08:48:16"
    },
    {
      "id": "987870664956102_2221919974884492",
      "created_time": "2025-12-13 08:43:48"
    },
    {
      "id": "987870664956102_2221904308219392",
      "created_time": "2025-12-13 08:13:34"
    },
    {
      "id": "987870664956102_2221900374886452",
      "created_time": "2025-12-13 08:04:36"
    },
    {
      "id": "987870664956102_2221899311553225",
      "created_time": "2025-12-13 08:01:59"
    },
    {
      "id": "987870664956102_2221853648224458",
      "created_time": "2025-12-13 06:24:31"
    },
    {
      "id": "987870664956102_2221871231556033",
      "created_time": "2025-12-13 07:04:09"
    },
    {
      "id": "987870664956102_2221653201577836",
      "created_time": "2025-12-12 23:42:02"
    },
    {
      "id": "987870664956102_2221649001578256",
      "created_time": "2025-12-12 23:34:57"
    },
    {
      "id": "987870664956102_2221632708246552",
      "created_time": "2025-12-12 23:08:28"
    },
    {
      "id": "987870664956102_2221558374920652",
      "created_time": "2025-12-12 21:18:07"
    },
    {
      "id": "987870664956102_2220351941707962",
      "created_time": "2025-12-11 08:21:14"
    },
    {
      "id": "987870664956102_2221498528259970",
      "created_time": "2025-12-12 19:46:03"
    },
    {
      "id": "987870664956102_2221186881624468",
      "created_time": "2025-12-12 10:12:12"
    },
    {
      "id": "987870664956102_2221369584939531",
      "created_time": "2025-12-12 16:07:36"
    },
    {
      "id": "987870664956102_2221371554939334",
      "created_time": "2025-12-12 16:11:37"
    },
    {
      "id": "987870664956102_2221372414939248",
      "created_time": "2025-12-12 16:13:11"
    },
    {
      "id": "987870664956102_2220586028351220",
      "created_time": "2025-12-11 16:02:06"
    },
    {
      "id": "987870664956102_2219826585093831",
      "created_time": "2025-12-10 16:26:39"
    },
    {
      "id": "987870664956102_2221387264937763",
      "created_time": "2025-12-12 16:41:28"
    },
    {
      "id": "987870664956102_2221383018271521",
      "created_time": "2025-12-12 16:33:29"
    },
    {
      "id": "987870664956102_2221246734951816",
      "created_time": "2025-12-12 12:08:10"
    },
    {
      "id": "987870664956102_2221366931606463",
      "created_time": "2025-12-12 16:02:33"
    },
    {
      "id": "987870664956102_2221335264942963",
      "created_time": "2025-12-12 15:05:32"
    },
    {
      "id": "987870664956102_2221110004965489",
      "created_time": "2025-12-12 07:42:26"
    },
    {
      "id": "987870664956102_2221352341607922",
      "created_time": "2025-12-12 15:35:11"
    },
    {
      "id": "987870664956102_2221348478274975",
      "created_time": "2025-12-12 15:28:31"
    },
    {
      "id": "987870664956102_2221345224941967",
      "created_time": "2025-12-12 15:22:38"
    },
    {
      "id": "987870664956102_2221344984941991",
      "created_time": "2025-12-12 15:22:12"
    },
    {
      "id": "987870664956102_2221343118275511",
      "created_time": "2025-12-12 15:19:07"
    },
    {
      "id": "987870664956102_2221328181610338",
      "created_time": "2025-12-12 14:52:38"
    },
    {
      "id": "987870664956102_2221235914952898",
      "created_time": "2025-12-12 11:47:25"
    },
    {
      "id": "987870664956102_2221327948277028",
      "created_time": "2025-12-12 14:52:14"
    },
    {
      "id": "987870664956102_2219661758443647",
      "created_time": "2025-12-10 10:55:23"
    },
    {
      "id": "987870664956102_2221321818277641",
      "created_time": "2025-12-12 14:39:44"
    },
    {
      "id": "987870664956102_2221319071611249",
      "created_time": "2025-12-12 14:34:37"
    },
    {
      "id": "987870664956102_2221125964963893",
      "created_time": "2025-12-12 08:15:51"
    },
    {
      "id": "987870664956102_2219814605095029",
      "created_time": "2025-12-10 16:03:48"
    },
    {
      "id": "987870664956102_2221292134947276",
      "created_time": "2025-12-12 13:40:12"
    },
    {
      "id": "987870664956102_2221290414947448",
      "created_time": "2025-12-12 13:36:56"
    },
    {
      "id": "987870664956102_2221288564947633",
      "created_time": "2025-12-12 13:33:24"
    },
    {
      "id": "987870664956102_2219826901760466",
      "created_time": "2025-12-10 16:27:05"
    },
    {
      "id": "987870664956102_2221237838286039",
      "created_time": "2025-12-12 11:50:57"
    },
    {
      "id": "987870664956102_2221237371619419",
      "created_time": "2025-12-12 11:50:14"
    },
    {
      "id": "987870664956102_2221194761623680",
      "created_time": "2025-12-12 10:25:30"
    },
    {
      "id": "987870664956102_2220518285024661",
      "created_time": "2025-12-11 13:47:42"
    },
    {
      "id": "987870664956102_2221222104954279",
      "created_time": "2025-12-12 11:19:28"
    },
    {
      "id": "987870664956102_2221215224954967",
      "created_time": "2025-12-12 11:05:38"
    },
    {
      "id": "987870664956102_2221212454955244",
      "created_time": "2025-12-12 11:00:26"
    },
    {
      "id": "987870664956102_2219105915165898",
      "created_time": "2025-12-09 17:49:40"
    },
    {
      "id": "987870664956102_2221186034957886",
      "created_time": "2025-12-12 10:10:31"
    },
    {
      "id": "987870664956102_2221184104958079",
      "created_time": "2025-12-12 10:06:57"
    },
    {
      "id": "987870664956102_2221164821626674",
      "created_time": "2025-12-12 09:31:13"
    },
    {
      "id": "987870664956102_2221175444958945",
      "created_time": "2025-12-12 09:51:40"
    },
    {
      "id": "987870664956102_2221172091625947",
      "created_time": "2025-12-12 09:44:57"
    },
    {
      "id": "987870664956102_2221164431626713",
      "created_time": "2025-12-12 09:30:41"
    },
    {
      "id": "987870664956102_2221157764960713",
      "created_time": "2025-12-12 09:17:45"
    },
    {
      "id": "987870664956102_2221155368294286",
      "created_time": "2025-12-12 09:12:38"
    },
    {
      "id": "987870664956102_2221150408294782",
      "created_time": "2025-12-12 09:03:34"
    },
    {
      "id": "987870664956102_2221135174962972",
      "created_time": "2025-12-12 08:34:24"
    },
    {
      "id": "987870664956102_2221135111629645",
      "created_time": "2025-12-12 08:34:15"
    },
    {
      "id": "987870664956102_2220386135037876",
      "created_time": "2025-12-11 09:26:48"
    },
    {
      "id": "987870664956102_2221133218296501",
      "created_time": "2025-12-12 08:30:12"
    },
    {
      "id": "987870664956102_2221130001630156",
      "created_time": "2025-12-12 08:23:44"
    },
    {
      "id": "987870664956102_2221129034963586",
      "created_time": "2025-12-12 08:21:51"
    },
    {
      "id": "987870664956102_2221128078297015",
      "created_time": "2025-12-12 08:19:43"
    },
    {
      "id": "987870664956102_2221126654963824",
      "created_time": "2025-12-12 08:17:06"
    },
    {
      "id": "987870664956102_2221125058297317",
      "created_time": "2025-12-12 08:14:09"
    },
    {
      "id": "987870664956102_2220792621663894",
      "created_time": "2025-12-11 21:48:32"
    },
    {
      "id": "987870664956102_2221092754967214",
      "created_time": "2025-12-12 07:04:02"
    },
    {
      "id": "987870664956102_2220515625024927",
      "created_time": "2025-12-11 13:42:11"
    },
    {
      "id": "987870664956102_2221064708303352",
      "created_time": "2025-12-12 06:01:59"
    },
    {
      "id": "987870664956102_2220885944987895",
      "created_time": "2025-12-12 00:18:59"
    },
    {
      "id": "987870664956102_2220851474991342",
      "created_time": "2025-12-11 23:21:06"
    },
    {
      "id": "987870664956102_2220841901658966",
      "created_time": "2025-12-11 23:05:42"
    },
    {
      "id": "987870664956102_2220799338329889",
      "created_time": "2025-12-11 21:58:55"
    },
    {
      "id": "987870664956102_2220790898330733",
      "created_time": "2025-12-11 21:46:21"
    },
    {
      "id": "987870664956102_2220772464999243",
      "created_time": "2025-12-11 21:17:16"
    },
    {
      "id": "987870664956102_2220731535003336",
      "created_time": "2025-12-11 20:11:43"
    },
    {
      "id": "987870664956102_2220729825003507",
      "created_time": "2025-12-11 20:09:05"
    },
    {
      "id": "987870664956102_2220688588340964",
      "created_time": "2025-12-11 19:02:19"
    },
    {
      "id": "987870664956102_2219827995093690",
      "created_time": "2025-12-10 16:29:03"
    },
    {
      "id": "987870664956102_2220551801687976",
      "created_time": "2025-12-11 14:56:19"
    },
    {
      "id": "987870664956102_2218024815274008",
      "created_time": "2025-12-08 08:15:10"
    },
    {
      "id": "987870664956102_2220605685015921",
      "created_time": "2025-12-11 16:38:44"
    },
    {
      "id": "987870664956102_2219811285095361",
      "created_time": "2025-12-10 15:57:26"
    },
    {
      "id": "987870664956102_2220412201701936",
      "created_time": "2025-12-11 10:18:00"
    },
    {
      "id": "987870664956102_2220589248350898",
      "created_time": "2025-12-11 16:08:19"
    },
    {
      "id": "987870664956102_2219033858506437",
      "created_time": "2025-12-09 15:40:13"
    },
    {
      "id": "987870664956102_2220369461706210",
      "created_time": "2025-12-11 08:55:26"
    },
    {
      "id": "987870664956102_2220364665040023",
      "created_time": "2025-12-11 08:46:22"
    },
    {
      "id": "987870664956102_2220546845021805",
      "created_time": "2025-12-11 14:46:50"
    },
    {
      "id": "987870664956102_2220546465021843",
      "created_time": "2025-12-11 14:46:04"
    },
    {
      "id": "987870664956102_2218069978602825",
      "created_time": "2025-12-08 09:43:52"
    },
    {
      "id": "987870664956102_2220531035023386",
      "created_time": "2025-12-11 14:14:53"
    },
    {
      "id": "987870664956102_2220524005024089",
      "created_time": "2025-12-11 14:00:20"
    },
    {
      "id": "987870664956102_2220518395024650",
      "created_time": "2025-12-11 13:47:57"
    },
    {
      "id": "987870664956102_2220517831691373",
      "created_time": "2025-12-11 13:46:45"
    },
    {
      "id": "987870664956102_2220504348359388",
      "created_time": "2025-12-11 13:19:12"
    },
    {
      "id": "987870664956102_2220512988358524",
      "created_time": "2025-12-11 13:36:50"
    },
    {
      "id": "987870664956102_2220499408359882",
      "created_time": "2025-12-11 13:09:08"
    },
    {
      "id": "987870664956102_2220497848360038",
      "created_time": "2025-12-11 13:06:16"
    },
    {
      "id": "987870664956102_2220469638362859",
      "created_time": "2025-12-11 12:12:17"
    },
    {
      "id": "987870664956102_2220458388363984",
      "created_time": "2025-12-11 11:49:07"
    },
    {
      "id": "987870664956102_2220447621698394",
      "created_time": "2025-12-11 11:27:04"
    },
    {
      "id": "987870664956102_2220436165032873",
      "created_time": "2025-12-11 11:03:54"
    },
    {
      "id": "987870664956102_2219809051762251",
      "created_time": "2025-12-10 15:52:55"
    },
    {
      "id": "987870664956102_2220428058367017",
      "created_time": "2025-12-11 10:48:20"
    },
    {
      "id": "987870664956102_2220426268367196",
      "created_time": "2025-12-11 10:45:13"
    },
    {
      "id": "987870664956102_2220419081701248",
      "created_time": "2025-12-11 10:31:19"
    },
    {
      "id": "987870664956102_2220373151705841",
      "created_time": "2025-12-11 09:02:22"
    },
    {
      "id": "987870664956102_2220395615036928",
      "created_time": "2025-12-11 09:44:08"
    },
    {
      "id": "987870664956102_2220389651704191",
      "created_time": "2025-12-11 09:33:29"
    },
    {
      "id": "987870664956102_2220387441704412",
      "created_time": "2025-12-11 09:29:09"
    },
    {
      "id": "987870664956102_2220388191704337",
      "created_time": "2025-12-11 09:30:47"
    },
    {
      "id": "987870664956102_2220385851704571",
      "created_time": "2025-12-11 09:26:24"
    },
    {
      "id": "987870664956102_2220385595037930",
      "created_time": "2025-12-11 09:26:04"
    },
    {
      "id": "987870664956102_2220385001704656",
      "created_time": "2025-12-11 09:24:59"
    },
    {
      "id": "987870664956102_2220383311704825",
      "created_time": "2025-12-11 09:21:32"
    },
    {
      "id": "987870664956102_2220379228371900",
      "created_time": "2025-12-11 09:13:49"
    },
    {
      "id": "987870664956102_2220376148372208",
      "created_time": "2025-12-11 09:08:20"
    },
    {
      "id": "987870664956102_2220339611709195",
      "created_time": "2025-12-11 07:55:15"
    },
    {
      "id": "987870664956102_2220353068374516",
      "created_time": "2025-12-11 08:23:15"
    },
    {
      "id": "987870664956102_2220341098375713",
      "created_time": "2025-12-11 07:58:33"
    },
    {
      "id": "987870664956102_2220341548375668",
      "created_time": "2025-12-11 07:59:12"
    },
    {
      "id": "987870664956102_2220337081709448",
      "created_time": "2025-12-11 07:50:04"
    },
    {
      "id": "987870664956102_2220307581712398",
      "created_time": "2025-12-11 06:45:32"
    },
    {
      "id": "987870664956102_2220094941733662",
      "created_time": "2025-12-10 23:40:10"
    },
    {
      "id": "987870664956102_2219965918413231",
      "created_time": "2025-12-10 20:23:18"
    },
    {
      "id": "987870664956102_2220036148406208",
      "created_time": "2025-12-10 22:09:17"
    },
    {
      "id": "987870664956102_2220033011739855",
      "created_time": "2025-12-10 22:04:36"
    },
    {
      "id": "987870664956102_2218980578511765",
      "created_time": "2025-12-09 13:56:14"
    },
    {
      "id": "987870664956102_2220005545075935",
      "created_time": "2025-12-10 21:24:49"
    },
    {
      "id": "987870664956102_2220005105075979",
      "created_time": "2025-12-10 21:24:14"
    },
    {
      "id": "987870664956102_2219041588505664",
      "created_time": "2025-12-09 15:55:26"
    },
    {
      "id": "987870664956102_2219943131748843",
      "created_time": "2025-12-10 19:46:21"
    },
    {
      "id": "987870664956102_2219920711751085",
      "created_time": "2025-12-10 19:11:13"
    },
    {
      "id": "987870664956102_2219913521751804",
      "created_time": "2025-12-10 18:59:31"
    },
    {
      "id": "987870664956102_2219885005087989",
      "created_time": "2025-12-10 18:11:16"
    },
    {
      "id": "987870664956102_2219875021755654",
      "created_time": "2025-12-10 17:54:57"
    },
    {
      "id": "987870664956102_2219861305090359",
      "created_time": "2025-12-10 17:28:41"
    },
    {
      "id": "987870664956102_2219852011757955",
      "created_time": "2025-12-10 17:11:07"
    },
    {
      "id": "987870664956102_2218111771931979",
      "created_time": "2025-12-08 11:03:40"
    },
    {
      "id": "987870664956102_2219842495092240",
      "created_time": "2025-12-10 16:55:21"
    },
    {
      "id": "987870664956102_2219827141760442",
      "created_time": "2025-12-10 16:27:31"
    },
    {
      "id": "987870664956102_2219826595093830",
      "created_time": "2025-12-10 16:26:41"
    },
    {
      "id": "987870664956102_2219823015094188",
      "created_time": "2025-12-10 16:19:30"
    },
    {
      "id": "987870664956102_2219817295094760",
      "created_time": "2025-12-10 16:08:20"
    },
    {
      "id": "987870664956102_2219667591776397",
      "created_time": "2025-12-10 11:07:10"
    },
    {
      "id": "987870664956102_2219650618444761",
      "created_time": "2025-12-10 10:33:40"
    },
    {
      "id": "987870664956102_2219583741784782",
      "created_time": "2025-12-10 08:24:11"
    },
    {
      "id": "987870664956102_2218997278510095",
      "created_time": "2025-12-09 14:29:21"
    },
    {
      "id": "987870664956102_2218191475257342",
      "created_time": "2025-12-08 13:39:16"
    },
    {
      "id": "987870664956102_2219740248435798",
      "created_time": "2025-12-10 13:40:06"
    },
    {
      "id": "987870664956102_2219766071766549",
      "created_time": "2025-12-10 14:35:13"
    },
    {
      "id": "987870664956102_2219700638439759",
      "created_time": "2025-12-10 12:16:16"
    },
    {
      "id": "987870664956102_2219699698439853",
      "created_time": "2025-12-10 12:14:15"
    },
    {
      "id": "987870664956102_2219655255110964",
      "created_time": "2025-12-10 10:42:56"
    },
    {
      "id": "987870664956102_2219682778441545",
      "created_time": "2025-12-10 11:38:34"
    },
    {
      "id": "987870664956102_2219624305114059",
      "created_time": "2025-12-10 09:42:24"
    },
    {
      "id": "987870664956102_2219672485109241",
      "created_time": "2025-12-10 11:17:04"
    },
    {
      "id": "987870664956102_2218918595184630",
      "created_time": "2025-12-09 11:49:12"
    },
    {
      "id": "987870664956102_2219580645118425",
      "created_time": "2025-12-10 08:18:28"
    },
    {
      "id": "987870664956102_2219605685115921",
      "created_time": "2025-12-10 09:08:51"
    },
    {
      "id": "987870664956102_2219622751780881",
      "created_time": "2025-12-10 09:40:03"
    },
    {
      "id": "987870664956102_2219612345115255",
      "created_time": "2025-12-10 09:21:35"
    },
    {
      "id": "987870664956102_2219610101782146",
      "created_time": "2025-12-10 09:17:37"
    },
    {
      "id": "987870664956102_2219605895115900",
      "created_time": "2025-12-10 09:09:10"
    },
    {
      "id": "987870664956102_2219603531782803",
      "created_time": "2025-12-10 09:04:13"
    },
    {
      "id": "987870664956102_2219593055117184",
      "created_time": "2025-12-10 08:43:00"
    },
    {
      "id": "987870664956102_2219582451784911",
      "created_time": "2025-12-10 08:21:17"
    },
    {
      "id": "987870664956102_2218761295200360",
      "created_time": "2025-12-09 06:41:05"
    },
    {
      "id": "987870664956102_2219521455124344",
      "created_time": "2025-12-10 06:06:12"
    },
    {
      "id": "987870664956102_2219444081798748",
      "created_time": "2025-12-10 03:24:49"
    },
    {
      "id": "987870664956102_2219332928476530",
      "created_time": "2025-12-09 23:51:04"
    },
    {
      "id": "987870664956102_2219264495150040",
      "created_time": "2025-12-09 22:02:20"
    },
    {
      "id": "987870664956102_2218849128524910",
      "created_time": "2025-12-09 09:41:48"
    },
    {
      "id": "987870664956102_2219054125171077",
      "created_time": "2025-12-09 16:18:58"
    },
    {
      "id": "987870664956102_2219100491833107",
      "created_time": "2025-12-09 17:41:02"
    },
    {
      "id": "987870664956102_2219164888493334",
      "created_time": "2025-12-09 19:24:25"
    },
    {
      "id": "987870664956102_2219160208493802",
      "created_time": "2025-12-09 19:17:02"
    },
    {
      "id": "987870664956102_2219154071827749",
      "created_time": "2025-12-09 19:07:49"
    },
    {
      "id": "987870664956102_2219112588498564",
      "created_time": "2025-12-09 18:00:40"
    },
    {
      "id": "987870664956102_2219076745168815",
      "created_time": "2025-12-09 17:00:25"
    },
    {
      "id": "987870664956102_2219081048501718",
      "created_time": "2025-12-09 17:07:58"
    },
    {
      "id": "987870664956102_2219079245168565",
      "created_time": "2025-12-09 17:04:39"
    },
    {
      "id": "987870664956102_2218815108528312",
      "created_time": "2025-12-09 08:37:20"
    },
    {
      "id": "987870664956102_2219072798502543",
      "created_time": "2025-12-09 16:53:16"
    },
    {
      "id": "987870664956102_2219051895171300",
      "created_time": "2025-12-09 16:14:42"
    },
    {
      "id": "987870664956102_2219044371838719",
      "created_time": "2025-12-09 16:00:27"
    },
    {
      "id": "987870664956102_2219043351838821",
      "created_time": "2025-12-09 15:58:40"
    },
    {
      "id": "987870664956102_2219043271838829",
      "created_time": "2025-12-09 15:58:35"
    },
    {
      "id": "987870664956102_2219015778508245",
      "created_time": "2025-12-09 15:05:45"
    },
    {
      "id": "987870664956102_2218082508601572",
      "created_time": "2025-12-08 10:08:05"
    },
    {
      "id": "987870664956102_2218887128521110",
      "created_time": "2025-12-09 10:48:59"
    },
    {
      "id": "987870664956102_2218852205191269",
      "created_time": "2025-12-09 09:47:32"
    },
    {
      "id": "987870664956102_2218984991844657",
      "created_time": "2025-12-09 14:05:02"
    },
    {
      "id": "987870664956102_2218975031845653",
      "created_time": "2025-12-09 13:45:07"
    },
    {
      "id": "987870664956102_2218974278512395",
      "created_time": "2025-12-09 13:43:49"
    },
    {
      "id": "987870664956102_2218966828513140",
      "created_time": "2025-12-09 13:28:09"
    },
    {
      "id": "987870664956102_2218962641846892",
      "created_time": "2025-12-09 13:19:55"
    },
    {
      "id": "987870664956102_2218959698513853",
      "created_time": "2025-12-09 13:13:41"
    },
    {
      "id": "987870664956102_2218948861848270",
      "created_time": "2025-12-09 12:50:18"
    },
    {
      "id": "987870664956102_2218938051849351",
      "created_time": "2025-12-09 12:29:17"
    },
    {
      "id": "987870664956102_2218930641850092",
      "created_time": "2025-12-09 12:14:15"
    },
    {
      "id": "987870664956102_2218921758517647",
      "created_time": "2025-12-09 11:55:52"
    },
    {
      "id": "987870664956102_2218921628517660",
      "created_time": "2025-12-09 11:55:38"
    },
    {
      "id": "987870664956102_2218920431851113",
      "created_time": "2025-12-09 11:53:21"
    },
    {
      "id": "987870664956102_2218915495184940",
      "created_time": "2025-12-09 11:42:52"
    },
    {
      "id": "987870664956102_2218913731851783",
      "created_time": "2025-12-09 11:39:21"
    },
    {
      "id": "987870664956102_2218912691851887",
      "created_time": "2025-12-09 11:37:29"
    },
    {
      "id": "987870664956102_2218907885185701",
      "created_time": "2025-12-09 11:28:21"
    },
    {
      "id": "987870664956102_2218825088527314",
      "created_time": "2025-12-09 08:55:46"
    },
    {
      "id": "987870664956102_2218845255191964",
      "created_time": "2025-12-09 09:33:53"
    },
    {
      "id": "987870664956102_2218890005187489",
      "created_time": "2025-12-09 10:54:34"
    },
    {
      "id": "987870664956102_2218887438521079",
      "created_time": "2025-12-09 10:49:42"
    },
    {
      "id": "987870664956102_2218873971855759",
      "created_time": "2025-12-09 10:25:10"
    },
    {
      "id": "987870664956102_2218871938522629",
      "created_time": "2025-12-09 10:21:07"
    },
    {
      "id": "987870664956102_2218860248523798",
      "created_time": "2025-12-09 10:01:13"
    },
    {
      "id": "987870664956102_2218853068524516",
      "created_time": "2025-12-09 09:48:59"
    },
    {
      "id": "987870664956102_2218846598525163",
      "created_time": "2025-12-09 09:36:53"
    },
    {
      "id": "987870664956102_2218844438525379",
      "created_time": "2025-12-09 09:32:45"
    },
    {
      "id": "987870664956102_2218834645193025",
      "created_time": "2025-12-09 09:13:51"
    },
    {
      "id": "987870664956102_2218833591859797",
      "created_time": "2025-12-09 09:11:36"
    },
    {
      "id": "987870664956102_2218806385195851",
      "created_time": "2025-12-09 08:19:41"
    },
    {
      "id": "987870664956102_2218809135195576",
      "created_time": "2025-12-09 08:24:59"
    },
    {
      "id": "987870664956102_2218807458529077",
      "created_time": "2025-12-09 08:21:35"
    },
    {
      "id": "987870664956102_2218804945195995",
      "created_time": "2025-12-09 08:16:45"
    },
    {
      "id": "987870664956102_2218789588530864",
      "created_time": "2025-12-09 07:45:39"
    },
    {
      "id": "987870664956102_2218778915198598",
      "created_time": "2025-12-09 07:21:56"
    },
    {
      "id": "987870664956102_2218766071866549",
      "created_time": "2025-12-09 06:52:23"
    },
    {
      "id": "987870664956102_2218241011919055",
      "created_time": "2025-12-08 15:16:02"
    },
    {
      "id": "987870664956102_2218564448553378",
      "created_time": "2025-12-09 00:15:55"
    },
    {
      "id": "987870664956102_2218063408603482",
      "created_time": "2025-12-08 09:30:39"
    },
    {
      "id": "987870664956102_2218519148557908",
      "created_time": "2025-12-08 23:02:58"
    },
    {
      "id": "987870664956102_2218433518566471",
      "created_time": "2025-12-08 20:47:01"
    },
    {
      "id": "987870664956102_2218284945247995",
      "created_time": "2025-12-08 16:35:32"
    },
    {
      "id": "987870664956102_2218418001901356",
      "created_time": "2025-12-08 20:21:53"
    },
    {
      "id": "987870664956102_2218417488568074",
      "created_time": "2025-12-08 20:21:04"
    },
    {
      "id": "987870664956102_2218015498608273",
      "created_time": "2025-12-08 07:57:26"
    },
    {
      "id": "987870664956102_2218294355247054",
      "created_time": "2025-12-08 16:52:23"
    },
    {
      "id": "987870664956102_2218290981914058",
      "created_time": "2025-12-08 16:46:23"
    },
    {
      "id": "987870664956102_2218286281914528",
      "created_time": "2025-12-08 16:38:10"
    },
    {
      "id": "987870664956102_2218284571914699",
      "created_time": "2025-12-08 16:34:58"
    },
    {
      "id": "987870664956102_2218282571914899",
      "created_time": "2025-12-08 16:31:15"
    },
    {
      "id": "987870664956102_2218197291923427",
      "created_time": "2025-12-08 13:51:32"
    },
    {
      "id": "987870664956102_2218271945249295",
      "created_time": "2025-12-08 16:11:10"
    },
    {
      "id": "987870664956102_2218240905252399",
      "created_time": "2025-12-08 15:15:49"
    },
    {
      "id": "987870664956102_2218026891940467",
      "created_time": "2025-12-08 08:18:59"
    },
    {
      "id": "987870664956102_2218199698589853",
      "created_time": "2025-12-08 13:55:37"
    },
    {
      "id": "987870664956102_2218045705271919",
      "created_time": "2025-12-08 08:55:56"
    },
    {
      "id": "987870664956102_2218189198590903",
      "created_time": "2025-12-08 13:36:04"
    },
    {
      "id": "987870664956102_2218149185261571",
      "created_time": "2025-12-08 12:18:13"
    },
    {
      "id": "987870664956102_2218120891931067",
      "created_time": "2025-12-08 11:21:44"
    },
    {
      "id": "987870664956102_2218074815269008",
      "created_time": "2025-12-08 09:53:33"
    },
    {
      "id": "987870664956102_2218069138602909",
      "created_time": "2025-12-08 09:41:44"
    },
    {
      "id": "987870664956102_2218114078598415",
      "created_time": "2025-12-08 11:08:33"
    },
    {
      "id": "987870664956102_2218105138599309",
      "created_time": "2025-12-08 10:51:07"
    },
    {
      "id": "987870664956102_2218101631932993",
      "created_time": "2025-12-08 10:44:23"
    },
    {
      "id": "987870664956102_2218098148600008",
      "created_time": "2025-12-08 10:37:05"
    },
    {
      "id": "987870664956102_2218086881934468",
      "created_time": "2025-12-08 10:16:50"
    },
    {
      "id": "987870664956102_2218069041936252",
      "created_time": "2025-12-08 09:41:38"
    },
    {
      "id": "987870664956102_2218056371937519",
      "created_time": "2025-12-08 09:17:29"
    },
    {
      "id": "987870664956102_2218047285271761",
      "created_time": "2025-12-08 08:59:19"
    },
    {
      "id": "987870664956102_2218041918605631",
      "created_time": "2025-12-08 08:48:20"
    },
    {
      "id": "987870664956102_2218037021939454",
      "created_time": "2025-12-08 08:39:07"
    },
    {
      "id": "987870664956102_2218031441940012",
      "created_time": "2025-12-08 08:28:05"
    },
    {
      "id": "987870664956102_2218030248606798",
      "created_time": "2025-12-08 08:25:54"
    },
    {
      "id": "987870664956102_2217963801946776",
      "created_time": "2025-12-08 05:56:19"
    },
    {
      "id": "987870664956102_2217792805297209",
      "created_time": "2025-12-08 00:24:34"
    }
  ]
}
--- END FILE: backend\data\987870664956102_posts_2025-12-8_to_2025-12-14.json ---

--- START FILE: backend\data\runtime_control.json ---
{
  "global_emergency_stop": false,
  "global_pause": false,
  "paused_profiles": [],
  "stopped_profiles": [
    "621e1f5d-0c42-481e-9ddd-7abaafce68ed"
  ],
  "profile_states": {
    "621e1f5d-0c42-481e-9ddd-7abaafce68ed": "STOPPED"
  },
  "updated_at": "2025-12-20T15:01:39.554689+00:00"
}

--- END FILE: backend\data\runtime_control.json ---

--- START FILE: backend\data\post_ids\031ca13d-e8fa-400c-a603-df57a2806788.json ---
[
  {
    "id": "122150960222694490",
    "flag": "xanh",
    "text": "Ná»™i dung mÃ´ phá»ng cho post 122150960222694490",
    "owning_profile": {
      "__typename": "User",
      "name": "Vinfast Tuyá»ƒn Dá»¥ng",
      "id": "61570834715466"
    }
  },
  {
    "id": "101620679431321",
    "flag": "Ä‘á»",
    "text": "Ná»™i dung mÃ´ phá»ng cho post 101620679431321",
    "owning_profile": {
      "__typename": "User",
      "name": "TH True Mart tuyá»ƒn dá»¥ng",
      "id": "100087385844583"
    }
  },
  {
    "id": "1171101481878307",
    "flag": "vÃ ng",
    "text": "Ná»™i dung mÃ´ phá»ng cho post 1171101481878307",
    "owning_profile": {
      "__typename": "User",
      "name": "Americus & Gosani",
      "id": "100069353979673"
    }
  },
  {
    "id": "1273299934841514",
    "flag": "Ä‘á»",
    "text": "Ná»™i dung mÃ´ phá»ng cho post 1273299934841514",
    "owning_profile": {
      "__typename": "User",
      "name": "Google Ads",
      "id": "100064845576688"
    }
  }
]
--- END FILE: backend\data\post_ids\031ca13d-e8fa-400c-a603-df57a2806788.json ---

--- START FILE: backend\data\post_ids\621e1f5d-0c42-481e-9ddd-7abaafce68ed.json ---
[FILE QUÃ Lá»šN - ÄÃƒ Bá»Ž QUA Ná»˜I DUNG]: 2074174 bytes
--- END FILE: backend\data\post_ids\621e1f5d-0c42-481e-9ddd-7abaafce68ed.json ---

--- START FILE: backend\data\results\all_results_summary.json ---
{
  "total_files": 1,
  "results_by_file": {
    "031ca13d-e8fa-400c-a603-df57a2806788.json": [
      {
        "post_id": "122150960222694490",
        "flag": "xanh",
        "text": "Ná»™i dung mÃ´ phá»ng cho post 122150960222694490",
        "owning_profile": {
          "__typename": "User",
          "name": "Vinfast Tuyá»ƒn Dá»¥ng",
          "id": "61570834715466"
        },
        "source_file": "031ca13d-e8fa-400c-a603-df57a2806788.json",
        "profile_id": "031ca13d-e8fa-400c-a603-df57a2806788",
        "reactions": [
          {
            "id": "1214542366",
            "name": "LÃª Tuáº¥n Anh"
          },
          {
            "id": "1292943111",
            "name": "Phan Trung NguyÃªn"
          },
          {
            "id": "1782435515",
            "name": "Ngá»c Äá»©c"
          },
          {
            "id": "61550059940044",
            "name": "Trá»‹nh Máº«n Äáº¡t"
          },
          {
            "id": "61550153908914",
            "name": "QuÃ´c HÃ¹ng VÄƒn"
          },
          {
            "id": "61550190320270",
            "name": "Ha Vo"
          },
          {
            "id": "61550193146115",
            "name": "Duc Phan"
          },
          {
            "id": "61550237573639",
            "name": "VÃµ Háº£i ÄÄƒng"
          },
          {
            "id": "61550750961915",
            "name": "HoÃ ng Thá»‹ Sen"
          },
          {
            "id": "61550772063924",
            "name": "Tráº§n PhÆ°Æ¡ng Thanh"
          },
          {
            "id": "61550999487915",
            "name": "Nguyá»…n Phong"
          },
          {
            "id": "61551546826747",
            "name": "NgÃ´ Quá»‘c Thuáº­n"
          },
          {
            "id": "61551647594740",
            "name": "VÃµ Thanh ThÆ°"
          },
          {
            "id": "61551654736672",
            "name": "Vuphuong Pham"
          },
          {
            "id": "61551910047695",
            "name": "Tho Le"
          },
          {
            "id": "61552290736526",
            "name": "Thong Truong"
          },
          {
            "id": "61552482234494",
            "name": "Pháº¡m Má»¹ HoÃ i"
          },
          {
            "id": "61552731746198",
            "name": "Chinh NgÃ´"
          },
          {
            "id": "61553042151311",
            "name": "BÃ­ch Thá»¥c"
          },
          {
            "id": "61553093332398",
            "name": "Pháº¡m Thoáº¡i"
          },
          {
            "id": "61553310185273",
            "name": "Äáº·ng Lá»‡ Giang"
          },
          {
            "id": "61553376471681",
            "name": "Anh Vinh"
          },
          {
            "id": "61553473583189",
            "name": "Anh Ngacthingoc"
          },
          {
            "id": "61553474652388",
            "name": "HoÃ ng ThiÃªn"
          },
          {
            "id": "61553606457563",
            "name": "VÄƒn ThÆ° TrÆ°Æ¡ng"
          },
          {
            "id": "61553746900864",
            "name": "Tráº§n CÃ´ng ChÃ­nh"
          },
          {
            "id": "61553996652415",
            "name": "LÃª Ban"
          },
          {
            "id": "61554535333110",
            "name": "Nguyá»…n ThÃ nh TÃ´n"
          },
          {
            "id": "61554553051813",
            "name": "Thi ÄÃ i"
          },
          {
            "id": "61554841419040",
            "name": "HoÃ ng Tuáº¥n"
          },
          {
            "id": "61555196481553",
            "name": "Hung Dinh"
          },
          {
            "id": "61555257830327",
            "name": "Tuá»‡ Thi"
          },
          {
            "id": "61555369258413",
            "name": "Chau Nil"
          },
          {
            "id": "61555548130590",
            "name": "Nguyá»…n HoÃ ng Má»¹ An"
          },
          {
            "id": "61555718849183",
            "name": "LÃª VÄƒn Há»¯u"
          },
          {
            "id": "61555758365166",
            "name": "Nguyá»…n Phan BÃ¡ch"
          },
          {
            "id": "61555883115652",
            "name": "ÄÃ o VÄƒn Tháº¯ng"
          },
          {
            "id": "61556221923418",
            "name": "Anh Den"
          },
          {
            "id": "61556416546676",
            "name": "Nguyá»…n Thu"
          },
          {
            "id": "61556429245622",
            "name": "VÃµ Trung TÃ­nh"
          },
          {
            "id": "61556583657121",
            "name": "Pháº¡m Ngá»c Äáº¡i"
          },
          {
            "id": "61556638873141",
            "name": "Nguyá»…n Quang Huy"
          },
          {
            "id": "61556712015558",
            "name": "Tuan Ho Minh"
          },
          {
            "id": "61556751703516",
            "name": "Nguyá»…n ThÆ°Æ¡ng Tháº¿ ThÆ°Æ¡ng"
          },
          {
            "id": "61556892341904",
            "name": "LÃª DÆ°Æ¡ng"
          },
          {
            "id": "61556993636367",
            "name": "PhÃ­ TrÃ­ Phong"
          },
          {
            "id": "61557132958034",
            "name": "Pháº¡m NguyÃªn"
          },
          {
            "id": "61557224086989",
            "name": "Giáº§u ThÃ¬ Äá»•i TÃªn"
          },
          {
            "id": "61557390292291",
            "name": "Äinh VÄƒn LÃ¢m"
          },
          {
            "id": "61557829371662",
            "name": "An Binh"
          },
          {
            "id": "61557873392874",
            "name": "TrÆ°Æ¡ng Äá»©c Hiá»‡u"
          },
          {
            "id": "61557909418384",
            "name": "Tanh Tran"
          },
          {
            "id": "61557965053258",
            "name": "Nguyá»…n HoÃ i Thanh"
          },
          {
            "id": "61558471221863",
            "name": "Quyá»n Äáº·ng Apple"
          },
          {
            "id": "61558823319364",
            "name": "TÃ´i TÃ´i"
          },
          {
            "id": "61559400821880",
            "name": "Viet Pham"
          },
          {
            "id": "61559650302496",
            "name": "Biá»‡n Tháº¿"
          },
          {
            "id": "61559705297714",
            "name": "MÃ¢y Yery"
          },
          {
            "id": "61560035970415",
            "name": "Tráº§n An"
          },
          {
            "id": "61560101372516",
            "name": "Kien Nguyen"
          },
          {
            "id": "61560240163485",
            "name": "TrÆ°Æ¡ng Äáº¡t"
          },
          {
            "id": "61560912545695",
            "name": "ChÃ­ Kiá»‡t LÃª ÄÃ¬nh"
          },
          {
            "id": "61560914474255",
            "name": "Äáº·ng Minh Cáº£nh"
          },
          {
            "id": "61561012500083",
            "name": "Atoshi Andy"
          },
          {
            "id": "61561909633863",
            "name": "Má»«ng Háº¡nh"
          },
          {
            "id": "61562217440547",
            "name": "KÃ­nh CÃ¡t Phan"
          },
          {
            "id": "61563459808331",
            "name": "NhÃ  Äáº¹p Cáº§n ThÆ¡"
          },
          {
            "id": "61563518163679",
            "name": "Ã”ng ToÃ n CÃ¡ NÆ°Æ¡ng"
          },
          {
            "id": "61563565635597",
            "name": "Anhâ€™m Äá»©c"
          },
          {
            "id": "61563845038034",
            "name": "Nguyá»…n Dung"
          },
          {
            "id": "61563904617608",
            "name": "Tráº§n Há»¯u TrÃ¬nh"
          },
          {
            "id": "61564632449852",
            "name": "LÃª VÄƒn Tháº¡ch"
          },
          {
            "id": "61564714274825",
            "name": "Tráº§n Minh ThiÃªn"
          },
          {
            "id": "61565102477144",
            "name": "Hoang Tran"
          },
          {
            "id": "61565476362714",
            "name": "Phan Nguyen Sinh Long"
          },
          {
            "id": "61565563686765",
            "name": "Váº¡n Sá»± TÃ¹y DuyÃªn"
          },
          {
            "id": "61565939900633",
            "name": "Khanh Ngá»c"
          },
          {
            "id": "61566451314348",
            "name": "LÆ°u Quang Nháº­t"
          },
          {
            "id": "61567380088381",
            "name": "NhÆ° Tháº¡ch"
          },
          {
            "id": "61567466173210",
            "name": "LÆ°u ÄÃ¬nh Háº£i"
          },
          {
            "id": "61567481420339",
            "name": "VÅ© Thanh SÆ¡n"
          },
          {
            "id": "61568618935175",
            "name": "Vi Tháº¿ Minh"
          },
          {
            "id": "61569370455682",
            "name": "SÃ¹ng LÃ½"
          },
          {
            "id": "61569645153513",
            "name": "Tráº§n Minh Háº£i"
          },
          {
            "id": "61570721606359",
            "name": "Taxi Äiá»‡n Dak Mil"
          },
          {
            "id": "61571217583855",
            "name": "QuÃ½ ÄÃ¨n"
          },
          {
            "id": "61571321180665",
            "name": "DÅ©ng HoÃ ng"
          },
          {
            "id": "61571638992049",
            "name": "Nguyá»…n HoÃ ng Tuáº¥n"
          },
          {
            "id": "61571877424896",
            "name": "Tráº§n Äá»©c Tuáº¥n"
          },
          {
            "id": "61572283970523",
            "name": "Kha Nguyá»…n"
          },
          {
            "id": "61573027550312",
            "name": "Nguyá»…n Äá»©c"
          },
          {
            "id": "61573064976926",
            "name": "Nguyá»…n VÄƒn Sá»¹"
          },
          {
            "id": "61573491487746",
            "name": "Nguyá»…n Tiáº¿n Máº¡nh"
          },
          {
            "id": "61573537564565",
            "name": "LÃª Táº¥n TÃ i"
          },
          {
            "id": "61573586934658",
            "name": "Tráº§n VÄƒn Tuyáº¿n"
          },
          {
            "id": "61573711706382",
            "name": "Bao Danh"
          },
          {
            "id": "61573763254050",
            "name": "Nao Phuong"
          },
          {
            "id": "61573844124691",
            "name": "Hui Hui"
          },
          {
            "id": "61573915527394",
            "name": "Thanh Hoang"
          },
          {
            "id": "61574001565747",
            "name": "Cao Ngá»c Anh"
          },
          {
            "id": "61574189246513",
            "name": "Thu Háº±ng"
          },
          {
            "id": "61574679824202",
            "name": "Tráº§n Thanh Huyá»n"
          },
          {
            "id": "61574737877584",
            "name": "Linh LÃ m Láº¡i"
          },
          {
            "id": "61575186987078",
            "name": "Äinh Kiá»ƒu Cua Keo"
          },
          {
            "id": "61575282962063",
            "name": "Tráº§n NgÃ´ Nam DÆ°Æ¡ng"
          },
          {
            "id": "61575494616299",
            "name": "NgÃ´ Há»“ PhÆ°Æ¡ng Oanh"
          },
          {
            "id": "61575698109292",
            "name": "Äá»— Mai Lan"
          },
          {
            "id": "61575812472309",
            "name": "LÃª ChÃ­ Báº£o"
          },
          {
            "id": "61575938769222",
            "name": "Trieu Phuc Tuan"
          },
          {
            "id": "61575945382522",
            "name": "Sung Äinh XuÃ¢n"
          },
          {
            "id": "61575949373189",
            "name": "Há»“ XuÃ¢n Æ¯á»›c"
          },
          {
            "id": "61576093173624",
            "name": "Thanh Huyá»n"
          },
          {
            "id": "61576195197717",
            "name": "NghiÃªm XuÃ¢n Hiáº¿u"
          },
          {
            "id": "61576277193461",
            "name": "Nguyá»…n PhÆ°á»›c DÆ°Æ¡ng"
          },
          {
            "id": "61576374425970",
            "name": "Mai Quá»‘c ToÃ n"
          },
          {
            "id": "61576515957045",
            "name": "DÆ°Æ¡ng Minh TÃ¢m"
          },
          {
            "id": "61576662986596",
            "name": "Lee Cáº§u"
          },
          {
            "id": "61576777081809",
            "name": "ÄoÃ n ThÃ´ng"
          },
          {
            "id": "61577042683152",
            "name": "LÃª Minh Hiáº¿u"
          },
          {
            "id": "61577067789924",
            "name": "HÆ°Æ¡ng Nguyá»…n"
          },
          {
            "id": "61577138643696",
            "name": "Pháº¡m HoÃ ng Anh Huyá»n"
          },
          {
            "id": "61577230861839",
            "name": "Äá»— VÄƒn Luáº­t"
          },
          {
            "id": "61577405372435",
            "name": "HÃ¹ng CÆ°á»ng"
          },
          {
            "id": "61577648417717",
            "name": "Váº«n Tháº¿ ThÃ´i"
          },
          {
            "id": "61577695247359",
            "name": "Quá»‘c Phong"
          },
          {
            "id": "61577785595272",
            "name": "Tráº§n Má»¹ Thanh"
          },
          {
            "id": "61577819717298",
            "name": "Minh TÃ¢m"
          },
          {
            "id": "61577834410255",
            "name": "Nguyá»…n HÃ¹ng"
          },
          {
            "id": "61578057123368",
            "name": "Nguyá»…n Khoa"
          },
          {
            "id": "61578387970912",
            "name": "Nguyá»…n Thá»‹ Háº¡nh PhÆ°á»›c"
          },
          {
            "id": "61578514164788",
            "name": "Thanh TÃ¢m NgÃ´"
          },
          {
            "id": "61578775288506",
            "name": "Máº¡nh Tuáº¥n"
          },
          {
            "id": "61578869934824",
            "name": "NgÃ´ Thanh ThÃ¹y"
          },
          {
            "id": "61579032569407",
            "name": "Pháº¡m Anh Tuáº¥n"
          },
          {
            "id": "61579309906747",
            "name": "Nguyá»…n Má»¹ Ãi"
          },
          {
            "id": "61579322157993",
            "name": "Binh Dang"
          },
          {
            "id": "61579778518833",
            "name": "Vu Huong"
          },
          {
            "id": "61580044954504",
            "name": "Nguyá»…n Nguyá»‡t"
          },
          {
            "id": "61580054685764",
            "name": "Mai Tháº¿ TÃ i"
          },
          {
            "id": "61580129107195",
            "name": "Nguyá»…n Minh Nháº­t TrÆ°á»ng"
          },
          {
            "id": "61580160249454",
            "name": "BÃ¹i Táº¥n Duy"
          },
          {
            "id": "61580641012868",
            "name": "Tháº¿ LÆ°u"
          },
          {
            "id": "61580808189151",
            "name": "Trá»‹nh Minh PhÃ¡t"
          },
          {
            "id": "61580864793716",
            "name": "Tháº£o Má»™c TrÃ "
          },
          {
            "id": "61580866906116",
            "name": "Nguyá»…n DÃ¬n"
          },
          {
            "id": "61581209631243",
            "name": "Nguyá»…n Viá»‡t KhuÃª"
          },
          {
            "id": "61581237090879",
            "name": "VÅ© Duy Ngá»c"
          },
          {
            "id": "61581346027157",
            "name": "Tráº§n Tiáº¿n Lá»±c"
          },
          {
            "id": "61581444254432",
            "name": "HÃ  QuÃ½ Äá»©c"
          },
          {
            "id": "61581512801129",
            "name": "Äáº·ng ÄÃ¬nh Hiá»‡p"
          },
          {
            "id": "61581694171594",
            "name": "VÃµ ÄÃ o TÆ°á»ng Vy"
          },
          {
            "id": "61581755460218",
            "name": "KiÃªn Tiáº¿n Äáº¡t"
          },
          {
            "id": "61581815861776",
            "name": "Nguyá»…n CÃ´ng Hiá»‡n"
          },
          {
            "id": "61581865704920",
            "name": "Thuá»· Nguyá»…n"
          },
          {
            "id": "61582009840036",
            "name": "Huong Mai"
          },
          {
            "id": "61582461015714",
            "name": "Tráº§n Huy Tháº¯ng"
          },
          {
            "id": "61582737447639",
            "name": "LÃª Äá»— Má»¹ Khanh"
          },
          {
            "id": "61582942364053",
            "name": "HÃ  TÃ¢m NhÆ°"
          },
          {
            "id": "61583197623099",
            "name": "NghiÃªm VÄƒn HoÃ n"
          },
          {
            "id": "61584126890019",
            "name": "Tiáº¿n TÃ¹ng LÃª"
          },
          {
            "id": "100000053375494",
            "name": "Andrena Cao"
          },
          {
            "id": "100000110883929",
            "name": "Ha Thanh Chung"
          },
          {
            "id": "100000123602180",
            "name": "VÅ© Tuáº¥nAnh"
          },
          {
            "id": "100000229685165",
            "name": "Thanh Tuan Pham"
          },
          {
            "id": "100000270213526",
            "name": "Chabelita Vu"
          },
          {
            "id": "100000293909088",
            "name": "XuÃ¢n TÃ i"
          },
          {
            "id": "100000300630646",
            "name": "Äá»— Quá»‘c Máº¡nh"
          },
          {
            "id": "100000313608123",
            "name": "Báº¡ch Long XuyÃªn"
          },
          {
            "id": "100000331590407",
            "name": "Duy Nam"
          },
          {
            "id": "100000335125295",
            "name": "BÃ¬nh Nguyá»…n"
          },
          {
            "id": "100000445478354",
            "name": "Pháº¡m ThÃ¡i"
          },
          {
            "id": "100000739121968",
            "name": "Van Nguyen"
          },
          {
            "id": "100000743953886",
            "name": "Quang ThÃ nh"
          },
          {
            "id": "100000771188377",
            "name": "Duy NhÆ¡n"
          },
          {
            "id": "100000877793278",
            "name": "Hachai Nguyen"
          },
          {
            "id": "100000972454358",
            "name": "KhÃ¡nh Nguyá»…n"
          },
          {
            "id": "100001367930839",
            "name": "Tráº§n DÅ©ngAnh"
          },
          {
            "id": "100001466315573",
            "name": "Hai Tran"
          },
          {
            "id": "100001486282365",
            "name": "Vinh Nguyá»…n"
          },
          {
            "id": "100001508273313",
            "name": "HoÃ ng VÄƒn TrÆ°á»ng"
          },
          {
            "id": "100001583151656",
            "name": "NgÆ°á»i NgoÃ i HÃ nh Lang"
          },
          {
            "id": "100001812224676",
            "name": "Doan Xuan Dung"
          },
          {
            "id": "100001849817525",
            "name": "LÆ°u XuÃ¢n VÅ©"
          },
          {
            "id": "100001857517697",
            "name": "Há»“ Viá»‡t"
          },
          {
            "id": "100001904097247",
            "name": "LÃª VÄƒn NhÃ¢t Long"
          },
          {
            "id": "100001950724213",
            "name": "Nguyá»…n Há»¯u Tháº¯ng"
          },
          {
            "id": "100001958186770",
            "name": "Nguyá»…n Tuáº¥n"
          },
          {
            "id": "100002096463126",
            "name": "Viet Duc Nguyen"
          },
          {
            "id": "100002163243089",
            "name": "Tá» Ron"
          },
          {
            "id": "100002170368238",
            "name": "HÃ  Kiá»‡t HÃ¹ng"
          },
          {
            "id": "100002219822412",
            "name": "Nho KhÃ¡nh HoÃ ng"
          },
          {
            "id": "100002523274564",
            "name": "Sá»¹ ÄÃ o"
          },
          {
            "id": "100002705281662",
            "name": "Hoang Huy"
          },
          {
            "id": "100002798834494",
            "name": "VÅ© VÆ°Æ¡ng"
          },
          {
            "id": "100002842993642",
            "name": "miá»n trung QuÃª TÃ´i"
          },
          {
            "id": "100002912316049",
            "name": "Ha Bao Phuong"
          },
          {
            "id": "100002923482352",
            "name": "KaKey XuÃ¢n"
          },
          {
            "id": "100002924475529",
            "name": "LiÃªm Äá»—"
          },
          {
            "id": "100002932924215",
            "name": "CÆ°á»ng LÃ½ VÄƒn"
          },
          {
            "id": "100002952012000",
            "name": "TrÆ°Æ¡ng Thanh Sang"
          },
          {
            "id": "100002962687396",
            "name": "Khoa Nguyá»…n"
          },
          {
            "id": "100003000268039",
            "name": "Nguyá»…n Trung ThÃ nh"
          },
          {
            "id": "100003003406713",
            "name": "KhÃ´i Tráº§n"
          },
          {
            "id": "100003032147513",
            "name": "Huy HÆ°ng Nguyá»…n"
          },
          {
            "id": "100003035652086",
            "name": "Ráº·ng TrÃ¢m Báº§u"
          },
          {
            "id": "100003036497563",
            "name": "VÆ°Æ¡ng LÃª"
          },
          {
            "id": "100003093205201",
            "name": "HoangThanh Phong Tran"
          },
          {
            "id": "100003108176843",
            "name": "Tran Tuan Tinh"
          },
          {
            "id": "100003109606876",
            "name": "Nháº­t ThiÃªn"
          },
          {
            "id": "100003114304714",
            "name": "Anh Viá»‡t"
          },
          {
            "id": "100003180291163",
            "name": "LÃ² HÆ°ng"
          },
          {
            "id": "100003185754303",
            "name": "Tran Huong"
          },
          {
            "id": "100003198944590",
            "name": "Sá»‘ Äáº¹p BÃ¬nh Thuáº­n"
          },
          {
            "id": "100003199621562",
            "name": "Nguyá»…n PhÆ°Æ¡ng"
          },
          {
            "id": "100003213000140",
            "name": "Nguyá»…n Duy VÆ°Æ¡ng"
          },
          {
            "id": "100003226587524",
            "name": "Tráº§n LÃª Nam"
          },
          {
            "id": "100003260319685",
            "name": "Pháº¡m Anh Tuáº¥n"
          },
          {
            "id": "100003265082843",
            "name": "Le Pin"
          },
          {
            "id": "100003281408213",
            "name": "Quá»³nh Khang"
          },
          {
            "id": "100003291099861",
            "name": "SÆ¡n Os Car"
          },
          {
            "id": "100003348321446",
            "name": "Pham Thuc Tri"
          },
          {
            "id": "100003378679843",
            "name": "Tráº§n Tháº¿ Ã‚n"
          },
          {
            "id": "100003486531925",
            "name": "Tuáº¥n VÃµ"
          },
          {
            "id": "100003498836725",
            "name": "LÃª Táº¥n VÄ©nh"
          },
          {
            "id": "100003514916931",
            "name": "Ngá»c Danh"
          },
          {
            "id": "100003636438879",
            "name": "Chu Äá»©c Huy"
          },
          {
            "id": "100003652865575",
            "name": "Nguyá»…n Äá»©c DÅ©ng"
          },
          {
            "id": "100003662906000",
            "name": "Son Nguyenhuynh"
          },
          {
            "id": "100003673515294",
            "name": "Binh Le"
          },
          {
            "id": "100003677476266",
            "name": "Tuáº¥n TÃ "
          },
          {
            "id": "100003680438191",
            "name": "Nguyen Trung"
          },
          {
            "id": "100003687615809",
            "name": "Tho Coca"
          },
          {
            "id": "100003716411480",
            "name": "Nguyá»…n ÄÃ´n Quá»‘c Huy"
          },
          {
            "id": "100003725988498",
            "name": "Sociall Chan"
          },
          {
            "id": "100003749691542",
            "name": "Pháº¡m Quang Huy"
          },
          {
            "id": "100003756016525",
            "name": "Minh Tuáº¥n"
          },
          {
            "id": "100003778875989",
            "name": "Binh Phan"
          },
          {
            "id": "100003789181191",
            "name": "Ho Thai"
          },
          {
            "id": "100003801107711",
            "name": "HÆ°ng Nguyá»…n"
          },
          {
            "id": "100003804268466",
            "name": "Tá»‘ng VÄƒn Háº£i"
          },
          {
            "id": "100003807622700",
            "name": "Kháº¯c QuÃ½"
          },
          {
            "id": "100003814183607",
            "name": "Nguyá»…n TÃ¹ng"
          },
          {
            "id": "100003829609506",
            "name": "NguyÃªn Tem"
          },
          {
            "id": "100003890425671",
            "name": "Duy Nguyen"
          },
          {
            "id": "100003909051692",
            "name": "An LÃª"
          },
          {
            "id": "100003932734095",
            "name": "ThÃ nh Kyo"
          },
          {
            "id": "100003953913292",
            "name": "DÅ©ng Nguyá»…n Minh"
          },
          {
            "id": "100003967388299",
            "name": "Jacku Chau Kelbum"
          },
          {
            "id": "100003987673444",
            "name": "ThÃ¡i Hiá»ƒn Mercedes-Benz"
          },
          {
            "id": "100003996916839",
            "name": "VÅ© Nam Tháº¯ng"
          },
          {
            "id": "100004004265686",
            "name": "Tiáº¿n NguyÃªn XuÃ¢n"
          },
          {
            "id": "100004030554678",
            "name": "Tu Phamvan"
          },
          {
            "id": "100004030849137",
            "name": "Anh VÅ©"
          },
          {
            "id": "100004042764799",
            "name": "Thá»§y Tráº§n"
          },
          {
            "id": "100004057419411",
            "name": "Tráº§n Khoa"
          },
          {
            "id": "100004076505781",
            "name": "HÃ  An"
          },
          {
            "id": "100004077823939",
            "name": "Tráº§n Quá»‘c Toáº£n"
          },
          {
            "id": "100004078771805",
            "name": "Dinh Anh"
          },
          {
            "id": "100004080587874",
            "name": "Tráº§n ÄÃ¬nh Máº¡nh"
          },
          {
            "id": "100004080901822",
            "name": "Chinh Nguyá»…n"
          },
          {
            "id": "100004090248677",
            "name": "Linh PhÃ¡t"
          },
          {
            "id": "100004100214009",
            "name": "Nam Pháº¡m"
          },
          {
            "id": "100004100562440",
            "name": "Háº£i Äx"
          },
          {
            "id": "100004112928159",
            "name": "Minh Thao"
          },
          {
            "id": "100004177718050",
            "name": "Báº£o Ngá»c"
          },
          {
            "id": "100004200002394",
            "name": "Bang Kute"
          },
          {
            "id": "100004214313772",
            "name": "Nhat Minh Pham Dang"
          },
          {
            "id": "100004219354599",
            "name": "Nguyá»…n Tuáº¥n"
          },
          {
            "id": "100004252146019",
            "name": "Nguyá»…n Tráº§n Quáº¿ LÃ¢m"
          },
          {
            "id": "100004267990780",
            "name": "LÆ°Æ¡ng Quá»³nh"
          },
          {
            "id": "100004276817387",
            "name": "Pháº¡m VÄƒn Há»¯u"
          },
          {
            "id": "100004305962879",
            "name": "Báº¯c Camry"
          },
          {
            "id": "100004306931350",
            "name": "ÄoÃ n BÃ­ch Ngá»c"
          },
          {
            "id": "100004313885329",
            "name": "Tan Binh"
          },
          {
            "id": "100004343610637",
            "name": "Äá»©c Äá»™"
          },
          {
            "id": "100004347813032",
            "name": "Há»¯u Thá»¥y"
          },
          {
            "id": "100004361805877",
            "name": "Hanh Phan"
          },
          {
            "id": "100004363118985",
            "name": "Hongmen Nguyen"
          },
          {
            "id": "100004371098477",
            "name": "PhÆ°Æ¡ng Nam Stone"
          },
          {
            "id": "100004381384017",
            "name": "PhÃ¡p VÃµ"
          },
          {
            "id": "100004389006642",
            "name": "Phan Huy"
          },
          {
            "id": "100004402931304",
            "name": "Nguyá»…n ThÃ nh Trung"
          },
          {
            "id": "100004410096237",
            "name": "Äá»— Tiáº¿n Vinh"
          },
          {
            "id": "100004411442941",
            "name": "TÃ¹ng TÃ¹ng"
          },
          {
            "id": "100004457105191",
            "name": "LÃª CÃºc"
          },
          {
            "id": "100004458961932",
            "name": "Huá»³nh Quang VÄ©nh"
          },
          {
            "id": "100004460194040",
            "name": "Luáº­n Nguyá»…n"
          },
          {
            "id": "100004471183096",
            "name": "Lá»u TÃº"
          },
          {
            "id": "100004472953126",
            "name": "Tráº§n VÆ°Æ¡ng"
          },
          {
            "id": "100004488077365",
            "name": "Hung Pham"
          },
          {
            "id": "100004501097561",
            "name": "Hiá»n HoÃ ng"
          },
          {
            "id": "100004505400037",
            "name": "Tráº§n HoÃ ng DÅ©ng"
          },
          {
            "id": "100004521220150",
            "name": "Nguyá»…n Thá»‹ Há»“ng TrÃ¢m"
          },
          {
            "id": "100004525081021",
            "name": "Nguyá»…n Táº¥n Quáº£ng"
          },
          {
            "id": "100004533972894",
            "name": "Äinh CÃ´ng TÃ¹ng"
          },
          {
            "id": "100004544404009",
            "name": "Äá»©c Quá»³nh"
          },
          {
            "id": "100004573716163",
            "name": "Nguyá»…n LÃª Phong PhÃº"
          },
          {
            "id": "100004601116015",
            "name": "Nguyen Huong"
          },
          {
            "id": "100004623810946",
            "name": "Tuáº¥n Keyboard"
          },
          {
            "id": "100004645301626",
            "name": "NhÆ° SÆ¡n Lá»£i"
          },
          {
            "id": "100004650003227",
            "name": "DÅ©ng TrÃ  VÄƒn"
          },
          {
            "id": "100004664855379",
            "name": "Vi Há»c"
          },
          {
            "id": "100004678741233",
            "name": "Nguyen Anh Dung"
          },
          {
            "id": "100004692610476",
            "name": "Khanh Pham"
          },
          {
            "id": "100004693632157",
            "name": "DÃ²ng SÃ´ng Ko Táº¯c"
          },
          {
            "id": "100004720993485",
            "name": "Quoc Giau"
          },
          {
            "id": "100004740183122",
            "name": "Huuloi Nguyen"
          },
          {
            "id": "100004758912094",
            "name": "LÃª Äá»©c"
          },
          {
            "id": "100004791406165",
            "name": "Tiáº¿n Há»“ng"
          },
          {
            "id": "100004821126371",
            "name": "LÃª Há»“ng GiÃ¡p"
          },
          {
            "id": "100004828269961",
            "name": "TrÆ°á»Ÿng Tráº§n ÄÃ¬nh"
          },
          {
            "id": "100004835075640",
            "name": "Tráº§n VÄƒn Toáº£n"
          },
          {
            "id": "100004845454844",
            "name": "LÃª VÄƒn ThÃ nh"
          },
          {
            "id": "100004873443869",
            "name": "NguyÃªÌƒn ThÃ¡i HoÃ ng"
          },
          {
            "id": "100004878213052",
            "name": "Cá»§ Cáº£i"
          },
          {
            "id": "100004878877577",
            "name": "ChÃº TÃ i"
          },
          {
            "id": "100004891631473",
            "name": "Tráº¯ng Äen"
          },
          {
            "id": "100004912120953",
            "name": "HoÃ ng CÃ´ng Trang"
          },
          {
            "id": "100004914648434",
            "name": "Gia Phu Luu"
          },
          {
            "id": "100004923665770",
            "name": "Giang Truong"
          },
          {
            "id": "100004931131732",
            "name": "CÃ´ng TÃ¹ng"
          },
          {
            "id": "100004935077214",
            "name": "Äá»©c Long"
          },
          {
            "id": "100004947610393",
            "name": "ÄÆ°á»£c Gato"
          },
          {
            "id": "100004948902319",
            "name": "Gia Nguyen"
          },
          {
            "id": "100004951294465",
            "name": "Nam Ngoc Tran"
          },
          {
            "id": "100004962607216",
            "name": "Knhan Kha"
          },
          {
            "id": "100004977885980",
            "name": "TÃ¢m Minh VI"
          },
          {
            "id": "100004993363800",
            "name": "My Linh"
          },
          {
            "id": "100005016546857",
            "name": "Phan Nháº­t"
          },
          {
            "id": "100005078329276",
            "name": "ChÃº Ngá»c"
          },
          {
            "id": "100005084799324",
            "name": "LÃª Phan Duy"
          },
          {
            "id": "100005109164185",
            "name": "Quang DÄ©nh"
          },
          {
            "id": "100005189943891",
            "name": "Phuong Van"
          },
          {
            "id": "100005213730731",
            "name": "Pháº¡m Ngá»c SÆ¡n"
          },
          {
            "id": "100005221662486",
            "name": "Minh Hue"
          },
          {
            "id": "100005223697774",
            "name": "DuyÃªn Nguyá»…n"
          },
          {
            "id": "100005239566602",
            "name": "Minh ÄoÃ n"
          },
          {
            "id": "100005250155779",
            "name": "BÃ¹i Quáº¿ SÆ¡n"
          },
          {
            "id": "100005259790122",
            "name": "Nguyá»…n Tiáº¿n Äá»™"
          },
          {
            "id": "100005272868493",
            "name": "Báº¯c Kiá»u Phong"
          },
          {
            "id": "100005277759278",
            "name": "CÆ°á»ng HoÃ ng Quá»‘c"
          },
          {
            "id": "100005290246770",
            "name": "Äá»— Kim"
          },
          {
            "id": "100005308805741",
            "name": "ChÃ¢n Lá»‡"
          },
          {
            "id": "100005310645533",
            "name": "Nguyen Ngoc"
          },
          {
            "id": "100005342896623",
            "name": "Váº¡n Sá»± Tuá»³ DuyÃªn"
          },
          {
            "id": "100005364911950",
            "name": "Luathi Do"
          },
          {
            "id": "100005369113786",
            "name": "Phong Kieu"
          },
          {
            "id": "100005389773203",
            "name": "Huong Vo"
          },
          {
            "id": "100005393534513",
            "name": "VÅ© Duáº«n"
          },
          {
            "id": "100005400192970",
            "name": "LÃª Tháº¯ng"
          },
          {
            "id": "100005430543435",
            "name": "Thoai Huu"
          },
          {
            "id": "100005434384830",
            "name": "DucTrung Mai"
          },
          {
            "id": "100005436226525",
            "name": "Triá»‡u VÄƒn Ãšt"
          },
          {
            "id": "100005436524598",
            "name": "HoÃ ng Thanh"
          },
          {
            "id": "100005440874625",
            "name": "HoÃ ng VÄƒn HÆ°ng"
          },
          {
            "id": "100005474374423",
            "name": "Nguyen Thanh Hung"
          },
          {
            "id": "100005474920722",
            "name": "Tuyá»n Nguyá»…n"
          },
          {
            "id": "100005476217128",
            "name": "Dang Bao"
          },
          {
            "id": "100005511273550",
            "name": "SÃ¡ng VÅ©"
          },
          {
            "id": "100005532223758",
            "name": "Nguyen Minh Khoa"
          },
          {
            "id": "100005592932500",
            "name": "Nguyá»…n VÄƒn Doanh"
          },
          {
            "id": "100005618498479",
            "name": "Háº¡nh Mfast"
          },
          {
            "id": "100005629265097",
            "name": "HoÃ ng TrÆ°á»ng"
          },
          {
            "id": "100005634914100",
            "name": "HÃ  TrÃ­ TrÆ°á»ng"
          },
          {
            "id": "100005637397028",
            "name": "Nguyen Thanh Han"
          },
          {
            "id": "100005668684964",
            "name": "Kim Ly Van"
          },
          {
            "id": "100005686478750",
            "name": "Hoangnhut Nguyen"
          },
          {
            "id": "100005691152298",
            "name": "VÄƒn DÅ©ng"
          },
          {
            "id": "100005697936923",
            "name": "Nguyen Manh Tu"
          },
          {
            "id": "100005702057312",
            "name": "Thá»§y Äáº¡t"
          },
          {
            "id": "100005850397639",
            "name": "Trá»‹nh Quá»‘c Viá»‡t"
          },
          {
            "id": "100005860711804",
            "name": "LÃª ChÃ­ Äáº¡i"
          },
          {
            "id": "100005871247063",
            "name": "CÃ¡ LÃ³c Äá»“ng"
          },
          {
            "id": "100005905716860",
            "name": "Khiem Pham"
          },
          {
            "id": "100005913486642",
            "name": "GBosco Nguyá»…n"
          },
          {
            "id": "100005920830743",
            "name": "Quynh Trang"
          },
          {
            "id": "100005933920342",
            "name": "Quá»‘c TrÆ°Æ¡ng"
          },
          {
            "id": "100005948052217",
            "name": "XuÃ¢n Äiá»m XuÃ¢n Äiá»m"
          },
          {
            "id": "100005956292499",
            "name": "Ca TrÃ¢ng"
          },
          {
            "id": "100005987466839",
            "name": "DÆ°Æ¡ng Trá»‹nh"
          },
          {
            "id": "100006021090930",
            "name": "Äiá»‡n Tá»­ Vo Thien"
          },
          {
            "id": "100006055116186",
            "name": "Pháº¡m Háº£i"
          },
          {
            "id": "100006088536710",
            "name": "Nguyen Nam Long"
          },
          {
            "id": "100006114274865",
            "name": "Sang VÃµ"
          },
          {
            "id": "100006132164415",
            "name": "Nguyá»…n Há»¯u NhÃ¢n"
          },
          {
            "id": "100006144248952",
            "name": "Nam Tráº§n Huy"
          },
          {
            "id": "100006178006981",
            "name": "NhÆ° Ã Phan"
          },
          {
            "id": "100006201374839",
            "name": "Xuan Nguyen"
          },
          {
            "id": "100006274262365",
            "name": "Giang Tran"
          },
          {
            "id": "100006280080935",
            "name": "ÄoÃ n Tháº¿ SÆ¡n"
          },
          {
            "id": "100006311802258",
            "name": "Rockerdieucay Nguyen"
          },
          {
            "id": "100006331740916",
            "name": "Si Vo"
          },
          {
            "id": "100006335761739",
            "name": "Nguyá»…n Viáº¿t KhÃ¡nh"
          },
          {
            "id": "100006336307775",
            "name": "Trai Ngoc HoÃ ng"
          },
          {
            "id": "100006358570209",
            "name": "Mai TÆ°Æ¡ng"
          },
          {
            "id": "100006411037860",
            "name": "Dang Thang"
          },
          {
            "id": "100006430445403",
            "name": "NgÃ´ Há»¯u PhÆ°á»›c"
          },
          {
            "id": "100006441069339",
            "name": "Hau Thanh"
          },
          {
            "id": "100006458114368",
            "name": "AHÃ¹ng Phan"
          },
          {
            "id": "100006458318397",
            "name": "Tráº§n Äáº¡t"
          },
          {
            "id": "100006485410251",
            "name": "Äá»©c ThÆ°á»Ÿng"
          },
          {
            "id": "100006485952546",
            "name": "Kim Ngo"
          },
          {
            "id": "100006487448178",
            "name": "VÅ© Há»“ng HÃ "
          },
          {
            "id": "100006492302354",
            "name": "Nguyá»…n Viá»‡t HoÃ ng"
          },
          {
            "id": "100006526034323",
            "name": "HoÃ ng á»c"
          },
          {
            "id": "100006539737769",
            "name": "Nguyá»…n DÅ©ng"
          },
          {
            "id": "100006547662125",
            "name": "ThÃ¡i CÆ°Æ¡ng"
          },
          {
            "id": "100006573662878",
            "name": "Nguyá»…n LÃ i TÃ¢m"
          },
          {
            "id": "100006588751429",
            "name": "Abhilekh Kumar"
          },
          {
            "id": "100006598930466",
            "name": "Huyen Sam"
          },
          {
            "id": "100006603673365",
            "name": "Äá»©c BÃ¬nh"
          },
          {
            "id": "100006610416402",
            "name": "Ngoc Khanh Ngoc Nguyen"
          },
          {
            "id": "100006614348795",
            "name": "Háº±ng Kem"
          },
          {
            "id": "100006639345122",
            "name": "SÆ¡n LÃª Há»“ng"
          },
          {
            "id": "100006646428287",
            "name": "Tráº§n Thá»‹ Háº±ng"
          },
          {
            "id": "100006659744444",
            "name": "HÆ°ng Äinh"
          },
          {
            "id": "100006663578211",
            "name": "Van De Ha"
          },
          {
            "id": "100006670560114",
            "name": "Nguyá»…n Minh TÃ¢m"
          },
          {
            "id": "100006684305517",
            "name": "Cuong Do"
          },
          {
            "id": "100006688203144",
            "name": "Ngocvandien Ngoc"
          },
          {
            "id": "100006713836529",
            "name": "Äáº·ng Tiáº¿n Máº¡nh"
          },
          {
            "id": "100006725167075",
            "name": "Sá»· HÃ¹ng"
          },
          {
            "id": "100006788239488",
            "name": "Kháº£i TC"
          },
          {
            "id": "100006828812149",
            "name": "Hai Con CuÃ´ng"
          },
          {
            "id": "100006862306834",
            "name": "HÃ¹ng Äá»— Máº¡nh"
          },
          {
            "id": "100006876256521",
            "name": "Hieu Tran"
          },
          {
            "id": "100006918856776",
            "name": "Ngá»c Hiáº¿u"
          },
          {
            "id": "100006936967422",
            "name": "Heo Con Pham"
          },
          {
            "id": "100006977445554",
            "name": "Ho Ty"
          },
          {
            "id": "100007011754166",
            "name": "Hoang Carlos"
          },
          {
            "id": "100007055490136",
            "name": "Quang ClÃª"
          },
          {
            "id": "100007080754865",
            "name": "Duong Thanh Hoai"
          },
          {
            "id": "100007088110629",
            "name": "Kevin DÆ°Æ¡ng"
          },
          {
            "id": "100007097866545",
            "name": "Trang PhÃ¹ng"
          },
          {
            "id": "100007100203328",
            "name": "Nguyá»…n ÄÄƒng Há»£i"
          },
          {
            "id": "100007117951675",
            "name": "Thoan VÅ©"
          },
          {
            "id": "100007132061779",
            "name": "Trá»‹nh HoÃ ng"
          },
          {
            "id": "100007137696020",
            "name": "El Kháº£"
          },
          {
            "id": "100007155450757",
            "name": "Tráº§n PhÃº"
          },
          {
            "id": "100007161571294",
            "name": "Sá»¹ Nam LÃª"
          },
          {
            "id": "100007398428883",
            "name": "Ã Milano"
          },
          {
            "id": "100007401700913",
            "name": "HoÃ ng ThÃ nh"
          },
          {
            "id": "100007409956911",
            "name": "Na Cherry"
          },
          {
            "id": "100007492020652",
            "name": "Cáº©m TÃº"
          },
          {
            "id": "100007492099092",
            "name": "Quynh Yen"
          },
          {
            "id": "100007548750974",
            "name": "Nguyá»…n ThÃ nh Nam"
          },
          {
            "id": "100007581607803",
            "name": "Tháº¡nh LÃª"
          },
          {
            "id": "100007625044641",
            "name": "Lienhoang Lienhoang"
          },
          {
            "id": "100007659499002",
            "name": "Good"
          },
          {
            "id": "100007761669245",
            "name": "Quá»‘c ChÃ­"
          },
          {
            "id": "100007786844087",
            "name": "Linhda Thach"
          },
          {
            "id": "100007792452826",
            "name": "Báº¡ch Dinh Nga"
          },
          {
            "id": "100007798502709",
            "name": "HoÃ ng Minh Yáº¿n"
          },
          {
            "id": "100007874500326",
            "name": "LÃª VÄƒn HÃ "
          },
          {
            "id": "100007909069433",
            "name": "Huá»³nh Quá»‘c Kiá»‡t"
          },
          {
            "id": "100007927878662",
            "name": "Há»¯u Viá»‡t"
          },
          {
            "id": "100007949389490",
            "name": "Dung Tran"
          },
          {
            "id": "100007951984952",
            "name": "Chuong Phan"
          },
          {
            "id": "100007962273267",
            "name": "VÅ© Thá»¥c Khanh"
          },
          {
            "id": "100007978717592",
            "name": "Trinh XuÃ¢n SÆ°"
          },
          {
            "id": "100008014325245",
            "name": "HoÃ ng LÃª"
          },
          {
            "id": "100008046061859",
            "name": "BT Diá»…m UyÃªn"
          },
          {
            "id": "100008067069498",
            "name": "Quan Phan"
          },
          {
            "id": "100008076999861",
            "name": "Hocdeptrai Nguyen"
          },
          {
            "id": "100008077140703",
            "name": "Nguyá»…n ÄÃ¬nhThuyÃªn"
          },
          {
            "id": "100008127374813",
            "name": "Nguyá»…n ThÃ nh CÃ´ng"
          },
          {
            "id": "100008135494840",
            "name": "Äinh Tháº¿ TÃ i"
          },
          {
            "id": "100008165192348",
            "name": "Viá»‡tt AAnh"
          },
          {
            "id": "100008285864549",
            "name": "Tuan Cao"
          },
          {
            "id": "100008293622112",
            "name": "ThÃ¹y HÆ°ng NgÃ´"
          },
          {
            "id": "100008363706067",
            "name": "Thao Tran"
          },
          {
            "id": "100008408917781",
            "name": "Thá»ƒ ThÃ¡i QuÃ´c"
          },
          {
            "id": "100008435970473",
            "name": "Tuan Le"
          },
          {
            "id": "100008437486642",
            "name": "Thao Nguyen"
          },
          {
            "id": "100008446634919",
            "name": "LÃ­nh LÃ­nh"
          },
          {
            "id": "100008449080812",
            "name": "LÆ°Æ¡ng HoÃ ng SÆ¡n"
          },
          {
            "id": "100008459286791",
            "name": "Nhá»‹n Nháº«n"
          },
          {
            "id": "100008463697571",
            "name": "Káº¿t Phan"
          },
          {
            "id": "100008562035716",
            "name": "Ly Meo"
          },
          {
            "id": "100008608894306",
            "name": "Nam Nguyen"
          },
          {
            "id": "100008621820819",
            "name": "HO Sung"
          },
          {
            "id": "100008775306925",
            "name": "Bac Nguyen Anh Bac"
          },
          {
            "id": "100008848298072",
            "name": "Äáº·ng Diá»‡p Minh"
          },
          {
            "id": "100008858381523",
            "name": "Há»“ ÄÆ¡n PhÆ°Æ¡ng"
          },
          {
            "id": "100008861194363",
            "name": "ÄÃ´ng VÅ©"
          },
          {
            "id": "100008939113432",
            "name": "Bach Cong Tu"
          },
          {
            "id": "100008958123188",
            "name": "Kim TÃ¹ng"
          },
          {
            "id": "100009080135472",
            "name": "Le Vinh"
          },
          {
            "id": "100009105455492",
            "name": "Nguyá»…n Viá»‡t Minh Tuáº¥n"
          },
          {
            "id": "100009123352323",
            "name": "Nguyá»…n HÃ "
          },
          {
            "id": "100009123623871",
            "name": "Giang Äá»—"
          },
          {
            "id": "100009171300589",
            "name": "Tuáº¥n DÆ°Æ¡ng"
          },
          {
            "id": "100009191338441",
            "name": "Há»“ Nguyá»…n"
          },
          {
            "id": "100009199769587",
            "name": "Tráº§n HÃ¢n"
          },
          {
            "id": "100009201297565",
            "name": "Ngá»c KhÃ¡nh Há»“"
          },
          {
            "id": "100009227039386",
            "name": "Luong Dung"
          },
          {
            "id": "100009227854992",
            "name": "GiÃ¡p BÃ¹i"
          },
          {
            "id": "100009247263432",
            "name": "Há»©a HÆ°nG"
          },
          {
            "id": "100009302872140",
            "name": "Dai Chinh"
          },
          {
            "id": "100009310301444",
            "name": "Nguyá»…n ThiÃªn PhÆ°á»›c"
          },
          {
            "id": "100009335739145",
            "name": "Huá»³nh Táº¥n"
          },
          {
            "id": "100009373329006",
            "name": "Vi VÄƒn HÃ¹ng"
          },
          {
            "id": "100009494950965",
            "name": "ThÃ nh LuÃ¢n"
          },
          {
            "id": "100009517237227",
            "name": "LÃª Máº¡nh"
          },
          {
            "id": "100009601836282",
            "name": "Nguyá»…n Báº£o Huy"
          },
          {
            "id": "100009638105875",
            "name": "Nguyá»…n ThÃ nh NhÃ¢n"
          },
          {
            "id": "100009654405604",
            "name": "SÆ¡n Long"
          },
          {
            "id": "100009728507234",
            "name": "Há»“ Sá»¹ Háº£i QuÃ¢n"
          },
          {
            "id": "100009806287512",
            "name": "Quang Khai Dam"
          },
          {
            "id": "100009887071759",
            "name": "Káº» PhÃ¹ Du"
          },
          {
            "id": "100009900585261",
            "name": "LÆ°Æ¡ng VÄƒn Nghiá»‡p"
          },
          {
            "id": "100009956405807",
            "name": "Tráº§n Ngá»c"
          },
          {
            "id": "100009976338657",
            "name": "LÃª Tháº¯ng"
          },
          {
            "id": "100010064766848",
            "name": "Pháº¡m Tuáº¥n"
          },
          {
            "id": "100010071044607",
            "name": "Nguyá»…n QuÃ½ TrÆ°á»ng"
          },
          {
            "id": "100010090487339",
            "name": "Le Huy Hai"
          },
          {
            "id": "100010107045833",
            "name": "JR Nam"
          },
          {
            "id": "100010144590899",
            "name": "Cao Tri"
          },
          {
            "id": "100010189992522",
            "name": "pháº¡m doanh"
          },
          {
            "id": "100010217444895",
            "name": "Nguyá»…n Há»¯u NghÄ©a"
          },
          {
            "id": "100010312505428",
            "name": "Quá»‘c Thuáº­n"
          },
          {
            "id": "100010359901844",
            "name": "Kathy Giahan"
          },
          {
            "id": "100010392634698",
            "name": "Nguyá»…n Minh Äá»©c"
          },
          {
            "id": "100010447452206",
            "name": "BÃ¡ Lá»™c Lee"
          },
          {
            "id": "100010513878140",
            "name": "Äanh ÄÃ¡ Lan Anh"
          },
          {
            "id": "100010717126616",
            "name": "Pháº¡m Duy Hiá»ƒn"
          },
          {
            "id": "100010742432121",
            "name": "Ca Tha Su"
          },
          {
            "id": "100010777352919",
            "name": "Tráº§n LÃª Vi"
          },
          {
            "id": "100010868115949",
            "name": "Truong Hieu"
          },
          {
            "id": "100010886641605",
            "name": "Tung Hpv"
          },
          {
            "id": "100010910023743",
            "name": "ThÃ nh Long"
          },
          {
            "id": "100010937883909",
            "name": "Phong Vu"
          },
          {
            "id": "100010955986448",
            "name": "XuÃ¢n Máº¡nh"
          },
          {
            "id": "100010964537443",
            "name": "TÃ´ Nháº­t Nguyá»‡t"
          },
          {
            "id": "100011010849376",
            "name": "VÆ°Æ¡ng"
          },
          {
            "id": "100011018535963",
            "name": "PhÃ¹ng Máº¡nh Chung"
          },
          {
            "id": "100011018952525",
            "name": "Pháº¡m Trung NghÄ©a"
          },
          {
            "id": "100011052729480",
            "name": "Thanh Nguyen"
          },
          {
            "id": "100011114115772",
            "name": "Duy HÆ°ng"
          },
          {
            "id": "100011127217594",
            "name": "DÆ°Æ¡ng TÃ­ch"
          },
          {
            "id": "100011198112994",
            "name": "Nguyá»…n DÅ©ng"
          },
          {
            "id": "100011277198065",
            "name": "Tráº§n HoÃ ng Ã‚n"
          },
          {
            "id": "100011289166005",
            "name": "VÃµ TrÃ­ Nam"
          },
          {
            "id": "100011357589940",
            "name": "LÃª Minh"
          },
          {
            "id": "100011359191307",
            "name": "ÄÃ o Tráº§n"
          },
          {
            "id": "100011364897956",
            "name": "Pham Hoang"
          },
          {
            "id": "100011403334902",
            "name": "VÃµ VÄƒn LÃ¢m"
          },
          {
            "id": "100011406930682",
            "name": "Binbin Nguyá»…n"
          },
          {
            "id": "100011431565807",
            "name": "Xuan Quang"
          },
          {
            "id": "100011513946907",
            "name": "Phan Duc Thiep"
          },
          {
            "id": "100011667190499",
            "name": "VÃµNgá»c XuÃ¢nQuá»³nh"
          },
          {
            "id": "100011674270898",
            "name": "Äinh Thá»©c"
          },
          {
            "id": "100011676384280",
            "name": "Minh Tri Nguyen"
          },
          {
            "id": "100011730030761",
            "name": "Gia Hiáº¿u"
          },
          {
            "id": "100011875779159",
            "name": "Tran Minh"
          },
          {
            "id": "100011953606081",
            "name": "Thao Phamvan"
          },
          {
            "id": "100011965962364",
            "name": "Nga Nguyen"
          },
          {
            "id": "100012165750794",
            "name": "Nguyen The Anh"
          },
          {
            "id": "100012191446614",
            "name": "HoÃ ng Thuáº­n"
          },
          {
            "id": "100012431374186",
            "name": "Nguyá»…n Kim NgÃ¢n"
          },
          {
            "id": "100012442474104",
            "name": "Quang Nguyá»…n"
          },
          {
            "id": "100012451836115",
            "name": "HÃ¹ng LÃ¢m"
          },
          {
            "id": "100012472891925",
            "name": "TuyÃªn BÃ¬nh"
          },
          {
            "id": "100012500490117",
            "name": "CÆ°á»ng Pháº¡m"
          },
          {
            "id": "100012606064707",
            "name": "Giang ÄÃ o"
          },
          {
            "id": "100012616565768",
            "name": "VÄ© Pham"
          },
          {
            "id": "100012675437591",
            "name": "Trong Bui"
          },
          {
            "id": "100012721385581",
            "name": "Chung Hanoiwind"
          },
          {
            "id": "100012736537157",
            "name": "Trung Dangmai"
          },
          {
            "id": "100012743863571",
            "name": "TÃ´ Ngá»c VÃµ ToÃ n"
          },
          {
            "id": "100012748478942",
            "name": "Nguyá»…n XuÃ¢n Há»£i"
          },
          {
            "id": "100012857702537",
            "name": "CÃ´ng Minh"
          },
          {
            "id": "100012909798515",
            "name": "Cuong Vu"
          },
          {
            "id": "100012914538238",
            "name": "Nháº­t Minh"
          },
          {
            "id": "100012917227755",
            "name": "Tuáº¥n Chelsea"
          },
          {
            "id": "100012923230971",
            "name": "Ductoan Le"
          },
          {
            "id": "100013151740885",
            "name": "TrÆ°Æ¡ng Trá»ng TrÆ°á»ng"
          },
          {
            "id": "100013263695559",
            "name": "Äá»©c Pháº¡m"
          },
          {
            "id": "100013340235681",
            "name": "Binn"
          },
          {
            "id": "100013351847328",
            "name": "Duy DÄ©Ãªn"
          },
          {
            "id": "100013403760748",
            "name": "Kien Vo"
          },
          {
            "id": "100013515064899",
            "name": "LÃª Kháº¯c Huy"
          },
          {
            "id": "100013621170332",
            "name": "Quang Ghibli"
          },
          {
            "id": "100013650121362",
            "name": "Hai Nguyen"
          },
          {
            "id": "100013714758654",
            "name": "Nguyá»…n VÄƒn BÃ¬nh"
          },
          {
            "id": "100013751328301",
            "name": "Nham Nguyen"
          },
          {
            "id": "100013842343513",
            "name": "Chithuong Phan"
          },
          {
            "id": "100014241792764",
            "name": "Chung Coi"
          },
          {
            "id": "100014277391659",
            "name": "LÃª Äiá»n"
          },
          {
            "id": "100014293536894",
            "name": "LÃª Háº£i"
          },
          {
            "id": "100014309414113",
            "name": "Tráº§n ThiÃªn SÆ¡n"
          },
          {
            "id": "100014398757450",
            "name": "Triá»‡u Long"
          },
          {
            "id": "100014521302523",
            "name": "VÄƒn VÃµ"
          },
          {
            "id": "100014609710313",
            "name": "Nguyá»…n VÄƒn Äá»‹nh"
          },
          {
            "id": "100014628276972",
            "name": "CÆ°á»ng Tráº§n"
          },
          {
            "id": "100014736707023",
            "name": "Tuan Anh Nguyá»…n"
          },
          {
            "id": "100014751903614",
            "name": "Anh Tuáº¥n"
          },
          {
            "id": "100014782031875",
            "name": "Lich Pham"
          },
          {
            "id": "100014788382227",
            "name": "ThÃ nh Nguyá»…n"
          },
          {
            "id": "100014901303499",
            "name": "Lam Deacl"
          },
          {
            "id": "100014975941617",
            "name": "Hiáº¿u Trung ÄoÃ n"
          },
          {
            "id": "100015065231756",
            "name": "Lan NgÃ´"
          },
          {
            "id": "100015074383749",
            "name": "Duc John"
          },
          {
            "id": "100015093575873",
            "name": "Minh TÃ¢m"
          },
          {
            "id": "100015138398074",
            "name": "HoÃ ng Thá»‹ Linh"
          },
          {
            "id": "100015259144211",
            "name": "Sen Nguyen Nguyen"
          },
          {
            "id": "100015265394008",
            "name": "Pháº¡m Huyá»n"
          },
          {
            "id": "100015280722287",
            "name": "QuÃ½ NT"
          },
          {
            "id": "100015327542257",
            "name": "Nguyá»…n Dung"
          },
          {
            "id": "100015384604720",
            "name": "Quyá»n Rolls-"
          },
          {
            "id": "100015390040960",
            "name": "BÃ¹i Há»“ng BÃ¬nh"
          },
          {
            "id": "100015504943901",
            "name": "RÃ¨m ThiÃªn VÃ¢n"
          },
          {
            "id": "100015570335034",
            "name": "Quang Nguyá»…n."
          },
          {
            "id": "100015714030799",
            "name": "An An"
          },
          {
            "id": "100015735960734",
            "name": "Ban Cao Van"
          },
          {
            "id": "100015755689212",
            "name": "VÅ© Äá»©c HÆ°ng"
          },
          {
            "id": "100015835411944",
            "name": "Nguyá»…n CÃºc"
          },
          {
            "id": "100016076432678",
            "name": "ThiÃªn PhÃº Thá»"
          },
          {
            "id": "100016108369107",
            "name": "KhÃ¡nh HoÃ ng"
          },
          {
            "id": "100016602241828",
            "name": "Baá» An CÃ´ng"
          },
          {
            "id": "100016764632852",
            "name": "Thuyen Pham"
          },
          {
            "id": "100017139339257",
            "name": "NÄƒng Vu"
          },
          {
            "id": "100017479698436",
            "name": "LÃª Äá»©c Thanh"
          },
          {
            "id": "100017497693268",
            "name": "VÅ© XuÃ¢n TÃ¹ng PhÆ°á»£ng"
          },
          {
            "id": "100017577664261",
            "name": "Nguyá»…n VÄƒn NguyÃªn"
          },
          {
            "id": "100017866807509",
            "name": "LÃª ÄÃ´ng"
          },
          {
            "id": "100017922133360",
            "name": "HoÃ i Thanh"
          },
          {
            "id": "100018049517791",
            "name": "Tráº§n Mai ThÃ´ng"
          },
          {
            "id": "100018712299690",
            "name": "Äáº·ng Duy HÆ°ng"
          },
          {
            "id": "100018963754299",
            "name": "ThÃ nh Tuáº¥n"
          },
          {
            "id": "100019179690123",
            "name": "Hoa NguyÃªn"
          },
          {
            "id": "100019893935349",
            "name": "TrÆ°Æ¡ng Tháº¿ TrÆ°Æ¡ng"
          },
          {
            "id": "100020131243296",
            "name": "Nguyá»…n Tuyá»ƒn"
          },
          {
            "id": "100020177471149",
            "name": "LÃª Tuáº¥n Annh"
          },
          {
            "id": "100020190502153",
            "name": "Tráº§n Lam"
          },
          {
            "id": "100020417523493",
            "name": "Anh Huynh Nhut"
          },
          {
            "id": "100021453602558",
            "name": "TrÃ­ Nguyá»‡n"
          },
          {
            "id": "100021764872523",
            "name": "VÅ© VÄƒn HÃ¹ng"
          },
          {
            "id": "100021806509769",
            "name": "Phan Thi"
          },
          {
            "id": "100021878376978",
            "name": "Nguyá»…n Ãšt"
          },
          {
            "id": "100021919653145",
            "name": "Ã‚n Hoai Duong"
          },
          {
            "id": "100021940850251",
            "name": "Ngo Vinh"
          },
          {
            "id": "100021983567918",
            "name": "Pháº¡m Tuáº¥n Minh"
          },
          {
            "id": "100022031980524",
            "name": "Tráº§n Ghi"
          },
          {
            "id": "100022217554921",
            "name": "Phan Tuan"
          },
          {
            "id": "100022282055761",
            "name": "Quang TÃ¨o"
          },
          {
            "id": "100022317994624",
            "name": "Quang Háº­u"
          },
          {
            "id": "100022360027136",
            "name": "Nguyá»ƒn CÃ´ng HoÃ¡n"
          },
          {
            "id": "100022435640319",
            "name": "Nguyá»…n Hao"
          },
          {
            "id": "100022517055361",
            "name": "Nguyá»…n VÄƒn DiÃªn"
          },
          {
            "id": "100022734603050",
            "name": "ThÃ nh LuÃ¢n"
          },
          {
            "id": "100022789208282",
            "name": "Long Tran"
          },
          {
            "id": "100022831932941",
            "name": "BÃ¬nh Nam"
          },
          {
            "id": "100022902003897",
            "name": "Äinh KhÃ¡nh"
          },
          {
            "id": "100022967137101",
            "name": "Tráº§n BÃ¬nh Minh"
          },
          {
            "id": "100023297012713",
            "name": "Tháº£o Tháº£o"
          },
          {
            "id": "100023300376686",
            "name": "Trá»ng NhÃ¢n"
          },
          {
            "id": "100023512393653",
            "name": "Äiá»‡p Nguyenvan"
          },
          {
            "id": "100023513746104",
            "name": "Láº¡i SÆ¡n HÃ "
          },
          {
            "id": "100023626236973",
            "name": "Chinh Nguyen"
          },
          {
            "id": "100023705472238",
            "name": "Tá»« ToÃ n"
          },
          {
            "id": "100023717926559",
            "name": "Tan Nguyen Nhat"
          },
          {
            "id": "100023745526063",
            "name": "Nguyen Diep"
          },
          {
            "id": "100023789610325",
            "name": "Han Diem"
          },
          {
            "id": "100023829974626",
            "name": "Nguyá»…n Yáº¿n Nhi"
          },
          {
            "id": "100023855422145",
            "name": "Nghia Äinh"
          },
          {
            "id": "100023882984856",
            "name": "LÃª Sang"
          },
          {
            "id": "100023935591002",
            "name": "HoÃ ng Duy"
          },
          {
            "id": "100023967601828",
            "name": "LÆ°u ÄÃ¬nh Tuá»“ng"
          },
          {
            "id": "100024020507922",
            "name": "Tráº§n NguyÃªn HÃ¹ng"
          },
          {
            "id": "100024284104280",
            "name": "CÆ°á»ng Bii"
          },
          {
            "id": "100024454964725",
            "name": "Tuan Tran"
          },
          {
            "id": "100024491362124",
            "name": "ThÆ¡m Nguyá»…n"
          },
          {
            "id": "100024505130411",
            "name": "Trung Nguyen"
          },
          {
            "id": "100024547509830",
            "name": "VÃµ Äoan ThÆ°"
          },
          {
            "id": "100024607389678",
            "name": "Pháº¡m Tráº§n HoÃ n ThÆ°Æ¡ng"
          },
          {
            "id": "100024630065281",
            "name": "ÄoÃ n CÃ´ng"
          },
          {
            "id": "100024837681980",
            "name": "Nguyenthi Sen"
          },
          {
            "id": "100024868969161",
            "name": "Nga Tran"
          },
          {
            "id": "100024911246336",
            "name": "Äá»•ng Gi NÄƒng"
          },
          {
            "id": "100025352925523",
            "name": "HoÃ ng Quá»‘c BÃ¬nh"
          },
          {
            "id": "100025483265108",
            "name": "Nho Honganh"
          },
          {
            "id": "100025546158109",
            "name": "Bds Nguyen Vinh"
          },
          {
            "id": "100025652496150",
            "name": "Pháº¡m ÄÄƒng KhoaKhÃ´i"
          },
          {
            "id": "100025711111232",
            "name": "Ð¢Ñ€ÑƒÐ¾Ð½Ð³ ÐÐ³Ð¾Ðº Ð›ÑƒÐ°Ð½"
          },
          {
            "id": "100025751972016",
            "name": "Nguyá»…n PhÆ°Æ¡ng"
          },
          {
            "id": "100025863706317",
            "name": "Äan Háº¡nh Chi"
          },
          {
            "id": "100026087749786",
            "name": "Ãšt Ka"
          },
          {
            "id": "100026138737546",
            "name": "Pháº¡mvÄƒn Chiáº¿n"
          },
          {
            "id": "100026139130081",
            "name": "ÄiÃªp Bui"
          },
          {
            "id": "100026223167460",
            "name": "VÃ¢n QuÃ½"
          },
          {
            "id": "100026247289554",
            "name": "Huy HoÃ ng"
          },
          {
            "id": "100026437669420",
            "name": "LÃª Tuáº¥n"
          },
          {
            "id": "100026477684911",
            "name": "Khanh Bui"
          },
          {
            "id": "100026559170770",
            "name": "HÃ²a Xe Äiá»‡n"
          },
          {
            "id": "100026615640496",
            "name": "Ngá»c Nháº­t"
          },
          {
            "id": "100026721912170",
            "name": "Tina Le"
          },
          {
            "id": "100026733764500",
            "name": "Loi Mai"
          },
          {
            "id": "100026765928164",
            "name": "Quang Kháº£i"
          },
          {
            "id": "100026850331941",
            "name": "Äá»— VÄƒn ÄÄƒng"
          },
          {
            "id": "100026896832330",
            "name": "Minh Quang Vu"
          },
          {
            "id": "100026936149866",
            "name": "Tráº§n TrÃºc NhiÃªn"
          },
          {
            "id": "100027079024680",
            "name": "Táº¡ BÃ¡ Tuáº¥n"
          },
          {
            "id": "100027251987363",
            "name": "Nam Nguyen"
          },
          {
            "id": "100027525197751",
            "name": "Duyen Tran"
          },
          {
            "id": "100027590805624",
            "name": "Binh Nguyen"
          },
          {
            "id": "100027605949776",
            "name": "Danh Nguyen"
          },
          {
            "id": "100027739780918",
            "name": "Chelsea LuÃ¢n"
          },
          {
            "id": "100027743360489",
            "name": "Dang Pham"
          },
          {
            "id": "100027773987109",
            "name": "Quan Thuáº§n"
          },
          {
            "id": "100027892488162",
            "name": "Há»“ Má»¹ Trang"
          },
          {
            "id": "100027961111623",
            "name": "Buitrongdien Dien"
          },
          {
            "id": "100028093906264",
            "name": "HoÃ n Kim Gia"
          },
          {
            "id": "100028328448631",
            "name": "Ngai Nguyen"
          },
          {
            "id": "100028365949571",
            "name": "Gia Háº¡nh"
          },
          {
            "id": "100028435161789",
            "name": "LÃª Sá»¹ Hung"
          },
          {
            "id": "100028503198433",
            "name": "Tráº§n TÆ°á»ng Ãnh"
          },
          {
            "id": "100028509436233",
            "name": "Nguyá»…n Nho ThoÃ¡ng"
          },
          {
            "id": "100028566961243",
            "name": "Truyen Nguyen"
          },
          {
            "id": "100028631181121",
            "name": "Tráº§n VÄƒn Hiá»‡p"
          },
          {
            "id": "100028866198818",
            "name": "Minh Äang"
          },
          {
            "id": "100028888531798",
            "name": "Vicky XuÃ¢n Toan"
          },
          {
            "id": "100028965546354",
            "name": "Nguyá»…n Dung"
          },
          {
            "id": "100029020853492",
            "name": "NgÃ´ Thiá»‡n KhÃ¡nh"
          },
          {
            "id": "100029030191042",
            "name": "Anh Nam"
          },
          {
            "id": "100029149698151",
            "name": "DÆ°Æ¡ng HoÃ i Thu"
          },
          {
            "id": "100029181168499",
            "name": "HoÃ i Báº£o"
          },
          {
            "id": "100029299301680",
            "name": "Vi Hoa"
          },
          {
            "id": "100029346698399",
            "name": "BÃ¹i Thanh Hiá»n"
          },
          {
            "id": "100029720150756",
            "name": "Ryeo Raining"
          },
          {
            "id": "100029722425907",
            "name": "Nguyá»…n Minh"
          },
          {
            "id": "100029875591423",
            "name": "Äi Bá»¥i"
          },
          {
            "id": "100029938457021",
            "name": "Giang Vá»‰nh Háº£o"
          },
          {
            "id": "100030073980274",
            "name": "TrÆ°Æ¡ng Thiá»‡n"
          },
          {
            "id": "100030121470032",
            "name": "TLuynh Luynh"
          },
          {
            "id": "100030239853577",
            "name": "SÃ¡ng HoÃ ng Trung"
          },
          {
            "id": "100030249394870",
            "name": "LÃª TrÃ¢m"
          },
          {
            "id": "100030249971041",
            "name": "Nguyá»…n Thá»‹ Huyá»n"
          },
          {
            "id": "100030489024105",
            "name": "Nguyá»…n ThÃ nh"
          },
          {
            "id": "100030706907266",
            "name": "SÆ¡n"
          },
          {
            "id": "100030751838191",
            "name": "Há»“ TÃ¢m"
          },
          {
            "id": "100030860375334",
            "name": "VÅ© Adam"
          },
          {
            "id": "100031257766967",
            "name": "Nguyá»…n Zin"
          },
          {
            "id": "100031384541474",
            "name": "Vinhht Phan"
          },
          {
            "id": "100031483183623",
            "name": "Nguyá»…n HoÃ "
          },
          {
            "id": "100031528416178",
            "name": "Táº¡ ÄÃ¬nh Sung"
          },
          {
            "id": "100031925047809",
            "name": "LÃŠ ÄÃŒNH NINH"
          },
          {
            "id": "100032300867841",
            "name": "Thanh Lo"
          },
          {
            "id": "100032440401114",
            "name": "ThÃ nh Nguyá»…n"
          },
          {
            "id": "100032751334007",
            "name": "Kiá»u Minh Hoáº¡t"
          },
          {
            "id": "100032785492366",
            "name": "Äáº·ng ThÆ°Æ¡ng"
          },
          {
            "id": "100032815822991",
            "name": "BÃ¬nh Minh DoÃ£n"
          },
          {
            "id": "100033404291659",
            "name": "Nguyá»…n PhÃºc Äá»©c"
          },
          {
            "id": "100033426524079",
            "name": "HoÃ ng Äá»©c Duy"
          },
          {
            "id": "100033518328128",
            "name": "PhÆ°á»›c Trá»ng"
          },
          {
            "id": "100033528742511",
            "name": "Pháº¡m VÄƒn ÄÃ´ng"
          },
          {
            "id": "100033533161349",
            "name": "Giang LÃª"
          },
          {
            "id": "100033844211158",
            "name": "Cáº­u Cáº£"
          },
          {
            "id": "100034076554564",
            "name": "Tháº±ng Trá»¥i"
          },
          {
            "id": "100034100074179",
            "name": "Phong NguyÃªn"
          },
          {
            "id": "100034153822517",
            "name": "VÆ°Æ¡ng Tráº§n"
          },
          {
            "id": "100034181616193",
            "name": "VÃµ TÆ°á»ng Vy"
          },
          {
            "id": "100034215710078",
            "name": "Nguyá»…n ThÃ nh PhÃ¡t"
          },
          {
            "id": "100034337852916",
            "name": "Nguyá»…n Gia Toai"
          },
          {
            "id": "100034379355514",
            "name": "Tráº§n Quyá»n"
          },
          {
            "id": "100034385144523",
            "name": "Huáº¥n Phá»‘ Báº¿n"
          },
          {
            "id": "100034424474566",
            "name": "Kim LiÃªn"
          },
          {
            "id": "100034493435530",
            "name": "Thien Nguyen"
          },
          {
            "id": "100034611783075",
            "name": "Thieu Hien"
          },
          {
            "id": "100034725467005",
            "name": "HoÃ i SÆ¡n"
          },
          {
            "id": "100034768921867",
            "name": "Nam Tracvan"
          },
          {
            "id": "100034778491397",
            "name": "Lan HÆ°Æ¡ng"
          },
          {
            "id": "100034789603436",
            "name": "NgÃ´ Ngá»c Äá»©c"
          },
          {
            "id": "100034948387595",
            "name": "Nguyá»…n TÃ¢n"
          },
          {
            "id": "100034985773173",
            "name": "Ãnh DÆ°Æ¡ng"
          },
          {
            "id": "100035011583665",
            "name": "Ã”ng Tráº§n"
          },
          {
            "id": "100035033857842",
            "name": "Son Tran Minh"
          },
          {
            "id": "100035169272383",
            "name": "QuÃ½"
          },
          {
            "id": "100035178792026",
            "name": "Tráº§n VÄƒn Thuá»·"
          },
          {
            "id": "100035358881561",
            "name": "SÃ³c Nhá»"
          },
          {
            "id": "100035575576968",
            "name": "Huu Hanh Le"
          },
          {
            "id": "100035758292807",
            "name": "Thanh TrÆ°Æ¡ng"
          },
          {
            "id": "100035861178488",
            "name": "Thanh Nguyen"
          },
          {
            "id": "100035973827446",
            "name": "Canh Phan"
          },
          {
            "id": "100036153819704",
            "name": "PhÃ¡n Quan Trung"
          },
          {
            "id": "100036447714319",
            "name": "Chi Lan"
          },
          {
            "id": "100036531399880",
            "name": "VÃµ Duy"
          },
          {
            "id": "100036744240658",
            "name": "PhÆ°Æ¡ng TrÃ "
          },
          {
            "id": "100036822712709",
            "name": "PhÃ¹ng Ngá»c Äiá»‡p"
          },
          {
            "id": "100036968888558",
            "name": "Báº£y DÃ¹ng"
          },
          {
            "id": "100037051122674",
            "name": "Tuantrang"
          },
          {
            "id": "100037139513574",
            "name": "Pháº¡m Hiá»‡p"
          },
          {
            "id": "100037168332348",
            "name": "Khanh DO"
          },
          {
            "id": "100037225265026",
            "name": "Ha Meo"
          },
          {
            "id": "100037240339992",
            "name": "LÃ½ DÅ©ng"
          },
          {
            "id": "100037302003281",
            "name": "Äá»— Lá»¥a"
          },
          {
            "id": "100037364839598",
            "name": "Nguyá»…n VÄƒn Minh"
          },
          {
            "id": "100037740071725",
            "name": "NÃ´ng DÃ¢n Äiá»‡n BiÃªn"
          },
          {
            "id": "100038017093325",
            "name": "ÄÃ¬nh Háº­u"
          },
          {
            "id": "100038182920865",
            "name": "Báº¿ TÆ°"
          },
          {
            "id": "100038250240450",
            "name": "Oanh Nguyá»…n"
          },
          {
            "id": "100038322881408",
            "name": "ÄÃ o XuÃ¢n Toáº¡i"
          },
          {
            "id": "100038905830432",
            "name": "Linh Nguyá»…n"
          },
          {
            "id": "100038980230141",
            "name": "Tri TriÃªt TÃ¢n Binh"
          },
          {
            "id": "100039091725458",
            "name": "Ngoc Thoai"
          },
          {
            "id": "100039282012097",
            "name": "DÆ°Æ¡ng QuÃ¢n"
          },
          {
            "id": "100039282094312",
            "name": "TÄƒng Huynh"
          },
          {
            "id": "100039397690119",
            "name": "VÅ© Ngá»c Tuáº¥n"
          },
          {
            "id": "100039591585968",
            "name": "NgÃ´ Háº£i Duy"
          },
          {
            "id": "100039669841146",
            "name": "Ha Tran"
          },
          {
            "id": "100039812761403",
            "name": "PhÆ°Æ¡ng Nam"
          },
          {
            "id": "100040048241571",
            "name": "NguyÃªn Äinh DÆ°Æ¡ng"
          },
          {
            "id": "100040124990391",
            "name": "Nguyen Phong"
          },
          {
            "id": "100040170500013",
            "name": "UyÃªn Tran Nha"
          },
          {
            "id": "100040175081724",
            "name": "Hien Le"
          },
          {
            "id": "100040235531352",
            "name": "Phm Trung Hiáº¿u"
          },
          {
            "id": "100040433213233",
            "name": "HÆ°Æ¡ng Lan"
          },
          {
            "id": "100040714280187",
            "name": "Khanh An Cam"
          },
          {
            "id": "100040781981209",
            "name": "á€¦á€¸á€¸á€¸á€¦á€¸á€¸á€¸ á€–á€¼á€­á€¯á€¸á€¸á€¸ á€œá€±á€¸á€¸á€¸"
          },
          {
            "id": "100040812604445",
            "name": "TrÆ°Æ¡ng LÃ½"
          },
          {
            "id": "100040854852044",
            "name": "Kien Nguyen"
          },
          {
            "id": "100040977260512",
            "name": "Loi Hoang"
          },
          {
            "id": "100041024493272",
            "name": "Minh Hiáº¿u"
          },
          {
            "id": "100041111113319",
            "name": "Phan LÃª"
          },
          {
            "id": "100041552012625",
            "name": "Man Ngo"
          },
          {
            "id": "100041614339961",
            "name": "LÃ¢m HÃ¹ng"
          },
          {
            "id": "100041616127935",
            "name": "Nguyá»…n Háº¡nh"
          },
          {
            "id": "100041680952650",
            "name": "Luyá»‡n Báº¯c"
          },
          {
            "id": "100041704119778",
            "name": "Hung Tran"
          },
          {
            "id": "100042008256920",
            "name": "HoÃ ng Tiá»‡p HoÃ ng"
          },
          {
            "id": "100042093652955",
            "name": "LÆ°u Äá»©c Oanh"
          },
          {
            "id": "100042118063344",
            "name": "Phat Nguyen Tan"
          },
          {
            "id": "100042185771280",
            "name": "Pháº¡m Tiáº¿n CÆ°Æ¡ng"
          },
          {
            "id": "100042327604842",
            "name": "GÃ³c Khuáº¥t"
          },
          {
            "id": "100042579408661",
            "name": "Nguyá»…n Há»¯u Thá»"
          },
          {
            "id": "100042688966930",
            "name": "VÅ© Háº¡o DÅ©ng"
          },
          {
            "id": "100043260187046",
            "name": "Nguyá»…n Há»¯u ToÃ n"
          },
          {
            "id": "100043264502762",
            "name": "LÃªtrá»ng TÃ¬nh"
          },
          {
            "id": "100043418721942",
            "name": "Há»“ VÅ© Khang"
          },
          {
            "id": "100043425382115",
            "name": "ÄÃ´i ChÃ¢n Tráº§n"
          },
          {
            "id": "100043542545563",
            "name": "Nguyá»…n XuÃ¢n Báº¯c"
          },
          {
            "id": "100043881496415",
            "name": "HoÃ n ÄoÃ n VÄƒn"
          },
          {
            "id": "100043940761527",
            "name": "VÄƒn Sá»¹"
          },
          {
            "id": "100044067831132",
            "name": "Doan Honggia"
          },
          {
            "id": "100044178167978",
            "name": "Byn Khang"
          },
          {
            "id": "100044324070389",
            "name": "TrÆ°á»ng Há»“"
          },
          {
            "id": "100044389982406",
            "name": "KiÃªn PhÃº Thá»"
          },
          {
            "id": "100044691622460",
            "name": "HÃ¹ng TrÃ¡ng Äá»—"
          },
          {
            "id": "100045008150009",
            "name": "LÆ°Æ¡nn Há»¯u HoÃ "
          },
          {
            "id": "100045053282915",
            "name": "ÄÃ m Thá» Cb"
          },
          {
            "id": "100045435091722",
            "name": "Æ¯ng Há»“ng Háº¡nh"
          },
          {
            "id": "100045751742263",
            "name": "Pháº¡m Ãnh Tuyáº¿t"
          },
          {
            "id": "100046327624982",
            "name": "Danngtong Dangtong"
          },
          {
            "id": "100046517572291",
            "name": "Tráº§n Minh"
          },
          {
            "id": "100046582313214",
            "name": "NhÃ¢n Tran"
          },
          {
            "id": "100046949852346",
            "name": "NV HÃ¹ng"
          },
          {
            "id": "100047255599736",
            "name": "Minh Bá»n"
          },
          {
            "id": "100047617992287",
            "name": "Huáº¿ ThÃ nhmay Náº±m"
          },
          {
            "id": "100047767521722",
            "name": "Thanh Phong"
          },
          {
            "id": "100047892043090",
            "name": "Cháº£o LÃ¡o San"
          },
          {
            "id": "100047917540682",
            "name": "TÄ©nh Huyá»n"
          },
          {
            "id": "100047954025395",
            "name": "Tráº§n Äoan HÃ²a"
          },
          {
            "id": "100048218244205",
            "name": "åŽæ¥"
          },
          {
            "id": "100048410842814",
            "name": "Ly Ngoc Bach"
          },
          {
            "id": "100048465451622",
            "name": "PhÆ°Æ¡ng NguyÃªn"
          },
          {
            "id": "100048551593131",
            "name": "Nguyá»…n ÄÃ¬nh TÃ¹ng"
          },
          {
            "id": "100049220392466",
            "name": "Nguyá»…n Nháº­t Minh"
          },
          {
            "id": "100049821484996",
            "name": "Phan Thanh Truyá»n"
          },
          {
            "id": "100049898291935",
            "name": "Duy Khang"
          },
          {
            "id": "100049933239314",
            "name": "Nguyá»…n Thanh PhÆ°Æ¡ng"
          },
          {
            "id": "100050081832728",
            "name": "Báº¡ch Nháº­t Minh"
          },
          {
            "id": "100050094380991",
            "name": "Trá»‹nh Trung Khang"
          },
          {
            "id": "100050219271565",
            "name": "Äáº·ng ÄÃ¬nh Hiá»‡p"
          },
          {
            "id": "100050271305833",
            "name": "ThÃ nh Minh"
          },
          {
            "id": "100050550402218",
            "name": "HÃ¹ng LÆ°Æ¡ng"
          },
          {
            "id": "100050572815761",
            "name": "Cáº­u TÃ¬nh"
          },
          {
            "id": "100050680277162",
            "name": "VÅ© Tuáº¥n YÃªn"
          },
          {
            "id": "100050762196716",
            "name": "SÃ³i CÃ´ Äá»™c"
          },
          {
            "id": "100050896924676",
            "name": "Chau Truong"
          },
          {
            "id": "100051201732914",
            "name": "VÅ© VÄƒn Äá»©c"
          },
          {
            "id": "100051580996504",
            "name": "VÆ°Æ¡ng HoÃ ng"
          },
          {
            "id": "100051612711651",
            "name": "Tháº¯ng Nguyá»…n Há»¯u"
          },
          {
            "id": "100051693558677",
            "name": "Thanh KiÃªn"
          },
          {
            "id": "100052074962392",
            "name": "Ah ChÃ¡y"
          },
          {
            "id": "100052600779696",
            "name": "TrÃ­ Thá»©c"
          },
          {
            "id": "100052658677088",
            "name": "VÃµ Minh Hiá»n"
          },
          {
            "id": "100052753493804",
            "name": "Nguyá»…n ThÃ nh Äáº¡t Äáº¡t"
          },
          {
            "id": "100052812753242",
            "name": "Luyá»‡n Tráº§n"
          },
          {
            "id": "100052828620627",
            "name": "VÃµ VÄƒn"
          },
          {
            "id": "100053027453513",
            "name": "DÃ¹ Há»©"
          },
          {
            "id": "100053230086536",
            "name": "Nhat Canh"
          },
          {
            "id": "100053284905438",
            "name": "Ca Gá»“m"
          },
          {
            "id": "100053361665211",
            "name": "Äá»‰nh Táº¥n"
          },
          {
            "id": "100053454844073",
            "name": "Oak Boudkhamsew"
          },
          {
            "id": "100053511361169",
            "name": "Ka BÃ¡nh Ãt"
          },
          {
            "id": "100053583423394",
            "name": "Nguyá»…n VÄƒn Khoa"
          },
          {
            "id": "100053672326252",
            "name": "Tuanlong Ochird"
          },
          {
            "id": "100053766391293",
            "name": "Trieu Doan"
          },
          {
            "id": "100053842155261",
            "name": "Äá»©c An"
          },
          {
            "id": "100054150917996",
            "name": "QuÃ ng Danh"
          },
          {
            "id": "100054309640814",
            "name": "Minh KhÆ°Æ¡ng"
          },
          {
            "id": "100054310251805",
            "name": "CÃ¹ Äáº¡i Láº§n"
          },
          {
            "id": "100054330039339",
            "name": "Doc Hoang"
          },
          {
            "id": "100054465764429",
            "name": "ÄÃ o Viáº¿t LÆ°u"
          },
          {
            "id": "100054530163166",
            "name": "Huá»³nh Háº¡o"
          },
          {
            "id": "100054600425268",
            "name": "Ngoan Trinh"
          },
          {
            "id": "100054667913583",
            "name": "Quáº£n Thu Dung"
          },
          {
            "id": "100054868803627",
            "name": "Loc Phan"
          },
          {
            "id": "100055148073913",
            "name": "VÃµ Há»¯u Trinh"
          },
          {
            "id": "100055921663548",
            "name": "Mai Äá»©c Cáº£nh"
          },
          {
            "id": "100056131990122",
            "name": "VÃ´ ThÆ°á»ng"
          },
          {
            "id": "100056222387660",
            "name": "Há»“ng Quáº¿"
          },
          {
            "id": "100056509171577",
            "name": "Nguyá»…n Kim Huá»‡"
          },
          {
            "id": "100056587181748",
            "name": "Háº£i Háº£i"
          },
          {
            "id": "100056964455463",
            "name": "Huá»³nh Má»™ng Thu"
          },
          {
            "id": "100057282332889",
            "name": "Äáº·ng Long"
          },
          {
            "id": "100057340689289",
            "name": "Nguyá»…n ÄÃ¬nh Hiá»u"
          },
          {
            "id": "100057365448136",
            "name": "LÃª Ngá»c Háº£i"
          },
          {
            "id": "100057469625858",
            "name": "LÃª Quang QuÃ½"
          },
          {
            "id": "100057660061835",
            "name": "Khan Hy"
          },
          {
            "id": "100058024125453",
            "name": "Salucky Sa Lucky"
          },
          {
            "id": "100058899249313",
            "name": "Minh SÆ¡n HoÃ ng LongÄiá»‡n"
          },
          {
            "id": "100058900838781",
            "name": "PhÃº Äinh"
          },
          {
            "id": "100058990093961",
            "name": "Linh Phan"
          },
          {
            "id": "100059213494923",
            "name": "Pháº¡m Quá»³nh"
          },
          {
            "id": "100059961310446",
            "name": "HoÃ n HÃ "
          },
          {
            "id": "100060372321847",
            "name": "TÃ´ Ãi UyÃªn"
          },
          {
            "id": "100060517170140",
            "name": "ÄÃ m Duy Tháº¯ng"
          },
          {
            "id": "100060997840862",
            "name": "Huá»³nh Thanh LiÃªm"
          },
          {
            "id": "100061360312221",
            "name": "Hiáº¿u VÄƒn"
          },
          {
            "id": "100061834217960",
            "name": "ThÃ¹y LÃª"
          },
          {
            "id": "100062201450391",
            "name": "Lananh Chu"
          },
          {
            "id": "100062513266361",
            "name": "Tony Trung"
          },
          {
            "id": "100062534152104",
            "name": "Chu Thanh Háº£i"
          },
          {
            "id": "100062621497074",
            "name": "Quang Sang"
          },
          {
            "id": "100062694501835",
            "name": "Ly Nguyá»…n"
          },
          {
            "id": "100062704573837",
            "name": "Duong Cao"
          },
          {
            "id": "100062735320361",
            "name": "Tráº§n VÄƒn Chanh"
          },
          {
            "id": "100062821777749",
            "name": "Nguyenvan Trieu"
          },
          {
            "id": "100063281912032",
            "name": "Nguyá»…n HÃ "
          },
          {
            "id": "100063331010668",
            "name": "Hanh Nguyen"
          },
          {
            "id": "100063505085817",
            "name": "VÅ© Háº£i"
          },
          {
            "id": "100063582972054",
            "name": "Nguyá»…n HÆ°Æ¡ng"
          },
          {
            "id": "100063619694865",
            "name": "Nguyá»…n Nhi"
          },
          {
            "id": "100063873661415",
            "name": "Tá»‘ng TrÆ°á»ng Giang"
          },
          {
            "id": "100063919234949",
            "name": "Thanh Nguyen Trung"
          },
          {
            "id": "100064049070587",
            "name": "NgÃ´ Quang TrÆ°á»ng"
          },
          {
            "id": "100064208395714",
            "name": "Láº¡i VÄƒn Quyáº¿t"
          },
          {
            "id": "100064590092909",
            "name": "Luu Lu"
          },
          {
            "id": "100064657144171",
            "name": "Quá»‘c Tuáº¥n"
          },
          {
            "id": "100064797853864",
            "name": "Nguyen Dung"
          },
          {
            "id": "100064804313372",
            "name": "Nguyá»…n VÅ©"
          },
          {
            "id": "100064938866027",
            "name": "TÃ¹ng Phan"
          },
          {
            "id": "100065194692555",
            "name": "Vinh HÃ "
          },
          {
            "id": "100066094399961",
            "name": "Phan Hiáº¿u"
          },
          {
            "id": "100066327822714",
            "name": "Kiá»u PhÃ¡p"
          },
          {
            "id": "100066401385037",
            "name": "Tuyen Nguyen Huu"
          },
          {
            "id": "100066662168929",
            "name": "Trá»‹nh PhÆ°á»›c Quang"
          },
          {
            "id": "100066694813756",
            "name": "Trang Lamgia"
          },
          {
            "id": "100066725032703",
            "name": "Chu Lá»±c"
          },
          {
            "id": "100066737857709",
            "name": "TÄ©nh Láº·ng"
          },
          {
            "id": "100066982938125",
            "name": "Nguyá»…n HÆ°á»ng"
          },
          {
            "id": "100067080495484",
            "name": "Thá» TrÆ°á»ng Hiáº¿n"
          },
          {
            "id": "100067095949990",
            "name": "LÆ°u XuÃ¢n TrÆ°á»ng"
          },
          {
            "id": "100067517981215",
            "name": "ChÃ¢u Bui"
          },
          {
            "id": "100067556804054",
            "name": "HoÃ ng Tháº¿"
          },
          {
            "id": "100067673264343",
            "name": "Nguyá»…n Tiáº¿n Hiáº¿u"
          },
          {
            "id": "100068381124248",
            "name": "NgÃ´ Ngá»c Äá»‰nh"
          },
          {
            "id": "100068621942157",
            "name": "Nguyá»…n XuÃ¢n DÆ°Æ¡ng"
          },
          {
            "id": "100069029108620",
            "name": "Ti Nguyá»…n"
          },
          {
            "id": "100069599028665",
            "name": "Minh BÃ¬nh"
          },
          {
            "id": "100069790115086",
            "name": "Nguyá»…n ChÃ­ Nguyá»‡n"
          },
          {
            "id": "100069862811031",
            "name": "Long Minh"
          },
          {
            "id": "100069944449129",
            "name": "Khoa VÃµ Minh"
          },
          {
            "id": "100070122397219",
            "name": "Huyáº¿n Car A.I"
          },
          {
            "id": "100070122994714",
            "name": "NhÃ¢n LÆ°Æ¡ng"
          },
          {
            "id": "100070402657212",
            "name": "HoÃ ng Má»‘c"
          },
          {
            "id": "100070444136850",
            "name": "Ngoc Nhan Hoang"
          },
          {
            "id": "100070795981453",
            "name": "Pham Thuyet"
          },
          {
            "id": "100070810669515",
            "name": "Má»¹ Corona"
          },
          {
            "id": "100070997281709",
            "name": "DÆ°Æ¡ng ThÃ nh Nam"
          },
          {
            "id": "100071267541852",
            "name": "Trá»‹nh Ngá»c HÃ¢n"
          },
          {
            "id": "100071351170521",
            "name": "LÃ¢m TrÆ°á»ng SÆ¡n"
          },
          {
            "id": "100071567387381",
            "name": "Quyá»n Tráº§n"
          },
          {
            "id": "100071577220199",
            "name": "Nguyá»…n NguyÃªn"
          },
          {
            "id": "100071856632509",
            "name": "Demvan Tendao"
          },
          {
            "id": "100071864262866",
            "name": "VÃµ Thanh VÃ¢n"
          },
          {
            "id": "100072111764346",
            "name": "VÄƒn Äá»©c"
          },
          {
            "id": "100072491820777",
            "name": "Nguyá»…n Duy Kiá»‡t"
          },
          {
            "id": "100072538355830",
            "name": "Há»“ Anh Chi"
          },
          {
            "id": "100072566436852",
            "name": "Nguyá»…n Ãnh Nguyá»‡t"
          },
          {
            "id": "100072789866916",
            "name": "LÃ² Thá»‹ TÃ­nh"
          },
          {
            "id": "100072937479624",
            "name": "ThÃ nh BÃ¡"
          },
          {
            "id": "100073230710896",
            "name": "HoÃ ng ThiÃªn"
          },
          {
            "id": "100073263274406",
            "name": "Nguyá»…n Táº¥n PhÆ°á»›c"
          },
          {
            "id": "100073387915626",
            "name": "Lan Luyáº¿n"
          },
          {
            "id": "100073593035621",
            "name": "Hiá»ƒu Vinh"
          },
          {
            "id": "100073647497812",
            "name": "Pháº¡m VÄƒn Du"
          },
          {
            "id": "100073731945222",
            "name": "Äá»— HoÃ ng BÃ¡ch"
          },
          {
            "id": "100073737976687",
            "name": "ThÆ°Æ¡ng HoÃ i"
          },
          {
            "id": "100073984576166",
            "name": "ThÃºy Quá»³nh"
          },
          {
            "id": "100074021537759",
            "name": "An BÃ¹i NhÆ°"
          },
          {
            "id": "100074158084599",
            "name": "Nguyá»…n Hiáº¿u"
          },
          {
            "id": "100074404527816",
            "name": "Nguyá»…n VÄƒn Nghá»‹"
          },
          {
            "id": "100074474076319",
            "name": "Trung TrÆ°á»ng"
          },
          {
            "id": "100074505640926",
            "name": "DÆ¯Æ¡ng Xáº¤u Báº¢nh"
          },
          {
            "id": "100074655594256",
            "name": "LÃª Thanh Hiá»n"
          },
          {
            "id": "100074821821120",
            "name": "DÃ¢n Quá»‘c"
          },
          {
            "id": "100075046613407",
            "name": "BÃ¡ch LÃª"
          },
          {
            "id": "100075113777038",
            "name": "Nguyá»…n PhÃ¡t"
          },
          {
            "id": "100075168665583",
            "name": "VÅ© HÃ  Anth"
          },
          {
            "id": "100075230191016",
            "name": "Tráº§n Äá»©c Chung"
          },
          {
            "id": "100075561325040",
            "name": "Tuáº¥n Äinh"
          },
          {
            "id": "100075701610698",
            "name": "Minh Há»c"
          },
          {
            "id": "100075825975148",
            "name": "LÃ² PhÆ°á»£ng"
          },
          {
            "id": "100075839027091",
            "name": "Pháº¡m HoÃ ng Lá»±c"
          },
          {
            "id": "100076050091490",
            "name": "Nga Nguá»…n ÄÃ¬nh"
          },
          {
            "id": "100076300312953",
            "name": "Nguyá»…n ÄÃ´"
          },
          {
            "id": "100076439432112",
            "name": "TÃ i NgÃ´ VÄƒn"
          },
          {
            "id": "100076477052283",
            "name": "Mai Thá»‹ Hiá»n"
          },
          {
            "id": "100076523271522",
            "name": "PhÃ¹ng Quang Duy"
          },
          {
            "id": "100076532163245",
            "name": "Hue Bui"
          },
          {
            "id": "100076878619518",
            "name": "Duong Ho"
          },
          {
            "id": "100077460186141",
            "name": "HoÃ ng KhÃ¡nh Trung"
          },
          {
            "id": "100077545832567",
            "name": "Nguyá»…n HÃ²a"
          },
          {
            "id": "100077555650415",
            "name": "PhÆ°Æ¡ng Cacao"
          },
          {
            "id": "100078034662037",
            "name": "Náº¯ng áº¤m"
          },
          {
            "id": "100078296346351",
            "name": "Pháº¡m Sá»¹"
          },
          {
            "id": "100078342848729",
            "name": "VÃµ ThÃ nh MuÃ´n"
          },
          {
            "id": "100078390965377",
            "name": "Nguyá»…n Lan"
          },
          {
            "id": "100078581336698",
            "name": "Nguyá»…n Quang CÆ°á»ng"
          },
          {
            "id": "100079099684434",
            "name": "Nguyá»…n Trung Báº¯c"
          },
          {
            "id": "100079568315780",
            "name": "Trung KiÃªn Ooc"
          },
          {
            "id": "100080220563485",
            "name": "Nguyá»…n Há»¯u ToÃ n"
          },
          {
            "id": "100080229565415",
            "name": "DÆ°Æ¡ng Tháº¯ng"
          },
          {
            "id": "100080368058191",
            "name": "Nguyá»…n Thá»‹ Háº£i"
          },
          {
            "id": "100080626157271",
            "name": "Thuy Nguyen"
          },
          {
            "id": "100080706649458",
            "name": "Quyáº¿t Tháº¯ng Äá»—"
          },
          {
            "id": "100080757789096",
            "name": "ThÃ¡i Kháº¯c GiÃ¡p"
          },
          {
            "id": "100080792601346",
            "name": "Nguyá»…n Thanh Trá»±c"
          },
          {
            "id": "100080910280392",
            "name": "Äinh QuÃ½ Äáº¡t"
          },
          {
            "id": "100081032773745",
            "name": "Nguyá»…n DÅ©ng"
          },
          {
            "id": "100081037962673",
            "name": "HÆ°Æ¡ng Lan"
          },
          {
            "id": "100081490017165",
            "name": "Luáº­n Thu"
          },
          {
            "id": "100081528862973",
            "name": "LÃª Gia Gia"
          },
          {
            "id": "100081761563178",
            "name": "VÄƒn MÃ³ng"
          },
          {
            "id": "100081955574668",
            "name": "Tháº£o BÃ¹ Sab"
          },
          {
            "id": "100082226723091",
            "name": "Huá»³nh ThÆ°Æ¡ng Äan"
          },
          {
            "id": "100082241628162",
            "name": "LÃª Äáº¡i"
          },
          {
            "id": "100082729834865",
            "name": "DÆ°Æ¡ng VÄƒn Vinh"
          },
          {
            "id": "100082954541280",
            "name": "VÅ© Thá»‹ Ãi VÃ¢n"
          },
          {
            "id": "100083102734898",
            "name": "Pháº¡m VÄƒn DÅ©ng"
          },
          {
            "id": "100083236869485",
            "name": "Nguyá»…n Há»¯u Máº£nh"
          },
          {
            "id": "100083335823145",
            "name": "Äá»— Thanh Huyá»n"
          },
          {
            "id": "100083787132060",
            "name": "Nguyá»…n VÄƒn ThÆ°á»£ng"
          },
          {
            "id": "100083913454357",
            "name": "TrÆ°Æ¡ng Diá»‡u Linh"
          },
          {
            "id": "100084345336503",
            "name": "HoÃ ng KhÃ´i NhÃ£"
          },
          {
            "id": "100084446230432",
            "name": "Phong Tráº§n"
          },
          {
            "id": "100084451928813",
            "name": "Nguyá»…n TuÃ¢n"
          },
          {
            "id": "100084484713884",
            "name": "HÃ  Thá»‹ Háº±ng"
          },
          {
            "id": "100085209656750",
            "name": "Váº¡n Minh"
          },
          {
            "id": "100085212109211",
            "name": "BÃ¹i VÄƒn HoÃ ng"
          },
          {
            "id": "100085213192181",
            "name": "Hwi HoÃ ng"
          },
          {
            "id": "100085234355061",
            "name": "Thanh VÃ¢n"
          },
          {
            "id": "100086438617252",
            "name": "Nguyá»…n VÄƒn TrÃ­"
          },
          {
            "id": "100086533914818",
            "name": "NÃ´ng A ThÆ¡"
          },
          {
            "id": "100087269914107",
            "name": "Mai Sy Long"
          },
          {
            "id": "100087508160216",
            "name": "Viá»‡t Huong"
          },
          {
            "id": "100087649161574",
            "name": "Triá»‡u LÆ°u"
          },
          {
            "id": "100087670414303",
            "name": "Äá»©c QuÃ½"
          },
          {
            "id": "100087719366668",
            "name": "VÅ© Tiáº¿n ThÃ nh"
          },
          {
            "id": "100087925421821",
            "name": "Nha Khoa Nháº­t Minh"
          },
          {
            "id": "100087993842922",
            "name": "SÆ° Tá»­ Há»‘ng"
          },
          {
            "id": "100088137217470",
            "name": "LÃª áº¨n"
          },
          {
            "id": "100088171385451",
            "name": "Tráº§n Thanh ToÃ n"
          },
          {
            "id": "100088406513377",
            "name": "NÃ´ng Thá»¥c"
          },
          {
            "id": "100088560654006",
            "name": "Pháº¡m VÄƒn Triá»‡u"
          },
          {
            "id": "100088819491679",
            "name": "Phan Kim Há»“ng"
          },
          {
            "id": "100089035332669",
            "name": "Äá»— Minh KhÃ´i"
          },
          {
            "id": "100089036137442",
            "name": "Huyá»n Meo"
          },
          {
            "id": "100089100117687",
            "name": "Nguyá»…n PhÆ°Æ¡ng"
          },
          {
            "id": "100089190185731",
            "name": "Äá»— Kim Anh"
          },
          {
            "id": "100089629840551",
            "name": "Kim Nháº­t Trung"
          },
          {
            "id": "100089758371520",
            "name": "Äá»— Quang áº¤n"
          },
          {
            "id": "100089831965784",
            "name": "Pháº¡m VÃ¢n"
          },
          {
            "id": "100090027374701",
            "name": "Nguyá»…n Lam"
          },
          {
            "id": "100090105016912",
            "name": "Binh VÃµ Thanh"
          },
          {
            "id": "100090113706347",
            "name": "Dinh Dinh VÄƒn"
          },
          {
            "id": "100090385070845",
            "name": "Nguyá»…n NhÆ° UyÃªn"
          },
          {
            "id": "100090461645348",
            "name": "SÆ¡n Thanh"
          },
          {
            "id": "100090583813167",
            "name": "LÃª Thanh Thanh"
          },
          {
            "id": "100090830105625",
            "name": "Sá»­ Há»“"
          },
          {
            "id": "100090940292695",
            "name": "Há»“ XuÃ¢n Äiá»‡p"
          },
          {
            "id": "100091521318826",
            "name": "Nguyá»…n Thanh Phong"
          },
          {
            "id": "100091552787383",
            "name": "Ngá»c Lan"
          },
          {
            "id": "100091578695473",
            "name": "VÃµ Tráº§n Äáº¡i"
          },
          {
            "id": "100091669860892",
            "name": "HÃ  LÃª"
          },
          {
            "id": "100091680230350",
            "name": "Ngá»c Kiá»u"
          },
          {
            "id": "100091752673413",
            "name": "Nguyá»…n Ngá»c Tiáº¿n"
          },
          {
            "id": "100091807230066",
            "name": "Äáº·ng Kháº¯c Lá»™c"
          },
          {
            "id": "100092000036702",
            "name": "Thanh Háº£i"
          },
          {
            "id": "100092181394275",
            "name": "Nguyen Thi My"
          },
          {
            "id": "100092285543661",
            "name": "BÃ¹i Duy HoÃ ng"
          },
          {
            "id": "100092325012055",
            "name": "Phong Le"
          },
          {
            "id": "100092672348227",
            "name": "Vu Vi"
          },
          {
            "id": "100092690103039",
            "name": "Nguyá»…n Thá»§y"
          },
          {
            "id": "100092873505619",
            "name": "Hao Dang"
          },
          {
            "id": "100093042820343",
            "name": "Huy HoÃ ng Minh"
          },
          {
            "id": "100093353030903",
            "name": "Ninh DÆ°Æ¡ng"
          },
          {
            "id": "100093440329466",
            "name": "Huá»³nh Anh Khoa"
          },
          {
            "id": "100093974701847",
            "name": "VÄƒn Quá»‘c Trá»‹nh"
          },
          {
            "id": "100094074710885",
            "name": "Ã Tran Anh"
          },
          {
            "id": "100094168261554",
            "name": "Lan Anh"
          },
          {
            "id": "100094199034583",
            "name": "Kiá»u Nhi"
          },
          {
            "id": "100094642756217",
            "name": "Tháº©m Minh Äá»©c"
          },
          {
            "id": "100094668193287",
            "name": "Tiáº¿n ThÃ nh"
          },
          {
            "id": "100095211926591",
            "name": "Ngoc Nguyen"
          },
          {
            "id": "100095592691405",
            "name": "LÃª Nguyá»…n"
          }
        ],
        "comments": [
          {
            "id": "61550007209843",
            "name": "Tráº§n Thá»",
            "text": "ChÃºc doanh nghiá»‡p thá»‹nh vÆ°Æ¡ng",
            "created_time_vn": "2025-12-07 21:16:59"
          },
          {
            "id": "100066725032703",
            "name": "Chu Lá»±c",
            "text": "Tuyá»‡t Ä‘áº¥y",
            "created_time_vn": "2025-11-07 21:39:21"
          },
          {
            "id": "100070122397219",
            "name": "Huyáº¿n Car A.I",
            "text": "ðŸ‘",
            "created_time_vn": "2025-12-06 21:05:48"
          },
          {
            "id": "61574468717923",
            "name": "Thuá»³ LiÃªn",
            "text": "Ib e áº¡",
            "created_time_vn": "2025-11-08 14:37:25"
          },
          {
            "id": "100025789984189",
            "name": "Pháº¡m VÄƒn ÄÃ´",
            "text": "Xin chÄƒn áº¡",
            "created_time_vn": "2025-12-03 21:43:19"
          },
          {
            "id": "100000165078699",
            "name": "TÃ¹ng BÃ¹i",
            "text": "Ib em áº¡",
            "created_time_vn": "2025-12-13 14:19:46"
          },
          {
            "id": "100012357012718",
            "name": "Hao Tran",
            "text": "Ib e áº¡",
            "created_time_vn": "2025-12-01 20:09:31"
          },
          {
            "id": "100009956405807",
            "name": "Tráº§n Ngá»c",
            "text": "CÃ²n tuyá»ƒn kiá»ƒm soÃ¡t ná»™i bá»™ khÃ´ng báº¡n ?",
            "created_time_vn": "2025-11-29 23:41:52"
          },
          {
            "id": "61579318266095",
            "name": "Tráº§n Thá»‹nh",
            "text": "TrÃ  vinh cÃ³ tuyá»ƒn ko áº¡.",
            "created_time_vn": "2025-11-20 19:17:49"
          },
          {
            "id": "100005029181365",
            "name": "Huy Nguyen",
            "text": "CÃ´ng ty cÃ³ tuyá»ƒn khu vá»±c Quáº£ng NgÃ£i khÃ´ng ad Æ¡i?",
            "created_time_vn": "2025-11-25 12:13:38"
          },
          {
            "id": "100005094872268",
            "name": "Dung Nguyen",
            "text": "Trá»£ lÃ½ giÃ¡m Ä‘á»‘c yÃªu cáº§u nhÆ° nÃ o",
            "created_time_vn": "2025-12-06 22:10:19"
          },
          {
            "id": "100035332923847",
            "name": "Trá»‹nh XuÃ¢n TrÆ°á»ng",
            "text": "CÃ³ tuyá»ƒn khu Ninh BÃ¬nh ko a",
            "created_time_vn": "2025-12-12 18:21:45"
          },
          {
            "id": "100014542606661",
            "name": "Thai Ninh",
            "text": "NhÃ¢n viÃªn kho yÃªu cáº§u tháº¿ nÃ o Ä‘á»™ tuá»•i nhiu",
            "created_time_vn": "2025-11-10 12:56:04"
          },
          {
            "id": "100057777966094",
            "name": "Tráº§n Tháº¯ng",
            "text": "NhÃ¢n viÃªn kho ntn báº¡n",
            "created_time_vn": "2025-11-24 06:57:27"
          },
          {
            "id": "100014070158894",
            "name": "Hoang Duong",
            "text": "E o Ä‘Ã´ng nai lÃ m dc k áº¡",
            "created_time_vn": "2025-11-26 14:54:32"
          },
          {
            "id": "100046326636929",
            "name": "Nguyá»…n Tháº¯ng",
            "text": "Tphcm cÃ³ k áº¡",
            "created_time_vn": "2025-11-09 22:41:45"
          },
          {
            "id": "100043881496415",
            "name": "HoÃ n ÄoÃ n VÄƒn",
            "text": "MÃ¬nh Ä‘Ã£ cÃ³ kinh nghiá»‡m quáº£n lÃ½ kho thÃ nh pháº©m gáº§n 10 nÄƒm. Muá»‘n á»©ng tuyá»ƒn vá»‹ trÃ­ nhÃ¢n viÃªn kho thÃ¬ lÃ m ntn.",
            "created_time_vn": "2025-12-03 18:53:49"
          },
          {
            "id": "100084546177261",
            "name": "Vuong Nguyen",
            "text": "Con tuyÃªn ko ak",
            "created_time_vn": "2025-11-25 10:20:26"
          },
          {
            "id": "100006913396585",
            "name": "Nguyá»…n VÄƒn Triá»u",
            "text": "Ib thá»§ kho",
            "created_time_vn": "2025-11-09 20:53:25"
          },
          {
            "id": "100074452901885",
            "name": "LÃ¢m PÃºch XÃª A",
            "text": "ChÆ¡n ThÃ nh tuyá»ƒn dá»¥ng khÃ´ng áº¡",
            "created_time_vn": "2025-11-27 12:29:41"
          },
          {
            "id": "61582500838091",
            "name": "Cá»‘ QuÃªn",
            "text": "LÃ m cv Æ¡ Ä‘Ã¢u dáº­y a",
            "created_time_vn": "2025-12-09 21:08:48"
          },
          {
            "id": "100085209656750",
            "name": "Váº¡n Minh",
            "text": "CÃ²n tuyá»ƒn Ká»· thuáº­t viÃªn khÃ´ng báº¡n",
            "created_time_vn": "2025-11-07 12:11:26"
          },
          {
            "id": "100006398494860",
            "name": "Tuan Tuan Trung",
            "text": "Nhan viÃªn kho yeu cÃ¢u tháº¿ mao ban",
            "created_time_vn": "2025-11-30 06:35:26"
          },
          {
            "id": "100025749559239",
            "name": "Minh Diá»‡u",
            "text": "Äiá»u kiá»‡n nhÆ° tháº¿ nÃ o záº­y ad",
            "created_time_vn": "2025-12-09 21:33:21"
          },
          {
            "id": "100034771966756",
            "name": "Du Tran",
            "text": "TrÃ  vinh cÃ³ khÃ´ng???",
            "created_time_vn": "2025-11-21 21:53:36"
          },
          {
            "id": "100027609980867",
            "name": "XuÃ¢n QuÃ¢n",
            "text": "CÃ³ tuyá»ƒn cn lao Ä‘á»™ng ko",
            "created_time_vn": "2025-11-29 20:27:49"
          },
          {
            "id": "100041024493272",
            "name": "Minh Hiáº¿u",
            "text": "Tuyá»ƒn á»Ÿ Ä‘Ã¢u váº­y áº¡",
            "created_time_vn": "2025-11-30 20:37:33"
          },
          {
            "id": "100022875712192",
            "name": "HoÃ ng Long",
            "text": "CÃ´ng nhÃ¢n kho cÃ³ cáº§n báº±ng ko",
            "created_time_vn": "2025-12-09 13:01:09"
          },
          {
            "id": "100007067495704",
            "name": "BiÃªn Nghá»‡ An",
            "text": ".",
            "created_time_vn": "2025-11-16 21:40:39"
          },
          {
            "id": "100011408690394",
            "name": "Nguyentrung Nguyen Trung",
            "text": "MÃ¬nh muá»‘n á»©ng tuyá»ƒnquan lÃ½ ná»™i bá»™",
            "created_time_vn": "2025-11-10 19:45:09"
          },
          {
            "id": "61553474652388",
            "name": "HoÃ ng ThiÃªn",
            "text": ".",
            "created_time_vn": "2025-11-22 23:32:20"
          },
          {
            "id": "100008858381523",
            "name": "Há»“ ÄÆ¡n PhÆ°Æ¡ng",
            "text": "CÃ²n tuyá»ƒn ko",
            "created_time_vn": "2025-12-03 22:11:42"
          },
          {
            "id": "100063919234949",
            "name": "Thanh Nguyen Trung",
            "text": "Toi 50 tuoi hien dang song tai tp hcm . CÃ³ báº±ng lai xe dáº¥u D . Ko biáº¿t cÃ³ tuyá»ƒn dung ko a",
            "created_time_vn": "2025-11-13 13:46:13"
          },
          {
            "id": "100018797025595",
            "name": "LÃª Thanh Hiá»n",
            "text": "khu vá»±c nÃ o a",
            "created_time_vn": "2025-11-08 16:33:58"
          },
          {
            "id": "100005246042832",
            "name": "VÄƒn ToÃ n",
            "text": "Poll",
            "created_time_vn": "2025-12-01 06:09:51"
          },
          {
            "id": "61582728937643",
            "name": "Phong Trinh",
            "text": "CÃ²n ko ah",
            "created_time_vn": "2025-11-06 07:23:41"
          },
          {
            "id": "100012165750794",
            "name": "Nguyen The Anh",
            "text": "hÃ³ng",
            "created_time_vn": "2025-12-15 10:44:05"
          },
          {
            "id": "100005475302341",
            "name": "Tháº¯ng Bx",
            "text": "Ib m nhe",
            "created_time_vn": "2025-11-18 20:38:20"
          },
          {
            "id": "100004471183096",
            "name": "Lá»u TÃº",
            "text": "xin Ä‘Äƒng kÃ½",
            "created_time_vn": "2025-11-08 00:00:21"
          },
          {
            "id": "100006828812149",
            "name": "Hai Con CuÃ´ng",
            "text": "Chá»‘t",
            "created_time_vn": "2025-11-26 22:23:20"
          },
          {
            "id": "100012451836115",
            "name": "HÃ¹ng LÃ¢m",
            "text": ".",
            "created_time_vn": "2025-11-13 23:23:47"
          },
          {
            "id": "100003117464476",
            "name": "Nguyá»…n Thá»‹ Háº£i Luáº­n",
            "text": "Kim Ly Van, Nguyá»…n Lá»‡ Thu",
            "created_time_vn": "2025-11-22 14:05:38"
          },
          {
            "id": "100010274467802",
            "name": "DÆ°Æ¡ng LÃª",
            "text": "CÃ²n tuyá»ƒn kho k ak",
            "created_time_vn": "2025-11-15 16:52:51"
          },
          {
            "id": "61577538753470",
            "name": "Äinh VÄƒn Khanh",
            "text": ".",
            "created_time_vn": "2025-11-11 12:00:09"
          },
          {
            "id": "61562755996958",
            "name": "Nguyá»…n Q. SÃ¡ng",
            "text": "Tráº§n Quá»³nh",
            "created_time_vn": "2025-11-24 21:27:05"
          },
          {
            "id": "100005475302341",
            "name": "Tháº¯ng Bx",
            "text": ".",
            "created_time_vn": "2025-11-20 13:21:58"
          },
          {
            "id": "100024020507922",
            "name": "Tráº§n NguyÃªn HÃ¹ng",
            "text": "...",
            "created_time_vn": "2025-11-10 13:01:04"
          },
          {
            "id": "100079717576937",
            "name": "Nguyá»…n VÃ¢n QuÃ¢n",
            "text": "Ib",
            "created_time_vn": "2025-11-09 17:34:45"
          },
          {
            "id": "61572587993897",
            "name": "Phan Phá»•",
            "text": "Pháº¡m TiÃªn Sinh",
            "created_time_vn": "2025-11-06 06:38:11"
          },
          {
            "id": "61565854161210",
            "name": "Huynh Ba",
            "text": "Ib",
            "created_time_vn": "2025-11-18 05:54:21"
          },
          {
            "id": "100034153822517",
            "name": "VÆ°Æ¡ng Tráº§n",
            "text": "Ib",
            "created_time_vn": "2025-12-01 17:44:14"
          },
          {
            "id": "100025638644041",
            "name": "Besd Gh Meng",
            "text": "Ib",
            "created_time_vn": "2025-11-25 09:41:40"
          },
          {
            "id": "100004418705827",
            "name": "Tháº¯ng Äá»—",
            "text": "Ib",
            "created_time_vn": "2025-11-18 17:57:55"
          }
        ],
        "reactions_count": 1118,
        "comments_count": 53,
        "reactions_count_before_filter": 1118,
        "comments_count_before_filter": 53,
        "status": "success"
      },
      {
        "post_id": "101620679431321",
        "flag": "Ä‘á»",
        "text": "Ná»™i dung mÃ´ phá»ng cho post 101620679431321",
        "owning_profile": {
          "__typename": "User",
          "name": "TH True Mart tuyá»ƒn dá»¥ng",
          "id": "100087385844583"
        },
        "source_file": "031ca13d-e8fa-400c-a603-df57a2806788.json",
        "profile_id": "031ca13d-e8fa-400c-a603-df57a2806788",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "1171101481878307",
        "flag": "vÃ ng",
        "text": "Ná»™i dung mÃ´ phá»ng cho post 1171101481878307",
        "owning_profile": {
          "__typename": "User",
          "name": "Americus & Gosani",
          "id": "100069353979673"
        },
        "source_file": "031ca13d-e8fa-400c-a603-df57a2806788.json",
        "profile_id": "031ca13d-e8fa-400c-a603-df57a2806788",
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
      },
      {
        "post_id": "1273299934841514",
        "flag": "Ä‘á»",
        "text": "Ná»™i dung mÃ´ phá»ng cho post 1273299934841514",
        "owning_profile": {
          "__typename": "User",
          "name": "Google Ads",
          "id": "100064845576688"
        },
        "source_file": "031ca13d-e8fa-400c-a603-df57a2806788.json",
        "profile_id": "031ca13d-e8fa-400c-a603-df57a2806788",
        "reactions": [],
        "comments": [
          {
            "id": "100083335447943",
            "name": "XÆ°á»Ÿng Sáº£n Xuáº¥t Nhá»±a GiÃ¡ Táº­n Gá»‘c",
            "text": "mÃ¬nh Ä‘ang sá»¯ dá»¥ng, tháº¥y hiá»‡u quáº£, giÃ¡ há»£p lÃ½",
            "created_time_vn": "2025-11-26 19:37:14"
          },
          {
            "id": "100090041555304",
            "name": "HÃ  Ná»™i Land",
            "text": "QÃºa tuyá»‡t vá»i",
            "created_time_vn": "2025-11-18 16:25:18"
          },
          {
            "id": "100063775987362",
            "name": "Tuan Anh",
            "text": "Lá»‡nh cháº¥t lÆ°á»£ng, há»— trá»£ nhiá»‡t tÃ¬nh, uy tÃ­n 10/10 â¤ï¸",
            "created_time_vn": "2025-11-06 08:51:35"
          },
          {
            "id": "100029780175583",
            "name": "Do Anh Tuan",
            "text": "Ná»n táº£ng nhÆ° cc xÃ¡c minh thÃ nh cÃ´ng lÃªn chiáº¿n dá»‹ch lÃ  deal",
            "created_time_vn": "2025-10-24 21:09:53"
          },
          {
            "id": "100056119253246",
            "name": "Huong Sen",
            "text": "NgÃ y Ä‘áº§u thÃ¡ng gá»­i báº¡n lá»i chÃºc: bÃ¬nh yÃªn, háº¡nh phÃºc vÃ  Ä‘á»§ Ä‘áº§y.",
            "created_time_vn": "2025-12-01 06:39:29"
          },
          {
            "id": "100083139822462",
            "name": "HÃ³a Pháº©m - HÃ³a Cháº¥t Beecok",
            "text": "CÃ´ng nháº­n Google AI giÃºp Ã­ch nhiá»u cho viá»‡c quáº£n lÃ½ quáº£ng cÃ¡o tháº­t, Ä‘á»¡ tá»‘n thá»i gian mÃ  láº¡i hiá»‡u quáº£ ná»¯a. ChÃºc báº¡n ngÃ y cÃ ng phÃ¡t triá»ƒn nhÃ©!",
            "created_time_vn": "2025-11-11 00:08:21"
          },
          {
            "id": "100022739147203",
            "name": "Huong Kim Le",
            "text": "Google AI tháº­t sá»± lÃ  cÃ´ng cá»¥ quáº£ng cÃ¡o ráº¥t hiá»‡u quáº£! GiÃºp quáº£n lÃ½ kinh doanh online dá»… dÃ ng hÆ¡n. ðŸ™‹",
            "created_time_vn": "2025-11-21 08:49:03"
          },
          {
            "id": "100082898025107",
            "name": "Nguyá»…n Há»“ng Gá»n",
            "text": "Ttql nha ngÆ°á»i Ä‘áº¹p ðŸŽ€âœ…",
            "created_time_vn": "2025-12-08 14:41:04"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "trÃ´ng cÃ³ váº» xá»‹n xÃ² nhe ðŸ˜†**",
            "created_time_vn": "2025-11-18 15:03:00"
          },
          {
            "id": "100078424484232",
            "name": "Nguyá»…n NgÃ¢n",
            "text": "ngÃ y má»›i vui váº» nhÃ© Google Ads",
            "created_time_vn": "2025-10-14 13:02:03"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ˜˜tÆ°Æ¡i tÆ°Æ¡i ko cáº§n tÆ°á»›i nhe ðŸ’•",
            "created_time_vn": "2025-11-17 19:14:49"
          },
          {
            "id": "100082898025107",
            "name": "Nguyá»…n Há»“ng Gá»n",
            "text": "Buá»•i tá»‘i vui váº» nha Google Ads",
            "created_time_vn": "2025-11-28 20:32:00"
          },
          {
            "id": "100048812236578",
            "name": "NhÃ¢n Vshorts",
            "text": "â¤ Káº¿t ná»‘i hiá»‡u quáº£ vá»›i khÃ¡ch hÃ ng tiá»m nÄƒng lÃ  ráº¥t quan trá»ng.\nâ­ TÆ°Æ¡ng tÃ¡c thÆ°á»ng xuyÃªn giÃºp chÃºng ta xÃ¢y dá»±ng má»‘i quan há»‡ vá»¯ng cháº¯c.\nðŸ’¡ LuÃ´n láº¯ng nghe Ä‘á»ƒ tháº¥u hiá»ƒu vÃ  náº¯m báº¯t má»i cÆ¡ há»™i phÃ¡t triá»ƒn.\nâœ… HÃ£y báº¯t Ä‘áº§u duy trÃ¬ liÃªn láº¡c ngay hÃ´m nay Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c thÃ nh cÃ´ng! \ncmt cháº¡y bá»Ÿi tool nuÃ´i nick vshorts LH 0978142991",
            "created_time_vn": "2025-12-09 08:04:45"
          },
          {
            "id": "61573151604058",
            "name": "ØªØ±Ø§Ù† Ø«ÙŠÙ† ØªØ´ÙŠÙˆØ§Ù†",
            "text": "ÄÃ nh lÃ m liá»u yÃªu há» Ä‘i táº¥t cáº£.",
            "created_time_vn": "2025-12-06 14:35:13"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "nÃ ng thÆ¡ lÃ  Ä‘Ã¢y kaka",
            "created_time_vn": "2025-12-10 15:31:39"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "MÃª canh lá»i lun ui nhoaaaðŸ˜˜-ðŸ˜˜",
            "created_time_vn": "2025-11-18 17:48:37"
          },
          {
            "id": "100093455242770",
            "name": "Mix video channal",
            "text": "ah, unbelievably dedication ðŸ˜ðŸ˜· ðŸ¤£ lol, i relate so hard it hurts.! ðŸ˜ðŸ˜¦ðŸ˜¨",
            "created_time_vn": "2025-12-07 08:16:56"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "yeah ðŸ‘chuáº©n khÃ´ng cáº§n chá»‰nh lun",
            "created_time_vn": "2025-12-04 15:24:10"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "â¤ï¸^^nháº¥t rá»“i nhe cvvv ah",
            "created_time_vn": "2025-11-25 15:44:16"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "nháº¥t lun rá»“i nhe timh yeu",
            "created_time_vn": "2025-12-02 13:50:01"
          },
          {
            "id": "100067163581142",
            "name": "NgÃ¢n Xuyáº¿n",
            "text": "TÆ°Æ¡ng tÃ¡c Ä‘á»ƒ tháº¥y nhau má»—i ngÃ y nhÃ© ðŸ",
            "created_time_vn": "2025-11-05 03:39:04"
          },
          {
            "id": "61576319129126",
            "name": "Thá»¥c Äoan NgÃ¢n",
            "text": "PhÃºc Äá»©c táº¡i máº«u ? NÃ³i sai thÃ¬ trá»i nÃ³ cÃ³ máº¯t,,, ko Ä‘i Ä‘Æ°á»ng láº¡i bá»‹ xe cÃ¡n cho ..",
            "created_time_vn": "2025-10-15 23:39:41"
          },
          {
            "id": "100076520708895",
            "name": "Link Ngon Má»—i NgÃ y",
            "text": "HÃ´m bá»¯a Ä‘i lÃ m, Ä‘á»“ng nghiá»‡p báº£o:\nâ€œSao Ã¡o quáº§n thÆ¡m dá»¯ váº­y, bÃ­ kÃ­p gÃ¬ tháº¿?â€\nMÃ¬nh chá»‰ cÆ°á»i: â€œCÃ³ gÃ¬ Ä‘Ã¢u, MaxKleen lo háº¿t rá»“i!â€ ðŸŒ¸\n\nðŸ§º NÆ°á»›c Giáº·t Xáº£ MaxKleen 3.8kg\nâœ¨ Giáº·t sáº¡ch váº¿t báº©n cá»©ng Ä‘áº§u, giá»¯ mÃ u váº£i tÆ°Æ¡i má»›i\nðŸŒ¸ HÆ°Æ¡ng thÆ¡m lÃ¢u, má»m váº£i, an toÃ n cho da\nðŸ’° Dung tÃ­ch lá»›n, giÃ¡ há»i â€“ sáº¯m ngay káº»o lá»¡!\nLink nÆ°á»›c giáº·t: https://s.shopee.vn/8pcqh7AHT3\nLink mÃ£ giáº£m giÃ¡: https://s.shopee.vn/7Ko2uObfAY",
            "created_time_vn": "2025-10-02 20:16:49"
          },
          {
            "id": "61567894921648",
            "name": "Heo Quay Giao Hiá»n",
            "text": "Hy vá»ng Google Ads luÃ´n vui váº», Ä‘á»§ nÄƒng lÆ°á»£ng Ä‘á»ƒ lÃ m Ä‘iá»u mÃ¬nh thÃ­ch ðŸŒ»ðŸ’›",
            "created_time_vn": "2025-11-02 12:41:59"
          },
          {
            "id": "100044326724856",
            "name": "Aesthetic",
            "text": "Fazzykizz CRIB  ðŸ˜‰ðŸ˜‡ ðŸ˜‚ ito ang energy na kailangan ko: me vs responsibilities. ðŸ˜…ðŸ˜¶ðŸ™",
            "created_time_vn": "2025-11-15 13:30:02"
          },
          {
            "id": "100081852616274",
            "name": "Smarthome Quy NhÆ¡n",
            "text": "LÃ m sao Ä‘á»ƒ káº¿t ná»‘i liÃªn tá»¥c khÃ´ng phiá»n?",
            "created_time_vn": "2025-12-03 18:16:59"
          },
          {
            "id": "100084229270156",
            "name": "HomeTech Lighting VN",
            "text": "Duy trÃ¬ káº¿t ná»‘i cÃ³ khÃ³ khÃ´ng má»i ngÆ°á»i?",
            "created_time_vn": "2025-12-03 18:12:33"
          },
          {
            "id": "100048317856828",
            "name": "Nguyá»…n Quang HÃ¹ng",
            "text": "tháº¡ tym mong google ads chÃº Ã½ tá»›i tÃ´i nhiá»u hÆ¡n trong tÆ°Æ¡ng lai tá»›i",
            "created_time_vn": "2025-12-12 21:46:22"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "kkk xuáº¥t sáº¯c tháº¿ ty á»“ likeeðŸ«°",
            "created_time_vn": "2025-11-30 16:33:23"
          },
          {
            "id": "100082898025107",
            "name": "Nguyá»…n Há»“ng Gá»n",
            "text": "Tháº¥y Google Ads Ä‘Äƒng bÃ i lÃ  tháº£ â¤ ngay nÃ¨!ðŸ¥°ðŸ¥°ðŸ¥°",
            "created_time_vn": "2025-11-28 10:25:10"
          },
          {
            "id": "100082898025107",
            "name": "Nguyá»…n Há»“ng Gá»n",
            "text": "AI nÃ y cÃ³ thá»±c sá»± hiá»‡u quáº£ khÃ´ng ta?",
            "created_time_vn": "2025-11-27 19:45:41"
          },
          {
            "id": "61584783687201",
            "name": "Xem Váº­n Má»‡nh Cuá»™c Äá»i",
            "text": "Má»i ngÆ°á»i ghÃ© trang mÃ¬nh xem tá»­ vi, phong thá»§y miá»…n phÃ­ nhÃ©!",
            "created_time_vn": "2025-12-14 21:00:09"
          },
          {
            "id": "100044326724856",
            "name": "Aesthetic",
            "text": "ðŸ™„ðŸ¤’ ðŸ˜‚ yung feeling kapag totoong mvp.. ðŸ¤¨ðŸ¤²",
            "created_time_vn": "2025-12-14 16:26:17"
          },
          {
            "id": "61576167173794",
            "name": "Má»¹ Linh",
            "text": "Sá»‘ng tá»­ táº¿ mÃ  lÃ m ngÆ°á»i cho chá»“ng nÃ³ thá» , ko láº¡i má»“ cÃ´i sá»›m... con Ä‘Ä© nhÃ  thá»• ..  con Loan lÃ´ Ä‘á» cá» báº¡c lá»«a Ä‘áº£o chá»‹ em ruá»™t ... cheers Ä‘i cho tráº­t Ä‘áº¥t con cho Loan nhÃ©",
            "created_time_vn": "2025-10-15 23:36:27"
          },
          {
            "id": "100050332876527",
            "name": "Hot Peach",
            "text": "ðŸ¤¡ ðŸ¤¯ me trying to just like me procrastinating again. but failing. ðŸ™‚",
            "created_time_vn": "2025-12-09 20:54:26"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "cháº¯c tui chá»›t quÃ¡ blemðŸ˜œ",
            "created_time_vn": "2025-11-17 21:39:45"
          },
          {
            "id": "61576291259765",
            "name": "Tuyáº¿t BÄƒng Linh",
            "text": "Tá»‰nh Ä‘i mÃ  lÃ m ngÆ°á»i .. láº¥y phÃºc cho 2 tháº±ng con nÃ³ hÆ°á»Ÿng ? Ko láº¡i Ä‘i cháº¡n vÆ°Æ¡ng thÃ¬ nhá»¥c láº¯m",
            "created_time_vn": "2025-10-15 23:37:39"
          },
          {
            "id": "100012280808799",
            "name": "Báº£o ChÃ¢u",
            "text": "lam bat dong san quang cao sao thay tao ma kho qua",
            "created_time_vn": "2025-11-26 09:58:02"
          },
          {
            "id": "61576196276597",
            "name": "TrÃºc Mai",
            "text": "Ã”i Ä‘á»i nhá»¥c tháº¿ .. con thÃ¬ cháº¡n vÆ°Æ¡ng , nhá»¥c nhÃ£ nhá»‰ ,",
            "created_time_vn": "2025-10-15 22:25:26"
          },
          {
            "id": "100009358907050",
            "name": "Bim Bim",
            "text": "CÃ´ng ngÃ y : 398.000Ä‘/11h\nCÃ´ng Ä‘Ãªm : 470.000Ä‘/11h\nChá»§ nháº­t ngÃ y : 687.000Ä‘/11h\nChá»§ nháº­t Ä‘Ãªm : 840.000Ä‘/11h\nlh 0975579293",
            "created_time_vn": "2025-11-08 09:10:04"
          },
          {
            "id": "61575821927513",
            "name": "Linh San Lan",
            "text": "Lá»«a Ä‘áº£o lÃ´ Ä‘á» ... che Ä‘c máº¯t thg Chá»“ng thÃ´i",
            "created_time_vn": "2025-10-15 22:25:25"
          },
          {
            "id": "100082898025107",
            "name": "Nguyá»…n Há»“ng Gá»n",
            "text": "AI quáº£n lÃ½ quáº£ng cÃ¡o nghe hay nÃ¨. CÃ³ ai dÃ¹ng chÆ°a?",
            "created_time_vn": "2025-11-27 19:29:06"
          },
          {
            "id": "61555131120322",
            "name": "CÃ¡t TÆ°á»ng",
            "text": "MÃ y chuyÃªn lá»«a Ä‘áº£o chá»‹ em mÃ y thaays nhá»¥c ko ?Ä‚n cháº¡c cá»§a chá»‹ em ruá»™t thi Ä‘á»i mÃ y xuá»‘ng dá»‘c ko phanh",
            "created_time_vn": "2025-10-16 00:17:31"
          },
          {
            "id": "61576317922402",
            "name": "Ngá»c HÆ°Æ¡ng ThÆ°",
            "text": "Háº¹n 1 thg Tráº£ 50 tr t nhÃ  .. lá»«a chÃ¡u ko tráº£ ... cÃ£i bay cÃ£i biáº¿n",
            "created_time_vn": "2025-10-15 23:36:45"
          },
          {
            "id": "61583506074526",
            "name": "HoÃ ng Long - Dai-ichi Life GA Nam Tá»« LiÃªm 2",
            "text": "Äi viá»‡n tá»‘n gÃ¬?\nKhÃ¡m ban Ä‘áº§u: vÃ i trÄƒm nghÃ¬n â€“ vÃ i triá»‡u\nTiá»n giÆ°á»ng ná»™i trÃº: 100k â€“ 2 triá»‡u/ngÃ y\nThuá»‘c & váº­t tÆ°: vÃ i trÄƒm nghÃ¬n â€“ vÃ i triá»‡u/ngÃ y\nPháº«u thuáº­t: 5 â€“ 100+ triá»‡u\nXÃ©t nghiá»‡m láº¡i trong viá»‡n: thÃªm vÃ i triá»‡u\nChi phÃ­ ngoÃ i hÃ³a Ä‘Æ¡n (Äƒn uá»‘ng, ngÆ°á»i chÄƒmâ€¦): 100k â€“ 500k/ngÃ y\nðŸ‘‰ Tá»•ng 3â€“5 ngÃ y náº±m viá»‡n:\nâ€¢ CÃ³ BHYT: 1â€“5 triá»‡u\nâ€¢ KhÃ´ng BHYT: 5â€“20 triá»‡u\nâ€¢ Má»•/ bá»‡nh náº·ng: cÃ³ thá»ƒ lÃªn Ä‘áº¿n hÃ ng chá»¥c triá»‡u â€“ hÆ¡n 100 triá»‡u.\nBáº£o hiá»ƒm sá»©c khá»e giÃºp mÃ¬nh giáº£m gÃ¡nh náº·ng ráº¥t nhiá»u khi á»‘m Ä‘au báº¥t ngá».",
            "created_time_vn": "2025-11-14 11:41:31"
          },
          {
            "id": "100094073614045",
            "name": "Smart Money with AI & Crypto",
            "text": "Google Ads Ä‘ang train AI Ä‘á»ƒ hiá»ƒu tÃ¢m lÃ½ ngÆ°á»i Viá»‡t: \"Mua 1 táº·ng 1\", \"Sale off 50%\", \"Chá»‰ cÃ²n 3 ngÃ y cuá»‘i\" ðŸ˜‚ Thuáº­t toÃ¡n Ä‘Ã£ há»c Ä‘Æ°á»£c cÃ¡ch lÃ m chÃºng ta \"auto click\" rá»“i Ä‘Ã¢y! #GoogleAI #AutoClick #VietnamShopping #MarketingGeniuses",
            "created_time_vn": "2025-10-31 09:36:09"
          },
          {
            "id": "61553242834878",
            "name": "Nguyá»‡t Ãnh",
            "text": "Con máº¥t dáº­y .. sá»‘ng lá»«a Ä‘áº£o con chÃ¡u ? MÃ y láº¥y phÃºc á»Ÿ Ä‘Ã¢u cho chá»“ng con mÃ y hÆ°á»Ÿng ? Ko cáº©n tháº­n cháº¿t non cáº£ nhÃ  mÃ y",
            "created_time_vn": "2025-10-15 23:57:47"
          },
          {
            "id": "100091643160429",
            "name": "Ads Manager - Káº¿t Ná»‘i KhÃ¡ch HÃ ng Bá»©t PhÃ¡ Doanh Thu",
            "text": "ð—¦ð—µð—¼ð—½ ð—¯ð—®Ì£ð—» ð—ºð˜‚ð—¼Ì‚Ìð—» ð—¯ð˜‚Ì›Ìð˜ ð˜ð—¼Ì‚Ìð—°? ð—§ð—¼Ì‚Ìð—¶ ð˜‚Ì›ð˜‚ ð—™ð—®ð—°ð—²ð—¯ð—¼ð—¼ð—¸ ð—¹ð—®Ì€ ð—¯ð˜‚Ì›ð—¼Ì›Ìð—° Ä‘ð—®Ì‚Ì€ð˜‚ ð˜ð—¶ð—²Ì‚ð—» Ä‘ð—²Ì‚Ì‰ ð˜ð—¶ð—²Ì‚Ìð—½ ð—°ð—®Ì£Ì‚ð—» Ä‘ð˜‚Ìð—»ð—´ ð˜ð—²Ì£Ì‚ð—½ ð—¸ð—µð—®Ìð—°ð—µ ð—¹ð—®Ì£ ð—°ð—¼Ì ð—»ð—µð˜‚ ð—°ð—®Ì‚Ì€ð˜‚ ð—ºð˜‚ð—® ð—µð—®Ì€ð—»ð—´,. ð—•ð—²Ì‚ð—» ð—²ð—º ð—°ð—µð˜‚ð˜†ð—²Ì‚ð—» ð—°ð˜‚ð—»ð—´ ð—°ð—®Ì‚Ìð—½ ð—šð—¶ð—®Ì‰ð—¶ ð—½ð—µð—®Ìð—½ ð˜ð—¶ð—²Ì‚Ìð—½ ð—°ð—®Ì£Ì‚ð—» ð—¸ð—µð—®Ìð—°ð—µ Ä‘ð˜‚Ìð—»ð—´ ð—»ð—µð˜‚ ð—°ð—®Ì‚Ì€ð˜‚ Ä‘ð—®ð—»ð—´ ð—°ð—®Ì‚Ì€ð—» ð˜€ð—®Ì‰ð—» ð—½ð—µð—®Ì‚Ì‰ð—º Mxh 360 - Giáº£i PhÃ¡p ToÃ n Diá»‡n",
            "created_time_vn": "2025-11-17 17:55:52"
          },
          {
            "id": "61581338795254",
            "name": "F88 135 Mai Thá»‹ Há»“ng Háº¡nh",
            "text": "âœª Cáº¦N LÃ€ CÃ“ - Äáº¾N LÃ€ DUYá»†Tâœª\nâœª F88 - TÃ€I CHÃNH BÃŒNH DÃ‚N âœª\nâ€‹â˜Žâ˜Žâ˜Ž ð‡ð¨ð­ð¥ð¢ð§ðž: 0297.730.0388\nâ˜Ž ZALO: 0764653891\nðŸ‘‰ ÄÄƒng kÃ½ ngay táº¡i Ä‘Ã¢y: http://vay.f88.vn/1_KGG0349",
            "created_time_vn": "2025-10-20 08:42:08"
          },
          {
            "id": "100041473875947",
            "name": "Nguyá»…n Báº£o Ngá»c Ly",
            "text": "â­•ï¸ Náº P 100K  Táº¶NG 68K \nâ­•ï¸ Náº P 300K Táº¶NG 128K\nâ­•ï¸ Náº P 500 Táº¶NG  168K",
            "created_time_vn": "2025-11-18 15:36:50"
          },
          {
            "id": "100092250423609",
            "name": "Kem Xinhh",
            "text": "TÆ°Æ¡ng tÃ¡c nha ty",
            "created_time_vn": "2025-10-03 03:19:20"
          },
          {
            "id": "100080685466820",
            "name": "Lan ÄÃ i TrÆ°Æ¡ng",
            "text": "good",
            "created_time_vn": "2025-10-04 06:56:18"
          },
          {
            "id": "100081042624704",
            "name": "HÃ  HÆ°Æ¡ng",
            "text": "xin chÃ o",
            "created_time_vn": "2025-10-16 08:38:44"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "tháº£ tim ðŸ©·tha tt má»—i ngÃ y nhoa ty",
            "created_time_vn": "2025-11-24 11:43:40"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "Ä‘Ãºng gu cháº¥t ngáº¥t lun ðŸ’•CHUáº¨N 100-->likeðŸ’‹ðŸ’ª",
            "created_time_vn": "2025-11-18 11:39:31"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "conmen vÃ  like cho nhau nhÃ©",
            "created_time_vn": "2025-10-18 17:34:13"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "Google Ads Æ¡i comments vÃ  tháº£ â™¥ï¸ cho nhau nhaðŸ’ðŸ’ðŸ’ðŸ’ðŸ’ðŸ’ðŸ’ðŸ˜ðŸ˜ðŸ˜ðŸ˜",
            "created_time_vn": "2025-10-12 10:58:27"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "Äáº§u tuan Ä‘áº§y lá»™c nhe cv",
            "created_time_vn": "2025-12-11 18:52:48"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "tháº£ tim ðŸ«°ðŸ«° cho ty",
            "created_time_vn": "2025-11-29 21:23:42"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ngon ngon nhe blem thiá»‡t nhoa",
            "created_time_vn": "2025-11-24 16:03:50"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "ðŸ“£ðŸ“£ðŸ“£ðŸ“£tt nhe ðŸ˜ðŸ˜ðŸ˜ðŸ˜",
            "created_time_vn": "2025-10-22 05:25:21"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "Ui lÃ  chÃ¨n blemmm wa ty oiðŸ˜‚",
            "created_time_vn": "2025-12-10 20:40:48"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "nhÃ¬n bÃ©n quÃ¡ cv uiii",
            "created_time_vn": "2025-12-04 14:05:32"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "tháº£ like tháº£ tim cho tinh yÃªu nÃ ",
            "created_time_vn": "2025-11-26 21:08:20"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "DUYá»†T nhe  so blem nhÃ¬n lÃ  ghiá»n tháº­t oh nheðŸ‘",
            "created_time_vn": "2025-12-04 12:45:49"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "tháº£ ngÃ n LIKEE cho be ui lun",
            "created_time_vn": "2025-11-23 19:33:27"
          },
          {
            "id": "100029099261636",
            "name": "Pháº¡m Huy",
            "text": "HÆ°á»›ng dáº«n cá»¥ thá»ƒ á»Ÿ Ä‘Ã¢y nhÃ© https://byvn.net/cimR",
            "created_time_vn": "2025-11-08 10:35:00"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "lung linh tháº¿ lÃ  cÃ¹ng ðŸ’‹BLEM",
            "created_time_vn": "2025-11-29 18:36:50"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "LÃ m sao Ä‘á»ƒ khÃ´ng lÃ m phiá»n khÃ¡ch nhá»‰?",
            "created_time_vn": "2025-11-23 20:45:01"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "tháº¥y lÃ  ban timðŸ«°ðŸ«°",
            "created_time_vn": "2025-11-24 17:31:53"
          },
          {
            "id": "100080685466820",
            "name": "Lan ÄÃ i TrÆ°Æ¡ng",
            "text": "xinn chÃ oo",
            "created_time_vn": "2025-10-03 23:28:24"
          },
          {
            "id": "100092250423609",
            "name": "Kem Xinhh",
            "text": "chÃºc chá»§ tus má»™t ngÃ y lá»™c lÃ¡ nhÃ©",
            "created_time_vn": "2025-10-06 09:42:09"
          },
          {
            "id": "100026873142348",
            "name": "Zency Nguyá»…n",
            "text": "CÃ¹ng nhau tÆ°Æ¡ng tÃ¡c nha",
            "created_time_vn": "2025-10-25 23:00:38"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "â€¢â€¢â€¢â€¢Duyá»‡t nhe so cÆ°ng",
            "created_time_vn": "2025-12-03 16:44:59"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "Äá»‰nh we nhe mÃªðŸ˜œblemm",
            "created_time_vn": "2025-11-29 14:23:59"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ˜xÄ©u máº¥t thÃ´i thÃ­ cÆ°ng lam blem^^",
            "created_time_vn": "2025-11-23 19:40:30"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ui uiiiiðŸ’šðŸ’š",
            "created_time_vn": "2025-11-27 12:59:56"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "KhÃ³ nháº¥t lÃ  lÃ m sao Ä‘á»ƒ há» nhá»› mÃ¬nh!",
            "created_time_vn": "2025-11-27 16:34:50"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "BÃ‰N nhe yÃªu ðŸ‘„ðŸ‘„",
            "created_time_vn": "2025-11-22 15:35:42"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "bÃ©n ngÃ³t z ta Æ¡i haðŸ˜µâ€ðŸ’«",
            "created_time_vn": "2025-11-22 17:32:59"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "Káº¿t ná»‘i tháº¿ nÃ o Ä‘á»ƒ khÃ´ng lÃ m phiá»n?",
            "created_time_vn": "2025-11-27 19:42:58"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "quÃ¡ trÃ i mÃª uiðŸ˜šðŸ˜š",
            "created_time_vn": "2025-11-29 14:33:20"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "chá»‹u chá»‹u 100 tim lun",
            "created_time_vn": "2025-12-10 10:03:22"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "cÆ°ng dá»¯ lam nh0a cv",
            "created_time_vn": "2025-12-07 21:17:33"
          },
          {
            "id": "100094148296219",
            "name": "TÃ¢m Thuy",
            "text": "Ná»™i dung 3",
            "created_time_vn": "2025-10-02 19:20:56"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "nhÃ¬n muá»‘n xÄ©u xiu ui nhoa",
            "created_time_vn": "2025-12-07 19:11:57"
          },
          {
            "id": "100035433741802",
            "name": "XÆ°á»Ÿng KhÃ´ CÃ¡ LÃ³c",
            "text": "bÃ¡n hÃ ng ngáº¡i chi tt, cÃ¹ng nhau tt nha",
            "created_time_vn": "2025-12-08 19:47:36"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "bÃ©n Ä‘..á»©t cÃ¡i tayy ðŸ¤¨ðŸ¤¨",
            "created_time_vn": "2025-11-29 20:06:13"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "cháº¯c tui chá»›t quÃ¡ahhhhhðŸ˜‚",
            "created_time_vn": "2025-11-22 19:03:20"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "sao nhÃ¬n Ä‘Ã£ quÃ¡ Ã  blemmm gÃª ðŸ’‹",
            "created_time_vn": "2025-12-08 10:10:54"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "iu quÃ¡aaaaaaa ah nhe",
            "created_time_vn": "2025-12-11 19:01:07"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "...siÃªu iuuuðŸ˜˜ðŸ˜˜",
            "created_time_vn": "2025-12-10 16:44:16"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ«°ðŸ«° 1000 tim lun",
            "created_time_vn": "2025-12-04 12:49:29"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "qe tÆ°oi lun ty oi \niiiiðŸ˜„ðŸ˜‰",
            "created_time_vn": "2025-11-26 15:16:07"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ’¯ðŸ§¡moaaðŸ§¡.ðŸ§¡",
            "created_time_vn": "2025-11-27 14:19:16"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "tháº¥y gÃ©t gi Ä‘Ã¢u oh chÃ¨n ui",
            "created_time_vn": "2025-11-30 14:53:41"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ˜˜iu chá»›t máº¥t thÃ´iiiiiðŸ¤¤ðŸ¤¤.",
            "created_time_vn": "2025-12-05 18:25:23"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "mÃª ko tÆ°á»Ÿng lun^^love uâ¤ï¸",
            "created_time_vn": "2025-12-08 18:02:26"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ˜ŠðŸ’œSO BLEM yÃªu ðŸ˜‰",
            "created_time_vn": "2025-12-01 21:21:00"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "âœ‚ï¸ cáº¯ t tim tðŸ’”",
            "created_time_vn": "2025-12-02 16:16:24"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "Giá»¯ káº¿t ná»‘i sao cho hiá»‡u quáº£ nháº¥t nhá»‰?",
            "created_time_vn": "2025-11-24 16:34:12"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "THÃNH Ä..á»˜C NHE ðŸ˜ŠnhÃ¬n mÃª lun oh trÃ i oiiiiiðŸ˜»ðŸ˜»ðŸ˜»",
            "created_time_vn": "2025-12-11 15:13:44"
          },
          {
            "id": "61567894921648",
            "name": "Heo Quay Giao Hiá»n",
            "text": "ChÃºc Google Ads luÃ´n khoáº» máº¡nh, bÃ¬nh an vÃ  gáº·p nhiá»u niá»m vui má»—i ngÃ y nha ðŸŒ¿ðŸ˜Š",
            "created_time_vn": "2025-11-02 13:10:20"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ¤Œ+ðŸ˜˜say Ä‘áº¯m lun TYyyyyðŸ˜šðŸ¤Ÿ",
            "created_time_vn": "2025-11-30 22:03:10"
          },
          {
            "id": "61577203947079",
            "name": "Thi Huong",
            "text": "hello b nha",
            "created_time_vn": "2025-10-14 12:45:36"
          },
          {
            "id": "100089212563525",
            "name": "Jeneth Higoy",
            "text": "Ráº¥t muá»‘n biáº¿t thÃªm vá» cÃ¡ch tá»‘i Æ°u hÃ³a quáº£ng cÃ¡o trÃªn YouTube! ðŸ¤”",
            "created_time_vn": "2025-10-10 16:37:33"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "MOAaaaaaaðŸ’‹â™¥ï¸ðŸ’‹",
            "created_time_vn": "2025-12-06 11:49:07"
          },
          {
            "id": "61574976895874",
            "name": "ThÃ nh\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNgá»t.",
            "text": "Há»c há»i Ä‘Æ°á»£c thÃªm ráº¥t nhiá»u Ä‘iá»u má»›i! ðŸ”¬",
            "created_time_vn": "2025-10-22 01:58:11"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "NGáº¦U gÃª  oiðŸ†˜",
            "created_time_vn": "2025-11-29 15:55:16"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "+++++timmmm ðŸ’•",
            "created_time_vn": "2025-12-08 15:31:14"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "â˜ºï¸yeu nhoaaaâ˜ºï¸ðŸ˜œ",
            "created_time_vn": "2025-11-30 12:12:52"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "Máº¥y tips nÃ o giá»¯ KH tiá»m nÄƒng hiá»‡u quáº£ nháº¥t váº­y?",
            "created_time_vn": "2025-11-27 12:56:47"
          },
          {
            "id": "100004667145783",
            "name": "LÃª Thi",
            "text": "Sáº£n pháº©m á»•n Ã¡p cá»±c ká»³ ðŸ’«",
            "created_time_vn": "2025-10-30 20:20:19"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "Quan trá»ng tháº­t, cÃ³ tips gÃ¬ hay ko mn?",
            "created_time_vn": "2025-11-24 21:29:22"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ‘uiðŸ¤ŒloveðŸ˜˜",
            "created_time_vn": "2025-12-13 09:23:59"
          },
          {
            "id": "61576216808616",
            "name": "LÃª Tá»‹nh DÆ°Æ¡ng",
            "text": "685. GÃ³i 2k = 1000 tim TikTok â¤ï¸ Zalo: 0353131260",
            "created_time_vn": "2025-11-17 21:39:50"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "bbÃ©n ngÃ³t z ta hiiii ðŸ˜Š",
            "created_time_vn": "2025-11-23 18:05:53"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "vá»¡ â£ï¸timmmmm lun rÃ¹i",
            "created_time_vn": "2025-12-03 15:21:10"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "Váº­y cÃ¡i nÃ o hiá»‡u quáº£ nháº¥t nhá»‰?",
            "created_time_vn": "2025-11-23 20:28:05"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "ðŸ“£ðŸ“£ chÃºc â¤ï¸â¤ï¸â¤ï¸ name  nhÃ©ðŸŒ»ðŸŒ»ðŸŒ»",
            "created_time_vn": "2025-10-08 14:38:35"
          },
          {
            "id": "100057258111443",
            "name": "Jennifer Äáº·ng",
            "text": "QuyÃªn Æ¡i, xinh Ä‘áº¹p tháº¿ nÃ y báº£o sao tim em cá»© láº¡c trÃ´i hoÃ i! ðŸ˜‰",
            "created_time_vn": "2025-10-05 13:16:12"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "+++loveðŸ¤Œ+++",
            "created_time_vn": "2025-12-02 12:41:22"
          },
          {
            "id": "100004667145783",
            "name": "LÃª Thi",
            "text": "Sáº£n pháº©m dÃ¹ng tháº¥y mÃª tháº­t ðŸ’«",
            "created_time_vn": "2025-10-25 19:15:32"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "Ä‘Ã£ quÃ¡ rui nhaaa",
            "created_time_vn": "2025-12-06 19:21:09"
          },
          {
            "id": "100003193478226",
            "name": "Nurul Alifah Abdullah",
            "text": "Instant Hand Sanitizer oh, fantastically ability ðŸ˜ðŸ‘ ðŸ˜Ž that moment when the meme is too real. ðŸ˜‚ðŸ˜šðŸ¤¡",
            "created_time_vn": "2025-11-28 18:17:03"
          },
          {
            "id": "61577171410963",
            "name": "Lum Tung",
            "text": "Ná»™i dung comment 1",
            "created_time_vn": "2025-10-02 12:56:58"
          },
          {
            "id": "61577171410963",
            "name": "Lum Tung",
            "text": "Ná»™i dung 3",
            "created_time_vn": "2025-10-02 12:56:40"
          },
          {
            "id": "100085106522012",
            "name": "Äá»— Quá»‘c BÃ¹i",
            "text": "Quáº£ng cÃ¡o livestream â€“ CÃ´ng cá»¥ bá»©t phÃ¡ doanh sá»‘\nBáº¡n tá»‘n tiá»n quáº£ng cÃ¡o nhÆ°ng livestream váº«n váº¯ng khÃ¡ch?\nTiá»n Háº£i Agency giÃºp shop tiáº¿p cáº­n Ä‘Ãºng khÃ¡ch hÃ ng, tÄƒng tÆ°Æ¡ng tÃ¡c vÃ  chá»‘t Ä‘Æ¡n hiá»‡u quáº£.\n\n- Cam káº¿t máº¯t xem tháº­t, tÃ i khoáº£n Agency á»•n Ä‘á»‹nh, khÃ´ng lo thá»‘c tiá»n.\n- Há»— trá»£ kÃ­ch page quáº£ng cÃ¡o livestream náº¿u cáº§n.\n- Má»—i ngÃ y Ä‘á»u cÃ³ bÃ¡o cÃ¡o chi tiáº¿t, giÃºp shop theo dÃµi sÃ¡t hiá»‡u quáº£ cháº¡y quáº£ng cÃ¡o.\nLiÃªn há»‡ ngay Ä‘á»ƒ Ä‘Æ°á»£c tÆ° váº¥n miá»…n phÃ­: 0888.848.655 (Zalo Mr Há»™i) / 0333.848.655.",
            "created_time_vn": "2025-12-02 10:56:26"
          },
          {
            "id": "100065085677680",
            "name": "Bui Thien",
            "text": "xinn chÃ oo",
            "created_time_vn": "2025-10-04 13:11:02"
          },
          {
            "id": "100011603650708",
            "name": "ThÆ¡ Nguyá»…n",
            "text": "ThoNguyenBeauty xin chÃ o â¤ï¸ TÆ°Æ¡ng tÃ¡c cÃ¹ng mÃ¬nh nha",
            "created_time_vn": "2025-10-23 15:20:27"
          },
          {
            "id": "100053090900253",
            "name": "Ben Nguyen",
            "text": "Quáº£ng cÃ¡o hay quÃ¡! ðŸ¤” TÃ¬m hiá»ƒu ngay thÃ´i!",
            "created_time_vn": "2025-11-10 13:38:19"
          },
          {
            "id": "100035170861322",
            "name": "à¸§à¸²'à¹€à¸¥à¸™ à¹„à¸—à¸™à¹Œ à¸¯.",
            "text": "Wow, that sounds incredibly helpful! Definitely need to look into this. Thanks for sharing!",
            "created_time_vn": "2025-10-29 21:19:31"
          },
          {
            "id": "100066302663939",
            "name": "Nguyá»…n KhÃ¡nh Linh",
            "text": "dÃ­ dá»m, hÃ i hÆ°á»›c",
            "created_time_vn": "2025-11-26 15:25:37"
          },
          {
            "id": "100085897737942",
            "name": "Son Tran The",
            "text": "ÄÃ¡p Ã¡n C + 782 + Sinh nháº­t KidsPlaza Háº£i PhÃ²ng + Long VÄƒn LÃª Thá»‹ QuyÃªn Háº±ng Pháº¡m",
            "created_time_vn": "2025-11-08 08:26:32"
          },
          {
            "id": "61573913737629",
            "name": "Huynh Tan Huy",
            "text": "ngÃ y má»›i vui váº» ðŸ˜‘ .B",
            "created_time_vn": "2025-10-29 08:32:19"
          },
          {
            "id": "100093881454095",
            "name": "LÃª Quang NhÃ¢n",
            "text": "ChÃºc báº¡n nÄƒm má»›i Ä‘á»§ tá»‘c Ä‘á»™ Ä‘á»ƒ cháº¡y thoÃ¡t khá»i má»i deadline (háº¡n chÃ³t), Ä‘á»§ sá»©c máº¡nh Ä‘á»ƒ cÃµng má»i gÃ¡nh náº·ng lo Ã¢u. TÃ³m láº¡i, pháº£i \"MÃ£ ÄÃ¡o ThÃ nh CÃ´ng\" nhÆ°ng nhá»› giá»¯ phanh HoÃ ng Trang Linh Háº£i Yáº¿n Tráº§n Ngá»c Háº£i Quá»³nh",
            "created_time_vn": "2025-12-05 11:12:29"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "Giá»¯ tÆ°Æ¡ng tÃ¡c mÃ  khÃ´ng spam má»›i khÃ³ chá»©.",
            "created_time_vn": "2025-11-21 08:15:42"
          },
          {
            "id": "100090184350702",
            "name": "Khanh Chi Van",
            "text": "ChÃºc báº¡n nÄƒm má»›i Ä‘á»§ tá»‘c Ä‘á»™ Ä‘á»ƒ cháº¡y thoÃ¡t khá»i má»i deadline (háº¡n chÃ³t), Ä‘á»§ sá»©c máº¡nh Ä‘á»ƒ cÃµng má»i gÃ¡nh náº·ng lo Ã¢u. TÃ³m láº¡i, pháº£i \"MÃ£ ÄÃ¡o ThÃ nh CÃ´ng\" nhÆ°ng nhá»› giá»¯ phanh Pura Arena Nguyá»…n Trung Hiáº¿u Mee Ben",
            "created_time_vn": "2025-12-05 09:22:38"
          },
          {
            "id": "61579381330268",
            "name": "Nguyá»…n PhÆ°Æ¡ng Tháº£o",
            "text": "QÃºa tuyá»‡t vá»i",
            "created_time_vn": "2025-12-10 13:47:39"
          },
          {
            "id": "100068789210183",
            "name": "BÃ­ch Loan Há»“",
            "text": "Rá»“i xong, AI mÃ  cÅ©ng Ä‘i bÃ¡n nÆ°á»›c giáº·t xáº£ lÃ  tui xin thua! ðŸ˜‚ MÃ  thÃ´i, cá»© Ä‘á»ƒ AI nÃ³ \"tri Ã¢n khÃ¡ch hÃ ng hiá»‡u thuá»‘c\" Ä‘i, mÃ¬nh cá»© táº­p trung \"phÃ¡t triá»ƒn kinh doanh\" Ä‘Ã£! ðŸ˜œ",
            "created_time_vn": "2025-10-03 18:49:42"
          },
          {
            "id": "61577758443660",
            "name": "Huy Anh",
            "text": "ÄÃ‚Y LÃ€ BÃ€I ÄÄ‚NG Tá»° Äá»˜NG\n\nBÃN ACC CLONE FACEBOOK - FULL 2FA - NGÃ‚M TRÃ‚U 8 THÃNG ðŸ”¥\nâœ… Há»— trá»£ spam tay + tool, báº£o hÃ nh acc die/ checkpoint trong 7 ngÃ y Ä‘áº§u 1 Ä‘á»•i 1\nâœ… CÃ¢n má»i giao dá»‹ch trung gian \nâœ… Full báº¡n bÃ¨, avt, áº£nh bÃ¬a - acc trÃ¢u chuyÃªn spam\nâœ… GiÃ¡ cá»±c ráº», nhÆ° giÃ¡ clone tráº¯ng\nâš ï¸ Anh em lÆ°u Ã½: Chá»n nguá»“n clone cá»±c ká»³ quan trá»ng - bÃªn em chá»‰ cung cáº¥p acc Ä‘Ã£ ngÃ¢m spam trÃªn 8 thÃ¡ng, chá»‹u spam tá»‘t - trÃ¡nh tÃ¬nh tráº¡ng mua acc trÃªn cÃ¡c web má»›i log 30p Ä‘Ã£ die, spam vÃ i cmt Ä‘Ã£ die/checkpoint. VÃ¬ cÃ¡c acc trÃªn web háº§u háº¿t lÃ  nÃ­ch má»›i hoáº·c má»›i chá»‰ ngÃ¢m vÃ i ngÃ y Ä‘áº¿n vÃ i tuáº§n cÃ²n ráº¥t yáº¿u\n\nðŸŽ¯ Acc bÃªn em cÃ³ gÃ¬?\nâ€¢ Full 2FA - qua spam trÃ¢u trÃªn 8 thÃ¡ng\nÄ‘Ã£ qua gá»¡ checkpoint nhiá»u láº§n\nâ€¢ Sáºµn báº¡n bÃ¨ \nâ€¢ Avt + áº£nh bÃ¬a - Ä‘á»™ trust cao\nâ€¢ Há»— trá»£ quy trÃ¬nh spam bÃªn em (Tool + trick spam sá»‘ng lÃ¢u)\nâ€¢ Cam káº¿t báº£o hÃ nh 7 ngÃ y - lá»—i Ä‘á»•i acc má»›i 1:1\n\nðŸ“© Inbox Fb ngay hoáº·c Z.A.L.O 0787076429  Ä‘á»ƒ test acc - dÃ¹ng thá»­ quy trÃ¬nh spam hiá»‡u quáº£!\nðŸ›¡ï¸ Uy tÃ­n táº¡o nÃªn thÆ°Æ¡ng hiá»‡u - bÃ¡n acc lÃ  pháº£i cÃ³ báº£o hÃ nh!",
            "created_time_vn": "2025-12-05 11:24:09"
          },
          {
            "id": "100072857650328",
            "name": "Hoa Anh Mai",
            "text": "ZALO TÃšI  https://zalo.me/g/inwvfs117\nZALO QUáº¦N ÃO QCCC https://zalo.me/g/nouukf919",
            "created_time_vn": "2025-10-02 12:10:58"
          },
          {
            "id": "61550882822847",
            "name": "Thá»‹ Lá»‡ QuyÃªn",
            "text": "ÄÃ¡p Ã¡n C + 420 + Sinh nháº­t KidsPlaza Háº£i PhÃ²ng + Nguyá»‡t Moon Tráº§n Kenny HoÃ i Nam",
            "created_time_vn": "2025-11-08 07:36:21"
          },
          {
            "id": "61577835693056",
            "name": "Linh Háº¡",
            "text": "ib....",
            "created_time_vn": "2025-11-25 15:46:04"
          },
          {
            "id": "100004837362784",
            "name": "ThÃ¡i HÃ²a",
            "text": "ZKV Luxury xá»‹n quÃ¡, sale 15%, má»i ngÆ°á»i báº¥m ngay: https://byvn.net/mUWE",
            "created_time_vn": "2025-10-02 18:50:28"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "NÃªn cháº¡y YouTube Ads khÃ´ng má»i ngÆ°á»i?",
            "created_time_vn": "2025-11-23 16:31:09"
          },
          {
            "id": "61550716772041",
            "name": "ThÃ¡i Báº£o VÃµ",
            "text": "Ibox giÃºp mÃ¬nh nhÃ©",
            "created_time_vn": "2025-10-02 10:39:15"
          },
          {
            "id": "100070020588557",
            "name": "Linh Quá»³nh",
            "text": "Ná»™i dung 2",
            "created_time_vn": "2025-10-18 05:53:49"
          },
          {
            "id": "100070399322134",
            "name": "Mai Tháº£o",
            "text": "má»›i Ä‘Æ°á»£c nháº­n bÃºt xinh láº¯m mÃ  má»±c Ä‘en",
            "created_time_vn": "2025-10-22 00:20:21"
          },
          {
            "id": "100080916420394",
            "name": "LÃª Thanh Diá»‡u Loan",
            "text": "Map du lá»‹ch cá»§a mÃ¬nh cáº§n review LOCAL cÃ³ HÃ¬nh áº£nh táº¡i nhiá»u thÃ nh phá»‘. Team lÃ m ráº¥t chuáº©n IP. Dá»‹ch vá»¥ cÃ²n bao gá»“m Phá»¥c há»“i Maps vÃ  Xá»­ lÃ½ 1 sao xáº¥u. DV tÄƒng review TOP 1 lÃ  Ä‘Ã¢y! Zalo: ðŸ¬ ðŸ¯ ðŸ´ ðŸ¯ ðŸ³ ðŸµ ðŸ° ðŸ° ðŸ° ðŸ°.",
            "created_time_vn": "2025-11-28 09:25:10"
          },
          {
            "id": "100094124551519",
            "name": "BÃ¹i Kim NgÃ¢n",
            "text": "TÆ°Æ¡ng tÃ¡c vui váº»",
            "created_time_vn": "2025-10-02 17:41:38"
          },
          {
            "id": "100070039696667",
            "name": "Hoa ÄoÃ n",
            "text": "má»›i Ä‘Æ°á»£c nháº­n bÃºt xinh láº¯m mÃ  má»±c Ä‘en",
            "created_time_vn": "2025-10-22 00:24:02"
          },
          {
            "id": "100069895732949",
            "name": "Äáº·ng Ngá»c",
            "text": "má»›i Ä‘Æ°á»£c nháº­n bÃºt xinh láº¯m mÃ  má»±c Ä‘en",
            "created_time_vn": "2025-10-21 22:11:10"
          },
          {
            "id": "100069850804586",
            "name": "TrÃ¢m PhÆ°Æ¡ng",
            "text": "má»›i Ä‘Æ°á»£c nháº­n bÃºt xinh láº¯m mÃ  má»±c Ä‘en",
            "created_time_vn": "2025-10-19 19:08:43"
          },
          {
            "id": "100083201255228",
            "name": "Anh Mai",
            "text": "Hi2Chá»‹ Æ¡i, em Quá»³nh cÃ³ máº«u xinh láº¯m, ná»™i Ä‘á»‹a hÃ ng chuáº©n,chá»‹ xem thá»­ nha GÃ³c Táº¡p HoÃ¡ NhÃ  BÆ  ðŸ¥‘ð–«ð–ºð—‡ð—€ ð–³ð—ð–ºð—‡ð—€ ð–³ð—‹ð—Žð—‡ð—€ ð–°ð—Žá»‘ð–¼ Nháº·t HÃ ng ( Sale - Hot Trend )ðŸ¥‘",
            "created_time_vn": "2025-10-04 12:02:51"
          },
          {
            "id": "100065085677680",
            "name": "Bui Thien",
            "text": "good",
            "created_time_vn": "2025-10-03 14:57:35"
          },
          {
            "id": "100054700774785",
            "name": "Nguyá»…n Tuáº¥n",
            "text": "Hay Ä‘Ã³ báº¡n Æ¡i! CÃ²n ná»n táº£ng nÃ o khÃ¡c ná»¯a khÃ´ng áº¡? ðŸ¤”",
            "created_time_vn": "2025-10-05 09:21:23"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "YouTube Ads cÃ³ hiá»‡u quáº£ hÆ¡n ná»n táº£ng khÃ¡c khÃ´ng nhá»‰?",
            "created_time_vn": "2025-11-23 15:08:17"
          },
          {
            "id": "100093067592511",
            "name": "HoÃ ng Ngáº¡n Minh",
            "text": "NÄƒm má»›i chÃºc báº¡n luÃ´n cÃ³ MÃ£nh Lá»±c tÃ i chÃ­nh, MÃ£ Lá»±c tÃ¬nh yÃªu. Tiá»n vÃ o nhÆ° suá»‘i, tiÃªu xÃ i khÃ´ng cáº§n Ä‘áº¯n Ä‘o, vÃ  nhá»› Ä‘á»«ng bao giá» \"cÆ°á»¡i ngá»±a xem hoa\" vá»›i cÃ¡c cÆ¡ há»™i tá»‘t KHÃ”NG TÃŠN LÃª Phi Long PhÃ¡o Hoa Má»¹ Äá»©c",
            "created_time_vn": "2025-12-06 09:39:17"
          },
          {
            "id": "61576232606008",
            "name": "Tiphany Ruri",
            "text": "ÄÃ‚Y LÃ€ BÃ€I ÄÄ‚NG Tá»° Äá»˜NG\n\nBÃN ACC CLONE FACEBOOK - FULL 2FA - NGÃ‚M TRÃ‚U 8 THÃNG ðŸ”¥\nâœ… Há»— trá»£ spam tay + tool, báº£o hÃ nh acc die/ checkpoint trong 7 ngÃ y Ä‘áº§u 1 Ä‘á»•i 1\nâœ… CÃ¢n má»i giao dá»‹ch trung gian \nâœ… Full báº¡n bÃ¨, avt, áº£nh bÃ¬a - acc trÃ¢u chuyÃªn spam\nâœ… GiÃ¡ cá»±c ráº», nhÆ° giÃ¡ clone tráº¯ng\nâš ï¸ Anh em lÆ°u Ã½: Chá»n nguá»“n clone cá»±c ká»³ quan trá»ng - bÃªn em chá»‰ cung cáº¥p acc Ä‘Ã£ ngÃ¢m spam trÃªn 8 thÃ¡ng, chá»‹u spam tá»‘t - trÃ¡nh tÃ¬nh tráº¡ng mua acc trÃªn cÃ¡c web má»›i log 30p Ä‘Ã£ die, spam vÃ i cmt Ä‘Ã£ die/checkpoint. VÃ¬ cÃ¡c acc trÃªn web háº§u háº¿t lÃ  nÃ­ch má»›i hoáº·c má»›i chá»‰ ngÃ¢m vÃ i ngÃ y Ä‘áº¿n vÃ i tuáº§n cÃ²n ráº¥t yáº¿u\n\nðŸŽ¯ Acc bÃªn em cÃ³ gÃ¬?\nâ€¢ Full 2FA - qua spam trÃ¢u trÃªn 8 thÃ¡ng\nÄ‘Ã£ qua gá»¡ checkpoint nhiá»u láº§n\nâ€¢ Sáºµn báº¡n bÃ¨ \nâ€¢ Avt + áº£nh bÃ¬a - Ä‘á»™ trust cao\nâ€¢ Há»— trá»£ quy trÃ¬nh spam bÃªn em (Tool + trick spam sá»‘ng lÃ¢u)\nâ€¢ Cam káº¿t báº£o hÃ nh 7 ngÃ y - lá»—i Ä‘á»•i acc má»›i 1:1\n\nðŸ“© Inbox Fb ngay hoáº·c Z.A.L.O 0787076429  Ä‘á»ƒ test acc - dÃ¹ng thá»­ quy trÃ¬nh spam hiá»‡u quáº£!\nðŸ›¡ï¸ Uy tÃ­n táº¡o nÃªn thÆ°Æ¡ng hiá»‡u - bÃ¡n acc lÃ  pháº£i cÃ³ báº£o hÃ nh!",
            "created_time_vn": "2025-12-04 11:56:07"
          },
          {
            "id": "61564179112005",
            "name": "TÃ´ TrÆ°á»ng",
            "text": "ChÃºc báº¡n nÄƒm nay cÃ³ sá»©c khá»e khá»e nhÆ° ngá»±a, tinh tháº§n sung mÃ£n nhÆ° chiáº¿n mÃ£, nhÆ°ng nhá»› giá»¯ má»“m giá»¯ miá»‡ng, Ä‘á»«ng \"nÃ³i nhÆ° ngá»±a hÃ­\" nhÃ© Tráº§n TÃ i LÃª HÆ°ng MÃ¡y In Nguyá»…n DÆ°Æ¡ng",
            "created_time_vn": "2025-12-05 10:52:55"
          },
          {
            "id": "100071371495160",
            "name": "Bablu Shah",
            "text": "Really nice",
            "created_time_vn": "2025-10-01 22:02:35"
          },
          {
            "id": "61578697734762",
            "name": "Goda Harmony",
            "text": "ÄÃ‚Y LÃ€ BÃ€I ÄÄ‚NG Tá»° Äá»˜NG\n\nBÃN ACC CLONE FACEBOOK - FULL 2FA - NGÃ‚M TRÃ‚U 8 THÃNG ðŸ”¥\nâœ… Há»— trá»£ spam tay + tool, báº£o hÃ nh acc die/ checkpoint trong 7 ngÃ y Ä‘áº§u 1 Ä‘á»•i 1\nâœ… CÃ¢n má»i giao dá»‹ch trung gian \nâœ… Full báº¡n bÃ¨, avt, áº£nh bÃ¬a - acc trÃ¢u chuyÃªn spam\nâœ… GiÃ¡ cá»±c ráº», nhÆ° giÃ¡ clone tráº¯ng\nâš ï¸ Anh em lÆ°u Ã½: Chá»n nguá»“n clone cá»±c ká»³ quan trá»ng - bÃªn em chá»‰ cung cáº¥p acc Ä‘Ã£ ngÃ¢m spam trÃªn 8 thÃ¡ng, chá»‹u spam tá»‘t - trÃ¡nh tÃ¬nh tráº¡ng mua acc trÃªn cÃ¡c web má»›i log 30p Ä‘Ã£ die, spam vÃ i cmt Ä‘Ã£ die/checkpoint. VÃ¬ cÃ¡c acc trÃªn web háº§u háº¿t lÃ  nÃ­ch má»›i hoáº·c má»›i chá»‰ ngÃ¢m vÃ i ngÃ y Ä‘áº¿n vÃ i tuáº§n cÃ²n ráº¥t yáº¿u\n\nðŸŽ¯ Acc bÃªn em cÃ³ gÃ¬?\nâ€¢ Full 2FA - qua spam trÃ¢u trÃªn 8 thÃ¡ng\nÄ‘Ã£ qua gá»¡ checkpoint nhiá»u láº§n\nâ€¢ Sáºµn báº¡n bÃ¨ \nâ€¢ Avt + áº£nh bÃ¬a - Ä‘á»™ trust cao\nâ€¢ Há»— trá»£ quy trÃ¬nh spam bÃªn em (Tool + trick spam sá»‘ng lÃ¢u)\nâ€¢ Cam káº¿t báº£o hÃ nh 7 ngÃ y - lá»—i Ä‘á»•i acc má»›i 1:1\n\nðŸ“© Inbox Fb ngay hoáº·c Z.A.L.O 0787076429  Ä‘á»ƒ test acc - dÃ¹ng thá»­ quy trÃ¬nh spam hiá»‡u quáº£!\nðŸ›¡ï¸ Uy tÃ­n táº¡o nÃªn thÆ°Æ¡ng hiá»‡u - bÃ¡n acc lÃ  pháº£i cÃ³ báº£o hÃ nh!",
            "created_time_vn": "2025-12-05 17:48:12"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "CÃ³ máº¹o gÃ¬ Ä‘á»ƒ tá»‘i Æ°u YouTube Ads Ä‘a ná»n táº£ng?",
            "created_time_vn": "2025-11-23 17:15:52"
          },
          {
            "id": "100071210919331",
            "name": "Dangvu Hoanganh",
            "text": "https://forms.gle/3EvtTk6VzAbppzq88",
            "created_time_vn": "2025-11-07 22:16:06"
          },
          {
            "id": "100063644996673",
            "name": "Nguyá»…n Huyá»n",
            "text": "má»›i Ä‘Æ°á»£c nháº­n bÃºt xinh láº¯m mÃ  má»±c Ä‘en",
            "created_time_vn": "2025-10-21 21:19:30"
          },
          {
            "id": "100072377756389",
            "name": "Phan ThÃ¡i Má»¹ Thanh",
            "text": "",
            "created_time_vn": "2025-10-25 16:01:37"
          },
          {
            "id": "61574315413246",
            "name": "BÃ¹i Tuáº¥n Kiá»‡t",
            "text": "ÄÃ‚Y LÃ€ BÃ€I ÄÄ‚NG Tá»° Äá»˜NG\n\nBÃN ACC CLONE FACEBOOK - FULL 2FA - NGÃ‚M TRÃ‚U 8 THÃNG ðŸ”¥\nâœ… Há»— trá»£ spam tay + tool, báº£o hÃ nh acc die/ checkpoint trong 7 ngÃ y Ä‘áº§u 1 Ä‘á»•i 1\nâœ… CÃ¢n má»i giao dá»‹ch trung gian \nâœ… Full báº¡n bÃ¨, avt, áº£nh bÃ¬a - acc trÃ¢u chuyÃªn spam\nâœ… GiÃ¡ cá»±c ráº», nhÆ° giÃ¡ clone tráº¯ng\nâš ï¸ Anh em lÆ°u Ã½: Chá»n nguá»“n clone cá»±c ká»³ quan trá»ng - bÃªn em chá»‰ cung cáº¥p acc Ä‘Ã£ ngÃ¢m spam trÃªn 8 thÃ¡ng, chá»‹u spam tá»‘t - trÃ¡nh tÃ¬nh tráº¡ng mua acc trÃªn cÃ¡c web má»›i log 30p Ä‘Ã£ die, spam vÃ i cmt Ä‘Ã£ die/checkpoint. VÃ¬ cÃ¡c acc trÃªn web háº§u háº¿t lÃ  nÃ­ch má»›i hoáº·c má»›i chá»‰ ngÃ¢m vÃ i ngÃ y Ä‘áº¿n vÃ i tuáº§n cÃ²n ráº¥t yáº¿u\n\nðŸŽ¯ Acc bÃªn em cÃ³ gÃ¬?\nâ€¢ Full 2FA - qua spam trÃ¢u trÃªn 8 thÃ¡ng\nÄ‘Ã£ qua gá»¡ checkpoint nhiá»u láº§n\nâ€¢ Sáºµn báº¡n bÃ¨ \nâ€¢ Avt + áº£nh bÃ¬a - Ä‘á»™ trust cao\nâ€¢ Há»— trá»£ quy trÃ¬nh spam bÃªn em (Tool + trick spam sá»‘ng lÃ¢u)\nâ€¢ Cam káº¿t báº£o hÃ nh 7 ngÃ y - lá»—i Ä‘á»•i acc má»›i 1:1\n\nðŸ“© Inbox Fb ngay hoáº·c Z.A.L.O 0787076429  Ä‘á»ƒ test acc - dÃ¹ng thá»­ quy trÃ¬nh spam hiá»‡u quáº£!\nðŸ›¡ï¸ Uy tÃ­n táº¡o nÃªn thÆ°Æ¡ng hiá»‡u - bÃ¡n acc lÃ  pháº£i cÃ³ báº£o hÃ nh!",
            "created_time_vn": "2025-11-29 11:58:44"
          },
          {
            "id": "100059626030069",
            "name": "Nguyá»…n YÃªn",
            "text": "",
            "created_time_vn": "2025-10-27 16:26:40"
          },
          {
            "id": "100069212790260",
            "name": "Nguyá»…n ThÃ nh Nam",
            "text": "",
            "created_time_vn": "2025-10-24 11:12:00"
          },
          {
            "id": "100068965561825",
            "name": "Kada Mati-à¦•à¦¾à¦¦à¦¾à¦®à¦¾à¦Ÿà¦¿",
            "text": "ðŸ˜»ðŸ‘  ðŸ˜ðŸ˜§",
            "created_time_vn": "2025-11-21 03:46:55"
          },
          {
            "id": "100029595614516",
            "name": "Má»™c CÃ¡t",
            "text": "",
            "created_time_vn": "2025-10-17 15:49:27"
          },
          {
            "id": "61578653246351",
            "name": "Phan TÆ°á»ng VÃ¢n",
            "text": "ÄÃ‚Y LÃ€ BÃ€I ÄÄ‚NG Tá»° Äá»˜NG\n\nBÃN ACC CLONE FACEBOOK - FULL 2FA - NGÃ‚M TRÃ‚U 8 THÃNG ðŸ”¥\nâœ… Há»— trá»£ spam tay + tool, báº£o hÃ nh acc die/ checkpoint trong 7 ngÃ y Ä‘áº§u 1 Ä‘á»•i 1\nâœ… CÃ¢n má»i giao dá»‹ch trung gian \nâœ… Full báº¡n bÃ¨, avt, áº£nh bÃ¬a - acc trÃ¢u chuyÃªn spam\nâœ… GiÃ¡ cá»±c ráº», nhÆ° giÃ¡ clone tráº¯ng\nâš ï¸ Anh em lÆ°u Ã½: Chá»n nguá»“n clone cá»±c ká»³ quan trá»ng - bÃªn em chá»‰ cung cáº¥p acc Ä‘Ã£ ngÃ¢m spam trÃªn 8 thÃ¡ng, chá»‹u spam tá»‘t - trÃ¡nh tÃ¬nh tráº¡ng mua acc trÃªn cÃ¡c web má»›i log 30p Ä‘Ã£ die, spam vÃ i cmt Ä‘Ã£ die/checkpoint. VÃ¬ cÃ¡c acc trÃªn web háº§u háº¿t lÃ  nÃ­ch má»›i hoáº·c má»›i chá»‰ ngÃ¢m vÃ i ngÃ y Ä‘áº¿n vÃ i tuáº§n cÃ²n ráº¥t yáº¿u\n\nðŸŽ¯ Acc bÃªn em cÃ³ gÃ¬?\nâ€¢ Full 2FA - qua spam trÃ¢u trÃªn 8 thÃ¡ng\nÄ‘Ã£ qua gá»¡ checkpoint nhiá»u láº§n\nâ€¢ Sáºµn báº¡n bÃ¨ \nâ€¢ Avt + áº£nh bÃ¬a - Ä‘á»™ trust cao\nâ€¢ Há»— trá»£ quy trÃ¬nh spam bÃªn em (Tool + trick spam sá»‘ng lÃ¢u)\nâ€¢ Cam káº¿t báº£o hÃ nh 7 ngÃ y - lá»—i Ä‘á»•i acc má»›i 1:1\n\nðŸ“© Inbox Fb ngay hoáº·c Z.A.L.O 0787076429  Ä‘á»ƒ test acc - dÃ¹ng thá»­ quy trÃ¬nh spam hiá»‡u quáº£!\nðŸ›¡ï¸ Uy tÃ­n táº¡o nÃªn thÆ°Æ¡ng hiá»‡u - bÃ¡n acc lÃ  pháº£i cÃ³ báº£o hÃ nh!",
            "created_time_vn": "2025-11-29 12:46:22"
          },
          {
            "id": "100019035406502",
            "name": "Nháº¥n MÃ­ VÄ©nh Long",
            "text": "<3 <3 <3",
            "created_time_vn": "2025-11-06 12:50:54"
          },
          {
            "id": "61574649492788",
            "name": "Takeshi Konya",
            "text": "ÄÃ‚Y LÃ€ BÃ€I ÄÄ‚NG Tá»° Äá»˜NG\n\nBÃN ACC CLONE FACEBOOK - FULL 2FA - NGÃ‚M TRÃ‚U 8 THÃNG ðŸ”¥\nâœ… Há»— trá»£ spam tay + tool, báº£o hÃ nh acc die/ checkpoint trong 7 ngÃ y Ä‘áº§u 1 Ä‘á»•i 1\nâœ… CÃ¢n má»i giao dá»‹ch trung gian \nâœ… Full báº¡n bÃ¨, avt, áº£nh bÃ¬a - acc trÃ¢u chuyÃªn spam\nâœ… GiÃ¡ cá»±c ráº», nhÆ° giÃ¡ clone tráº¯ng\nâš ï¸ Anh em lÆ°u Ã½: Chá»n nguá»“n clone cá»±c ká»³ quan trá»ng - bÃªn em chá»‰ cung cáº¥p acc Ä‘Ã£ ngÃ¢m spam trÃªn 8 thÃ¡ng, chá»‹u spam tá»‘t - trÃ¡nh tÃ¬nh tráº¡ng mua acc trÃªn cÃ¡c web má»›i log 30p Ä‘Ã£ die, spam vÃ i cmt Ä‘Ã£ die/checkpoint. VÃ¬ cÃ¡c acc trÃªn web háº§u háº¿t lÃ  nÃ­ch má»›i hoáº·c má»›i chá»‰ ngÃ¢m vÃ i ngÃ y Ä‘áº¿n vÃ i tuáº§n cÃ²n ráº¥t yáº¿u\n\nðŸŽ¯ Acc bÃªn em cÃ³ gÃ¬?\nâ€¢ Full 2FA - qua spam trÃ¢u trÃªn 8 thÃ¡ng\nÄ‘Ã£ qua gá»¡ checkpoint nhiá»u láº§n\nâ€¢ Sáºµn báº¡n bÃ¨ \nâ€¢ Avt + áº£nh bÃ¬a - Ä‘á»™ trust cao\nâ€¢ Há»— trá»£ quy trÃ¬nh spam bÃªn em (Tool + trick spam sá»‘ng lÃ¢u)\nâ€¢ Cam káº¿t báº£o hÃ nh 7 ngÃ y - lá»—i Ä‘á»•i acc má»›i 1:1\n\nðŸ“© Inbox Fb ngay hoáº·c Z.A.L.O 0787076429  Ä‘á»ƒ test acc - dÃ¹ng thá»­ quy trÃ¬nh spam hiá»‡u quáº£!\nðŸ›¡ï¸ Uy tÃ­n táº¡o nÃªn thÆ°Æ¡ng hiá»‡u - bÃ¡n acc lÃ  pháº£i cÃ³ báº£o hÃ nh!",
            "created_time_vn": "2025-12-03 10:35:11"
          },
          {
            "id": "100000337479326",
            "name": "Jonly Nguyá»…n",
            "text": "",
            "created_time_vn": "2025-12-04 16:22:51"
          },
          {
            "id": "100040820550946",
            "name": "Nguyá»…n Gia Báº£o",
            "text": "â¤ï¸",
            "created_time_vn": "2025-10-23 18:21:00"
          },
          {
            "id": "100030531736828",
            "name": "Xe MÃ¡y Báº£o Vy",
            "text": "",
            "created_time_vn": "2025-11-06 16:28:46"
          },
          {
            "id": "100005615563103",
            "name": "TÃº TÃº",
            "text": "ðŸ–¤",
            "created_time_vn": "2025-10-25 09:40:37"
          },
          {
            "id": "100006815075990",
            "name": "Diem Chau",
            "text": "",
            "created_time_vn": "2025-10-29 13:01:44"
          },
          {
            "id": "61574110607256",
            "name": "Gabriel Shop ACE",
            "text": "<3",
            "created_time_vn": "2025-11-28 15:25:37"
          },
          {
            "id": "100003163276094",
            "name": "LÃª NhÆ° TrÃºc",
            "text": "ðŸ’—ðŸ’—ðŸ’—",
            "created_time_vn": "2025-10-10 19:59:53"
          },
          {
            "id": "61553137958836",
            "name": "Äá»“ng TÃ¢m",
            "text": "",
            "created_time_vn": "2025-10-29 14:38:45"
          },
          {
            "id": "100095448218689",
            "name": "UyÃªn Thá»‹",
            "text": "",
            "created_time_vn": "2025-10-26 19:05:58"
          },
          {
            "id": "100008087553689",
            "name": "Vang Hoa Hong",
            "text": "â¤ï¸",
            "created_time_vn": "2025-10-28 19:35:04"
          },
          {
            "id": "61558225924451",
            "name": "H.Ká»³ HÃ¢n",
            "text": "ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸",
            "created_time_vn": "2025-11-10 08:02:45"
          },
          {
            "id": "100087275617731",
            "name": "XÄƒm Phun NgÃ¢n CaLee",
            "text": "<3 <3 <3",
            "created_time_vn": "2025-11-04 17:11:05"
          },
          {
            "id": "61558225924451",
            "name": "H.Ká»³ HÃ¢n",
            "text": "ðŸŒ¹ðŸŒ¹ðŸŒ¹ðŸŒ¹ðŸŒ¹ðŸŒ¹",
            "created_time_vn": "2025-10-12 09:55:59"
          },
          {
            "id": "61558225924451",
            "name": "H.Ká»³ HÃ¢n",
            "text": "ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸ðŸŒ¸",
            "created_time_vn": "2025-10-11 09:35:17"
          },
          {
            "id": "100010146123696",
            "name": "Há»“ng Pháº¡m",
            "text": "LÃ m sao káº¿t ná»‘i khÃ¡ch tiá»m nÄƒng hiá»‡u quáº£?",
            "created_time_vn": "2025-11-27 19:25:49"
          },
          {
            "id": "100088444084365",
            "name": "VÃµ Quang Báº£o",
            "text": "ðŸŒ±",
            "created_time_vn": "2025-10-03 12:57:58"
          },
          {
            "id": "100072487330925",
            "name": "Dinh Dieu My",
            "text": "",
            "created_time_vn": "2025-10-27 13:19:29"
          },
          {
            "id": "100024555773581",
            "name": "Tráº¡i Chim Miá»n Báº¯c",
            "text": "",
            "created_time_vn": "2025-10-18 12:36:55"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": ">>>>ðŸ˜˜....",
            "created_time_vn": "2025-12-04 20:23:17"
          },
          {
            "id": "100007257905909",
            "name": "PhÃº HoÃ ng Thá»‹",
            "text": "",
            "created_time_vn": "2025-10-04 22:42:03"
          },
          {
            "id": "100004009415173",
            "name": "NgÃ¢n CaLee",
            "text": "<3 <3 <3",
            "created_time_vn": "2025-10-27 11:10:34"
          },
          {
            "id": "100064186325870",
            "name": "Bs DÆ°Æ¡ng VÄƒn QuÃ¢n - Viá»‡n Ung BÆ°á»›u Tuyáº¿n GiÃ¡p",
            "text": "ðŸ¤©",
            "created_time_vn": "2025-11-06 15:34:06"
          },
          {
            "id": "100013487506335",
            "name": "Nguyá»…n Thá»‹ Tuyáº¿t",
            "text": "ðŸ’–",
            "created_time_vn": "2025-10-09 20:41:06"
          },
          {
            "id": "100002466069570",
            "name": "Nguyá»…n Trang",
            "text": "",
            "created_time_vn": "2025-10-29 17:14:41"
          },
          {
            "id": "100010083885119",
            "name": "HoÃ  Ruby Vua NÃ¡m",
            "text": "",
            "created_time_vn": "2025-10-31 17:58:45"
          },
          {
            "id": "100073167124572",
            "name": "Nguyá»‡t Minh Loan",
            "text": "",
            "created_time_vn": "2025-10-18 09:14:28"
          },
          {
            "id": "100004876143227",
            "name": "Nguyá»…n VÃ¢n Anh",
            "text": "ðŸ€ðŸ€ðŸ€",
            "created_time_vn": "2025-10-26 17:53:10"
          },
          {
            "id": "100035542175597",
            "name": "Nguyá»…n Há»“ng",
            "text": "â˜˜",
            "created_time_vn": "2025-11-07 07:29:33"
          },
          {
            "id": "100027348696807",
            "name": "LÃª Anh",
            "text": "â¤ï¸",
            "created_time_vn": "2025-10-26 07:25:13"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "â¤ï¸ðŸ’¥ðŸ’¥ðŸ’¥â¤ï¸â¤ï¸â¤ï¸ðŸ’¥ðŸ’¥ðŸ’¥â¤ï¸ðŸ’“ðŸ’“ðŸ’“â¤ï¸â¤ï¸ðŸ’¥ðŸ¤ðŸ¤â¤ï¸â¤ï¸â¤ï¸",
            "created_time_vn": "2025-11-03 15:24:23"
          },
          {
            "id": "100087054717049",
            "name": "Na PhÆ°á»£ng Háº­u",
            "text": "ðŸ’–ðŸ’– \n10:56:25 - 17/10/2025",
            "created_time_vn": "2025-10-17 10:56:26"
          },
          {
            "id": "100028449421951",
            "name": "Lan Anh",
            "text": ".",
            "created_time_vn": "2025-10-29 12:01:40"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "...ðŸ’‹...",
            "created_time_vn": "2025-11-18 12:47:28"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "â£ï¸__ðŸ’›_â£ï¸^^",
            "created_time_vn": "2025-11-18 16:30:49"
          },
          {
            "id": "100019074513407",
            "name": "Trang SÄ© XilÃ­t",
            "text": "ðŸ§¡",
            "created_time_vn": "2025-10-07 18:25:42"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "ðŸ’ ðŸ˜ðŸ˜",
            "created_time_vn": "2025-10-09 13:52:41"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "â¤ï¸â¤ï¸â¤ï¸â¤ï¸",
            "created_time_vn": "2025-10-17 13:30:27"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "ðŸŒ·ðŸ“£ðŸ“£ðŸ“£ðŸŒ·ðŸŒ·â¤ï¸",
            "created_time_vn": "2025-10-15 12:42:28"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "â¤ï¸â¤ï¸ðŸŒ·ðŸŒ·",
            "created_time_vn": "2025-10-10 13:03:15"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "ðŸŒ´ðŸŒ´ðŸŒ±ðŸŒ±ðŸŒŸ",
            "created_time_vn": "2025-10-09 07:31:50"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "ðŸ¥‡ðŸ¥‡ðŸ’¯ðŸ’¯",
            "created_time_vn": "2025-10-17 13:30:02"
          },
          {
            "id": "61558225924451",
            "name": "H.Ká»³ HÃ¢n",
            "text": "ðŸŒ·ðŸŒ·ðŸŒ·ðŸŒ·ðŸŒ·",
            "created_time_vn": "2025-10-04 08:43:14"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "â€¼ï¸---ðŸ’œ--â€¼ï¸",
            "created_time_vn": "2025-11-24 13:09:08"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": ".ðŸ˜œðŸ˜œ+ðŸ˜‰",
            "created_time_vn": "2025-11-27 09:31:18"
          },
          {
            "id": "100026047372699",
            "name": "Äá»— NgÃ¢n",
            "text": "<3",
            "created_time_vn": "2025-12-01 17:52:17"
          },
          {
            "id": "61562031986635",
            "name": "TÃ´ Gia Huáº¥n",
            "text": "ðŸ˜Š",
            "created_time_vn": "2025-10-13 13:35:04"
          },
          {
            "id": "100006681911817",
            "name": "Linh Pháº¡m HoÃ i",
            "text": "ðŸ™Š",
            "created_time_vn": "2025-10-07 15:52:47"
          },
          {
            "id": "100006251196602",
            "name": "Nguyá»…n Thá»‹ Nam",
            "text": "ðŸ’ðŸ’ðŸ’",
            "created_time_vn": "2025-10-08 14:28:20"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "'''...<ðŸ’™",
            "created_time_vn": "2025-12-10 19:23:25"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ˜Šâ€¢â€¢â€¢â€¢â€¢â£ï¸",
            "created_time_vn": "2025-11-24 10:19:17"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ‘+ðŸ¤Œ+ðŸ˜˜",
            "created_time_vn": "2025-11-30 13:05:07"
          },
          {
            "id": "100004299451261",
            "name": "Tráº§n Thá»‹ Ngá»c Diá»‡u",
            "text": "ðŸ‘Œ",
            "created_time_vn": "2025-10-07 09:46:29"
          },
          {
            "id": "100010291742375",
            "name": "Candy Trinh",
            "text": "",
            "created_time_vn": "2025-10-25 07:25:12"
          },
          {
            "id": "100073112582996",
            "name": "PhÆ°Æ¡ng Trinh TiÃªn",
            "text": "",
            "created_time_vn": "2025-10-17 09:40:47"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ‘„ðŸ‘„ðŸ‘„",
            "created_time_vn": "2025-11-24 10:22:09"
          },
          {
            "id": "100003788861496",
            "name": "TrÃ¢m Po Huá»³nh",
            "text": "â¤ï¸",
            "created_time_vn": "2025-12-02 09:59:38"
          },
          {
            "id": "100065085677680",
            "name": "Bui Thien",
            "text": "ðŸ¥°ðŸ¥°",
            "created_time_vn": "2025-10-05 08:14:45"
          },
          {
            "id": "100089954899142",
            "name": "Kiá»u Linh",
            "text": "ðŸ¥°ðŸ¥°",
            "created_time_vn": "2025-10-03 15:04:03"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸŒ¸^^",
            "created_time_vn": "2025-12-10 13:00:36"
          },
          {
            "id": "100003659478400",
            "name": "HoÃ ng Thá»‹ Thu HoÃ i",
            "text": "â¤ï¸â¤ï¸â¤ï¸",
            "created_time_vn": "2025-12-11 10:34:32"
          },
          {
            "id": "100093036590635",
            "name": "Lá»“ng Äáº¹p Báº£o QuÃ¢n",
            "text": "<3 <3",
            "created_time_vn": "2025-10-14 15:00:55"
          },
          {
            "id": "100014035036544",
            "name": "NgÆ° Äáº­u Äáº­u",
            "text": "",
            "created_time_vn": "2025-10-05 17:03:09"
          },
          {
            "id": "100076047635226",
            "name": "Cáº§m Äá»“ Nguyá»…n GiaTrÃ­",
            "text": "Nháº­n cáº§m cá»‘ táº¥t cáº£ cÃ¡c loáº¡i tÃ i sáº£n:Laptop, Ä‘iá»‡n thoáº¡i, ipad ,xe mÃ¡y, oto,Ä‘á»“ hiá»‡u..... giÃ¡ cao.\nÄá»‹a chá»‰: Cáº¦M Äá»’ VIETMONEY 186 Nguyá»…n Gia TrÃ­ P25 Q.BÃ¬nh Tháº¡nh TPHCM\nHotline: 19008009",
            "created_time_vn": "2025-10-06 11:07:25"
          },
          {
            "id": "100006251196602",
            "name": "Nguyá»…n Thá»‹ Nam",
            "text": "ðŸŒ·ðŸ“£ðŸ“£ðŸ“£ðŸŒ·ðŸŒ·â¤ï¸â¤ï¸â¤ï¸ðŸŒ·ðŸŒ·ðŸ’¥ðŸ’¥ðŸ’¥ðŸŒ·ðŸŒ·",
            "created_time_vn": "2025-10-09 07:30:19"
          },
          {
            "id": "100006251196602",
            "name": "Nguyá»…n Thá»‹ Nam",
            "text": "â¤ï¸â¤ï¸ðŸŒ·ðŸŒ·",
            "created_time_vn": "2025-10-09 14:57:15"
          },
          {
            "id": "100006251196602",
            "name": "Nguyá»…n Thá»‹ Nam",
            "text": "ðŸ’ðŸ’ðŸ’¯ðŸ’¯ðŸ’¯",
            "created_time_vn": "2025-10-07 07:44:36"
          },
          {
            "id": "100088074794820",
            "name": "ThÃ¡i Hiá»n",
            "text": ":)",
            "created_time_vn": "2025-10-21 21:18:50"
          },
          {
            "id": "61553969805309",
            "name": "Thanh HiÃªu QuÃ¡ch",
            "text": "@goodluck386",
            "created_time_vn": "2025-11-29 21:44:50"
          },
          {
            "id": "100057805115156",
            "name": "Ngá»c Thanh",
            "text": "ðŸŒª",
            "created_time_vn": "2025-10-03 14:40:45"
          },
          {
            "id": "100086849041464",
            "name": "Kháº£i Minh Sá»±",
            "text": "â›ˆ",
            "created_time_vn": "2025-10-03 10:49:14"
          },
          {
            "id": "61554024308850",
            "name": "ÄÆ°á»ng Thanh Vy",
            "text": "@goodluck386",
            "created_time_vn": "2025-12-02 21:36:23"
          },
          {
            "id": "100089378621191",
            "name": "Partridge Jyoshna",
            "text": "22:36:06",
            "created_time_vn": "2025-10-01 23:50:10"
          },
          {
            "id": "100086407351979",
            "name": "Vinfast MÃ³ng CÃ¡i - 0981805047",
            "text": "mÃ¬nh Ä‘ang sá»¯ dá»¥ng, tháº¥y hiá»‡u quáº£, giÃ¡ há»£p lÃ½",
            "created_time_vn": "2025-11-27 10:41:46"
          },
          {
            "id": "100025193200496",
            "name": "Thu Hiá»n",
            "text": "CMT tÆ°Ì£ Ä‘Ã´Ì£ng Hello  Google Ads . ð›ðžÌ‚ð§ ð‡ð¢ðžÌ‚Ì€ð§ ðœð¡ð®ð²ðžÌ‚ð§ quÃ¢Ì€n aÌo, giaÌ€y deÌp, tuÌi saÌch haÌ€ng hotgirl chuÃ¢Ì‰n mÃ¢Ìƒu loaÌ£i 1, ord taobao, ship nÆ°Æ¡Ìc ngoaÌ€i",
            "created_time_vn": "2025-10-30 13:43:33"
          },
          {
            "id": "61554740793003",
            "name": "GiÃ u Huy",
            "text": "â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸Google Ads",
            "created_time_vn": "2025-10-20 20:47:37"
          },
          {
            "id": "61554018565289",
            "name": "PhÆ°á»£ng OÊ€der China",
            "text": "Em ghÃ© qua Google Ads Ä‘á»ƒ xin chÃºt tÆ°Æ¡ng tÃ¡c ðŸ«¶ Máº¹ Báº¯p Order uy tÃ­n, order nhanh gá»n nha ðŸŒ¸",
            "created_time_vn": "2025-10-01 21:13:12"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "Ä‘Ãºng gu cháº¥t ngáº¥t lun nÃ¨hhhhðŸŒŸ",
            "created_time_vn": "2025-11-29 13:05:44"
          },
          {
            "id": "61580808680533",
            "name": "Alice Collins",
            "text": "ðŸ™‚",
            "created_time_vn": "2025-10-03 21:19:00"
          },
          {
            "id": "100086343225983",
            "name": "Nguyá»…n HÆ¡n",
            "text": "ÄÃ¡p Ã¡n C + 972 + Sinh nháº­t KidsPlaza Háº£i PhÃ²ng + Nguyen Thá»‹ Háº£i Binh Tráº§n Huy HoÃ ng Há»“ng Tuyáº¿t",
            "created_time_vn": "2025-11-08 10:03:32"
          },
          {
            "id": "100080281520203",
            "name": "Linh Pháº¡m ThÃ¹y",
            "text": "ÄÃ¡p Ã¡n C + 497 + Sinh nháº­t KidsPlaza Háº£i PhÃ²ng + Há»“ng NhÆ° Má»™ng HÃ  Nguyá»…n Vá»ng Nguyá»‡t",
            "created_time_vn": "2025-11-08 09:26:47"
          },
          {
            "id": "100093506269067",
            "name": "Chung TrÃ­",
            "text": "ÄÃ¡p Ã¡n C + 742 + Sinh nháº­t KidsPlaza Háº£i PhÃ²ng + Khanh Vi Ly Phuong Anh HP Nguyá»…n Thuáº§n",
            "created_time_vn": "2025-11-08 09:12:03"
          },
          {
            "id": "61579213434642",
            "name": "Vanessa Nichols",
            "text": "T4 FREE PLAYâ¤ï¸ FREE PLAYâ¤ï¸ FREE PLAYâ¤ï¸\nâ¯ï¸ð‚-ð¡ð¨â€Œð¢ ð§ð ðšð²: ðŸ—ðŸ—ð¯ð¢ð§ðš .ðŸð¢ð­\nâ¬‡ï¸ð“-ðšâ€Œð¢ ð­ð«ð®â€Œâ€Œðœ ð­ð¢ðžâ€Œâ€Œð©: ð“ðšð¢ðŸ—ðŸ—ð¯ð¢ð§ðš .ðŸð¢ð­\nðŸ‘‘Äáº§y Äá»§ CÃ¡c Thá»ƒ Loáº¡i Game Xanh ChÃ­n\nðŸ§Náº¡p RÃºt 1: 1  SiÃªu Tá»‘c - Uy TÃ­n An ToÃ n.\nâ™»ï¸Dá»… ChÆ¡i - Dá»… TrÃºng - Uy TÃ­n - An ToÃ n\n\n#99vina #gambai #Gamebai2025 #Gamebai11 #Gamebaiuytin #Taixiu\"  #Khuyáº¿nMÃ£iSiÃªuÄá»‰nh #Náº¡p1Nháº­n2 #GameBÃ iÄá»•iThÆ°á»Ÿng  #gaixinh #tiktok #giaodich #Tuyenctv #triannnhieu #choilathang #trainghiem #30s #xuhuong #tangcode",
            "created_time_vn": "2025-10-12 22:44:08"
          },
          {
            "id": "100081508420834",
            "name": "QuÃ¢n LÃª",
            "text": "ÄÃ¡p Ã¡n C + 863 + Sinh nháº­t KidsPlaza Háº£i PhÃ²ng + Khanh Vi Ly Phuong Anh HP Nguyá»…n Thuáº§n",
            "created_time_vn": "2025-11-08 10:23:21"
          },
          {
            "id": "100003360736991",
            "name": "Thuyha Phan",
            "text": "Google Adsâ˜˜ï¸",
            "created_time_vn": "2025-10-23 09:22:25"
          },
          {
            "id": "100005002120350",
            "name": "Äá»— Luyá»‡n",
            "text": "Check inbox mk nha",
            "created_time_vn": "2025-10-18 09:20:37"
          },
          {
            "id": "100080685466820",
            "name": "Lan ÄÃ i TrÆ°Æ¡ng",
            "text": "hello",
            "created_time_vn": "2025-10-04 01:00:11"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ðŸ’¯tim yeeuu wwa",
            "created_time_vn": "2025-12-06 20:45:30"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "b...an like ðŸ€ðŸ€",
            "created_time_vn": "2025-12-03 17:43:29"
          },
          {
            "id": "100094342195604",
            "name": "Margaret Harris",
            "text": "good",
            "created_time_vn": "2025-10-10 16:53:15"
          },
          {
            "id": "100012607898683",
            "name": "Há»“ng HÃ ",
            "text": "good",
            "created_time_vn": "2025-10-04 10:33:59"
          },
          {
            "id": "100084726134501",
            "name": "Vai Äáº¹p HoÃ ng Mai",
            "text": "hellÃ´",
            "created_time_vn": "2025-10-03 22:05:59"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "xuáº¥t sáº¯c quÃ¡ xuáº¥t sáº¯c ui cv á»“hhhhhhðŸ‘",
            "created_time_vn": "2025-12-09 13:17:55"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "trÃ´ng cÃ³ váº» blem lÄƒm rÃ´i nhe cvðŸ¤ª",
            "created_time_vn": "2025-12-08 20:35:00"
          },
          {
            "id": "100056685217322",
            "name": "Nguyá»…n Tráº§n HÃ  Trang",
            "text": "Báº¡n khÃ´ng biáº¿t cÃ¡ch tÃ¬m kiáº¿m khÃ¡ch hÃ ng tiá»m nÄƒng. Ib e chá»‰ cho pháº§n má»m tÃ¬m kiáº¿m, quÃ©t khÃ¡ch vÃ  tiáº¿p cáº­n vá»›i khÃ¡ch hÃ ng tiá»m nÄƒng nhÃ© Google Ads",
            "created_time_vn": "2025-12-08 06:12:35"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "tháº£ ðŸ’”",
            "created_time_vn": "2025-11-30 17:50:45"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "ngon nhe ...blem thiá»‡t nhe",
            "created_time_vn": "2025-11-29 18:44:57"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "ðŸ“£ðŸ“£ chÃºc Google Ads â¤ï¸â¤ï¸â¤ï¸ lÃ m viá»‡c hiá»‡u quáº£ Ä‘áº§y yÃªu thÆ°Æ¡ng nhÃ©ðŸ’šðŸ’šðŸ’šðŸŒ»ðŸŒ»ðŸŒ»",
            "created_time_vn": "2025-11-04 13:18:24"
          },
          {
            "id": "100015108849162",
            "name": "ThÆ°Æ¡ng Chiáº¿n",
            "text": "ðŸ’–ðŸ’•ðŸ’—ðŸ’“ðŸ’žðŸŒ·ðŸŒ·ðŸŒ· Google Ads",
            "created_time_vn": "2025-10-28 12:27:38"
          },
          {
            "id": "100015108849162",
            "name": "ThÆ°Æ¡ng Chiáº¿n",
            "text": "ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’Google Ads",
            "created_time_vn": "2025-10-27 09:21:47"
          },
          {
            "id": "100015108849162",
            "name": "ThÆ°Æ¡ng Chiáº¿n",
            "text": "ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“Google Ads",
            "created_time_vn": "2025-10-27 09:03:38"
          },
          {
            "id": "100015108849162",
            "name": "ThÆ°Æ¡ng Chiáº¿n",
            "text": "ðŸŒ»ðŸŒ»ðŸŒ»ðŸŒ»ðŸ’œðŸ’œðŸ’œðŸ’œðŸ’œðŸ’œðŸŒ»ðŸŒ»ðŸŒ»ðŸŒ»Google Ads",
            "created_time_vn": "2025-10-25 11:07:07"
          },
          {
            "id": "100015108849162",
            "name": "ThÆ°Æ¡ng Chiáº¿n",
            "text": "ðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žGoogle Ads",
            "created_time_vn": "2025-10-24 21:33:20"
          },
          {
            "id": "61576213671717",
            "name": "Nguyá»…n Anh Khoa",
            "text": "tt",
            "created_time_vn": "2025-10-22 14:11:56"
          },
          {
            "id": "100008988797961",
            "name": "Phan Thá»‹ PhÆ°Æ¡ng",
            "text": "hello",
            "created_time_vn": "2025-10-21 12:47:49"
          },
          {
            "id": "61568300993180",
            "name": "Nguyá»…n Anh Kha",
            "text": "tt",
            "created_time_vn": "2025-10-21 10:44:40"
          },
          {
            "id": "100041009225441",
            "name": "Kem Trá»‹ NÃ¡m Yiyimei",
            "text": "ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“ðŸ’—ðŸ’“Google Ads",
            "created_time_vn": "2025-10-11 08:43:34"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "helo â¤ï¸â¤ï¸ðŸ’ðŸ’ðŸ’â¤ï¸ðŸ“£ðŸ“£ðŸ“£ðŸ’¯ðŸ’¯â¤ï¸â¤ï¸ðŸ’¯ðŸ’¯ðŸ’ðŸ’ðŸ’ðŸ’¯ðŸ’¯ðŸ’¯ðŸ¥‡ðŸ¥‡ðŸ’¯ðŸ’¯",
            "created_time_vn": "2025-10-07 07:44:52"
          },
          {
            "id": "100065085677680",
            "name": "Bui Thien",
            "text": "woww",
            "created_time_vn": "2025-10-07 02:37:13"
          },
          {
            "id": "100012607898683",
            "name": "Há»“ng HÃ ",
            "text": "woww",
            "created_time_vn": "2025-10-06 12:23:33"
          },
          {
            "id": "100041009225441",
            "name": "Kem Trá»‹ NÃ¡m Yiyimei",
            "text": "ðŸ’˜ðŸ’˜ðŸ’˜ðŸ’˜ðŸ’˜ðŸ’˜ðŸ’˜ðŸ’˜ðŸŒ¹ðŸŒ¹ðŸŒ¹Google Ads",
            "created_time_vn": "2025-10-06 07:23:57"
          },
          {
            "id": "100041009225441",
            "name": "Kem Trá»‹ NÃ¡m Yiyimei",
            "text": "ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’ðŸ’–ðŸ’Google Ads",
            "created_time_vn": "2025-10-05 22:22:14"
          },
          {
            "id": "100041009225441",
            "name": "Kem Trá»‹ NÃ¡m Yiyimei",
            "text": "ðŸŒ»ðŸŒ»ðŸŒ»ðŸŒ»ðŸ’œðŸ’œðŸ’œðŸ’œðŸ’œðŸ’œðŸŒ»ðŸŒ»ðŸŒ»ðŸŒ»Google Ads",
            "created_time_vn": "2025-10-04 08:10:54"
          },
          {
            "id": "100041009225441",
            "name": "Kem Trá»‹ NÃ¡m Yiyimei",
            "text": "ðŸ’–ðŸ’•ðŸ’—ðŸ’“ðŸ’žðŸŒ·ðŸŒ·ðŸŒ· Google Ads",
            "created_time_vn": "2025-10-04 08:10:04"
          },
          {
            "id": "100080052987048",
            "name": "Nguyá»…n ChÃ­ Thanh-BÃ¬nh DÆ°Æ¡ng",
            "text": "âœ…Thá»§ tá»¥c Ä‘Æ¡n giáº£n.\nâœ…Báº£o máº­t thÃ´ng tin tuyá»‡t Ä‘á»‘i\nðŸ‘‰CÃ³ F88 lo, xoay vá»‘n lÃ  chuyá»‡n nhá»!\n#f88taichinhbinhdan #canlaco #vaybangdangkyoto #vaynhanh #vaycavetoto\nÄiá»‡n thoáº¡i: 1800.6388 (PhÃ­m 1)\nhotline : 0274.7304288\nðŸ“ž Zalo: 0703 842 261\nðŸ‘‰ Website: https://vay.f88.vn/1_BDG22018.\nâœª F88 : Sá»‘ 496 Nguyá»…n ChÃ­ Thanh, phÆ°á»ng Hiá»‡p An, Thá»§ Dáº§u Má»™t, BÃ¬nh DÆ°Æ¡ng (NgÃ£ 4 VÃµ CÃ¡i)",
            "created_time_vn": "2025-10-03 08:45:22"
          },
          {
            "id": "100092505173277",
            "name": "Lan TÃ¢y",
            "text": "woww",
            "created_time_vn": "2025-10-01 20:41:55"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "*+loveeeeeðŸ’”",
            "created_time_vn": "2025-12-11 11:51:21"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "suáº¥t sáº¯c nhe cv oiðŸ˜Š",
            "created_time_vn": "2025-12-10 14:14:43"
          },
          {
            "id": "61575022290670",
            "name": "NhÃ  MÃ¡y Sáº£n Xuáº¥t ÄÃ¨n Onevn",
            "text": "BÃªn em chuyÃªn cung cáº¥p Ä‘Ã¨n led dÃ¢n dá»¥ng, cÃ´ng nghiá»‡p, nhÃ  mÃ¡y, sÃ¢n thá»ƒ thao...hotline: 0971112656",
            "created_time_vn": "2025-11-09 12:35:49"
          },
          {
            "id": "100055143821721",
            "name": "Tháº¿ Hiá»ƒn",
            "text": "inb hoac inb zalo 0336951152",
            "created_time_vn": "2025-12-15 13:58:32"
          },
          {
            "id": "100041009225441",
            "name": "Kem Trá»‹ NÃ¡m Yiyimei",
            "text": "ðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žðŸ’•ðŸ’žGoogle Ads",
            "created_time_vn": "2025-12-13 16:33:46"
          },
          {
            "id": "100056685217322",
            "name": "Nguyá»…n Tráº§n HÃ  Trang",
            "text": "BÃ i viáº¿t Ä‘Äƒng nhÆ°ng khÃ´ng ai like, luÃ´n bá»‹ chÃ¬m ib e cÃ i gÃ³i tÄƒng like tá»± Ä‘á»™ng giÃºp bÃ i viáº¿t Ä‘áº¹p vÃ  luÃ´n Ä‘Æ°á»£c uu tiÃªn hiá»ƒn thá»‹ nhÃ© Google Ads",
            "created_time_vn": "2025-12-08 14:20:11"
          },
          {
            "id": "100030703762997",
            "name": "TrÃ¢n PK",
            "text": "[ðŸ¤Ÿui ðŸ¤ŸðŸ¤Ÿui ]",
            "created_time_vn": "2025-12-02 15:04:25"
          },
          {
            "id": "61572290194727",
            "name": "ChÃ¢n TÄƒng Chá»‰nh",
            "text": "0987 985 194 liÃªn há»‡",
            "created_time_vn": "2025-11-21 12:06:15"
          },
          {
            "id": "100039997129171",
            "name": "Nguyá»…n Nam",
            "text": "ðŸ’•ðŸ’•ðŸ’žðŸ’žðŸ’žðŸ’žðŸ’žðŸ’ðŸ’â¤ï¸â¤ï¸ðŸ’šðŸ’šâ¤ï¸â¤ï¸ðŸ’ðŸ’ðŸ’ ttql nha Google Ads",
            "created_time_vn": "2025-11-08 12:43:19"
          },
          {
            "id": "61577233445134",
            "name": "JYD Eyelashes - XÆ°á»Ÿng mi giáº£ giÃ¡ sá»‰",
            "text": "Sá»‰ mi tá»« 11k mi sáºµn keo\n- GÃ­a táº­n xÆ°á»Ÿng - táº­n gá»‘c - nhÃ  sáº£n xuáº¥t\n- KhÃ´ng giá»›i háº¡n máº«u\n- Cáº­p nháº­t máº«u má»›i liÃªn tá»¥c\n09091,.75622\nGr za.lo: https://zalo.me/g/yomjfu734\nShá»™p pi : https://vn.shp.ee/YjQGgxy\nTÃ³p tÃ³p : https://byvn.net/qfBp",
            "created_time_vn": "2025-11-07 14:50:25"
          },
          {
            "id": "100006251196602",
            "name": "Nguyá»…n Thá»‹ Nam",
            "text": "comment vÃ  like qua láº¡i nhÃ¡ Google Ads ðŸŒ¸ðŸŒºðŸŒºðŸŒºðŸ’ðŸ’ðŸ’ðŸŒ¸ðŸŒ¹ðŸŒ¹ðŸŒ¹ðŸŒ¸â¤ï¸â¤ï¸â¤ï¸ðŸŒ¸â¤ï¸â¤ï¸ðŸŒ¸ðŸŒ¸â¤ï¸ðŸ’¥",
            "created_time_vn": "2025-10-18 17:34:08"
          },
          {
            "id": "100058457693815",
            "name": "Nguyá»…n UyÃªn",
            "text": "Ná»™i dung comment 1",
            "created_time_vn": "2025-10-18 06:17:27"
          },
          {
            "id": "100092250423609",
            "name": "Kem Xinhh",
            "text": "Hello",
            "created_time_vn": "2025-10-05 07:24:26"
          },
          {
            "id": "100011322913686",
            "name": "TrÆ°Æ¡ng Thá»§y",
            "text": "hello",
            "created_time_vn": "2025-10-05 02:53:34"
          }
        ],
        "reactions_count": 0,
        "comments_count": 304,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 304,
        "status": "success"
      }
    ]
  },
  "total_posts_processed": 4,
  "total_reactions": 1118,
  "total_comments": 357
}
--- END FILE: backend\data\results\all_results_summary.json ---

--- START FILE: backend\worker\check_cookies.py ---
import requests
from get_payload import get_cookies_by_profile_id


def check_cookie_by_title(profile_id: str) -> dict:
    """
    Táº£i facebook.com vá»›i cookies vÃ  kiá»ƒm tra title Ä‘Äƒng nháº­p.
    Title "Facebook â€“ log in or sign up" => cookies die.
    """
    cookie = get_cookies_by_profile_id(profile_id)
    if not cookie:
        return {"status": "dead", "message": "âŒ KhÃ´ng láº¥y Ä‘Æ°á»£c cookie"}

    url = "https://www.facebook.com/"
    headers = {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",
        "accept-encoding": "gzip, deflate, br",
        "accept-language": "en,vi;q=0.9,en-US;q=0.8",
        "referer": "https://www.facebook.com/",
        "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": '"Windows"',
        "upgrade-insecure-requests": "1",
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
        "cookie": cookie,
    }

    try:
        resp = requests.get(url, headers=headers, timeout=20, allow_redirects=True)
        login_title = '<title id="pageTitle">Facebook â€“ log in or sign up</title>'
        html_lower = resp.text.lower()

        if login_title.lower() in html_lower:
            return {
                "status": "dead",
                "message": "âŒ PhÃ¡t hiá»‡n title login: cookies die",
                "status_code": resp.status_code,
                "final_url": resp.url,
            }

        # KhÃ´ng tháº¥y title login => coi lÃ  cookies cÃ²n sá»‘ng (dÃ¹ status khÃ¡c 200)
        return {
            "status": "alive",
            "message": "âœ… KhÃ´ng tháº¥y title login, coi cookies cÃ²n sá»‘ng",
            "status_code": resp.status_code,
            "final_url": resp.url,
        }
    except Exception as e:
        return {"status": "error", "message": f"âŒ Lá»—i: {e}"}


if __name__ == "__main__":
    profile_id = "031ca13d-e8fa-400c-a603-df57a2806788"
    result = check_cookie_by_title(profile_id)
    print(result["message"])


--- END FILE: backend\worker\check_cookies.py ---

--- START FILE: backend\worker\get_all_info.py ---
import json
import os
from pathlib import Path
from single_get_reactions import get_all_users_by_fid
from single_get_comment import get_all_comments_by_post_id
from get_payload import get_payload_by_profile_id, get_cookies_by_profile_id

# ====== ÄÆ¯á»œNG DáºªN THEO PROJECT ROOT ======
BASE_DIR = Path(__file__).resolve().parents[2]  # ThÆ° má»¥c gá»‘c project
POST_IDS_DIR = BASE_DIR / "backend" / "data" / "post_ids"
OUTPUT_DIR = BASE_DIR / "backend" / "data" / "results"

# Táº¡o thÆ° má»¥c output náº¿u chÆ°a cÃ³
os.makedirs(OUTPUT_DIR, exist_ok=True)

# ====== PROFILE ID ======
# Profile ID máº·c Ä‘á»‹nh, cÃ³ thá»ƒ thay Ä‘á»•i
DEFAULT_PROFILE_ID = "031ca13d-e8fa-400c-a603-df57a2806788"


def filter_by_owner_id(items, owner_id):
    """
    Lá»c bá» cÃ¡c items cÃ³ id trÃ¹ng vá»›i owner_id
    
    Args:
        items (list): Danh sÃ¡ch items (reactions hoáº·c comments)
        owner_id (str): ID cá»§a owner cáº§n loáº¡i bá»
        
    Returns:
        list: Danh sÃ¡ch items Ä‘Ã£ Ä‘Æ°á»£c lá»c
    """
    if not owner_id or not items:
        return items
    
    filtered = []
    removed_count = 0
    
    for item in items:
        # Reactions: {"id": user_id, "name": user_name}
        # Comments: {"id": user_id, "name": user_name, "text": ...} hoáº·c {"id": comment_id, "author": {"id": user_id, ...}}
        item_id = None
        
        # Thá»­ láº¥y id tá»« cÃ¡c vá»‹ trÃ­ cÃ³ thá»ƒ
        if "id" in item:
            # Vá»›i comments, cÃ³ thá»ƒ lÃ  comment_id hoáº·c user_id
            # Náº¿u cÃ³ "author", thÃ¬ id lÃ  comment_id, cáº§n láº¥y tá»« author
            if "author" in item and isinstance(item["author"], dict):
                item_id = item["author"].get("id")
            else:
                # Náº¿u khÃ´ng cÃ³ author, thÃ¬ id chÃ­nh lÃ  user_id
                item_id = item.get("id")
        
        # Náº¿u váº«n chÆ°a cÃ³, thá»­ cÃ¡c field khÃ¡c
        if not item_id:
            item_id = item.get("user_id")
        
        # Chá»‰ thÃªm vÃ o náº¿u id khÃ¡c vá»›i owner_id
        if item_id != owner_id:
            filtered.append(item)
        else:
            removed_count += 1
    
    if removed_count > 0:
        print(f"   ðŸš« ÄÃ£ lá»c bá» {removed_count} items tá»« owner (ID: {owner_id})")
    
    return filtered


def process_post_id(post_data, file_name, profile_id, payload_dict, cookies):
    """
    Xá»­ lÃ½ má»™t post: láº¥y reactions vÃ  comments
    
    Args:
        post_data (dict hoáº·c str): 
            - Náº¿u lÃ  dict: {"id": "...", "flag": "...", "text": "...", "owning_profile": {...}}
            - Náº¿u lÃ  str: post_id (format cÅ©, Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch)
        file_name (str): TÃªn file JSON chá»©a post nÃ y
        profile_id (str): Profile ID
        payload_dict (dict): Payload dictionary Ä‘Ã£ Ä‘Æ°á»£c load sáºµn
        cookies (str): Cookie string Ä‘Ã£ Ä‘Æ°á»£c load sáºµn
        
    Returns:
        dict: Káº¿t quáº£ vá»›i reactions vÃ  comments
    """
    # Xá»­ lÃ½ cáº£ format cÅ© (string) vÃ  format má»›i (object)
    if isinstance(post_data, str):
        # Format cÅ©: chá»‰ lÃ  string post_id
        post_id = post_data
        flag = None
        text = None
        owning_profile = None
        owning_profile_id = None
    else:
        # Format má»›i: object vá»›i id, flag, text, owning_profile
        post_id = post_data.get("id")
        flag = post_data.get("flag")
        text = post_data.get("text")
        owning_profile = post_data.get("owning_profile")
        owning_profile_id = owning_profile.get("id") if owning_profile else None
    
    if not post_id:
        print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y post_id trong post_data")
        return None
    
    print("\n" + "="*70)
    print(f"ðŸ“Œ Xá»­ lÃ½ Post ID: {post_id}")
    if flag:
        print(f"ðŸ·ï¸  Flag: {flag}")
    if owning_profile:
        print(f"ðŸ‘¤ Owner: {owning_profile.get('name', 'N/A')} (ID: {owning_profile_id})")
    print(f"ðŸ“ Tá»« file: {file_name}")
    print(f"ðŸ‘¤ Profile ID: {profile_id}")
    print("="*70)
    
    result = {
        "post_id": post_id,
        "flag": flag,
        "text": text,
        "owning_profile": owning_profile,
        "source_file": file_name,
        "profile_id": profile_id,
        "reactions": [],
        "comments": [],
        "reactions_count": 0,
        "comments_count": 0,
        "reactions_count_before_filter": 0,
        "comments_count_before_filter": 0,
        "status": "success"
    }
    
    try:
        # 1. Láº¥y reactions
        print(f"\nðŸ”µ Báº¯t Ä‘áº§u láº¥y REACTIONS cho post_id: {post_id}")
        reactions = get_all_users_by_fid(post_id, payload_dict, profile_id, cookies)
        result["reactions_count_before_filter"] = len(reactions)
        
        # Lá»c bá» reactions tá»« owner
        if owning_profile_id:
            reactions = filter_by_owner_id(reactions, owning_profile_id)
            filtered_count = result["reactions_count_before_filter"] - len(reactions)
            if filtered_count > 0:
                print(f"ðŸš« ÄÃ£ lá»c bá» {filtered_count} reactions tá»« owner (ID: {owning_profile_id})")
        
        result["reactions"] = reactions
        result["reactions_count"] = len(reactions)
        print(f"âœ… ÄÃ£ láº¥y Ä‘Æ°á»£c {result['reactions_count']} reactions (sau khi lá»c)")
        
        # 2. Láº¥y comments
        print(f"\nðŸŸ¢ Báº¯t Ä‘áº§u láº¥y COMMENTS cho post_id: {post_id}")
        comments = get_all_comments_by_post_id(post_id, payload_dict, profile_id, cookies)
        result["comments_count_before_filter"] = len(comments)
        
        # Lá»c bá» comments tá»« owner
        if owning_profile_id:
            comments = filter_by_owner_id(comments, owning_profile_id)
            filtered_count = result["comments_count_before_filter"] - len(comments)
            if filtered_count > 0:
                print(f"ðŸš« ÄÃ£ lá»c bá» {filtered_count} comments tá»« owner (ID: {owning_profile_id})")
        
        result["comments"] = comments
        result["comments_count"] = len(comments)
        print(f"âœ… ÄÃ£ láº¥y Ä‘Æ°á»£c {result['comments_count']} comments (sau khi lá»c)")
        
    except Exception as e:
        print(f"âŒ Lá»—i khi xá»­ lÃ½ post_id {post_id}: {e}")
        import traceback
        traceback.print_exc()
        result["status"] = "error"
        result["error"] = str(e)
    
    return result


def extract_profile_id_from_filename(file_name):
    """
    TÃ¡ch profile_id tá»« tÃªn file (vÃ­ dá»¥: 031ca13d-e8fa-400c-a603-df57a2806788.json -> 031ca13d-e8fa-400c-a603-df57a2806788)
    
    Args:
        file_name (str): TÃªn file (cÃ³ thá»ƒ cÃ³ hoáº·c khÃ´ng cÃ³ Ä‘Æ°á»ng dáº«n)
        
    Returns:
        str: Profile ID hoáº·c None náº¿u khÃ´ng tÃ¡ch Ä‘Æ°á»£c
    """
    # Láº¥y tÃªn file khÃ´ng cÃ³ extension
    base_name = os.path.splitext(os.path.basename(file_name))[0]
    
    # Kiá»ƒm tra xem cÃ³ pháº£i lÃ  UUID format khÃ´ng (cÃ³ dáº¥u gáº¡ch ngang)
    if '-' in base_name and len(base_name) == 36:  # UUID format: 8-4-4-4-12
        return base_name
    
    return None


def process_post_ids_file(file_path):
    """
    Xá»­ lÃ½ má»™t file JSON chá»©a danh sÃ¡ch post_ids
    
    Args:
        file_path (str): ÄÆ°á»ng dáº«n Ä‘áº¿n file JSON
        
    Returns:
        list: Danh sÃ¡ch káº¿t quáº£ cá»§a táº¥t cáº£ post_ids trong file
    """
    file_name = os.path.basename(file_path)
    
    # Tá»± Ä‘á»™ng tÃ¡ch profile_id tá»« tÃªn file
    profile_id = extract_profile_id_from_filename(file_name)
    
    if not profile_id:
        print(f"âš ï¸ KhÃ´ng thá»ƒ tÃ¡ch profile_id tá»« tÃªn file: {file_name}")
        print(f"   Sá»­ dá»¥ng profile_id máº·c Ä‘á»‹nh: {DEFAULT_PROFILE_ID}")
        profile_id = DEFAULT_PROFILE_ID
    else:
        print(f"âœ… ÄÃ£ tÃ¡ch profile_id tá»« tÃªn file: {profile_id}")
    
    print("\n" + "="*70)
    print(f"ðŸ“‚ Äang xá»­ lÃ½ file: {file_name}")
    print(f"ðŸ‘¤ Profile ID: {profile_id}")
    print("="*70)
    
    try:
        with open(file_path, "r", encoding="utf-8") as f:
            post_ids = json.load(f)
        
        if not isinstance(post_ids, list):
            print(f"âš ï¸ File {file_name} khÃ´ng chá»©a máº£ng post_ids")
            return []
        
        print(f"ðŸ“‹ TÃ¬m tháº¥y {len(post_ids)} post(s) trong file")
        
        # Load payload vÃ  cookies má»™t láº§n cho táº¥t cáº£ posts
        print(f"\nðŸ”„ Äang láº¥y payload vÃ  cookies tá»« profile_id: {profile_id}")
        payload_dict = get_payload_by_profile_id(profile_id)
        if not payload_dict:
            print(f"âŒ KhÃ´ng thá»ƒ láº¥y payload tá»« profile_id: {profile_id}")
            return []
        
        cookies = get_cookies_by_profile_id(profile_id)
        if not cookies:
            print(f"âŒ KhÃ´ng thá»ƒ láº¥y cookies tá»« profile_id: {profile_id}")
            return []
        
        print(f"âœ… ÄÃ£ load payload vÃ  cookies thÃ nh cÃ´ng (sáº½ dÃ¹ng chung cho táº¥t cáº£ {len(post_ids)} posts)")
        
        results = []
        for i, post_data in enumerate(post_ids, 1):
            # Xá»­ lÃ½ cáº£ format cÅ© (string) vÃ  format má»›i (object)
            if isinstance(post_data, str):
                post_id = post_data
            else:
                post_id = post_data.get("id")
            
            if not post_id:
                print(f"âš ï¸ [{i}/{len(post_ids)}] Bá» qua item khÃ´ng cÃ³ post_id: {post_data}")
                continue
            
            print(f"\n{'='*70}")
            print(f"ðŸ“Œ [{i}/{len(post_ids)}] Xá»­ lÃ½ Post ID: {post_id}")
            print(f"{'='*70}")
            
            result = process_post_id(post_data, file_name, profile_id, payload_dict, cookies)
            if result:
                results.append(result)
                
                # LÆ°u káº¿t quáº£ riÃªng cho má»—i post_id
                post_output_file = os.path.join(OUTPUT_DIR, f"{post_id}_info.json")
                with open(post_output_file, "w", encoding="utf-8") as f:
                    json.dump(result, f, ensure_ascii=False, indent=2)
                print(f"ðŸ’¾ ÄÃ£ lÆ°u káº¿t quáº£ vÃ o: {post_output_file}")
        
        return results
        
    except FileNotFoundError:
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y file: {file_path}")
        return []
    except json.JSONDecodeError as e:
        print(f"âŒ Lá»—i: File {file_name} khÃ´ng pháº£i JSON há»£p lá»‡: {e}")
        return []
    except Exception as e:
        print(f"âŒ Lá»—i khi xá»­ lÃ½ file {file_name}: {e}")
        import traceback
        traceback.print_exc()
        return []


def get_all_info_from_post_ids_dir():
    """
    Xá»­ lÃ½ táº¥t cáº£ cÃ¡c file JSON trong thÆ° má»¥c data/post_ids/
    Má»—i file sáº½ tá»± Ä‘á»™ng sá»­ dá»¥ng profile_id tá»« tÃªn file
    """
    print("\n" + "="*70)
    print("ðŸš€ Báº®T Äáº¦U Xá»¬ LÃ Táº¤T Cáº¢ POST IDs")
    print("="*70)
    print("â„¹ï¸  Má»—i file sáº½ tá»± Ä‘á»™ng sá»­ dá»¥ng profile_id tá»« tÃªn file")
    print("="*70)
    
    # Láº¥y táº¥t cáº£ file JSON trong thÆ° má»¥c
    post_ids_path = Path(POST_IDS_DIR)
    if not post_ids_path.exists():
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y thÆ° má»¥c: {POST_IDS_DIR}")
        return
    
    json_files = list(post_ids_path.glob("*.json"))
    
    if not json_files:
        print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y file JSON nÃ o trong {POST_IDS_DIR}")
        return
    
    print(f"ðŸ“ TÃ¬m tháº¥y {len(json_files)} file(s) JSON")
    
    all_results = {}
    
    # Xá»­ lÃ½ tá»«ng file (má»—i file sáº½ tá»± Ä‘á»™ng extract profile_id tá»« tÃªn file)
    for file_path in json_files:
        file_name = file_path.name
        results = process_post_ids_file(str(file_path))
        all_results[file_name] = results
    
    # LÆ°u káº¿t quáº£ tá»•ng há»£p
    summary_file = os.path.join(OUTPUT_DIR, "all_results_summary.json")
    summary = {
        "total_files": len(json_files),
        "results_by_file": all_results,
        "total_posts_processed": sum(len(results) for results in all_results.values()),
        "total_reactions": sum(
            sum(r.get("reactions_count", 0) for r in results)
            for results in all_results.values()
        ),
        "total_comments": sum(
            sum(r.get("comments_count", 0) for r in results)
            for results in all_results.values()
        )
    }
    
    with open(summary_file, "w", encoding="utf-8") as f:
        json.dump(summary, f, ensure_ascii=False, indent=2)
    
    print("\n" + "="*70)
    print("âœ… HOÃ€N THÃ€NH Xá»¬ LÃ Táº¤T Cáº¢ POST IDs")
    print("="*70)
    print(f"ðŸ“Š Tá»•ng sá»‘ file Ä‘Ã£ xá»­ lÃ½: {len(json_files)}")
    print(f"ðŸ“Š Tá»•ng sá»‘ post Ä‘Ã£ xá»­ lÃ½: {summary['total_posts_processed']}")
    print(f"ðŸ“Š Tá»•ng sá»‘ reactions: {summary['total_reactions']}")
    print(f"ðŸ“Š Tá»•ng sá»‘ comments: {summary['total_comments']}")
    print(f"ðŸ’¾ ÄÃ£ lÆ°u káº¿t quáº£ tá»•ng há»£p vÃ o: {summary_file}")
    print("="*70)


if __name__ == "__main__":
    get_all_info_from_post_ids_dir()


--- END FILE: backend\worker\get_all_info.py ---

--- START FILE: backend\worker\get_id.py ---
import requests
import json
import re
import codecs
from urllib.parse import urlencode, urlparse, parse_qs

# ====== LÆ¯U Ã ======
# Cookies vÃ  payload Ä‘Æ°á»£c láº¥y tá»« cookies.json vÃ  payload.txt thÃ´ng qua profile_id
# cookies.json cÃ³ cáº¥u trÃºc: {"profile_id": {"cookie": "...", "access_token": "..."}}
# Sá»­ dá»¥ng get_payload.get_payload_by_profile_id(profile_id) Ä‘á»ƒ láº¥y payload
# Sá»­ dá»¥ng get_payload.get_cookies_by_profile_id(profile_id) Ä‘á»ƒ láº¥y cookie


def _import_get_cookies_by_profile_id():
    """
    Há»— trá»£ cháº¡y Ä‘Æ°á»£c cáº£ 2 kiá»ƒu:
    - cháº¡y trá»±c tiáº¿p trong folder backend/worker (import get_payload)
    - cháº¡y qua module backend.worker.get_id (import backend.worker.get_payload)
    """
    try:
        from get_payload import get_cookies_by_profile_id  # type: ignore
        return get_cookies_by_profile_id
    except Exception:
        try:
            from backend.worker.get_payload import get_cookies_by_profile_id  # type: ignore
            return get_cookies_by_profile_id
        except Exception:
            # fallback (náº¿u sys.path Ä‘Ã£ append worker_path)
            from worker.get_payload import get_cookies_by_profile_id  # type: ignore
            return get_cookies_by_profile_id


# ================================
#   HÃ€M Gá»ŒI API Vá»šI URL VIDEO
# ================================
def get_post_id(video_url, profile_id, cookies=None):
    """
    Láº¥y post_id vÃ  owning_profile tá»« HTML source (view-source)
    Sá»­ dá»¥ng cookies Ä‘á»ƒ má»Ÿ nhÆ° trÃ¬nh duyá»‡t bÃ¬nh thÆ°á»ng
    
    Args:
        video_url (str): URL cá»§a video Facebook (vÃ­ dá»¥: "https://www.facebook.com/reel/1525194028720314/")
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y cookies
        cookies (str, optional): Cookie string (náº¿u Ä‘Ã£ cÃ³ sáºµn)
        
    Returns:
        tuple: (post_id, owning_profile_dict) hoáº·c (None, None) náº¿u khÃ´ng tÃ¬m tháº¥y
        owning_profile_dict: {"__typename": "...", "name": "...", "id": "..."} hoáº·c None
    """
    # Sá»­ dá»¥ng HTML source Ä‘á»ƒ láº¥y thÃ´ng tin (vá»›i cookies)
    post_id, owning_profile, post_text = get_post_id_from_html(video_url, profile_id, cookies)
    
    # Decode Unicode escape sequences trong owning_profile name náº¿u cÃ³
    if owning_profile and "name" in owning_profile:
        name = owning_profile['name']
        if isinstance(name, str) and '\\u' in name:
            try:
                name = json.loads(f'"{name}"')
                owning_profile['name'] = name
            except:
                try:
                    name = codecs.decode(name, 'unicode_escape')
                    owning_profile['name'] = name
                except:
                    pass
    
    return post_id, owning_profile, post_text


def get_post_id_from_html(url, profile_id, cookies=None):
    """
    Láº¥y post_id vÃ  owning_profile tá»« HTML source cá»§a trang (view-source)
    Sá»­ dá»¥ng cookies Ä‘á»ƒ má»Ÿ nhÆ° trÃ¬nh duyá»‡t bÃ¬nh thÆ°á»ng
    
    Args:
        url (str): URL cá»§a Facebook post
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y cookies
        cookies (str, optional): Cookie string (náº¿u Ä‘Ã£ cÃ³ sáºµn)
        
    Returns:
        tuple: (post_id, owning_profile_dict) hoáº·c (None, None) náº¿u khÃ´ng tÃ¬m tháº¥y
        owning_profile_dict: {"__typename": "...", "name": "...", "id": "..."} hoáº·c None
    """
    get_cookies_by_profile_id = _import_get_cookies_by_profile_id()
    
    # Láº¥y cookies náº¿u chÆ°a cÃ³
    if cookies is None:
        cookies = get_cookies_by_profile_id(profile_id)
        if not cookies:
            print(f"âŒ KhÃ´ng thá»ƒ láº¥y cookies tá»« profile_id: {profile_id}")
            return None, None
    
    try:
        # Táº¡o session Ä‘á»ƒ quáº£n lÃ½ cookies tá»‘t hÆ¡n (nhÆ° trÃ¬nh duyá»‡t)
        session = requests.Session()
        
        # Parse cookies string thÃ nh dict vÃ  thÃªm vÃ o session
        # Cookies string format: "name1=value1; name2=value2; ..."
        if cookies:
            cookies_dict = {}
            for cookie_pair in cookies.split(';'):
                cookie_pair = cookie_pair.strip()
                if '=' in cookie_pair:
                    key, value = cookie_pair.split('=', 1)
                    cookies_dict[key.strip()] = value.strip()
            session.cookies.update(cookies_dict)
        
        # Headers cho GET request (giá»‘ng trÃ¬nh duyá»‡t, CHá»ˆ gzip/deflate Ä‘á»ƒ trÃ¡nh lá»—i brotli trÃªn mÃ¡y thiáº¿u thÆ° viá»‡n)
        get_headers = {
            "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",
            "accept-encoding": "gzip, deflate",
            "accept-language": "en,vi;q=0.9,en-US;q=0.8",
            "referer": "https://www.facebook.com/",
            "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": '"Windows"',
            "sec-fetch-dest": "document",
            "sec-fetch-mode": "navigate",
            "sec-fetch-site": "same-origin",
            "upgrade-insecure-requests": "1",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
        }
        
        # Láº¥y HTML source trá»±c tiáº¿p (view-source) vá»›i cookies
        print(f"ðŸŒ Láº¥y HTML source (view-source) trá»±c tiáº¿p tá»«: {url}")
        response = session.get(url, headers=get_headers)
        
        print(f"ðŸ“Š Status Code: {response.status_code}")
        print(f"ðŸ“„ Response Length: {len(response.text)} characters")
        
        if response.status_code != 200:
            print(f"âŒ Status code khÃ´ng pháº£i 200: {response.status_code}")
            return None, None
        
        html_content = response.text
        print(f"âœ… ÄÃ£ láº¥y HTML content ({len(html_content)} kÃ½ tá»±)")
        
        # Debug: TÃ¬m cÃ¡c pattern cÃ³ thá»ƒ cÃ³ trong HTML
        # Facebook cÃ³ thá»ƒ escape hoáº·c encode khÃ¡c
        print(f"\nðŸ” Äang tÃ¬m kiáº¿m patterns...")
        
        # Thá»­ tÃ¬m post_id vá»›i nhiá»u pattern khÃ¡c nhau
        post_id = None
        
        # Pattern 1: "post_id":"123456789" (chuáº©n)
        match = re.search(r'"post_id"\s*:\s*"(\d+)"', html_content)
        if match:
            post_id = match.group(1)
            print(f"âœ… TÃ¬m tháº¥y post_id (pattern 1): {post_id}")
        else:
            # Pattern 2: "post_id":123456789 (khÃ´ng cÃ³ quotes)
            match = re.search(r'"post_id"\s*:\s*(\d+)', html_content)
            if match:
                post_id = match.group(1)
                print(f"âœ… TÃ¬m tháº¥y post_id (pattern 2): {post_id}")
            else:
                # Pattern 3: post_id":"123456789" (cÃ³ thá»ƒ escape)
                match = re.search(r'post_id["\']?\s*:\s*["\']?(\d+)', html_content)
                if match:
                    post_id = match.group(1)
                    print(f"âœ… TÃ¬m tháº¥y post_id (pattern 3): {post_id}")
                else:
                    # Pattern 4: TÃ¬m trong JSON structure
                    # CÃ³ thá»ƒ lÃ  JSON Ä‘Æ°á»£c embed trong HTML
                    json_matches = re.findall(r'["\']post_id["\']\s*:\s*["\']?(\d+)', html_content, re.IGNORECASE)
                    if json_matches:
                        post_id = json_matches[0]
                        print(f"âœ… TÃ¬m tháº¥y post_id (pattern 4 - JSON): {post_id}")
                    else:
                        print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y post_id vá»›i báº¥t ká»³ pattern nÃ o")
                        # Debug: TÃ¬m má»™t sá»‘ pattern khÃ¡c Ä‘á»ƒ xem HTML cÃ³ gÃ¬
                        if '"post_id"' in html_content:
                            print(f"   ðŸ” TÃ¬m tháº¥y chuá»—i 'post_id' trong HTML nhÆ°ng khÃ´ng match pattern")
                            # TÃ¬m context xung quanh
                            idx = html_content.find('"post_id"')
                            if idx != -1:
                                context = html_content[max(0, idx-50):min(len(html_content), idx+100)]
                                print(f"   ðŸ“‹ Context: {context[:150]}...")
                        else:
                            print(f"   ðŸ” KhÃ´ng tÃ¬m tháº¥y chuá»—i 'post_id' trong HTML")
        
        # ===== TÃŒM OWNING_PROFILE Äáº¦U TIÃŠN TRONG HTML =====
        # Pattern: "owning_profile":{"__typename":"User","name":"...","id":"..."}
        # CÃ³ thá»ƒ cÃ³ cÃ¡c field khÃ¡c nhÆ° "short_name" giá»¯a cÃ¡c field
        owning_profile = None
        
        # TÃ¬m owning_profile vá»›i nhiá»u pattern khÃ¡c nhau
        
        # Pattern 1: "owning_profile":{ (chuáº©n)
        pattern = r'"owning_profile"\s*:\s*\{'
        match = re.search(pattern, html_content)
        
        if match:
            print(f"âœ… TÃ¬m tháº¥y 'owning_profile':{{ táº¡i vá»‹ trÃ­ {match.start()}")
            start_pos = match.end()
            
            # TÃ¬m closing brace tÆ°Æ¡ng á»©ng (balanced braces)
            brace_count = 1
            end_pos = start_pos
            while end_pos < len(html_content) and brace_count > 0:
                if html_content[end_pos] == '{':
                    brace_count += 1
                elif html_content[end_pos] == '}':
                    brace_count -= 1
                end_pos += 1
            
            if brace_count == 0:
                # Láº¥y ná»™i dung bÃªn trong braces
                block_content = html_content[start_pos:end_pos-1]
                print(f"   ðŸ“‹ Block content length: {len(block_content)} characters")
                
                # TÃ¬m cÃ¡c field trong block nÃ y
                owning_profile_data = {}
                
                # TÃ¬m __typename
                typename_match = re.search(r'"__typename"\s*:\s*"([^"]+)"', block_content)
                if typename_match:
                    owning_profile_data["__typename"] = typename_match.group(1)
                    print(f"   âœ… TÃ¬m tháº¥y __typename: {typename_match.group(1)}")
                
                # TÃ¬m name
                name_match = re.search(r'"name"\s*:\s*"([^"]+)"', block_content)
                if name_match:
                    owning_profile_data["name"] = name_match.group(1)
                    print(f"   âœ… TÃ¬m tháº¥y name: {name_match.group(1)[:50]}...")
                
                # TÃ¬m id
                id_match = re.search(r'"id"\s*:\s*"([^"]+)"', block_content)
                if id_match:
                    owning_profile_data["id"] = id_match.group(1)
                    print(f"   âœ… TÃ¬m tháº¥y id: {id_match.group(1)}")
                
                # Chá»‰ láº¥y náº¿u cÃ³ Ä‘á»§ Ã­t nháº¥t 2 trong 3 fields (__typename, name, id)
                if len(owning_profile_data) >= 2:
                    owning_profile = owning_profile_data
                    print(f"âœ… ÄÃ£ extract owning_profile thÃ nh cÃ´ng")
                else:
                    print(f"âš ï¸ KhÃ´ng Ä‘á»§ fields trong owning_profile (chá»‰ cÃ³ {len(owning_profile_data)} fields)")
            else:
                print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y closing brace tÆ°Æ¡ng á»©ng (brace_count: {brace_count})")
        else:
            print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y pattern 'owning_profile':{{")
            # Debug: Kiá»ƒm tra xem cÃ³ chuá»—i owning_profile khÃ´ng
            if '"owning_profile"' in html_content or "'owning_profile'" in html_content:
                print(f"   ðŸ” TÃ¬m tháº¥y chuá»—i 'owning_profile' trong HTML nhÆ°ng khÃ´ng match pattern")
                # TÃ¬m context xung quanh
                idx = html_content.find('owning_profile')
                if idx != -1:
                    context = html_content[max(0, idx-50):min(len(html_content), idx+200)]
                    print(f"   ðŸ“‹ Context: {context[:200]}...")
            else:
                print(f"   ðŸ” KhÃ´ng tÃ¬m tháº¥y chuá»—i 'owning_profile' trong HTML")
                # CÃ³ thá»ƒ HTML Ä‘Æ°á»£c minify, thá»­ tÃ¬m trong JSON blocks
                # Facebook thÆ°á»ng embed JSON trong script tags
                script_tags = re.findall(r'<script[^>]*>(.*?)</script>', html_content, re.DOTALL)
                print(f"   ðŸ” TÃ¬m tháº¥y {len(script_tags)} script tags, Ä‘ang tÃ¬m trong Ä‘Ã³...")
                for i, script_content in enumerate(script_tags[:5]):  # Chá»‰ check 5 script Ä‘áº§u tiÃªn
                    if 'owning_profile' in script_content:
                        print(f"   âœ… TÃ¬m tháº¥y 'owning_profile' trong script tag #{i+1}")
                        # TÃ¬m trong script nÃ y
                        match = re.search(r'"owning_profile"\s*:\s*\{', script_content)
                        if match:
                            print(f"      âœ… Match pattern trong script tag!")
                            # Extract tá»« script content
                            start_pos = match.end()
                            brace_count = 1
                            end_pos = start_pos
                            while end_pos < len(script_content) and brace_count > 0:
                                if script_content[end_pos] == '{':
                                    brace_count += 1
                                elif script_content[end_pos] == '}':
                                    brace_count -= 1
                                end_pos += 1
                            
                            if brace_count == 0:
                                block_content = script_content[start_pos:end_pos-1]
                                owning_profile_data = {}
                                
                                typename_match = re.search(r'"__typename"\s*:\s*"([^"]+)"', block_content)
                                if typename_match:
                                    owning_profile_data["__typename"] = typename_match.group(1)
                                
                                name_match = re.search(r'"name"\s*:\s*"([^"]+)"', block_content)
                                if name_match:
                                    owning_profile_data["name"] = name_match.group(1)
                                
                                id_match = re.search(r'"id"\s*:\s*"([^"]+)"', block_content)
                                if id_match:
                                    owning_profile_data["id"] = id_match.group(1)
                                
                                if len(owning_profile_data) >= 2:
                                    owning_profile = owning_profile_data
                                    print(f"      âœ… ÄÃ£ extract owning_profile tá»« script tag!")
                                    break
        
        # Decode Unicode escape sequences trong owning_profile name náº¿u cÃ³
        if owning_profile and "name" in owning_profile:
            name = owning_profile['name']
            if isinstance(name, str) and '\\u' in name:
                try:
                    name = json.loads(f'"{name}"')
                    owning_profile['name'] = name
                except:
                    try:
                        name = codecs.decode(name, 'unicode_escape')
                        owning_profile['name'] = name
                    except:
                        pass

        # ===== Láº¤Y Ná»˜I DUNG BÃ€I POST =====
        post_text = None

        # Æ¯u tiÃªn láº¥y ná»™i dung trong block story_message (ná»™i dung bÃ i post)
        content_html = None

        story_match = re.search(
            r'data-ad-rendering-role="story_message"[^>]*>(.*?)</div></div></div>',
            html_content,
            re.DOTALL,
        )
        if story_match:
            content_html = story_match.group(1)
            print("âœ… TÃ¬m tháº¥y block story_message Ä‘á»ƒ trÃ­ch ná»™i dung bÃ i post")
        else:
            # Fallback: dÃ¹ng má»™t pháº§n Ä‘áº§u HTML
            content_html = html_content[:500_000]
            print("âš ï¸ KhÃ´ng tÃ¬m tháº¥y block story_message, dÃ¹ng fallback (500KB Ä‘áº§u HTML)")

        # Thay <img ... alt="..."> báº±ng chÃ­nh alt (Ä‘á»ƒ giá»¯ emoji/text)
        def _img_alt_to_text(m):
            alt_text = m.group(1) or ""
            return f" {alt_text} "

        content_html = re.sub(
            r'<img[^>]*alt="([^"]*)"[^>]*>',
            _img_alt_to_text,
            content_html,
            flags=re.IGNORECASE,
        )

        # Bá» toÃ n bá»™ tag HTML cÃ²n láº¡i
        text_raw = re.sub(r"<[^>]*>", " ", content_html)
        # Chuáº©n hÃ³a khoáº£ng tráº¯ng
        text_clean = re.sub(r"\s+", " ", text_raw).strip()

        if text_clean:
            post_text = text_clean
            preview = post_text[:400] + "..." if len(post_text) > 400 else post_text
            print(f"âœ… Post text (preview): {preview}")
        else:
            print("âš ï¸ KhÃ´ng trÃ­ch Ä‘Æ°á»£c ná»™i dung bÃ i post tá»« HTML")

        return post_id, owning_profile, post_text
            
    except Exception as e:
        print(f"âŒ Lá»—i khi láº¥y HTML source: {e}")
        import traceback
        traceback.print_exc()
        return None, None


def get_page_id_from_html(url, profile_id, cookies=None):
    """
    Láº¥y page_id tá»« HTML source cá»§a trang (view-source)
    Sá»­ dá»¥ng cookies Ä‘á»ƒ má»Ÿ nhÆ° trÃ¬nh duyá»‡t bÃ¬nh thÆ°á»ng
    
    Args:
        url (str): URL cá»§a Facebook page/group
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y cookies
        cookies (str, optional): Cookie string (náº¿u Ä‘Ã£ cÃ³ sáºµn)
        
    Returns:
        str: page_id Ä‘áº§u tiÃªn tÃ¬m tháº¥y hoáº·c None
    """
    get_cookies_by_profile_id = _import_get_cookies_by_profile_id()

    # âœ… Æ¯u tiÃªn tuyá»‡t Ä‘á»‘i: náº¿u URL Ä‘Ã£ cÃ³ numeric group_id thÃ¬ tráº£ vá» luÃ´n (á»•n Ä‘á»‹nh nháº¥t)
    try:
        m_url = re.search(r"/groups/(\d+)", str(url or ""))
        if m_url:
            return m_url.group(1)
    except Exception:
        pass
    
    # Láº¥y cookies náº¿u chÆ°a cÃ³
    if cookies is None:
        cookies = get_cookies_by_profile_id(profile_id)
        if not cookies:
            print(f"âŒ KhÃ´ng thá»ƒ láº¥y cookies tá»« profile_id: {profile_id}")
            return None
    
    try:
        # Táº¡o session Ä‘á»ƒ quáº£n lÃ½ cookies tá»‘t hÆ¡n (nhÆ° trÃ¬nh duyá»‡t)
        session = requests.Session()
        
        # Parse cookies string thÃ nh dict vÃ  thÃªm vÃ o session
        if cookies:
            cookies_dict = {}
            for cookie_pair in cookies.split(';'):
                cookie_pair = cookie_pair.strip()
                if '=' in cookie_pair:
                    key, value = cookie_pair.split('=', 1)
                    cookies_dict[key.strip()] = value.strip()
            session.cookies.update(cookies_dict)
        
        # Headers cho GET request (giá»‘ng trÃ¬nh duyá»‡t, CHá»ˆ gzip/deflate Ä‘á»ƒ trÃ¡nh lá»—i brotli trÃªn mÃ¡y thiáº¿u thÆ° viá»‡n)
        get_headers = {
            "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",
            "accept-encoding": "gzip, deflate",
            "accept-language": "en,vi;q=0.9,en-US;q=0.8",
            "referer": "https://www.facebook.com/",
            "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
            "sec-ch-ua-mobile": "?0",
            "sec-ch-ua-platform": '"Windows"',
            "sec-fetch-dest": "document",
            "sec-fetch-mode": "navigate",
            "sec-fetch-site": "same-origin",
            "upgrade-insecure-requests": "1",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
        }
        
        # Láº¥y HTML source trá»±c tiáº¿p (view-source) vá»›i cookies
        print(f"ðŸŒ Láº¥y HTML source (view-source) trá»±c tiáº¿p tá»«: {url}")
        response = session.get(url, headers=get_headers)
        
        if response.status_code != 200:
            return None

        # âœ… Náº¿u Facebook redirect sang URL cÃ³ /groups/<id> thÃ¬ Æ°u tiÃªn láº¥y luÃ´n tá»« response.url
        try:
            m_final = re.search(r"/groups/(\d+)", str(getattr(response, "url", "") or ""))
            if m_final:
                return m_final.group(1)
        except Exception:
            pass
        
        html_content = response.text
        
        # ===== Æ¯U TIÃŠN Láº¤Y "GROUP ID" (trÃ¡nh nháº·t nháº§m page_id khÃ¡c trong HTML) =====
        # 1) CÃ¡c pattern ráº¥t Ä‘áº·c hiá»‡u cho group
        group_specific_patterns = [
            # page_id_type = group (Æ°u tiÃªn)
            r'"page_id"\s*:\s*"(\d+)"\s*,\s*"page_id_type"\s*:\s*"group"',
            r'"page_id_type"\s*:\s*"group"\s*,\s*"page_id"\s*:\s*"(\d+)"',
            # groupID/group_id
            r'"groupID"\s*:\s*"(\d+)"',
            r'"group_id"\s*:\s*"(\d+)"',
        ]
        for pat in group_specific_patterns:
            m = re.search(pat, html_content, flags=re.IGNORECASE)
            if m:
                return m.group(1)

        # 2) Náº¿u HTML cÃ³ /groups/<id> thÃ¬ Æ°u tiÃªn ID xuáº¥t hiá»‡n nhiá»u nháº¥t (trÃ¡nh dÃ­nh 1 ID cá»‘ Ä‘á»‹nh á»Ÿ header)
        try:
            group_ids = re.findall(r"/groups/(\d+)", html_content, flags=re.IGNORECASE)
            if group_ids:
                # chá»n ID phá»• biáº¿n nháº¥t
                freq: dict[str, int] = {}
                for gid in group_ids:
                    freq[gid] = freq.get(gid, 0) + 1
                group_ids_sorted = sorted(freq.items(), key=lambda x: x[1], reverse=True)
                return group_ids_sorted[0][0]
        except Exception:
            pass

        # 3) Fallback cuá»‘i: tÃ¬m page_id nhÆ°ng chá»n cÃ¡i cÃ³ táº§n suáº¥t cao nháº¥t (Ä‘á»¡ nháº·t "cÃ¡i Ä‘áº§u tiÃªn")
        try:
            candidates: list[str] = []
            for pat in [
                r'"page_id"\s*:\s*"(\d+)"',
                r'page_id["\']\s*:\s*["\'](\d+)',
                r'page_id=(\d+)',
                r'data-page-id="(\d+)"',
                r'"pageID"\s*:\s*"(\d+)"',
            ]:
                candidates.extend(re.findall(pat, html_content, flags=re.IGNORECASE) or [])
            if candidates:
                freq2: dict[str, int] = {}
                for cid in candidates:
                    freq2[cid] = freq2.get(cid, 0) + 1
                cand_sorted = sorted(freq2.items(), key=lambda x: x[1], reverse=True)
                return cand_sorted[0][0]
        except Exception:
            pass

        return None
            
    except Exception:
        return None


def get_id_from_url(url, profile_id):
    """
    HÃ m tá»•ng há»£p tá»± Ä‘á»™ng phÃ¡t hiá»‡n loáº¡i URL vÃ  láº¥y page_id hoáº·c post_id tÆ°Æ¡ng á»©ng
    Sá»­ dá»¥ng HTML source (view-source) vá»›i cookies Ä‘á»ƒ má»Ÿ nhÆ° trÃ¬nh duyá»‡t bÃ¬nh thÆ°á»ng
    
    Logic:
    - Náº¿u URL chá»©a "group" â†’ lÃ  group (chá»‰ láº¥y page_id)
    - CÃ²n láº¡i táº¥t cáº£ â†’ lÃ  post (láº¥y post_id vÃ  owning_profile)
    
    Args:
        url (str): URL cá»§a Facebook (cÃ³ thá»ƒ lÃ  group hoáº·c post)
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y cookies
        
    Returns:
        dict: {
            "page_id": str hoáº·c None,
            "post_id": str hoáº·c None,
            "owning_profile": dict hoáº·c None,
            "url_type": str ("group" hoáº·c "post")
        }
    """
    get_cookies_by_profile_id = _import_get_cookies_by_profile_id()
    
    # Load cookies má»™t láº§n duy nháº¥t
    cookies = get_cookies_by_profile_id(profile_id)
    
    if not cookies:
        print(f"âŒ KhÃ´ng thá»ƒ láº¥y cookies tá»« profile_id: {profile_id}")
        return {
            "page_id": None,
            "post_id": None,
            "owning_profile": None,
            "url_type": "post"
        }
    
    url_lower = url.lower()
    result = {
        "page_id": None,
        "post_id": None,
        "owning_profile": None,
        "url_type": "post"  # Máº·c Ä‘á»‹nh lÃ  post
    }
    
    # PhÃ¡t hiá»‡n loáº¡i URL: náº¿u cÃ³ "group" trong URL â†’ lÃ  group
    if "group" in url_lower:
        result["url_type"] = "group"
        page_id = get_page_id_from_html(url, profile_id, cookies)
        result["page_id"] = page_id
        if page_id:
            print(f"page_id: {page_id}")
        return result
    else:
        # Táº¥t cáº£ cÃ¡c URL khÃ¡c Ä‘á»u lÃ  post
        result["url_type"] = "post"
        
        # Láº¥y post_id, owning_profile vÃ  post_text tá»« HTML source (vá»›i cookies)
        post_id, owning_profile, post_text = get_post_id(url, profile_id, cookies)
        
        result["post_id"] = post_id
        result["owning_profile"] = owning_profile
        result["post_text"] = post_text
        
        # In káº¿t quáº£ cuá»‘i cÃ¹ng
        if post_id:
            print(f"post_id: {post_id}")
        
        if owning_profile:
            owning_profile_typename = owning_profile.get("__typename")
            owning_profile_name = owning_profile.get("name")
            owning_profile_id = owning_profile.get("id")
            
            if owning_profile_typename:
                print(f"owning_profile.__typename: {owning_profile_typename}")
            if owning_profile_name:
                print(f"owning_profile.name: {owning_profile_name}")
            if owning_profile_id:
                print(f"owning_profile.id: {owning_profile_id}")

        if post_text:
            preview = post_text[:200] + "..." if len(post_text) > 200 else post_text
            print(f"post_text: {preview}")
        
        return result


if __name__ == "__main__":
    # VÃ­ dá»¥ sá»­ dá»¥ng hÃ m get_id_from_url (tá»•ng há»£p)
    profile_id = "621e1f5d-0c42-481e-9ddd-7abaafce68ed"
    
    # Test vá»›i group URL
    # group_url = "https://www.facebook.com/groups/987870664956102/"
    # result = get_id_from_url(group_url, profile_id)
    
    # Test vá»›i video/post URL
    url = "https://www.facebook.com/122217299666284213"
    result = get_id_from_url(url, profile_id)
    print("heLLO" ,result)
--- END FILE: backend\worker\get_id.py ---

--- START FILE: backend\worker\get_payload.py ---
import requests
import re
import json
from pathlib import Path

# ====== ÄÆ¯á»œNG DáºªN THEO PROJECT ROOT ======
BASE_DIR = Path(__file__).resolve().parents[2]  # ThÆ° má»¥c gá»‘c project
SETTINGS_JSON_FILE = BASE_DIR / "backend" / "config" / "settings.json"
PAYLOAD_TXT_FILE = BASE_DIR / "backend" / "config" / "payload.txt"


def _normalize_cookie(cookie: str | None) -> str | None:
    if cookie is None:
        return None
    cookie = str(cookie).strip()
    if not cookie:
        return None
    # Loáº¡i bá» kÃ½ tá»± xuá»‘ng dÃ²ng vÃ  khoáº£ng tráº¯ng thá»«a
    return " ".join(cookie.split())


def _read_settings_profile_config(profile_id: str) -> dict | None:
    """
    Äá»c PROFILE_IDS[profile_id] tá»« backend/config/settings.json.
    Tráº£ vá» dict config hoáº·c None náº¿u khÃ´ng cÃ³.
    """
    try:
        if not SETTINGS_JSON_FILE.exists():
            return None
        with open(SETTINGS_JSON_FILE, "r", encoding="utf-8") as f:
            raw = json.load(f)
        profiles = raw.get("PROFILE_IDS")
        if not isinstance(profiles, dict):
            return None
        cfg = profiles.get(profile_id)
        return cfg if isinstance(cfg, dict) else None
    except Exception:
        return None


def get_cookies_by_profile_id(profile_id):
    """
    Láº¥y cookies theo profile_id.

    Æ¯u tiÃªn Ä‘á»c tá»« backend/config/settings.json:
      PROFILE_IDS[profile_id].cookie
    
    Args:
        profile_id (str): Profile ID (vÃ­ dá»¥: "031ca13d-e8fa-400c-a603-df57a2806788")
    
    Returns:
        str: Cookie string hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    # 1) Æ¯U TIÃŠN: settings.json
    cfg = _read_settings_profile_config(profile_id)
    if cfg is not None:
        cookie = _normalize_cookie(cfg.get("cookie"))
        if cookie:
            return cookie

    print(f"âŒ KhÃ´ng tÃ¬m tháº¥y cookie trong {SETTINGS_JSON_FILE} cho profile_id='{profile_id}'")
    return None


def get_access_token_by_profile_id(profile_id):
    """
    Láº¥y access_token theo profile_id.

    Æ¯u tiÃªn Ä‘á»c tá»« backend/config/settings.json:
      PROFILE_IDS[profile_id].access_token
    
    Args:
        profile_id (str): Profile ID (vÃ­ dá»¥: "031ca13d-e8fa-400c-a603-df57a2806788")
    
    Returns:
        str: Access token hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    # 1) Æ¯U TIÃŠN: settings.json
    cfg = _read_settings_profile_config(profile_id)
    if cfg is not None:
        access_token = str(cfg.get("access_token") or "").strip()
        if access_token:
            return access_token

    print(f"âŒ KhÃ´ng tÃ¬m tháº¥y access_token trong {SETTINGS_JSON_FILE} cho profile_id='{profile_id}'")
    return None


def get_base_headers(cookie):
    """
    Táº¡o headers vá»›i cookie Ä‘Æ°á»£c truyá»n vÃ o
    
    Args:
        cookie (str): Cookie string
    
    Returns:
        dict: Headers dictionary
    """
    return {
        "accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8",
        "accept-encoding": "gzip, deflate, br",
        "accept-language": "en,vi;q=0.9,en-US;q=0.8",
        "cookie": cookie,
        "referer": "https://www.facebook.com/",
        "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": '"Windows"',
        "sec-fetch-dest": "document",
        "sec-fetch-mode": "navigate",
        "sec-fetch-site": "same-origin",
        "upgrade-insecure-requests": "1",
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
    }


def get_c_user(cookie):
    """
    Láº¥y c_user tá»« cookie
    
    Args:
        cookie (str): Cookie string
    
    Returns:
        str: GiÃ¡ trá»‹ c_user hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    try:
        match = re.search(r'c_user=(\d+)', cookie)
        if match:
            return match.group(1)
        return None
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi láº¥y c_user: {e}")
        return None


def get_jazoest(fb_dtsg):
    """
    TÃ­nh jazoest tá»« fb_dtsg
    
    Args:
        fb_dtsg (str): GiÃ¡ trá»‹ fb_dtsg
    
    Returns:
        str: GiÃ¡ trá»‹ jazoest
    """
    if not fb_dtsg:
        return None
    jazoest = str(sum(ord(c) for c in fb_dtsg))
    return jazoest


def get_lsd(html):
    """
    Láº¥y lsd tá»« HTML
    
    Args:
        html (str): HTML content
    
    Returns:
        str: GiÃ¡ trá»‹ lsd hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    try:
        match = re.search(r'"LSD",\[\],{"token":"(.*?)"}', html)
        if match:
            return match.group(1)
        return None
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi láº¥y lsd: {e}")
        return None


def get_spin_r(html):
    """
    Láº¥y __spin_r tá»« HTML
    
    Args:
        html (str): HTML content
    
    Returns:
        str: GiÃ¡ trá»‹ __spin_r hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    try:
        match = re.search(r'"__spin_r":(\d+)', html)
        if match:
            return match.group(1)
        return None
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi láº¥y __spin_r: {e}")
        return None


def get_spin_t(html):
    """
    Láº¥y __spin_t tá»« HTML
    
    Args:
        html (str): HTML content
    
    Returns:
        str: GiÃ¡ trá»‹ __spin_t hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    try:
        match = re.search(r'"__spin_t":(\d+)', html)
        if match:
            return match.group(1)
        return None
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi láº¥y __spin_t: {e}")
        return None


def get_fb_dtsg(cookie):
    """
    Láº¥y fb_dtsg tá»« Facebook.com
    
    Args:
        cookie (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng
    
    Returns:
        str: GiÃ¡ trá»‹ fb_dtsg hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    url = "https://www.facebook.com"
    
    print(f"\nðŸš€ Äang GET request tá»«: {url}")
    
    try:
        # Táº¡o headers vá»›i cookie
        headers = get_base_headers(cookie)
        
        # GET request vá»›i cookies vÃ  headers
        response = requests.get(url, headers=headers)
        
        print(f"ðŸ“Š Status Code: {response.status_code}")
        
        if response.status_code != 200:
            print(f"âŒ Lá»—i: Status code {response.status_code}")
            print(f"Response text: {response.text[:500]}")
            return None
        
        html_content = response.text
        print(f"ðŸ“„ ÄÃ£ láº¥y HTML content ({len(html_content)} kÃ½ tá»±)")
        
        # Danh sÃ¡ch cÃ¡c pattern Ä‘á»ƒ tÃ¬m fb_dtsg
        patterns = [
            r'"name":"fb_dtsg","value":"([^"]+)"',      # Pattern gá»‘c
            r'"token":"([^"]+)","type":"fb_dtsg"',       # Token vá»›i type fb_dtsg
            r'"fb_dtsg"\s*:\s*"([^"]+)"',               # "fb_dtsg": "value"
            r'name="fb_dtsg"\s+value="([^"]+)"',        # name="fb_dtsg" value="value"
            r'DTSGInitData.*?"token":"([^"]+)"'          # DTSGInitData vá»›i token
        ]
        
        # Thá»­ tá»«ng pattern
        for i, pattern in enumerate(patterns, 1):
            match = re.search(pattern, html_content)
            if match:
                fb_dtsg = match.group(1)
                print(f"âœ… TÃ¬m tháº¥y fb_dtsg vá»›i pattern {i}: {fb_dtsg[:50]}...")
                return fb_dtsg
        
        # KhÃ´ng tÃ¬m tháº¥y vá»›i báº¥t ká»³ pattern nÃ o
        print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y fb_dtsg vá»›i {len(patterns)} patterns")
        return None
            
    except Exception as e:
        print(f"âŒ Lá»—i khi láº¥y fb_dtsg: {e}")
        import traceback
        traceback.print_exc()
        return None


def get_all_payload_values(cookie):
    """
    Láº¥y táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ payload tá»« Facebook.com
    
    Args:
        cookie (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng
    
    Returns:
        dict: Dictionary chá»©a c_user, av, __user, fb_dtsg, jazoest, lsd, spin_r, spin_t hoáº·c None náº¿u lá»—i
    """
    url = "https://www.facebook.com"
    
    print(f"\nðŸš€ Äang GET request tá»«: {url}")
    
    try:
        # Láº¥y c_user tá»« cookie
        c_user = get_c_user(cookie)
        if c_user:
            print(f"âœ… TÃ¬m tháº¥y c_user: {c_user}")
        else:
            print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y c_user trong cookie")
        
        # Táº¡o headers vá»›i cookie
        headers = get_base_headers(cookie)
        
        # GET request vá»›i cookies vÃ  headers
        response = requests.get(url, headers=headers)
        
        print(f"ðŸ“Š Status Code: {response.status_code}")
        
        if response.status_code != 200:
            print(f"âŒ Lá»—i: Status code {response.status_code}")
            print(f"Response text: {response.text[:500]}")
            return None
        
        html_content = response.text
        print(f"ðŸ“„ ÄÃ£ láº¥y HTML content ({len(html_content)} kÃ½ tá»±)")
        
        # Láº¥y fb_dtsg
        patterns = [
            r'"name":"fb_dtsg","value":"([^"]+)"',      # Pattern gá»‘c
            r'"token":"([^"]+)","type":"fb_dtsg"',       # Token vá»›i type fb_dtsg
            r'"fb_dtsg"\s*:\s*"([^"]+)"',               # "fb_dtsg": "value"
            r'name="fb_dtsg"\s+value="([^"]+)"',        # name="fb_dtsg" value="value"
            r'DTSGInitData.*?"token":"([^"]+)"'          # DTSGInitData vá»›i token
        ]
        
        fb_dtsg = None
        for i, pattern in enumerate(patterns, 1):
            match = re.search(pattern, html_content)
            if match:
                fb_dtsg = match.group(1)
                print(f"âœ… TÃ¬m tháº¥y fb_dtsg vá»›i pattern {i}: {fb_dtsg[:50]}...")
                break
        
        if not fb_dtsg:
            print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y fb_dtsg vá»›i {len(patterns)} patterns")
            return None
        
        # TÃ­nh jazoest tá»« fb_dtsg
        jazoest = get_jazoest(fb_dtsg)
        print(f"âœ… TÃ­nh Ä‘Æ°á»£c jazoest: {jazoest}")
        
        # Láº¥y lsd
        lsd = get_lsd(html_content)
        if lsd:
            print(f"âœ… TÃ¬m tháº¥y lsd: {lsd[:30]}...")
        else:
            print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y lsd")
        
        # Láº¥y spin_r
        spin_r = get_spin_r(html_content)
        if spin_r:
            print(f"âœ… TÃ¬m tháº¥y __spin_r: {spin_r}")
        else:
            print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y __spin_r")
        
        # Láº¥y spin_t
        spin_t = get_spin_t(html_content)
        if spin_t:
            print(f"âœ… TÃ¬m tháº¥y __spin_t: {spin_t}")
        else:
            print(f"âš ï¸ KhÃ´ng tÃ¬m tháº¥y __spin_t")
        
        result = {
            "c_user": c_user,
            "av": c_user,  # av giá»‘ng vá»›i c_user
            "__user": c_user,  # __user giá»‘ng vá»›i c_user
            "fb_dtsg": fb_dtsg,
            "jazoest": jazoest,
            "lsd": lsd,
            "spin_r": spin_r,
            "spin_t": spin_t
        }
        
        return result
            
    except Exception as e:
        print(f"âŒ Lá»—i khi láº¥y payload values: {e}")
        import traceback
        traceback.print_exc()
        return None


def create_payload_dict(payload_values):
    """
    Táº¡o payload dictionary tá»« payload.txt vÃ  payload_values
    
    Args:
        payload_values (dict): Dictionary chá»©a cÃ¡c giÃ¡ trá»‹ Ä‘á»™ng (fb_dtsg, jazoest, lsd, etc.)
    
    Returns:
        dict: Payload dictionary hoÃ n chá»‰nh
    """
    try:
        # Äá»c file payload.txt
        with open(PAYLOAD_TXT_FILE, "r", encoding="utf-8") as f:
            content = f.read().strip()
        
        # Parse tá»«ng dÃ²ng key: value
        payload_dict = {}
        for line in content.split('\n'):
            line = line.strip()
            if not line or not ':' in line:
                continue
            
            # TÃ¡ch key vÃ  value
            parts = line.split(':', 1)
            if len(parts) == 2:
                key = parts[0].strip().replace('"', '').replace("'", '')
                value = parts[1].strip().replace('"', '').replace("'", '').rstrip(',').strip()
                if key and value:
                    payload_dict[key] = value
        
        # Cáº­p nháº­t cÃ¡c giÃ¡ trá»‹ Ä‘á»™ng tá»« payload_values
        if payload_values.get('c_user'):
            payload_dict['av'] = payload_values['c_user']
            payload_dict['__user'] = payload_values['c_user']
        
        if payload_values.get('fb_dtsg'):
            payload_dict['fb_dtsg'] = payload_values['fb_dtsg']
        
        if payload_values.get('jazoest'):
            payload_dict['jazoest'] = payload_values['jazoest']
        
        if payload_values.get('lsd'):
            payload_dict['lsd'] = payload_values['lsd']
        
        if payload_values.get('spin_r'):
            payload_dict['__spin_r'] = payload_values['spin_r']
        
        if payload_values.get('spin_t'):
            payload_dict['__spin_t'] = payload_values['spin_t']
        
        print(f"âœ… ÄÃ£ táº¡o payload dictionary vá»›i {len(payload_dict)} keys")
        return payload_dict
        
    except FileNotFoundError:
        print(f"âŒ KhÃ´ng tÃ¬m tháº¥y file {PAYLOAD_TXT_FILE}!")
        return None
    except Exception as e:
        print(f"âŒ Lá»—i khi táº¡o payload dict: {e}")
        return None


def get_payload_by_profile_id(profile_id):
    """
    Láº¥y payload dictionary dá»±a trÃªn profile_id
    
    Args:
        profile_id (str): Profile ID (vÃ­ dá»¥: "031ca13d-e8fa-400c-a603-df57a2806788")
    
    Returns:
        dict: Payload dictionary hoÃ n chá»‰nh hoáº·c None náº¿u lá»—i
    """
    # Láº¥y cookies tá»« profile_id
    cookie = get_cookies_by_profile_id(profile_id)
    if not cookie:
        return None
    
    # Láº¥y payload values tá»« Facebook
    payload_values = get_all_payload_values(cookie)
    if not payload_values:
        return None
    
    # Táº¡o payload dict tá»« payload.txt vÃ  payload_values
    payload_dict = create_payload_dict(payload_values)
    return payload_dict


def update_payload_file(payload_values):
    """
    Cáº­p nháº­t file payload.txt vá»›i cÃ¡c giÃ¡ trá»‹ má»›i
    
    Args:
        payload_values (dict): Dictionary chá»©a cÃ¡c giÃ¡ trá»‹ cáº§n cáº­p nháº­t
            - c_user: GiÃ¡ trá»‹ c_user (sáº½ thay cho av vÃ  __user)
            - fb_dtsg: GiÃ¡ trá»‹ fb_dtsg
            - jazoest: GiÃ¡ trá»‹ jazoest
            - lsd: GiÃ¡ trá»‹ lsd
            - spin_r: GiÃ¡ trá»‹ __spin_r
            - spin_t: GiÃ¡ trá»‹ __spin_t
    
    Returns:
        bool: True náº¿u thÃ nh cÃ´ng, False náº¿u lá»—i
    """
    PAYLOAD_FILE = "backend/config/payload.txt"
    
    try:
        # Äá»c file payload hiá»‡n táº¡i
        with open(PAYLOAD_FILE, "r", encoding="utf-8") as f:
            lines = f.readlines()
        
        # Cáº­p nháº­t cÃ¡c giÃ¡ trá»‹
        updated_lines = []
        for line in lines:
            original_line = line
            
            # Cáº­p nháº­t av vÃ  __user náº¿u cÃ³ c_user
            if payload_values.get('c_user'):
                if line.strip().startswith('"av":'):
                    line = f'"av": "{payload_values["c_user"]}",\n'
                elif line.strip().startswith('"__user":'):
                    line = f'"__user": "{payload_values["c_user"]}",\n'
            
            # Cáº­p nháº­t fb_dtsg
            if payload_values.get('fb_dtsg') and line.strip().startswith('"fb_dtsg":'):
                line = f'"fb_dtsg": "{payload_values["fb_dtsg"]}",\n'
            
            # Cáº­p nháº­t jazoest
            if payload_values.get('jazoest') and line.strip().startswith('"jazoest":'):
                line = f'"jazoest": "{payload_values["jazoest"]}",\n'
            
            # Cáº­p nháº­t lsd
            if payload_values.get('lsd') and line.strip().startswith('"lsd":'):
                line = f'"lsd": "{payload_values["lsd"]}",\n'
            
            # Cáº­p nháº­t __spin_r
            if payload_values.get('spin_r') and line.strip().startswith('"__spin_r":'):
                line = f'"__spin_r": "{payload_values["spin_r"]}",\n'
            
            # Cáº­p nháº­t __spin_t
            if payload_values.get('spin_t') and line.strip().startswith('"__spin_t":'):
                line = f'"__spin_t": "{payload_values["spin_t"]}",\n'
            
            updated_lines.append(line)
        
        # Ghi láº¡i file
        with open(PAYLOAD_FILE, "w", encoding="utf-8") as f:
            f.writelines(updated_lines)
        
        print(f"âœ… ÄÃ£ cáº­p nháº­t file {PAYLOAD_FILE}")
        return True
        
    except Exception as e:
        print(f"âŒ Lá»—i khi cáº­p nháº­t file payload: {e}")
        import traceback
        traceback.print_exc()
        return False


if __name__ == "__main__":
    # VÃ­ dá»¥ sá»­ dá»¥ng vá»›i profile_id
    profile_id = "031ca13d-e8fa-400c-a603-df57a2806788"
    payload_dict = get_payload_by_profile_id(profile_id)
    
    if payload_dict:
        print(f"\nðŸ“‹ Payload dictionary Ä‘Ã£ táº¡o thÃ nh cÃ´ng!")
        print(f"   Sá»‘ lÆ°á»£ng keys: {len(payload_dict)}")
        print(f"   Sample keys: {list(payload_dict.keys())[:5]}")
    else:
        print(f"\nâŒ KhÃ´ng thá»ƒ táº¡o payload dictionary")


--- END FILE: backend\worker\get_payload.py ---

--- START FILE: backend\worker\get_post_from_page.py ---
import requests
import json
from pathlib import Path
from datetime import datetime, timezone, timedelta
from urllib.parse import urlparse, parse_qs

# ====== LÆ¯U Ã ======
# Láº¥y access_token tá»« cookies.json thÃ´ng qua profile_id
# Sá»­ dá»¥ng get_payload.get_access_token_by_profile_id(profile_id) Ä‘á»ƒ láº¥y access_token


def get_access_token_by_profile_id(profile_id):
    """
    Láº¥y access_token tá»« cookies.json dá»±a trÃªn profile_id
    
    Args:
        profile_id (str): Profile ID (vÃ­ dá»¥: "031ca13d-e8fa-400c-a603-df57a2806788")
    
    Returns:
        str: Access token hoáº·c None náº¿u khÃ´ng tÃ¬m tháº¥y
    """
    from get_payload import get_access_token_by_profile_id as get_token
    return get_token(profile_id)


def parse_datetime_string(dt_string):
    """
    Parse datetime string tá»« Facebook API (format: "2025-12-14T17:58:05+0000")
    
    Args:
        dt_string (str): Datetime string tá»« Facebook API
        
    Returns:
        datetime: Datetime object hoáº·c None náº¿u parse lá»—i
    """
    try:
        # Format: "2025-12-14T17:58:05+0000"
        # Chuyá»ƒn thÃ nh: "2025-12-14T17:58:05+00:00" Ä‘á»ƒ parse Ä‘Æ°á»£c
        if dt_string.endswith("+0000"):
            dt_string = dt_string.replace("+0000", "+00:00")
        elif dt_string.endswith("-0000"):
            dt_string = dt_string.replace("-0000", "-00:00")
        
        return datetime.fromisoformat(dt_string)
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi parse datetime '{dt_string}': {e}")
        return None


def convert_to_vietnam_datetime(dt_string):
    """
    Chuyá»ƒn Ä‘á»•i datetime string tá»« Facebook API sang ngÃ y thÃ¡ng nÄƒm theo mÃºi giá» Viá»‡t Nam (UTC+7)
    
    Args:
        dt_string (str): Datetime string tá»« Facebook API (format: "2025-12-14T17:58:05+0000")
        
    Returns:
        str: NgÃ y thÃ¡ng nÄƒm theo format "YYYY-MM-DD HH:MM:SS" (mÃºi giá» Viá»‡t Nam) hoáº·c None náº¿u lá»—i
    """
    try:
        # Parse datetime tá»« API (UTC)
        dt_utc = parse_datetime_string(dt_string)
        if not dt_utc:
            return None
        
        # Chuyá»ƒn sang mÃºi giá» Viá»‡t Nam (UTC+7)
        vietnam_tz = timezone(timedelta(hours=7))
        dt_vietnam = dt_utc.astimezone(vietnam_tz)
        
        # Format thÃ nh ngÃ y thÃ¡ng nÄƒm
        return dt_vietnam.strftime("%Y-%m-%d %H:%M:%S")
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi chuyá»ƒn Ä‘á»•i datetime '{dt_string}' sang giá» Viá»‡t Nam: {e}")
        return None


def parse_vietnam_datetime(date_str, is_end_of_day=False):
    """
    Parse ngÃ y thÃ¡ng nÄƒm theo mÃºi giá» Viá»‡t Nam (UTC+7) vÃ  chuyá»ƒn sang UTC
    
    Há»— trá»£ cÃ¡c format:
    - "2025-12-14" hoáº·c "2025/12/14"
    - "14-12-2025" hoáº·c "14/12/2025"
    - "2025-12-14 00:00:00" hoáº·c "2025-12-14 23:59:59"
    
    Args:
        date_str (str): Chuá»—i ngÃ y thÃ¡ng nÄƒm
        is_end_of_day (bool): Náº¿u True, Ä‘áº·t thá»i gian lÃ  23:59:59, náº¿u False lÃ  00:00:00
        
    Returns:
        tuple: (datetime_utc, datetime_string_for_api) hoáº·c (None, None) náº¿u lá»—i
    """
    try:
        # MÃºi giá» Viá»‡t Nam (UTC+7)
        vietnam_tz = timezone(timedelta(hours=7))
        
        # Loáº¡i bá» khoáº£ng tráº¯ng thá»«a
        date_str = date_str.strip()
        
        # Xá»­ lÃ½ cÃ¡c format khÃ¡c nhau
        dt = None
        
        # Format: "2025-12-14" hoáº·c "2025/12/14"
        if "-" in date_str or "/" in date_str:
            # Thay tháº¿ "/" báº±ng "-"
            date_str = date_str.replace("/", "-")
            
            # TÃ¡ch pháº§n ngÃ y vÃ  giá» (náº¿u cÃ³)
            parts = date_str.split()
            date_part = parts[0]
            time_part = parts[1] if len(parts) > 1 else None
            
            # Parse date part
            date_parts = date_part.split("-")
            
            if len(date_parts) == 3:
                # Kiá»ƒm tra format: YYYY-MM-DD hoáº·c DD-MM-YYYY
                if len(date_parts[0]) == 4:  # YYYY-MM-DD
                    year, month, day = date_parts
                else:  # DD-MM-YYYY
                    day, month, year = date_parts
                
                year = int(year)
                month = int(month)
                day = int(day)
                
                # Parse time part (náº¿u cÃ³)
                if time_part:
                    time_parts = time_part.split(":")
                    hour = int(time_parts[0])
                    minute = int(time_parts[1]) if len(time_parts) > 1 else 0
                    second = int(time_parts[2]) if len(time_parts) > 2 else 0
                else:
                    # Náº¿u khÃ´ng cÃ³ time, Ä‘áº·t theo is_end_of_day
                    if is_end_of_day:
                        hour, minute, second = 23, 59, 59
                    else:
                        hour, minute, second = 0, 0, 0
                
                # Táº¡o datetime vá»›i mÃºi giá» Viá»‡t Nam
                dt = datetime(year, month, day, hour, minute, second, tzinfo=vietnam_tz)
        
        # Náº¿u khÃ´ng parse Ä‘Æ°á»£c, thá»­ parse trá»±c tiáº¿p
        if dt is None:
            # Thá»­ parse vá»›i cÃ¡c format khÃ¡c
            formats = [
                "%Y-%m-%d",
                "%d-%m-%Y",
                "%Y/%m/%d",
                "%d/%m/%Y",
                "%Y-%m-%d %H:%M:%S",
                "%d-%m-%Y %H:%M:%S",
            ]
            
            for fmt in formats:
                try:
                    dt = datetime.strptime(date_str, fmt)
                    # ThÃªm mÃºi giá» Viá»‡t Nam
                    dt = dt.replace(tzinfo=vietnam_tz)
                    # Náº¿u khÃ´ng cÃ³ giá», Ä‘áº·t theo is_end_of_day
                    if "%H" not in fmt:
                        if is_end_of_day:
                            dt = dt.replace(hour=23, minute=59, second=59)
                        else:
                            dt = dt.replace(hour=0, minute=0, second=0)
                    break
                except ValueError:
                    continue
        
        if dt is None:
            raise ValueError(f"KhÃ´ng thá»ƒ parse date string: {date_str}")
        
        # Chuyá»ƒn sang UTC
        dt_utc = dt.astimezone(timezone.utc)
        
        # Format cho API: Unix timestamp hoáº·c ISO format
        # Sá»­ dá»¥ng Unix timestamp (dá»… dÃ ng hÆ¡n)
        unix_timestamp = str(int(dt_utc.timestamp()))
        
        return dt_utc, unix_timestamp
        
    except Exception as e:
        print(f"âš ï¸ Lá»—i khi parse Vietnam datetime '{date_str}': {e}")
        return None, None


def get_posts_from_page(page_id, profile_id, start_date=None, end_date=None, limit=None):
    """
    Láº¥y danh sÃ¡ch posts tá»« page/group qua Graph API vá»›i Ä‘iá»u kiá»‡n lá»c theo thá»i gian
    
    Args:
        page_id (str): Page ID hoáº·c Group ID
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y access_token
        start_date (str, required): NgÃ y báº¯t Ä‘áº§u theo mÃºi giá» Viá»‡t Nam (format: "2025-12-14" hoáº·c "14/12/2025")
        end_date (str, required): NgÃ y káº¿t thÃºc theo mÃºi giá» Viá»‡t Nam (format: "2025-12-14" hoáº·c "14/12/2025")
        limit (int, optional): Giá»›i háº¡n sá»‘ lÆ°á»£ng posts (None = khÃ´ng giá»›i háº¡n)
        
    Returns:
        list: Danh sÃ¡ch posts phÃ¹ há»£p Ä‘iá»u kiá»‡n thá»i gian [{"id": "...", "updated_time": "..."}, ...]
    """
    # Validate thá»i gian
    if not start_date or not end_date:
        print(f"âŒ Lá»—i: Cáº§n cung cáº¥p cáº£ start_date vÃ  end_date")
        return []
    
    # Láº¥y access_token
    access_token = get_access_token_by_profile_id(profile_id)
    if not access_token:
        print(f"âŒ KhÃ´ng thá»ƒ láº¥y access_token tá»« profile_id: {profile_id}")
        return []
    
    # Parse ngÃ y thÃ¡ng nÄƒm theo mÃºi giá» Viá»‡t Nam vÃ  chuyá»ƒn sang UTC
    start_dt, start_timestamp = parse_vietnam_datetime(start_date, is_end_of_day=False)
    end_dt, end_timestamp = parse_vietnam_datetime(end_date, is_end_of_day=True)
    
    if not start_dt or not end_dt:
        print(f"âŒ Lá»—i: KhÃ´ng thá»ƒ parse ngÃ y thÃ¡ng")
        return []
    
    # Validate: start_date pháº£i <= end_date
    if start_dt > end_dt:
        print(f"âŒ Lá»—i: start_date ({start_date}) pháº£i <= end_date ({end_date})")
        return []
    
    # Base URL cho Graph API
    base_url = f"https://graph.facebook.com/v24.0/{page_id}"
    
    # Parameters cho request (sá»­ dá»¥ng Unix timestamp)
    # Sá»­ dá»¥ng feed.limit(1000) Ä‘á»ƒ láº¥y nhiá»u posts má»—i trang (tá»‘i Ä‘a 1000)
    params = {
        "access_token": access_token,
        "fields": "feed.limit(1000){id,created_time}",
        "format": "json",
        "method": "get",
        "pretty": "0",
        "suppress_http_code": "1",
        "since": start_timestamp,  # Unix timestamp (UTC)
        "until": end_timestamp,     # Unix timestamp (UTC)
        "debug": "all",
        "origin_graph_explorer": "1",
        "transport": "cors"
    }
    
    all_posts = []
    next_url = None
    page_count = 0
    
    print(f"\nðŸš€ Báº¯t Ä‘áº§u láº¥y posts tá»« page_id: {page_id}")
    print(f"   ðŸ“… NgÃ y báº¯t Ä‘áº§u (VN): {start_date} â†’ UTC: {start_dt.strftime('%Y-%m-%d %H:%M:%S UTC')}")
    print(f"   ðŸ“… NgÃ y káº¿t thÃºc (VN): {end_date} â†’ UTC: {end_dt.strftime('%Y-%m-%d %H:%M:%S UTC')}")
    
    while True:
        # Gá»­i request
        if next_url:
            # Sá»­ dá»¥ng URL pagination tá»« response trÆ°á»›c
            url = next_url
            response = requests.get(url)
        else:
            # Request Ä‘áº§u tiÃªn
            url = base_url
            response = requests.get(url, params=params)
        
        page_count += 1
        print(f"\nðŸ“„ Trang {page_count}: {url[:100]}...")
        
        if response.status_code != 200:
            print(f"âŒ Lá»—i: Status code {response.status_code}")
            print(f"Response: {response.text[:500]}")
            break
        
        try:
            data = response.json()
            
            # Kiá»ƒm tra lá»—i tá»« API
            if "error" in data:
                print(f"âŒ Lá»—i tá»« API: {data['error']}")
                break
            
            # Láº¥y feed data
            feed_data = data.get("feed", {})
            posts = feed_data.get("data", [])
            
            if not posts:
                print(f"   â„¹ï¸ KhÃ´ng cÃ³ posts nÃ o trong trang nÃ y")
                break
            
            print(f"   ðŸ“‹ TÃ¬m tháº¥y {len(posts)} posts trong trang nÃ y")
            
            # Lá»c posts theo Ä‘iá»u kiá»‡n thá»i gian
            matched_count = 0
            for post in posts:
                post_id = post.get("id")
                created_time_str = post.get("created_time")
                
                if not post_id or not created_time_str:
                    continue
                
                # Parse created_time
                created_dt = parse_datetime_string(created_time_str)
                if not created_dt:
                    continue
                
                # Kiá»ƒm tra Ä‘iá»u kiá»‡n thá»i gian: start_time <= created_time <= end_time
                # Äáº£m báº£o created_time náº±m trong khoáº£ng [start_dt, end_dt]
                if start_dt <= created_dt <= end_dt:
                    # Chuyá»ƒn Ä‘á»•i sang ngÃ y thÃ¡ng nÄƒm theo mÃºi giá» Viá»‡t Nam
                    created_time_vn = convert_to_vietnam_datetime(created_time_str)
                    
                    all_posts.append({
                        "id": post_id,
                        "created_time": created_time_vn if created_time_vn else created_time_str
                    })
                    matched_count += 1
            
            print(f"   âœ… CÃ³ {matched_count} posts phÃ¹ há»£p Ä‘iá»u kiá»‡n trong trang nÃ y")
            
            # Kiá»ƒm tra limit
            if limit and len(all_posts) >= limit:
                print(f"   â¹ï¸ ÄÃ£ Ä‘áº¡t giá»›i háº¡n {limit} posts")
                all_posts = all_posts[:limit]
                break
            
            # Kiá»ƒm tra pagination
            paging = feed_data.get("paging", {})
            if "next" in paging:
                next_url = paging["next"]
            else:
                print(f"   â„¹ï¸ KhÃ´ng cÃ²n trang tiáº¿p theo")
                break
                
        except json.JSONDecodeError as e:
            print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡")
            print(f"Response text (500 kÃ½ tá»± Ä‘áº§u): {response.text[:500]}")
            break
        except Exception as e:
            print(f"âŒ Lá»—i khi xá»­ lÃ½ response: {e}")
            import traceback
            traceback.print_exc()
            break
    
    print(f"\nâœ… HoÃ n thÃ nh! Tá»•ng cá»™ng láº¥y Ä‘Æ°á»£c {len(all_posts)} posts phÃ¹ há»£p Ä‘iá»u kiá»‡n")
    return all_posts


def get_post_ids_from_page(page_id, profile_id, start_date=None, end_date=None, limit=None):
    """
    Láº¥y danh sÃ¡ch post IDs tá»« page/group (chá»‰ tráº£ vá» IDs, khÃ´ng cÃ³ thÃ´ng tin thá»i gian)
    
    Args:
        page_id (str): Page ID hoáº·c Group ID
        profile_id (str): Profile ID Ä‘á»ƒ láº¥y access_token
        start_date (str, required): NgÃ y báº¯t Ä‘áº§u theo mÃºi giá» Viá»‡t Nam (format: "2025-12-14" hoáº·c "14/12/2025")
        end_date (str, required): NgÃ y káº¿t thÃºc theo mÃºi giá» Viá»‡t Nam (format: "2025-12-14" hoáº·c "14/12/2025")
        limit (int, optional): Giá»›i háº¡n sá»‘ lÆ°á»£ng posts
        
    Returns:
        list: Danh sÃ¡ch post IDs (strings)
    """
    posts = get_posts_from_page(page_id, profile_id, start_date, end_date, limit)
    return [post["id"] for post in posts]


if __name__ == "__main__":
    import os
    
    # VÃ­ dá»¥ sá»­ dá»¥ng
    profile_id = "031ca13d-e8fa-400c-a603-df57a2806788"
    page_id = "987870664956102"
    
    # Láº¥y posts vá»›i Ä‘iá»u kiá»‡n thá»i gian (theo mÃºi giá» Viá»‡t Nam)
    start_date = "2025-12-8"  # NgÃ y báº¯t Ä‘áº§u (sáº½ tá»± Ä‘á»™ng Ä‘áº·t 00:00:00 VN = 17:00:00 UTC ngÃ y hÃ´m trÆ°á»›c)
    end_date = "2025-12-14"    # NgÃ y káº¿t thÃºc (sáº½ tá»± Ä‘á»™ng Ä‘áº·t 23:59:59 VN = 16:59:59 UTC ngÃ y hÃ´m sau)
    
    posts = get_posts_from_page(page_id, profile_id, start_date, end_date, limit=None)
    
    # In káº¿t quáº£
    print(f"\nðŸ“Š Káº¿t quáº£:")
    print(f"   Tá»•ng sá»‘ posts: {len(posts)}")
    if posts:
        print(f"   VÃ­ dá»¥ 5 posts Ä‘áº§u tiÃªn:")
        for post in posts[:5]:
            print(f"      - {post['id']} (created: {post['created_time']})")
    
    # LÆ°u ra file JSON (theo project root)
    base_dir = Path(__file__).resolve().parents[2]
    output_dir = base_dir / "backend" / "data"
    os.makedirs(output_dir, exist_ok=True)
    
    # Táº¡o tÃªn file dá»±a trÃªn page_id vÃ  ngÃ y
    filename = f"{page_id}_posts_{start_date.replace('/', '-')}_to_{end_date.replace('/', '-')}.json"
    filepath = output_dir / filename
    
    # Táº¡o dá»¯ liá»‡u Ä‘á»ƒ lÆ°u
    output_data = {
        "page_id": page_id,
        "profile_id": profile_id,
        "start_date": start_date,
        "end_date": end_date,
        "total_posts": len(posts),
        "posts": posts
    }
    
    # LÆ°u file JSON
    with open(filepath, "w", encoding="utf-8") as f:
        json.dump(output_data, f, ensure_ascii=False, indent=2)
    
    print(f"\nðŸ’¾ ÄÃ£ lÆ°u káº¿t quáº£ vÃ o: {filepath}")
    print(f"   Tá»•ng sá»‘ posts: {len(posts)}")
    
    # Láº¥y chá»‰ post IDs
    post_ids = get_post_ids_from_page(page_id, profile_id, start_date, end_date)
    print(f"\nðŸ“‹ Post IDs: {len(post_ids)}")
    if post_ids:
        print(f"   VÃ­ dá»¥: {post_ids[:5]}")


--- END FILE: backend\worker\get_post_from_page.py ---

--- START FILE: backend\worker\single_get_comment.py ---
import requests
import json
import base64
from urllib.parse import urlencode
from datetime import datetime, timezone, timedelta

# ====== LÆ¯U Ã ======
# Cookies vÃ  payload Ä‘Æ°á»£c láº¥y tá»« cookies.json vÃ  payload.txt thÃ´ng qua profile_id
# cookies.json cÃ³ cáº¥u trÃºc: {"profile_id": {"cookie": "...", "access_token": "..."}}
# Sá»­ dá»¥ng get_payload.get_payload_by_profile_id(profile_id) Ä‘á»ƒ láº¥y payload
# Sá»­ dá»¥ng get_payload.get_cookies_by_profile_id(profile_id) Ä‘á»ƒ láº¥y cookie

# ====== Táº O FEEDBACK ID Tá»ª POST_ID ======
def create_feedback_id(post_id):
    """Chuyá»ƒn Ä‘á»•i post_id thÃ nh feedback ID báº±ng base64"""
    s = f"feedback:{post_id}"
    feedback_id = base64.b64encode(s.encode()).decode()
    return feedback_id


# ====== CHUYá»‚N Äá»”I TIMESTAMP SANG GIá»œ VIá»†T NAM (UTC+7) ======
def convert_timestamp_to_vietnam_time(timestamp):
    """
    Chuyá»ƒn Ä‘á»•i Unix timestamp sang giá» Viá»‡t Nam (UTC+7)
    
    Args:
        timestamp (int): Unix timestamp (sá»‘ giÃ¢y tá»« epoch)
        
    Returns:
        str: Thá»i gian Ä‘á»‹nh dáº¡ng "YYYY-MM-DD HH:MM:SS" (giá» Viá»‡t Nam) hoáº·c None náº¿u timestamp khÃ´ng há»£p lá»‡
    """
    if timestamp is None:
        return None
    
    try:
        # Táº¡o datetime tá»« timestamp (UTC)
        dt_utc = datetime.fromtimestamp(timestamp, tz=timezone.utc)
        
        # Chuyá»ƒn sang giá» Viá»‡t Nam (UTC+7)
        vietnam_tz = timezone(timedelta(hours=7))
        dt_vietnam = dt_utc.astimezone(vietnam_tz)
        
        # Format thÃ nh string
        return dt_vietnam.strftime("%Y-%m-%d %H:%M:%S")
    except (ValueError, OSError, TypeError) as e:
        print(f"âš ï¸ Lá»—i khi chuyá»ƒn Ä‘á»•i timestamp {timestamp}: {e}")
        return None


# ====== EXTRACT USERS Tá»ª JSON ======
def extract_users_from_json(data, users_list, seen_ids):
    """
    Äá»‡ quy Ä‘á»ƒ tÃ¬m táº¥t cáº£ cÃ¡c user objects trong JSON structure vÃ  láº¥y text cá»§a comment
    
    Args:
        data: JSON data (dict, list, hoáº·c primitive)
        users_list: List Ä‘á»ƒ lÆ°u cÃ¡c user Ä‘Ã£ tÃ¬m tháº¥y
        seen_ids: Set Ä‘á»ƒ track cÃ¡c id Ä‘Ã£ tháº¥y, trÃ¡nh trÃ¹ng láº·p
    """
    if isinstance(data, dict):
        # Náº¿u cÃ³ key "user" vÃ  value lÃ  dict cÃ³ "id" vÃ  "name"
        if "user" in data and isinstance(data["user"], dict):
            user = data["user"]
            user_id = user.get("id")
            user_name = user.get("name")
            
            # Láº¥y text tá»« body náº¿u cÃ³
            comment_text = None
            if "body" in data and isinstance(data["body"], dict):
                comment_text = data["body"].get("text")
            
            # Láº¥y created_time náº¿u cÃ³
            created_time = data.get("created_time")
            created_time_vn = None
            if created_time:
                created_time_vn = convert_timestamp_to_vietnam_time(created_time)
            
            if user_id and user_name:
                # Táº¡o key duy nháº¥t tá»« user_id vÃ  text (Ä‘á»ƒ trÃ¡nh trÃ¹ng comment)
                unique_key = f"{user_id}_{comment_text}" if comment_text else user_id
                
                # Chá»‰ thÃªm náº¿u chÆ°a cÃ³ trong seen_ids
                if unique_key not in seen_ids:
                    seen_ids.add(unique_key)
                    user_data = {
                        "id": user_id,
                        "name": user_name,
                        "text": comment_text if comment_text else ""
                    }
                    # ThÃªm created_time_vn náº¿u cÃ³ (chá»‰ lÆ°u giá» Viá»‡t Nam)
                    if created_time_vn:
                        user_data["created_time_vn"] = created_time_vn
                    
                    users_list.append(user_data)
        
        # Äá»‡ quy vÃ o táº¥t cáº£ cÃ¡c values
        for value in data.values():
            extract_users_from_json(value, users_list, seen_ids)
    
    elif isinstance(data, list):
        # Äá»‡ quy vÃ o táº¥t cáº£ cÃ¡c items trong list
        for item in data:
            extract_users_from_json(item, users_list, seen_ids)


# ================================
#   Gá»¬I REQUEST GRAPHQL Vá»šI CURSOR
# ================================
def send_request(post_id, payload_dict, profile_id, cookies, commentsAfterCursor=None):
    """Gá»­i request GraphQL Ä‘á»ƒ láº¥y comments vá»›i post_id vÃ  commentsAfterCursor (náº¿u cÃ³)"""
    
    # Táº¡o feedback ID tá»« post_id
    feedback_id = create_feedback_id(post_id)
    
    # Variables cho comments API
    variables = {
        "commentsAfterCount": -1,
        "commentsAfterCursor": commentsAfterCursor if commentsAfterCursor else None,
        "commentsBeforeCount": None,
        "commentsBeforeCursor": None,
        "commentsIntentToken": "RANKED_UNFILTERED_CHRONOLOGICAL_REPLIES_INTENT_V1",
        "feedLocation": "POST_PERMALINK_DIALOG",
        "focusCommentID": None,
        "scale": 1,
        "useDefaultActor": False,
        "id": feedback_id,
        "__relay_internal__pv__CometUFICommentAvatarStickerAnimatedImagerelayprovider": False,
        "__relay_internal__pv__IsWorkUserrelayprovider": False
    }
    
    # ThÃªm commentsAfterCursor náº¿u cÃ³
    if commentsAfterCursor:
        print(f"   ðŸ”„ Sá»­ dá»¥ng commentsAfterCursor: {commentsAfterCursor[:50]}...")
    else:
        print(f"   ðŸ”„ KhÃ´ng cÃ³ commentsAfterCursor (trang Ä‘áº§u tiÃªn)")
    
    # Debug: In ra variables Ä‘á»ƒ kiá»ƒm tra
    print(f"   ðŸ“‹ Variables: {json.dumps(variables, ensure_ascii=False)}")
    
    # Sá»­ dá»¥ng payload Ä‘Æ°á»£c truyá»n vÃ o vÃ  thÃªm variables, doc_id, fb_api_req_friendly_name, __crn
    payload_dict = payload_dict.copy()
    payload_dict["variables"] = json.dumps(variables, ensure_ascii=False)
    payload_dict["doc_id"] = "25515916584706508"
    payload_dict["fb_api_req_friendly_name"] = "CommentListComponentsRootQuery"
    payload_dict["__crn"] = "comet.fbweb.CometSinglePostDialogRoute"  # Route riÃªng cho comments

    # Chuyá»ƒn dictionary thÃ nh form-urlencoded string
    payload = urlencode(payload_dict)
    
    # Debug: In ra payload Ä‘á»ƒ kiá»ƒm tra (chá»‰ 500 kÃ½ tá»± Ä‘áº§u)
    print(f"   ðŸ” Payload preview: {payload[:500]}...")

    # Táº¡o headers vá»›i cookies
    headers = {
        "accept": "*/*",
        "accept-encoding": "gzip, deflate, br",
        "accept-language": "en,vi;q=0.9,en-US;q=0.8",
        "content-type": "application/x-www-form-urlencoded",
        "cookie": cookies,
        "origin": "https://www.facebook.com",
        "priority": "u=1, i",
        "referer": "https://www.facebook.com/photo/?fbid=965661036626847&set=a.777896542069965",
        "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": '"Windows"',
        "sec-fetch-dest": "empty",
        "sec-fetch-mode": "cors",
        "sec-fetch-site": "same-origin",
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
        "x-asbd-id": "359341",
        "x-fb-friendly-name": "CommentListComponentsRootQuery",
        "x-fb-lsd": payload_dict.get("lsd", "")
    }

    url = "https://www.facebook.com/api/graphql/"
    
    # Gá»­i payload dÆ°á»›i dáº¡ng form-urlencoded vá»›i headers
    response = requests.post(url, data=payload, headers=headers)
    
    return response


# ================================
#   HÃ€M HOÃ€N CHá»ˆNH: Láº¤Y Táº¤T Cáº¢ COMMENTS Tá»ª POST_ID
# ================================
def get_all_comments_by_post_id(post_id, payload_dict, profile_id, cookies):
    """
    HÃ m hoÃ n chá»‰nh Ä‘á»ƒ láº¥y táº¥t cáº£ comments tá»« post_id
    
    Args:
        post_id (str): Facebook ID cá»§a post
        payload_dict (dict): Dictionary chá»©a payload parameters
        profile_id (str): Profile ID
        cookies (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng trong request
        
    Returns:
        list: Danh sÃ¡ch comments vá»›i format [{"id": "...", "text": "...", "author": {...}}, ...]
    """
    # Táº¡o feedback ID tá»« post_id
    feedback_id = create_feedback_id(post_id)
    
    print("\n" + "="*50)
    print(f"ðŸš€ Báº¯t Ä‘áº§u láº¥y comments tá»« Post ID: {post_id}")
    print(f"ðŸ”— Feedback ID: {feedback_id}")
    print("="*50)
    
    all_responses = []  # LÆ°u táº¥t cáº£ response JSON
    all_users = []  # LÆ°u táº¥t cáº£ users tá»« comments
    seen_user_ids = set()  # Set Ä‘á»ƒ track cÃ¡c user id Ä‘Ã£ tháº¥y
    cursors_info = {}  # LÆ°u thÃ´ng tin cursors
    commentsAfterCursor = None  # Cursor Ä‘á»ƒ pagination
    page_number = 1
    
    while True:
        print(f"\nðŸ“„ Trang {page_number} - Äang gá»­i request...")
        if commentsAfterCursor:
            print(f"   CommentsAfterCursor: {commentsAfterCursor[:50]}...")
        
        # Gá»­i request vá»›i post_id, payload, profile_id, cookies vÃ  commentsAfterCursor
        response = send_request(post_id, payload_dict, profile_id, cookies, commentsAfterCursor)
        
        print(f"   STATUS: {response.status_code}")
        
        if response.status_code != 200:
            print(f"âŒ Lá»—i: Status code {response.status_code}")
            print(f"   ðŸ“‹ Response text (500 kÃ½ tá»± Ä‘áº§u):")
            print(f"   {response.text[:500]}")
            
            # Thá»­ parse JSON Ä‘á»ƒ xem cÃ³ error message khÃ´ng
            try:
                error_json = response.json()
                if "errors" in error_json:
                    print(f"   âŒ Errors tá»« response: {json.dumps(error_json.get('errors'), indent=2, ensure_ascii=False)}")
                else:
                    print(f"   ðŸ“‹ Response JSON: {json.dumps(error_json, indent=2, ensure_ascii=False)[:1000]}")
            except:
                pass
            
            # LÆ°u response Ä‘á»ƒ debug
            with open("error_response_comment.txt", "w", encoding="utf-8") as f:
                f.write(f"Status Code: {response.status_code}\n")
                f.write(f"Headers: {dict(response.headers)}\n")
                f.write(f"\nResponse Text:\n{response.text}")
            print(f"   ðŸ’¾ ÄÃ£ lÆ°u response vÃ o error_response_comment.txt")
            break
        
        # Parse response thÃ nh JSON
        try:
            response_json = response.json()
            
            # LÆ°u response vÃ o list Ä‘á»ƒ lÆ°u táº¥t cáº£ vÃ o má»™t file sau
            all_responses.append(response_json)
            
            # Extract users tá»« response JSON
            extract_users_from_json(response_json, all_users, seen_user_ids)
            
            # Debug: Kiá»ƒm tra cáº¥u trÃºc response
            if "data" not in response_json:
                print(f"   âš ï¸ Response khÃ´ng cÃ³ 'data': {list(response_json.keys())}")
            if "errors" in response_json:
                print(f"   âŒ Response cÃ³ errors: {response_json.get('errors')}")
            
            # TrÃ­ch xuáº¥t page_info tá»« response
            try:
                # Cáº¥u trÃºc response: data.node.comment_rendering_instance_for_feed_location.comments
                node = response_json.get("data", {}).get("node", {})
                comment_rendering = node.get("comment_rendering_instance_for_feed_location", {})
                comments = comment_rendering.get("comments", {})
                edges = comments.get("edges", [])
                page_info = comments.get("page_info", {})
                end_cursor = page_info.get("end_cursor")
                start_cursor = page_info.get("start_cursor")
                has_next_page = page_info.get("has_next_page", False)
                
                print(f"   ðŸ” Debug: Sá»‘ edges trong response: {len(edges)}")
                print(f"   ðŸ”— End cursor: {end_cursor if end_cursor else 'None'}")
                print(f"   ðŸ”— Start cursor: {start_cursor if start_cursor else 'None'}")
                print(f"   ðŸ“„ Has next page: {has_next_page}")
                
                # LÆ°u cursors vÃ o dict (lÆ°u cá»§a trang cuá»‘i cÃ¹ng)
                cursors_info = {
                    "end_cursor": end_cursor,
                    "start_cursor": start_cursor,
                    "has_next_page": has_next_page,
                    "edges_count": len(edges),
                    "page_number": page_number
                }
                
                if len(edges) == 0:
                    print(f"   âš ï¸ KhÃ´ng cÃ³ edges trong response!")
                    print(f"   ðŸ” Debug: Comments keys: {list(comments.keys()) if comments else 'None'}")
                
                # Kiá»ƒm tra cÃ³ trang tiáº¿p theo khÃ´ng
                if not has_next_page:
                    print(f"\nâœ… ÄÃ£ láº¥y háº¿t táº¥t cáº£ comments! (has_next_page = False)")
                    break
                
                if not end_cursor:
                    print(f"\nâš ï¸ KhÃ´ng cÃ³ end_cursor Ä‘á»ƒ tiáº¿p tá»¥c, dá»«ng láº¡i")
                    break
                
                # Cáº­p nháº­t commentsAfterCursor cho láº§n láº·p tiáº¿p theo
                commentsAfterCursor = end_cursor
                page_number += 1
                print(f"   âž¡ï¸ CommentsAfterCursor Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t: {commentsAfterCursor[:50]}...")
                
            except Exception as e:
                print(f"âš ï¸ Lá»—i khi trÃ­ch xuáº¥t page_info: {e}")
                import traceback
                traceback.print_exc()
                break
                
        except json.JSONDecodeError as e:
            print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡")
            print(f"   Chi tiáº¿t: {e}")
            # LÆ°u response Ä‘á»ƒ debug
            with open("response_debug.txt", "w", encoding="utf-8") as f:
                f.write(response.text)
            print(f"   ÄÃ£ lÆ°u response vÃ o response_debug.txt")
            break
    
    # Hiá»ƒn thá»‹ káº¿t quáº£
    print(f"\n" + "="*50)
    print(f"âœ… HoÃ n thÃ nh!")
    print(f"ðŸ“„ Tá»•ng sá»‘ response: {len(all_responses)}")
    
    # Hiá»ƒn thá»‹ cursors info
    if cursors_info:
        print(f"   ðŸ”— End cursor: {cursors_info.get('end_cursor', 'None')}")
        print(f"   ðŸ”— Start cursor: {cursors_info.get('start_cursor', 'None')}")
    
    # Hiá»ƒn thá»‹ users Ä‘Ã£ extract
    if all_users:
        print(f"\nðŸ“‹ Danh sÃ¡ch users (10 Ä‘áº§u tiÃªn):")
        for i, user in enumerate(all_users[:10], 1):
            text_preview = user.get('text', '')[:50] + "..." if len(user.get('text', '')) > 50 else user.get('text', '')
            created_time_vn = user.get('created_time_vn', 'N/A')
            print(f"  {i}. ID: {user['id']}, Name: {user['name']}, Text: {text_preview}, Created: {created_time_vn}")
        if len(all_users) > 10:
            print(f"  ... vÃ  {len(all_users) - 10} users khÃ¡c")
    
    print("="*50)
    
    return all_users


# ================================
#   HÃ€M ÄÆ N GIáº¢N: Láº¤Y COMMENTS Tá»ª CURSOR
# ================================
def get_comments_by_cursor(post_id, payload_dict, profile_id, cookies, cursor=None):
    """
    HÃ m Ä‘Æ¡n giáº£n: truyá»n cursor vÃ o, tráº£ vá» comments vÃ  end_cursor
    
    Args:
        post_id (str): Facebook ID cá»§a post
        payload_dict (dict): Dictionary chá»©a payload parameters
        profile_id (str): Profile ID
        cookies (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng trong request
        cursor (str, optional): Cursor Ä‘á»ƒ láº¥y trang tiáº¿p theo. None náº¿u lÃ  trang Ä‘áº§u tiÃªn
        
    Returns:
        dict: {
            "comments": [{"id": "...", "text": "...", "author": {...}}, ...],
            "end_cursor": "...",
            "has_next_page": bool
        }
    """
    # Gá»­i request
    response = send_request(post_id, payload_dict, profile_id, cookies, cursor)
    
    if response.status_code != 200:
        print(f"âŒ Lá»—i: Status code {response.status_code}")
        return {"comments": [], "end_cursor": None, "has_next_page": False}
    
    # Parse response
    try:
        response_json = response.json()
        node = response_json.get("data", {}).get("node", {})
        comments = node.get("comments", {})
        edges = comments.get("edges", [])
        page_info = comments.get("page_info", {})
        end_cursor = page_info.get("end_cursor")
        has_next_page = page_info.get("has_next_page", False)
        
        # TÃ¡ch láº¥y comments
        comments_list = []
        for edge in edges:
            comment_node = edge.get("node", {})
            comment_id = comment_node.get("id")
            comment_text = comment_node.get("text")
            author = comment_node.get("author", {})
            created_time = comment_node.get("created_time")
            
            # Chuyá»ƒn Ä‘á»•i created_time sang giá» Viá»‡t Nam
            created_time_vn = None
            if created_time:
                created_time_vn = convert_timestamp_to_vietnam_time(created_time)
            
            if comment_id:
                comment_data = {
                    "id": comment_id,
                    "text": comment_text,
                    "author": author
                }
                # ThÃªm created_time_vn náº¿u cÃ³ (chá»‰ lÆ°u giá» Viá»‡t Nam)
                if created_time_vn:
                    comment_data["created_time_vn"] = created_time_vn
                
                comments_list.append(comment_data)
                
                # Print created_time
                author_name = author.get("name", "Unknown") if isinstance(author, dict) else "Unknown"
                text_preview = (comment_text[:50] + "...") if comment_text and len(comment_text) > 50 else (comment_text or "")
                print(f"   ðŸ’¬ Comment ID: {comment_id}, Author: {author_name}, Created: {created_time_vn or 'N/A'}, Text: {text_preview}")
        
        return {
            "comments": comments_list,
            "end_cursor": end_cursor,
            "has_next_page": has_next_page
        }
        
    except json.JSONDecodeError as e:
        print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡: {e}")
        return {"comments": [], "end_cursor": None, "has_next_page": False}
    except Exception as e:
        print(f"âŒ Lá»—i khi parse response: {e}")
        return {"comments": [], "end_cursor": None, "has_next_page": False}


if __name__ == "__main__":
    # VÃ­ dá»¥ sá»­ dá»¥ng hÃ m hoÃ n chá»‰nh vá»›i vÃ²ng láº·p tá»± Ä‘á»™ng
    from get_payload import get_payload_by_profile_id, get_cookies_by_profile_id
    
    profile_id = "031ca13d-e8fa-400c-a603-df57a2806788"
    payload_dict = get_payload_by_profile_id(profile_id)
    cookies = get_cookies_by_profile_id(profile_id)
    
    if payload_dict and cookies:
        post_id = "2664708703928050"  # Thay Ä‘á»•i Post ID á»Ÿ Ä‘Ã¢y
        comments = get_all_comments_by_post_id(post_id, payload_dict, profile_id, cookies)


--- END FILE: backend\worker\single_get_comment.py ---

--- START FILE: backend\worker\single_get_reactions.py ---
import requests
import json
import base64
from urllib.parse import urlencode

# ====== LÆ¯U Ã ======
# Cookies vÃ  payload Ä‘Æ°á»£c láº¥y tá»« cookies.json vÃ  payload.txt thÃ´ng qua profile_id
# cookies.json cÃ³ cáº¥u trÃºc: {"profile_id": {"cookie": "...", "access_token": "..."}}
# Sá»­ dá»¥ng get_payload.get_payload_by_profile_id(profile_id) Ä‘á»ƒ láº¥y payload
# Sá»­ dá»¥ng get_payload.get_cookies_by_profile_id(profile_id) Ä‘á»ƒ láº¥y cookie

# ====== Táº O FEEDBACK TARGET ID Tá»ª FID ======
def create_feedback_target_id(fid):
    """Chuyá»ƒn Ä‘á»•i fid thÃ nh feedbackTargetID báº±ng base64"""
    s = f"feedback:{fid}"
    feedback_target_id = base64.b64encode(s.encode()).decode()
    return feedback_target_id


# ================================
#   Gá»¬I REQUEST GRAPHQL Vá»šI CURSOR
# ================================
def send_request(feedback_target_id, payload_dict, profile_id, cookies, cursor=None):
    """Gá»­i request GraphQL vá»›i feedbackTargetID vÃ  cursor (náº¿u cÃ³)"""
    
    # Payload dÆ°á»›i dáº¡ng dictionary (tá»« Ä‘iá»ƒn)
    variables = {
        "count": 100,
        "feedbackTargetID": feedback_target_id,
        "reactionID": None,
        "scale": 1,
        "id": feedback_target_id
    }
    
    # ThÃªm cursor náº¿u cÃ³
    if cursor:
        variables["cursor"] = cursor
        print(f"   ðŸ”„ Sá»­ dá»¥ng cursor: {cursor[:50]}...")
    else:
        print(f"   ðŸ”„ KhÃ´ng cÃ³ cursor (trang Ä‘áº§u tiÃªn)")
    
    # Debug: In ra variables Ä‘á»ƒ kiá»ƒm tra
    print(f"   ðŸ“‹ Variables: {json.dumps(variables, ensure_ascii=False)}")
    
    # Sá»­ dá»¥ng payload Ä‘Æ°á»£c truyá»n vÃ o vÃ  thÃªm variables, doc_id, fb_api_req_friendly_name
    payload_dict = payload_dict.copy()
    payload_dict["variables"] = json.dumps(variables, ensure_ascii=False)
    payload_dict["doc_id"] = "31470716059194219"
    payload_dict["fb_api_req_friendly_name"] = "CometUFIReactionsDialogTabContentRefetchQuery"

    # Chuyá»ƒn dictionary thÃ nh form-urlencoded string
    payload = urlencode(payload_dict)

    # Táº¡o headers vá»›i cookies
    headers = {
        "accept": "*/*",
        "accept-encoding": "gzip, deflate, br",
        "accept-language": "en,vi;q=0.9,en-US;q=0.8",
        "content-type": "application/x-www-form-urlencoded",
        "cookie": cookies,
        "origin": "https://www.facebook.com",
        "priority": "u=1, i",
        "referer": "https://www.facebook.com/photo/?fbid=965661036626847&set=a.777896542069965",
        "sec-ch-ua": '"Google Chrome";v="143", "Chromium";v="143", "Not A(Brand";v="24"',
        "sec-ch-ua-mobile": "?0",
        "sec-ch-ua-platform": '"Windows"',
        "sec-fetch-dest": "empty",
        "sec-fetch-mode": "cors",
        "sec-fetch-site": "same-origin",
        "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36",
        "x-asbd-id": "359341",
        "x-fb-friendly-name": "CometUFIReactionsDialogTabContentRefetchQuery",
        "x-fb-lsd": payload_dict.get("lsd", "")
    }

    url = "https://www.facebook.com/api/graphql/"
    
    # Gá»­i payload dÆ°á»›i dáº¡ng form-urlencoded vá»›i headers
    response = requests.post(url, data=payload, headers=headers)
    
    return response


# ================================
#   HÃ€M HOÃ€N CHá»ˆNH: Láº¤Y Táº¤T Cáº¢ USERS Tá»ª FID
# ================================
def get_all_users_by_fid(fid, payload_dict, profile_id, cookies):
    """
    HÃ m hoÃ n chá»‰nh Ä‘á»ƒ láº¥y táº¥t cáº£ users (id vÃ  name) tá»« FID
    
    Args:
        fid (str): Facebook ID cá»§a post/photo
        payload_dict (dict): Dictionary chá»©a payload parameters
        profile_id (str): Profile ID
        cookies (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng trong request
        
    Returns:
        list: Danh sÃ¡ch users vá»›i format [{"id": "...", "name": "..."}, ...]
    """
    # Táº¡o feedbackTargetID tá»« FID
    feedback_target_id = create_feedback_target_id(fid)
    
    print("\n" + "="*50)
    print(f"ðŸš€ Báº¯t Ä‘áº§u láº¥y users tá»« FID: {fid}")
    print(f"ðŸ”— FeedbackTargetID: {feedback_target_id}")
    print("="*50)
    
    all_users = []
    seen_ids = set()  # Set Ä‘á»ƒ track cÃ¡c id Ä‘Ã£ tháº¥y, trÃ¡nh trÃ¹ng láº·p
    cursor = None
    page_number = 1
    duplicate_count = 0  # Äáº¿m sá»‘ user trÃ¹ng Ä‘Ã£ bá» qua
    
    while True:
        print(f"\nðŸ“„ Trang {page_number} - Äang gá»­i request...")
        if cursor:
            print(f"   Cursor: {cursor[:50]}...")
        
        # Gá»­i request vá»›i feedbackTargetID, payload, profile_id, cookies vÃ  cursor
        response = send_request(feedback_target_id, payload_dict, profile_id, cookies, cursor)
        
        print(f"   STATUS: {response.status_code}")
        
        if response.status_code != 200:
            print(f"âŒ Lá»—i: Status code {response.status_code}")
            break
        
        # Parse response thÃ nh JSON
        try:
            response_json = response.json()
            
            # Debug: Kiá»ƒm tra cáº¥u trÃºc response
            if "data" not in response_json:
                print(f"   âš ï¸ Response khÃ´ng cÃ³ 'data': {list(response_json.keys())}")
            if "errors" in response_json:
                print(f"   âŒ Response cÃ³ errors: {response_json.get('errors')}")
            
            # TrÃ­ch xuáº¥t id vÃ  name tá»« má»—i node
            try:
                reactors = response_json.get("data", {}).get("node", {}).get("reactors", {})
                edges = reactors.get("edges", [])
                page_info = reactors.get("page_info", {})
                end_cursor = page_info.get("end_cursor")
                has_next_page = page_info.get("has_next_page", False)
                
                print(f"   ðŸ” Debug: Sá»‘ edges trong response: {len(edges)}")
                if len(edges) == 0:
                    print(f"   âš ï¸ KhÃ´ng cÃ³ edges trong response!")
                    print(f"   ðŸ” Debug: Reactors keys: {list(reactors.keys()) if reactors else 'None'}")
                    print(f"   ðŸ” Debug: Data structure: {json.dumps(response_json.get('data', {}), indent=2, ensure_ascii=False)[:500]}")
                elif len(edges) > 0:
                    # Debug: In ra node Ä‘áº§u tiÃªn Ä‘á»ƒ kiá»ƒm tra
                    first_node = edges[0].get("node", {})
                    first_id = first_node.get("id")
                    first_name = first_node.get("name")
                    print(f"   ðŸ” Debug node Ä‘áº§u tiÃªn: id={first_id}, name={first_name}, Ä‘Ã£ cÃ³ trong seen_ids: {first_id in seen_ids if first_id else 'N/A'}")
                
                page_users = []
                last_cursor = None
                
                for edge in edges:
                    node = edge.get("node", {})
                    node_id = node.get("id")
                    node_name = node.get("name")
                    edge_cursor = edge.get("cursor")  # Láº¥y cursor tá»« edge
                    
                    # Debug: In ra node Ä‘áº§u tiÃªn Ä‘á»ƒ kiá»ƒm tra
                    if len(page_users) == 0 and len(edges) > 0:
                        print(f"   ðŸ” Debug node Ä‘áº§u tiÃªn: id={node_id}, name={node_name}, node_keys={list(node.keys())}")
                    
                    if node_id and node_name:
                        # Kiá»ƒm tra xem id Ä‘Ã£ tá»“n táº¡i chÆ°a
                        if node_id not in seen_ids:
                            seen_ids.add(node_id)
                            page_users.append({
                                "id": node_id,
                                "name": node_name
                            })
                        else:
                            duplicate_count += 1
                    elif not node_id:
                        print(f"   âš ï¸ Node khÃ´ng cÃ³ id: {node}")
                    elif not node_name:
                        print(f"   âš ï¸ Node khÃ´ng cÃ³ name: id={node_id}")
                    
                    # LÆ°u cursor cá»§a edge cuá»‘i cÃ¹ng
                    if edge_cursor:
                        last_cursor = edge_cursor
                
                all_users.extend(page_users)
                
                # Sá»­ dá»¥ng end_cursor tá»« page_info (theo yÃªu cáº§u)
                next_cursor = end_cursor
                
                print(f"   âœ… Láº¥y Ä‘Æ°á»£c {len(page_users)} users má»›i (Tá»•ng: {len(all_users)}, TrÃ¹ng: {duplicate_count})")
                print(f"   ðŸ”— End cursor (page_info): {end_cursor[:50] if end_cursor else 'None'}...")
                print(f"   ðŸ”— Last cursor (edge): {last_cursor[:50] if last_cursor else 'None'}...")
                print(f"   ðŸ”— Next cursor sáº½ dÃ¹ng: {next_cursor[:50] if next_cursor else 'None'}...")
                print(f"   ðŸ“„ Has next page: {has_next_page}")
                
                # Kiá»ƒm tra cÃ³ trang tiáº¿p theo khÃ´ng
                if not has_next_page:
                    print(f"\nâœ… ÄÃ£ láº¥y háº¿t táº¥t cáº£ users! (has_next_page = False)")
                    break
                
                if not next_cursor:
                    print(f"\nâš ï¸ KhÃ´ng cÃ³ cursor Ä‘á»ƒ tiáº¿p tá»¥c, dá»«ng láº¡i")
                    break
                
                # Cáº­p nháº­t cursor cho láº§n láº·p tiáº¿p theo
                cursor = next_cursor
                page_number += 1
                print(f"   âž¡ï¸ Cursor Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t: {cursor[:50]}...")
                
            except Exception as e:
                print(f"âš ï¸ Lá»—i khi trÃ­ch xuáº¥t nodes: {e}")
                break
                
        except json.JSONDecodeError as e:
            print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡")
            print(f"   Chi tiáº¿t: {e}")
            break
    
    # Hiá»ƒn thá»‹ káº¿t quáº£
    print(f"\n" + "="*50)
    print(f"âœ… HoÃ n thÃ nh!")
    print(f"ðŸ“Š Tá»•ng sá»‘ users (sau khi lá»c trÃ¹ng): {len(all_users)}")
    print(f"ðŸ”„ Sá»‘ user trÃ¹ng Ä‘Ã£ bá» qua: {duplicate_count}")
    print(f"ðŸ“„ Tá»•ng sá»‘ trang: {page_number}")
    print(f"\nðŸ“‹ Danh sÃ¡ch users (10 Ä‘áº§u tiÃªn):")
    for i, user in enumerate(all_users[:10], 1):
        print(f"  {i}. ID: {user['id']}, Name: {user['name']}")
    if len(all_users) > 10:
        print(f"  ... vÃ  {len(all_users) - 10} users khÃ¡c")
    
    # LÆ°u vÃ o file
    if all_users:
        extracted_data = {
            "users": all_users,
            "total_users": len(all_users),
            "duplicate_users_skipped": duplicate_count,
            "total_pages": page_number,
            "fid": fid,
            "feedback_target_id": feedback_target_id
        }
        
        print(f"\nâœ… ÄÃ£ láº¥y {len(all_users)} users")
    else:
        print("\nâš ï¸ KhÃ´ng cÃ³ users")
    
    print("="*50)
    
    return all_users


# ================================
#   HÃ€M ÄÆ N GIáº¢N: Láº¤Y USERS Tá»ª CURSOR
# ================================
def get_users_by_cursor(fid, payload_dict, profile_id, cookies, cursor=None):
    """
    HÃ m Ä‘Æ¡n giáº£n: truyá»n cursor vÃ o, tráº£ vá» users (id, name) vÃ  end_cursor
    
    Args:
        fid (str): Facebook ID cá»§a post/photo
        payload_dict (dict): Dictionary chá»©a payload parameters
        profile_id (str): Profile ID
        cookies (str): Cookie string Ä‘á»ƒ sá»­ dá»¥ng trong request
        cursor (str, optional): Cursor Ä‘á»ƒ láº¥y trang tiáº¿p theo. None náº¿u lÃ  trang Ä‘áº§u tiÃªn
        
    Returns:
        dict: {
            "users": [{"id": "...", "name": "..."}, ...],
            "end_cursor": "...",
            "has_next_page": bool
        }
    """
    # Táº¡o feedbackTargetID tá»« FID
    feedback_target_id = create_feedback_target_id(fid)
    
    # Gá»­i request
    response = send_request(feedback_target_id, payload_dict, profile_id, cookies, cursor)
    
    if response.status_code != 200:
        print(f"âŒ Lá»—i: Status code {response.status_code}")
        return {"users": [], "end_cursor": None, "has_next_page": False}
    
    # Parse response
    try:
        response_json = response.json()
        reactors = response_json.get("data", {}).get("node", {}).get("reactors", {})
        edges = reactors.get("edges", [])
        page_info = reactors.get("page_info", {})
        end_cursor = page_info.get("end_cursor")
        has_next_page = page_info.get("has_next_page", False)
        
        # TÃ¡ch láº¥y users (id vÃ  name)
        users = []
        for edge in edges:
            node = edge.get("node", {})
            node_id = node.get("id")
            node_name = node.get("name")
            
            if node_id and node_name:
                users.append({
                    "id": node_id,
                    "name": node_name
                })
        
        return {
            "users": users,
            "end_cursor": end_cursor,
            "has_next_page": has_next_page
        }
        
    except json.JSONDecodeError as e:
        print(f"âŒ Lá»—i: Response khÃ´ng pháº£i JSON há»£p lá»‡: {e}")
        return {"users": [], "end_cursor": None, "has_next_page": False}
    except Exception as e:
        print(f"âŒ Lá»—i khi parse response: {e}")
        return {"users": [], "end_cursor": None, "has_next_page": False}


# ================================
#   HÃ€M Gá»ŒI CÅ¨ (giá»¯ láº¡i Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch)
# ================================
def call_graphql(fid=None, profile_id=None):
    """HÃ m wrapper Ä‘á»ƒ gá»i get_all_users_by_fid"""
    if fid is None:
        fid = "965661076626843"  # FID máº·c Ä‘á»‹nh
    
    if profile_id is None:
        profile_id = "031ca13d-e8fa-400c-a603-df57a2806788"  # Profile ID máº·c Ä‘á»‹nh
    
    from get_payload import get_payload_by_profile_id, get_cookies_by_profile_id
    
    payload_dict = get_payload_by_profile_id(profile_id)
    cookies = get_cookies_by_profile_id(profile_id)
    
    if payload_dict and cookies:
        all_users = get_all_users_by_fid(fid, payload_dict, profile_id, cookies)
    else:
        print("âŒ KhÃ´ng thá»ƒ táº¡o payload dictionary hoáº·c láº¥y cookies")
        all_users = []
    
    # Hiá»ƒn thá»‹ káº¿t quáº£
    if all_users:
        print(f"\nâœ… ÄÃ£ láº¥y {len(all_users)} users")
    else:
        print("\nâš ï¸ KhÃ´ng láº¥y Ä‘Æ°á»£c users nÃ o")


if __name__ == "__main__":
    # VÃ­ dá»¥ sá»­ dá»¥ng hÃ m hoÃ n chá»‰nh vá»›i vÃ²ng láº·p tá»± Ä‘á»™ng
    from get_payload import get_payload_by_profile_id, get_cookies_by_profile_id
    
    profile_id = "031ca13d-e8fa-400c-a603-df57a2806788"
    payload_dict = get_payload_by_profile_id(profile_id)
    cookies = get_cookies_by_profile_id(profile_id)
    
    if payload_dict and cookies:
        fid = "2664708703928050"  # Thay Ä‘á»•i FID á»Ÿ Ä‘Ã¢y
        users = get_all_users_by_fid(fid, payload_dict, profile_id, cookies)
    

--- END FILE: backend\worker\single_get_reactions.py ---

--- START FILE: frontend\data.json ---
[
  { "id": 1, "type": "type1", "time": "08:30:15" },
  { "id": 2, "type": "type1", "time": "08:30:20" },
  { "id": 3, "type": "type2", "time": "08:30:25" },
  { "id": 4, "type": "type3", "time": "08:30:25" }
]


--- END FILE: frontend\data.json ---

--- START FILE: frontend\index.html ---
<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Há»‡ thá»‘ng QuÃ©t Facebook</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
  <!-- Splash Screen -->
  <div id="splashScreen" class="splash-screen">
    <div class="splash-content">
      <h1 class="splash-title">Há»† THá»NG ADS FACEBOOK</h1>
      <p class="splash-subtitle">Giáº£i phÃ¡p tá»± Ä‘á»™ng hÃ³a â€“ quáº£n lÃ½ & scale quáº£ng cÃ¡o</p>
      <button id="splashStartBtn" class="splash-btn">Báº¯t Ä‘áº§u</button>
    </div>
  </div>

  <div class="container">
    <div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>
    <header class="header">
      <div class="header-content">
        <h1>Há»† THá»NG ADS FACEBOOK</h1>
        <p class="subtitle">Giáº£i phÃ¡p tá»± Ä‘á»™ng hÃ³a â€“ quáº£n lÃ½ & scale quáº£ng cÃ¡o</p>
      </div>
    </header>

    <div class="layout">
      <div class="left-panel">
        <div class="panel-header">
          <h3>âš™ï¸ Äiá»u khiá»ƒn</h3>
        </div>
        <div class="panel-body">
          <div class="field">
            <button id="startBtn" class="btn-primary">
              <span class="btn-icon">â–¶ï¸</span>
              <span>Báº¯t Ä‘áº§u quÃ©t</span>
            </button>
          </div>
          <div class="field">
            <button id="stopBtn" class="btn-danger stop">
              <span class="btn-icon">â¹ï¸</span>
              <span>Dá»«ng quÃ©t</span>
            </button>
          </div>
          <div class="field">
            <label for="interval">
              <span class="label-icon">â±ï¸</span>
              Thá»i gian láº·p láº¡i (phÃºt)
            </label>
            <input id="interval" type="number" min="1" value="1" placeholder="Nháº­p sá»‘ phÃºt" />
          </div>
          <div class="field">
            <label for="runMinutes">
              <span class="label-icon">â³</span>
              Thá»i gian cháº¡y má»—i phiÃªn (phÃºt)
            </label>
            <input id="runMinutes" type="number" min="1" value="30" placeholder="VD: 30" />
          </div>
          <div class="field">
            <label for="postCount">
              <span class="label-icon">ðŸ“</span>
              Sá» BÃ€I VIáº¾T theo dÃµi
            </label>
            <input id="postCount" type="number" min="0" value="0" placeholder="Nháº­p sá»‘ bÃ i viáº¿t" />
          </div>

          <div class="field">
            <button id="exportExcelBtn" class="btn-success">
              <span class="btn-icon">ðŸ“Š</span>
              <span>Xuáº¥t file Excel</span>
            </button>
          </div>

          <div class="status-line">
            <span id="statusDot" class="status-dot"></span>
            <div class="status-text-group">
              <div class="status-label">Tráº¡ng thÃ¡i backend</div>
              <div id="backendStatus" class="status-text">ChÆ°a khá»Ÿi Ä‘á»™ng</div>
            </div>
          </div>
        </div>
      </div>

      <div class="right-panel">
        <div class="panel-header">
          <div class="panel-tabs">
            <button id="tabScanList" type="button" class="tab-button active">ðŸ“‹ Danh sÃ¡ch quÃ©t</button>
            <button id="tabPostManager" type="button" class="tab-button">ðŸ“ Quáº£n lÃ½ post</button>
            <button id="tabSettings" type="button" class="tab-button">âš™ï¸ Setting profile</button>
          </div>
          <span id="rowCount" class="badge">0</span>
        </div>

        <!-- View: Danh sÃ¡ch quÃ©t -->
        <div id="scanView">
          <div class="filter-container">
            <div class="filter-group">
              <div class="filter-label">ðŸ” Lá»c theo mÃ u:</div>
              <div class="filter-buttons">
                <button class="filter-btn filter-all active" data-filter="all">
                  <span>Táº¥t cáº£</span>
                </button>
                <button class="filter-btn filter-green" data-filter="type-green">
                  <span class="filter-dot filter-dot-green"></span>
                  <span>Xanh (type1)</span>
                </button>
                <button class="filter-btn filter-yellow" data-filter="type-yellow">
                  <span class="filter-dot filter-dot-yellow"></span>
                  <span>VÃ ng (type2)</span>
                </button>
                <button class="filter-btn filter-red" data-filter="type-red">
                  <span class="filter-dot filter-dot-red"></span>
                  <span>Äá» (type3)</span>
                </button>
              </div>
            </div>
            <div class="filter-group">
              <div class="filter-label">ðŸ“Š Lá»c theo:</div>
              <div class="filter-buttons">
                <button class="filter-btn filter-react" data-filter-react="has">
                  <span>âœ“ CÃ³ React</span>
                </button>
                <button class="filter-btn filter-react" data-filter-react="none">
                  <span>âœ— KhÃ´ng React</span>
                </button>
                <button class="filter-btn filter-comment" data-filter-comment="has">
                  <span>ðŸ’¬ CÃ³ Comment</span>
                </button>
                <button class="filter-btn filter-comment" data-filter-comment="none">
                  <span>âœ— KhÃ´ng Comment</span>
                </button>
              </div>
            </div>
            <div class="filter-group">
              <div class="filter-label">â° Lá»c theo thá»i gian:</div>
              <div class="time-filter-compact">
                <div class="time-filter-inline">
                  <input type="datetime-local" id="timeFilterFrom" class="time-filter-input-compact" placeholder="Tá»«" />
                  <span class="time-filter-separator">â†’</span>
                  <input type="datetime-local" id="timeFilterTo" class="time-filter-input-compact" placeholder="Äáº¿n" />
                  <button id="applyTimeFilterBtn" class="time-filter-btn-compact time-filter-apply-compact"
                    title="Ãp dá»¥ng">
                    <span>âœ“</span>
                  </button>
                  <button id="clearTimeFilterBtn" class="time-filter-btn-compact time-filter-clear-compact" title="XÃ³a">
                    <span>âœ—</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="table-container">
            <table id="listTable">
              <thead>
                <tr>
                  <th>ID BÃ i Post</th>
                  <th>ID User</th>
                  <th>Name</th>
                  <th>React</th>
                  <th>Comment</th>
                  <th>Time</th>
                  <th>Type</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div id="emptyState" class="empty">
            <div class="empty-icon">ðŸ“­</div>
            <p>ChÆ°a cÃ³ dá»¯ liá»‡u</p>
            <p class="empty-hint">Nháº¥n "Báº¯t Ä‘áº§u quÃ©t" Ä‘á»ƒ báº¯t Ä‘áº§u</p>
          </div>
        </div>

        <!-- View: Quáº£n lÃ½ post -->
        <div id="postView" style="display:none;">
          <div class="table-container">
            <table id="postTable">
              <thead>
                <tr>
                  <th>ID Post</th>
                  <th>Ná»™i dung</th>
                  <th>Type</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div id="postEmptyState" class="empty">
            <div class="empty-icon">ðŸ“­</div>
            <p>ChÆ°a cÃ³ dá»¯ liá»‡u post</p>
            <p class="empty-hint">Kiá»ƒm tra láº¡i file JSON trong thÆ° má»¥c post_ids</p>
          </div>
        </div>

        <!-- View: Setting profile -->
        <div id="settingsView" style="display:none;">
          <div class="settings-stack">
            <div class="setting-card">
              <div class="setting-card-header">
                <div>
                  <h4>API Key</h4>

                </div>
              </div>
              <div class="inline-field">
                <input id="settingApiKey" type="text" placeholder="Nháº­p API Key" />
                <button id="saveApiKeyBtn" class="btn-primary" type="button">LÆ°u API Key</button>
              </div>
              <p class="hint">API Key Ä‘Æ°á»£c lÆ°u trÃªn trÃ¬nh duyá»‡t; Ä‘á»•i thÃ¬ nháº­p má»›i rá»“i báº¥m LÆ°u.</p>
            </div>

            <div class="setting-card">
              <div class="setting-card-header">
                <div>
                  <h4>Danh sÃ¡ch profile</h4>
                  <p class="muted">ThÃªm profile_id vÃ  thao tÃ¡c nhanh</p>
                </div>
                <div class="setting-card-actions">
                  <button id="scanPostsSettingBtn" class="btn-success" type="button">QuÃ©t bÃ i viáº¿t</button>
                  <button id="scanGroupSettingBtn" class="btn-yellow" type="button">QuÃ©t theo group</button>
                  <button id="autoJoinGroupBtn" class="btn-primary" type="button">Tá»± Ä‘á»™ng tham gia group</button>
                  <button id="feedAccountSettingBtn" class="btn-nuoiacc" type="button">NuÃ´i acc</button>
                  <button id="pauseAllBtn" class="btn-yellow" type="button">Táº¡m dá»«ng táº¥t cáº£</button>
                  <button id="pauseSelectedProfilesBtn" class="btn-pause" type="button">Táº¡m dá»«ng profile Ä‘Ã£ chá»n</button>
                  <button id="stopSelectedProfilesBtn" class="btn-orange" type="button">Dá»«ng profile Ä‘Ã£ chá»n</button>
                  <button id="stopAllSettingBtn" class="btn-danger" type="button">Dá»«ng táº¥t cáº£</button>
                </div>
              </div>
              <div id="feedConfigPanel" class="feed-panel" style="display:none;">
                <div class="feed-panel-row">
                  <label class="feed-radio">
                    <input type="radio" name="feedMode" value="feed" checked />
                    <span>Feed</span>
                  </label>
                  <label class="feed-radio">
                    <input type="radio" name="feedMode" value="search" />
                    <span>Search</span>
                  </label>
                  <div class="feed-duration">
                    <span class="feed-label">Cháº¡y (phÃºt)</span>
                    <input id="feedRunMinutesInput" type="number" min="1" value="30" />
                  </div>
                  <div class="feed-duration">
                    <span class="feed-label">Thá»i gian láº·p láº¡i (phÃºt)</span>
                    <input id="feedRestMinutesInput" type="number" min="0" value="120" />
                  </div>
                </div>
                <div class="feed-panel-row">
                  <textarea id="feedTextInput"
                    placeholder="Nháº­p text. VD: báº¯c ninh , báº¯c giang  |  hoáº·c: tuyá»ƒn dá»¥ng báº¯c ninh , báº¯c giang"></textarea>
                </div>
                <div class="feed-panel-row feed-panel-actions">
                  <button id="feedStartBtn" class="btn-success" type="button">Cháº¡y</button>
                  <button id="feedCancelBtn" class="btn-secondary" type="button">Há»§y</button>
                </div>
                <p class="hint">
                  Rule like: bÃ i pháº£i cÃ³ (tuyá»ƒn dá»¥ng/tuyá»ƒn gáº¥p/tuyá»ƒn nhÃ¢n viÃªn) <b>vÃ </b> cÃ³ (báº¯c ninh <b>hoáº·c</b> báº¯c
                  giang).
                </p>
              </div>

              <!-- Panel: QuÃ©t bÃ i viáº¿t (dÃ¹ng core/browser.py: scan + like + share + báº¯t id) -->
              <div id="scanConfigPanel" class="feed-panel" style="display:none;">
                <div class="feed-panel-row">
                  <label class="feed-radio">
                    <input type="radio" name="scanMode" value="feed" checked />
                    <span>Feed</span>
                  </label>
                  <label class="feed-radio">
                    <input type="radio" name="scanMode" value="search" />
                    <span>Search</span>
                  </label>
                  <div class="feed-duration">
                    <span class="feed-label">Cháº¡y (phÃºt)</span>
                    <input id="scanRunMinutesInput" type="number" min="1" value="30" />
                  </div>
                  <div class="feed-duration">
                    <span class="feed-label">Thá»i gian láº·p láº¡i (phÃºt)</span>
                    <input id="scanRestMinutesInput" type="number" min="0" value="120" />
                  </div>
                </div>
                <div class="feed-panel-row">
                  <textarea id="scanTextInput"
                    placeholder="Nháº­p text. VD: báº¯c ninh , báº¯c giang  |  hoáº·c: tuyá»ƒn dá»¥ng báº¯c ninh , báº¯c giang"></textarea>
                </div>
                <div class="feed-panel-row feed-panel-actions">
                  <button id="scanStartBtn" class="btn-success" type="button">Cháº¡y</button>
                  <button id="scanCancelBtn" class="btn-secondary" type="button">Há»§y</button>
                </div>
                <p class="hint">
                  Rule scan: bÃ i pháº£i cÃ³ keyword máº·c Ä‘á»‹nh (tuyá»ƒn dá»¥ng/lÆ°Æ¡ng/...) <b>vÃ </b> cÃ³ Ã­t nháº¥t 1 cá»¥m tá»« trong
                  text
                  nháº­p (náº¿u cÃ³).
                </p>
              </div>

              <!-- Panel: QuÃ©t theo group (UI only - chÆ°a ná»‘i API) -->
              <div id="groupScanPanel" class="feed-panel" style="display:none;">
                <div class="feed-panel-row">
                  <div class="feed-duration feed-duration-left">
                    <span class="feed-label">Sá»‘ bÃ i viáº¿t theo dÃµi</span>
                    <input id="groupScanPostCountInput" type="number" min="0" value="0" placeholder="VD: 100" />
                  </div>
                </div>
                <div class="feed-panel-row">
                  <textarea id="groupScanUrlInput"
                    placeholder="Nháº­p URL group (má»—i dÃ²ng 1 URL). VD:
https://www.facebook.com/groups/tuyendungkisuIT
https://www.facebook.com/groups/abc123"></textarea>
                </div>
                <div class="feed-panel-row feed-panel-actions">
                  <button id="groupScanStartBtn" class="btn-success" type="button">Cháº¡y</button>
                  <button id="groupScanCancelBtn" class="btn-secondary" type="button">ÄÃ³ng</button>
                </div>
                <p class="hint">Chá»‰ UI Ä‘á»ƒ nháº­p URL group. (ChÆ°a ná»‘i API / chÆ°a cháº¡y gÃ¬)</p>
              </div>

              <div id="profileList" class="profile-list empty-state-box">
                <p class="muted">ChÆ°a cÃ³ profile nÃ o</p>
              </div>

              <div class="add-profile-row">
                <button id="addProfileRowBtn" class="btn-success" type="button">+ ThÃªm profile</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Help button vá»›i tooltip -->
  <button id="helpBtn" class="help-button" title="Xem giáº£i thÃ­ch mÃ u sáº¯c">
    <span>?</span>
  </button>
  <div id="helpTooltip" class="help-tooltip">
    <div class="tooltip-header">
      <h4>ðŸ“‹ Giáº£i thÃ­ch mÃ u sáº¯c</h4>
      <button class="tooltip-close">&times;</button>
    </div>
    <div class="tooltip-body">
      <div class="tooltip-item">
        <span class="tooltip-dot tooltip-green"></span>
        <div>
          <strong>Xanh (type1):</strong> data Æ°u tiÃªn , data Ä‘á»‘i thá»§
        </div>
      </div>
      <div class="tooltip-item">
        <span class="tooltip-dot tooltip-yellow"></span>
        <div>
          <strong>VÃ ng (type2):</strong> data Æ°u tiÃªn , data Ä‘á»‘i thá»§
        </div>
      </div>
      <div class="tooltip-item">
        <span class="tooltip-dot tooltip-red"></span>
        <div>
          <strong>Äá» (type3):</strong>data khÃ¡ch tÃ¬m kiáº¿m trÃªn facebook
        </div>
      </div>
    </div>
  </div>

  <!-- NÃºt chat Messenger & Zalo -->
  <div class="chat-floating">
    <a href="https://m.me/" target="_blank" rel="noopener noreferrer" class="chat-btn chat-mess" title="Chat Messenger">
      <img src="icon/logo-messenger-inkythuatso-2-01-30-15-47-51.jpg" alt="Messenger" class="chat-img" />
    </a>
    <a href="https://zalo.me/" target="_blank" rel="noopener noreferrer" class="chat-btn chat-zalo" title="Chat Zalo">
      <img src="icon/zalo-icon.png" alt="Zalo" class="chat-img" />
    </a>
  </div>

  <script src="script.js"></script>
</body>

</html>
--- END FILE: frontend\index.html ---

--- START FILE: frontend\script.js ---
// Splash Screen
const splashScreen = document.getElementById('splashScreen');
const splashStartBtn = document.getElementById('splashStartBtn');

// ThÃªm class splash-active khi trang load Ä‘á»ƒ áº©n container
if (splashScreen) {
  document.body.classList.add('splash-active');
}

// áº¨n splash screen khi click nÃºt "Báº¯t Ä‘áº§u"
if (splashStartBtn) {
  splashStartBtn.addEventListener('click', () => {
    if (splashScreen) {
      splashScreen.classList.add('hidden');
      // Cho phÃ©p hiá»ƒn thá»‹ container vÃ  scroll sau khi áº©n splash
      setTimeout(() => {
        document.body.classList.remove('splash-active');
      }, 600); // Äá»£i animation hoÃ n thÃ nh
    }
  });
}

const startBtn = document.getElementById('startBtn');
const stopBtn = document.getElementById('stopBtn');
const runMinutesInput = document.getElementById('runMinutes');
const intervalInput = document.getElementById('interval');
const stopAllBtn = document.getElementById('stopAllBtn');
const pauseAllBtn = document.getElementById('pauseAllBtn');
const tbody = document.querySelector('#listTable tbody');
const emptyState = document.getElementById('emptyState');
const rowCount = document.getElementById('rowCount');
const statusDot = document.getElementById('statusDot');
const backendStatus = document.getElementById('backendStatus');
// Tabs & view cho danh sÃ¡ch quÃ©t / quáº£n lÃ½ post
const tabScanList = document.getElementById('tabScanList');
const tabPostManager = document.getElementById('tabPostManager');
const tabSettings = document.getElementById('tabSettings');
const scanView = document.getElementById('scanView');
const postView = document.getElementById('postView');
const settingsView = document.getElementById('settingsView');
// Báº£ng quáº£n lÃ½ post
const postTableBody = document.querySelector('#postTable tbody');
const postEmptyState = document.getElementById('postEmptyState');
// Setting profile elements
const settingApiKeyInput = document.getElementById('settingApiKey');
const saveApiKeyBtn = document.getElementById('saveApiKeyBtn');
const profileList = document.getElementById('profileList');
// (Preview settings.json Ä‘Ã£ bá»‹ bá» khá»i UI)
const addProfileRowBtn = document.getElementById('addProfileRowBtn');
const autoJoinGroupBtn = document.getElementById('autoJoinGroupBtn');
const stopAllSettingBtn = document.getElementById('stopAllSettingBtn');
const stopSelectedProfilesBtn = document.getElementById('stopSelectedProfilesBtn');
const pauseSelectedProfilesBtn = document.getElementById('pauseSelectedProfilesBtn');
const feedAccountSettingBtn = document.getElementById('feedAccountSettingBtn');
const scanPostsSettingBtn = document.getElementById('scanPostsSettingBtn');
const scanGroupSettingBtn = document.getElementById('scanGroupSettingBtn');
const feedConfigPanel = document.getElementById('feedConfigPanel');
const scanConfigPanel = document.getElementById('scanConfigPanel');
const groupScanPanel = document.getElementById('groupScanPanel');
const groupScanUrlInput = document.getElementById('groupScanUrlInput');
const groupScanPostCountInput = document.getElementById('groupScanPostCountInput');
const groupScanStartBtn = document.getElementById('groupScanStartBtn');
const groupScanCancelBtn = document.getElementById('groupScanCancelBtn');
const scanTextInput = document.getElementById('scanTextInput');
const scanRunMinutesInput = document.getElementById('scanRunMinutesInput');
const scanRestMinutesInput = document.getElementById('scanRestMinutesInput');
const scanStartBtn = document.getElementById('scanStartBtn');
const scanCancelBtn = document.getElementById('scanCancelBtn');
const feedTextInput = document.getElementById('feedTextInput');
const feedRunMinutesInput = document.getElementById('feedRunMinutesInput');
const feedRestMinutesInput = document.getElementById('feedRestMinutesInput');
const feedStartBtn = document.getElementById('feedStartBtn');
const feedCancelBtn = document.getElementById('feedCancelBtn');

const API_BASE = 'http://localhost:8000';
const SETTINGS_STORAGE_KEY = 'profileSettings';
const toastContainer = document.getElementById('toastContainer');

let counter = 1;
let timerId = null;
let initialLoaded = false;
let dataCheckInterval = null; // Interval Ä‘á»ƒ kiá»ƒm tra dá»¯ liá»‡u má»›i
let loadedPostIds = new Set(); // LÆ°u cÃ¡c post_id Ä‘Ã£ load Ä‘á»ƒ trÃ¡nh trÃ¹ng láº·p
let postsLoaded = false; // ÄÃ£ load dá»¯ liá»‡u quáº£n lÃ½ post hay chÆ°a
let profileState = {
  apiKey: '',
  profiles: {}, // { [profileId]: { cookie: '', access_token: '', groups: string[] } }
  selected: {}, // { [profileId]: true/false } (frontend-only)
};
let addRowEl = null; // Row táº¡m Ä‘á»ƒ nháº­p profile má»›i
let joinGroupPollTimer = null;
let feedPollTimer = null;
let scanBackendPollTimer = null; // Poll tráº¡ng thÃ¡i bot runner Ä‘á»ƒ sync UI sau F5
let isScanning = false; // Tráº¡ng thÃ¡i Ä‘ang quÃ©t
let isPausedAll = false; // Tráº¡ng thÃ¡i pause all (UI)
let lastJobsStatus = null; // cache /jobs/status Ä‘á»ƒ badge khÃ´ng bá»‹ sai khi má»›i má»Ÿ trang

function setPauseAllButtonLabel(paused) {
  if (!pauseAllBtn) return;
  const isPaused = !!paused;
  // Support cáº£ 2 kiá»ƒu: button cÃ³ span icon/text hoáº·c button text thuáº§n
  const icon = pauseAllBtn.querySelector ? pauseAllBtn.querySelector('span.btn-icon') : null;
  const textSpan = pauseAllBtn.querySelector ? pauseAllBtn.querySelector('span:last-child') : null;
  if (icon || textSpan) {
    if (icon) icon.textContent = isPaused ? 'â–¶ï¸' : 'â¸ï¸';
    if (textSpan) textSpan.textContent = isPaused ? 'Tiáº¿p tá»¥c táº¥t cáº£' : 'Táº¡m dá»«ng táº¥t cáº£';
  } else {
    pauseAllBtn.textContent = isPaused ? 'Tiáº¿p tá»¥c táº¥t cáº£' : 'Táº¡m dá»«ng táº¥t cáº£';
  }
}

stopBtn.disabled = true;
// Máº·c Ä‘á»‹nh: chÆ°a biáº¿t backend cÃ³ cháº¡y gÃ¬ => disable STOP/PAUSE ALL trÆ°á»›c, lÃ¡t sáº½ resync theo /jobs/status
try {
  if (pauseAllBtn) pauseAllBtn.disabled = true;
  if (stopAllSettingBtn) stopAllSettingBtn.disabled = true;
  if (stopSelectedProfilesBtn) stopSelectedProfilesBtn.disabled = true;
  if (pauseSelectedProfilesBtn) pauseSelectedProfilesBtn.disabled = true;
} catch (_) { }

function updateRowCount() {
  const count = tbody.children.length;
  rowCount.textContent = count;
}

// Load dá»¯ liá»‡u quáº£n lÃ½ post tá»« file post_ids
async function loadPostsForManager() {
  if (postsLoaded || !postTableBody) return;
  try {
    const res = await fetch('../backend/data/post_ids/031ca13d-e8fa-400c-a603-df57a2806788.json');
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const data = await res.json();
    if (!Array.isArray(data) || data.length === 0) {
      postEmptyState && postEmptyState.classList.add('show');
      postsLoaded = true;
      return;
    }

    data.forEach((post) => appendPostRow(post));
    postEmptyState && postEmptyState.classList.remove('show');
    postsLoaded = true;
  } catch (err) {
    console.error('KhÃ´ng táº£i Ä‘Æ°á»£c dá»¯ liá»‡u post_ids:', err);
    postEmptyState && postEmptyState.classList.add('show');
  }
}

function setScanning(isOn) {
  isScanning = isOn;
  startBtn.disabled = isOn;
  const startBtnText = startBtn.querySelector('span:last-child');
  startBtnText.textContent = isOn ? (isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang quÃ©t...') : 'Báº¯t Ä‘áº§u quÃ©t';
  stopBtn.disabled = !isOn;
  
  // Disable/enable cÃ¡c nÃºt quÃ©t khÃ¡c khi Ä‘ang quÃ©t
  if (scanStartBtn) {
    scanStartBtn.disabled = isOn;
  }
  if (scanPostsSettingBtn) {
    scanPostsSettingBtn.disabled = isOn;
  }

  // Khi dá»«ng quÃ©t: gá»¡ háº¿t tráº¡ng thÃ¡i loading/spinner á»Ÿ cÃ¡c nÃºt liÃªn quan
  // (trÃ¡nh trÆ°á»ng há»£p backend stop cháº­m lÃ m UI bá»‹ káº¹t, khÃ´ng báº¥m láº¡i Ä‘Æ°á»£c)
  if (!isOn) {
    setButtonLoading(scanStartBtn, false);
    setButtonLoading(scanPostsSettingBtn, false);
  }
  // ThÃªm loading spinner cho nÃºt báº¯t Ä‘áº§u quÃ©t
  if (startBtn) {
    if (isOn) {
      if (!startBtn.classList.contains('btn-loading')) {
        startBtn.classList.add('btn-loading');
      }
    } else {
      startBtn.classList.remove('btn-loading');
    }
  }
}

function syncRunningLabelsWithPauseState() {
  // Khi PAUSE ALL báº­t, Ä‘á»•i text cÃ¡c nÃºt Ä‘ang "loading" Ä‘á»ƒ user biáº¿t Ä‘ang táº¡m dá»«ng,
  // trÃ¡nh hiá»ƒu nháº§m váº«n "Ä‘ang quÃ©t/Ä‘ang cháº¡y".
  try {
    if (isScanning) {
      const startBtnText = startBtn?.querySelector?.('span:last-child');
      if (startBtnText) startBtnText.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang quÃ©t...';

      if (scanStartBtn && scanStartBtn.classList.contains('btn-loading')) {
        scanStartBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang cháº¡y...';
      }
      if (scanPostsSettingBtn && scanPostsSettingBtn.classList.contains('btn-loading')) {
        scanPostsSettingBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang quÃ©t...';
      }
    }

    if (feedPollTimer) {
      if (feedStartBtn && feedStartBtn.classList.contains('btn-loading')) {
        feedStartBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang cháº¡y...';
      }
      if (feedAccountSettingBtn && feedAccountSettingBtn.classList.contains('btn-loading')) {
        feedAccountSettingBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang nuÃ´i acc...';
      }
    }

    if (joinGroupPollTimer) {
      if (autoJoinGroupBtn && autoJoinGroupBtn.classList.contains('btn-loading')) {
        autoJoinGroupBtn.textContent = isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang auto join...';
      }
    }
  } catch (_) { }
}

function applyControlStateToProfileRows(st) {
  // Äá»“ng bá»™ badge tráº¡ng thÃ¡i cho má»i profile row
  const pausedAll = Boolean(st && st.global_pause);
  const pausedProfiles = new Set(Array.isArray(st && st.paused_profiles) ? st.paused_profiles.map((x) => String(x)) : []);
  const profileStates = (st && typeof st.profile_states === 'object' && st.profile_states) ? st.profile_states : {};
  const jobs = lastJobsStatus || {};
  const botRunning = Boolean(jobs && jobs.bot_running);
  const botProfileIds = new Set(Array.isArray(jobs && jobs.bot_profile_ids) ? jobs.bot_profile_ids.map((x) => String(x)) : []);
  const joinRunning = new Set(Array.isArray(jobs && jobs.join_groups_running) ? jobs.join_groups_running.map((x) => String(x)) : []);
  const feedRunning = new Set(Array.isArray(jobs && jobs.feed_running) ? jobs.feed_running.map((x) => String(x)) : []);
  const sessionRunning = Boolean(
    botRunning
    || joinRunning.size > 0
    || feedRunning.size > 0
  );

  const rows = document.querySelectorAll('.profile-row-wrap');
  rows.forEach((wrap) => {
    const pid = String(wrap.dataset.profileId || '').trim();
    if (!pid) return;
    const badge = wrap.querySelector('.profile-state-badge');

    // --- Effective state ---
    // Default: READY (má»›i vÃ o / chÆ°a cÃ³ job)
    let eff = 'READY';
    // Náº¿u khÃ´ng cÃ³ session nÃ o cháº¡y -> luÃ´n READY
    if (sessionRunning) {
      // Náº¿u Ä‘ang pause (global hoáº·c profile) -> PAUSED
      if (pausedAll || pausedProfiles.has(pid)) {
        eff = 'PAUSED';
      } else {
        // RUNNING náº¿u profile Ä‘ang cÃ³ feed/join hoáº·c runner Ä‘ang cháº¡y vÃ  profile_state RUNNING
        if (feedRunning.has(pid) || joinRunning.has(pid)) {
          eff = 'RUNNING';
        } else if (botRunning) {
          const ps = String(profileStates[pid] || '').toUpperCase();
          // Æ¯u tiÃªn list tá»« backend: bot_profile_ids
          const inBot = botProfileIds.size > 0 ? botProfileIds.has(pid) : false;
          eff = (ps === 'RUNNING' || inBot) ? 'RUNNING' : 'READY';
        } else {
          eff = 'READY';
        }
      }
    }

    if (badge) {
      badge.classList.remove('state-running', 'state-paused', 'state-ready', 'state-idle', 'state-unknown', 'state-stopping', 'state-stopped', 'state-error');
      if (eff === 'PAUSED') badge.classList.add('state-paused');
      else if (eff === 'RUNNING') badge.classList.add('state-running');
      else badge.classList.add('state-ready');
      badge.textContent = (eff === 'READY') ? 'Sáº´N SÃ€NG' : (eff === 'RUNNING') ? 'ÄANG CHáº Y' : 'ÄANG Táº M Dá»ªNG';
    }
  });
}

function updateStopPauseButtonsByJobs() {
  const jobs = lastJobsStatus || {};
  const botHasProfiles = Array.isArray(jobs && jobs.bot_profile_ids) && jobs.bot_profile_ids.length > 0;
  const sessionRunning = Boolean(
    (jobs && jobs.bot_running && botHasProfiles)
    || (Array.isArray(jobs && jobs.join_groups_running) && jobs.join_groups_running.length > 0)
    || (Array.isArray(jobs && jobs.feed_running) && jobs.feed_running.length > 0)
  );
  const hasSelected = getSelectedProfileIds().length > 0;

  // Chá»‰ khi cÃ³ tiáº¿n trÃ¬nh cháº¡y má»›i cho báº¥m STOP/PAUSE
  const stopBtns = [stopBtn, stopAllSettingBtn].filter(Boolean);
  stopBtns.forEach((b) => {
    if (b.classList && b.classList.contains('btn-loading')) return;
    b.disabled = !sessionRunning;
  });

  const pauseBtns = [pauseAllBtn].filter(Boolean);
  pauseBtns.forEach((b) => {
    if (b.classList && b.classList.contains('btn-loading')) return;
    b.disabled = !sessionRunning;
  });

  if (pauseSelectedProfilesBtn && !pauseSelectedProfilesBtn.classList.contains('btn-loading')) {
    pauseSelectedProfilesBtn.disabled = !sessionRunning || !hasSelected;
  }
  if (stopSelectedProfilesBtn && !stopSelectedProfilesBtn.classList.contains('btn-loading')) {
    stopSelectedProfilesBtn.disabled = !sessionRunning || !hasSelected;
  }
}

// ==== Settings (frontend-only) ====
async function tryLoadProfileStateFromBackend() {
  try {
    const raw = await callBackendNoAlert('/settings', { method: 'GET' });
    if (!raw) return false;

    const apiKey = raw.API_KEY || raw.api_key || '';
    const profileIds = raw.PROFILE_IDS || raw.profile_ids || {};

    profileState.apiKey = String(apiKey || '').trim();

    // PROFILE_IDS cÃ³ thá»ƒ lÃ  list/string/dict; normalize vá» dict
    const nextProfiles = {};
    if (Array.isArray(profileIds)) {
      profileIds.forEach((pid) => {
        const key = String(pid || '').trim();
        if (key) nextProfiles[key] = { cookie: '', access_token: '' };
      });
    } else if (typeof profileIds === 'string') {
      profileIds.split(',').map((s) => s.trim()).filter(Boolean).forEach((pid) => {
        nextProfiles[pid] = { cookie: '', access_token: '' };
      });
    } else if (profileIds && typeof profileIds === 'object') {
      Object.entries(profileIds).forEach(([pid, cfg]) => {
        const key = String(pid || '').trim();
        if (!key) return;
        nextProfiles[key] = {
          cookie: (cfg && cfg.cookie) ? String(cfg.cookie) : '',
          access_token: (cfg && (cfg.access_token || cfg.accessToken)) ? String(cfg.access_token || cfg.accessToken) : '',
          groups: (cfg && Array.isArray(cfg.groups)) ? cfg.groups.map((x) => String(x || '').trim()).filter(Boolean) : [],
        };
      });
    }

    profileState.profiles = nextProfiles;
    // giá»¯ selected náº¿u cÃ³
    if (!profileState.selected || typeof profileState.selected !== 'object') profileState.selected = {};
    localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(profileState));
    return true;
  } catch (err) {
    return false;
  }
}

async function loadProfileState() {
  // Æ¯u tiÃªn láº¥y tá»« backend náº¿u cÃ³
  const loadedFromBackend = await tryLoadProfileStateFromBackend();
  if (loadedFromBackend) {
    if (settingApiKeyInput) settingApiKeyInput.value = profileState.apiKey || '';
    renderProfileList();
    updateSettingsActionButtons();
    return;
  }

  try {
    const stored = localStorage.getItem(SETTINGS_STORAGE_KEY);
    if (stored) {
      const parsed = JSON.parse(stored);
      profileState = {
        apiKey: parsed.apiKey || '',
        profiles: parsed.profiles || {},
        selected: parsed.selected || {},
      };
    }
  } catch (err) {
    console.warn('KhÃ´ng Ä‘á»c Ä‘Æ°á»£c dá»¯ liá»‡u settings tá»« localStorage', err);
  }

  if (settingApiKeyInput) settingApiKeyInput.value = profileState.apiKey || '';
  renderProfileList();
  updateSettingsActionButtons();
}

function saveProfileState() {
  localStorage.setItem(SETTINGS_STORAGE_KEY, JSON.stringify(profileState));
}

function getSelectedProfileIds() {
  return Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
}

function updateSettingsActionButtons() {
  const selected = getSelectedProfileIds();
  const hasSelected = selected.length > 0;

  // CÃ¡c nÃºt "hÃ nh Ä‘á»™ng" á»Ÿ Setting profile: yÃªu cáº§u tick Ã­t nháº¥t 1 profile
  const needSelectedBtns = [
    scanPostsSettingBtn,
    scanGroupSettingBtn,
    autoJoinGroupBtn,
    feedAccountSettingBtn,
    stopSelectedProfilesBtn,
    pauseSelectedProfilesBtn,
  ].filter(Boolean);

  needSelectedBtns.forEach((b) => {
    // náº¿u Ä‘ang loading thÃ¬ giá»¯ nguyÃªn tráº¡ng thÃ¡i disabled
    if (b.classList && b.classList.contains('btn-loading')) return;
    b.disabled = !hasSelected;
  });

  // CÃ¡c nÃºt ALL (khÃ´ng phá»¥ thuá»™c tick)
  // LÆ°u Ã½: stop/pause ALL sáº½ Ä‘Æ°á»£c enable/disable theo /jobs/status (updateStopPauseButtonsByJobs)
  // nÃªn khÃ´ng set á»Ÿ Ä‘Ã¢y Ä‘á»ƒ trÃ¡nh ghi Ä‘Ã¨ logic.

  // CÃ¡c nÃºt "Cháº¡y" trong cÃ¡c panel cÅ©ng yÃªu cáº§u tick profile
  const runBtns = [feedStartBtn, scanStartBtn, groupScanStartBtn].filter(Boolean);
  runBtns.forEach((b) => {
    if (b.classList && b.classList.contains('btn-loading')) return;
    b.disabled = !hasSelected;
  });

  // Náº¿u Ä‘ang PAUSE ALL thÃ¬ disable cÃ¡c nÃºt "Cháº¡y" Ä‘á»ƒ trÃ¡nh báº¥m láº¡i vÃ´ nghÄ©a
  if (isPausedAll) {
    [scanPostsSettingBtn, scanGroupSettingBtn, autoJoinGroupBtn, feedAccountSettingBtn, feedStartBtn, scanStartBtn, groupScanStartBtn]
      .filter(Boolean)
      .forEach((b) => {
        if (b.classList && b.classList.contains('btn-loading')) return;
        b.disabled = true;
      });
  }

  // Náº¿u khÃ´ng cÃ³ selection thÃ¬ auto Ä‘Ã³ng panel Ä‘á»ƒ trÃ¡nh ngÆ°á»i dÃ¹ng nháº­p rá»“i má»›i biáº¿t khÃ´ng cháº¡y Ä‘Æ°á»£c
  if (!hasSelected) {
    if (feedConfigPanel) feedConfigPanel.style.display = 'none';
    if (scanConfigPanel) scanConfigPanel.style.display = 'none';
    if (groupScanPanel) groupScanPanel.style.display = 'none';
  }

  // Äá»“ng bá»™ enable/disable cho STOP/PAUSE theo tráº¡ng thÃ¡i backend (sessionRunning)
  try { updateStopPauseButtonsByJobs(); } catch (_) { }
}

function showToast(message, type = 'success', ms = 1600) {
  if (!toastContainer) return;
  const el = document.createElement('div');
  el.className = `toast ${type}`;
  el.textContent = message;
  toastContainer.appendChild(el);
  requestAnimationFrame(() => el.classList.add('show'));
  setTimeout(() => {
    el.classList.remove('show');
    setTimeout(() => el.remove(), 220);
  }, ms);
}

function setButtonLoading(btn, isLoading, loadingText) {
  if (!btn) return;
  if (isLoading) {
    if (!btn.dataset.origText) {
      btn.dataset.origText = btn.textContent || '';
    }
    btn.disabled = true;
    btn.classList.add('btn-loading');
    if (loadingText) btn.textContent = loadingText;
  } else {
    btn.disabled = false;
    btn.classList.remove('btn-loading');
    if (btn.dataset.origText) {
      btn.textContent = btn.dataset.origText;
      delete btn.dataset.origText;
    }
  }
}

// (Preview settings.json Ä‘Ã£ bá»‹ bá» khá»i UI)

function createPill(text) {
  const pill = document.createElement('span');
  pill.className = 'pill';
  pill.textContent = text;
  return pill;
}

function setProfileListEmptyStateIfNeeded() {
  if (!profileList) return;
  const hasRow = Boolean(profileList.querySelector('.profile-row:not(.add-profile-form)'));
  if (hasRow) {
    profileList.classList.remove('empty-state-box');
    const p = profileList.querySelector('p.muted');
    if (p && p.textContent && p.textContent.includes('ChÆ°a cÃ³ profile')) {
      // náº¿u Ä‘ang lÃ  empty placeholder thÃ¬ xÃ³a
      profileList.innerHTML = '';
    }
    return;
  }
  profileList.classList.add('empty-state-box');
  profileList.innerHTML = '<p class="muted">ChÆ°a cÃ³ profile nÃ o</p>';
}

function buildProfileRow(initialPid, initialInfo) {
  let currentPid = initialPid;
  const wrap = document.createElement('div');
  wrap.className = 'profile-row-wrap';
  wrap.dataset.profileId = String(currentPid || '').trim();

  const row = document.createElement('div');
  row.className = 'profile-row';

  const selectWrap = document.createElement('div');
  selectWrap.className = 'profile-select';

  const selectCb = document.createElement('input');
  selectCb.type = 'checkbox';
  selectCb.className = 'profile-select-cb';
  selectCb.title = 'Chá»n profile';
  selectCb.checked = Boolean(profileState.selected && profileState.selected[currentPid]);

  const pidInput = document.createElement('input');
  pidInput.className = 'profile-id-input';
  pidInput.type = 'text';
  pidInput.value = currentPid;
  pidInput.addEventListener('change', () => {
    wrap.dataset.profileId = String(pidInput.value || '').trim();
  });

  const actions = document.createElement('div');
  actions.className = 'profile-actions';

  const saveBtn = document.createElement('button');
  saveBtn.type = 'button';
  saveBtn.className = 'btn-success';
  saveBtn.textContent = 'LÆ°u';

  const removeBtn = document.createElement('button');
  removeBtn.type = 'button';
  removeBtn.className = 'btn-danger';
  removeBtn.textContent = 'XÃ³a';

  const groupBtn = document.createElement('button');
  groupBtn.type = 'button';
  groupBtn.className = 'btn-primary';
  groupBtn.textContent = 'ThÃªm Groups';

  // Badge hiá»ƒn thá»‹ tráº¡ng thÃ¡i profile (RUNNING/PAUSED/STOPPED)
  const stateBadge = document.createElement('span');
  stateBadge.className = 'profile-state-badge state-idle';
  stateBadge.textContent = 'IDLE';

  // ===== Group editor panel (div) =====
  const groupPanel = document.createElement('div');
  groupPanel.className = 'group-panel';
  groupPanel.style.display = 'none';

  const groupPanelHeader = document.createElement('div');
  groupPanelHeader.className = 'group-panel-header';
  groupPanelHeader.textContent = 'Danh sÃ¡ch group (má»—i dÃ²ng 1 group)';

  const groupTextarea = document.createElement('textarea');
  groupTextarea.className = 'group-textarea';
  groupTextarea.placeholder = 'DÃ¡n group á»Ÿ Ä‘Ã¢y...\nVD:\nhttps://www.facebook.com/groups/tuyendungkisuIT\n3013041542259942';

  const groupPanelActions = document.createElement('div');
  groupPanelActions.className = 'group-panel-actions';

  const groupSaveBtn = document.createElement('button');
  groupSaveBtn.type = 'button';
  groupSaveBtn.className = 'btn-success';
  groupSaveBtn.textContent = 'LÆ°u groups';

  const groupCloseBtn = document.createElement('button');
  groupCloseBtn.type = 'button';
  groupCloseBtn.className = 'btn-secondary';
  groupCloseBtn.textContent = 'ÄÃ³ng';

  groupPanelActions.appendChild(groupSaveBtn);
  groupPanelActions.appendChild(groupCloseBtn);
  groupPanel.appendChild(groupPanelHeader);
  groupPanel.appendChild(groupTextarea);
  groupPanel.appendChild(groupPanelActions);

  function getLocalGroups(pid) {
    const info = profileState.profiles[pid] || {};
    const gs = info.groups;
    if (Array.isArray(gs)) return gs.map((x) => String(x || '').trim()).filter(Boolean);
    return [];
  }

  function setLocalGroups(pid, groups) {
    if (!profileState.profiles[pid]) profileState.profiles[pid] = { cookie: '', access_token: '', groups: [] };
    profileState.profiles[pid].groups = Array.isArray(groups) ? groups : [];
  }

  function updateGroupBtnLabel() {
    const count = getLocalGroups(currentPid).length;
    groupBtn.textContent = count > 0 ? `Groups (${count})` : 'Groups';
  }
  // init label from initialInfo/profileState
  if (initialInfo && Array.isArray(initialInfo.groups)) {
    setLocalGroups(currentPid, initialInfo.groups);
  } else if (!profileState.profiles[currentPid]?.groups) {
    // ensure field exists
    setLocalGroups(currentPid, getLocalGroups(currentPid));
  }
  updateGroupBtnLabel();

  selectCb.addEventListener('change', () => {
    if (!profileState.selected || typeof profileState.selected !== 'object') profileState.selected = {};
    if (selectCb.checked) profileState.selected[currentPid] = true;
    else delete profileState.selected[currentPid];
    saveProfileState();
    updateSettingsActionButtons();
  });

  const cookieBtn = document.createElement('button');
  cookieBtn.type = 'button';
  cookieBtn.className = 'btn-primary';
  cookieBtn.textContent = 'Cáº­p nháº­t cookie';

  const tokenBtn = document.createElement('button');
  tokenBtn.type = 'button';
  tokenBtn.className = 'btn-success';
  tokenBtn.textContent = initialInfo?.access_token ? 'Cáº­p nháº­t token' : 'Láº¥y access_token';

  groupBtn.addEventListener('click', async () => {
    const isOpen = groupPanel.style.display !== 'none';
    if (isOpen) {
      groupPanel.style.display = 'none';
      return;
    }

    // má»Ÿ panel + load groups tá»« backend Ä‘á»ƒ textarea Ä‘Ãºng dá»¯ liá»‡u hiá»‡n táº¡i
    groupBtn.disabled = true;
    try {
      const settings = await callBackendNoAlert('/settings', { method: 'GET' });
      const profiles = (settings && (settings.PROFILE_IDS || settings.profile_ids)) || {};
      const cfg = (profiles && typeof profiles === 'object') ? profiles[currentPid] : null;
      const rawGroups = cfg && typeof cfg === 'object' ? cfg.groups : null;
      const groups = Array.isArray(rawGroups) ? rawGroups.map((x) => String(x || '').trim()).filter(Boolean) : [];
      setLocalGroups(currentPid, groups);
      saveProfileState();
      updateGroupBtnLabel();
      groupTextarea.value = groups.join('\n');
      groupPanel.style.display = 'block';
      groupTextarea.focus();
    } catch (e) {
      // fallback: hiá»‡n theo local náº¿u backend lá»—i
      const groups = getLocalGroups(currentPid);
      groupTextarea.value = groups.join('\n');
      groupPanel.style.display = 'block';
      showToast('KhÃ´ng load Ä‘Æ°á»£c groups tá»« backend, Ä‘ang dÃ¹ng dá»¯ liá»‡u local.', 'error');
    } finally {
      groupBtn.disabled = false;
    }
  });

  groupCloseBtn.addEventListener('click', () => {
    groupPanel.style.display = 'none';
  });

  groupSaveBtn.addEventListener('click', async () => {
    const nextGroups = String(groupTextarea.value || '')
      .split(/\r?\n/)
      .map((s) => s.trim())
      .filter(Boolean);

    groupSaveBtn.disabled = true;
    try {
      // replace (Ä‘Ã¨ lÃªn cÃ¡i cÅ©)
      const res = await callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}/groups`, {
        method: 'PUT',
        body: JSON.stringify({ groups: nextGroups }),
      });
      const saved = (res && Array.isArray(res.groups)) ? res.groups : nextGroups;
      setLocalGroups(currentPid, saved);
      saveProfileState();
      updateGroupBtnLabel();
      showToast(`ÄÃ£ lÆ°u groups: ${saved.length}`, 'success');
      // LÆ°u xong thÃ¬ Ä‘Ã³ng textarea panel
      groupPanel.style.display = 'none';
    } catch (e) {
      showToast('KhÃ´ng lÆ°u Ä‘Æ°á»£c groups (kiá»ƒm tra FastAPI).', 'error');
    } finally {
      groupSaveBtn.disabled = false;
    }
  });

  saveBtn.addEventListener('click', async () => {
    const nextPid = (pidInput.value || '').replace(/\s+/g, '').trim();
    if (!nextPid) {
      showToast('profile_id khÃ´ng Ä‘Æ°á»£c Ä‘á»ƒ trá»‘ng', 'error');
      pidInput.value = currentPid;
      pidInput.focus();
      return;
    }
    // normalize hiá»ƒn thá»‹ Ä‘á»ƒ trÃ¡nh dÃ­nh space
    if (pidInput.value !== nextPid) pidInput.value = nextPid;

    const cur = profileState.profiles[currentPid] || { cookie: '', access_token: '', groups: [] };
    saveBtn.disabled = true;
    try {
      if (nextPid !== currentPid) {
        // rename = add new -> copy data -> delete old
        await callBackend('/settings/profiles', {
          method: 'POST',
          body: JSON.stringify({ profile_id: nextPid }),
        });
        await callBackend(`/settings/profiles/${encodeURIComponent(nextPid)}`, {
          method: 'PUT',
          body: JSON.stringify({
            cookie: cur.cookie || '',
            access_token: cur.access_token || '',
          }),
        });
        // copy groups sang profile má»›i (trÃ¡nh máº¥t)
        await callBackend(`/settings/profiles/${encodeURIComponent(nextPid)}/groups`, {
          method: 'PUT',
          body: JSON.stringify({ groups: Array.isArray(cur.groups) ? cur.groups : [] }),
        });
        await callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}`, { method: 'DELETE' });

        delete profileState.profiles[currentPid];
        profileState.profiles[nextPid] = { ...cur };
        // chuyá»ƒn checkbox selection sang key má»›i
        if (profileState.selected && profileState.selected[currentPid]) {
          delete profileState.selected[currentPid];
          profileState.selected[nextPid] = true;
        }
        currentPid = nextPid;
        pidInput.value = currentPid;
        selectCb.checked = Boolean(profileState.selected && profileState.selected[currentPid]);
        updateGroupBtnLabel();
      } else {
        await callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}`, {
          method: 'PUT',
          body: JSON.stringify({
            cookie: cur.cookie || '',
            access_token: cur.access_token || '',
          }),
        });
      }

      saveProfileState();
      tokenBtn.textContent = (profileState.profiles[currentPid]?.access_token) ? 'Cáº­p nháº­t token' : 'Láº¥y access_token';
      showToast('ÄÃ£ lÆ°u', 'success');
    } catch (e) {
      showToast('KhÃ´ng lÆ°u Ä‘Æ°á»£c (kiá»ƒm tra FastAPI).', 'error');
      pidInput.value = currentPid;
    } finally {
      saveBtn.disabled = false;
    }
  });

  removeBtn.addEventListener('click', () => {
    if (!confirm(`XÃ³a profile ${currentPid}?`)) return;
    removeBtn.disabled = true;
    callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}`, { method: 'DELETE' })
      .then(() => {
        delete profileState.profiles[currentPid];
        saveProfileState();
        row.remove();
        setProfileListEmptyStateIfNeeded();
        showToast('ÄÃ£ xÃ³a', 'success');
      })
      .catch(() => showToast('KhÃ´ng xÃ³a Ä‘Æ°á»£c (kiá»ƒm tra FastAPI).', 'error'))
      .finally(() => (removeBtn.disabled = false));
  });

  cookieBtn.addEventListener('click', () => {
    cookieBtn.disabled = true;
    showToast('Äang báº­t NST & láº¥y cookie...', 'success', 900);
    const safePid = String(currentPid || '').replace(/\s+/g, '');
    callBackend(`/settings/profiles/${encodeURIComponent(safePid)}/cookie/fetch`, {
      method: 'POST',
      body: JSON.stringify({}),
    })
      .then(() => {
        // Cookie Ä‘Ã£ Ä‘Æ°á»£c backend lÆ°u vÃ o backend/config/settings.json, frontend khÃ´ng lÆ°u/khÃ´ng hiá»ƒn thá»‹
        showToast('ÄÃ£ lÆ°u cookie vÃ o settings.json', 'success');
      })
      .catch(() => showToast('KhÃ´ng láº¥y Ä‘Æ°á»£c cookie (kiá»ƒm tra FastAPI / Ä‘Äƒng nháº­p NST).', 'error'))
      .finally(() => (cookieBtn.disabled = false));
  });

  tokenBtn.addEventListener('click', () => {
    const info = profileState.profiles[currentPid] || {};
    const newVal = prompt(`DÃ¡n access token cho profile ${currentPid}:`, info.access_token || '');
    if (newVal === null) return;
    const nextToken = newVal.trim();
    tokenBtn.disabled = true;
    callBackend(`/settings/profiles/${encodeURIComponent(currentPid)}`, {
      method: 'PUT',
      body: JSON.stringify({ access_token: nextToken }),
    })
      .then(() => {
        profileState.profiles[currentPid] = { ...profileState.profiles[currentPid], access_token: nextToken };
        saveProfileState();
        tokenBtn.textContent = nextToken ? 'Cáº­p nháº­t token' : 'Láº¥y access_token';
        showToast('ÄÃ£ lÆ°u token', 'success');
      })
      .catch(() => showToast('KhÃ´ng lÆ°u token (kiá»ƒm tra FastAPI).', 'error'))
      .finally(() => (tokenBtn.disabled = false));
  });

  actions.appendChild(stateBadge);
  actions.appendChild(saveBtn);
  actions.appendChild(removeBtn);
  actions.appendChild(groupBtn);
  actions.appendChild(cookieBtn);
  actions.appendChild(tokenBtn);

  selectWrap.appendChild(selectCb);
  row.appendChild(selectWrap);
  row.appendChild(pidInput);
  row.appendChild(actions);
  wrap.appendChild(row);
  wrap.appendChild(groupPanel);
  // init label
  try { updatePauseBtnLabel(); } catch (_) { }
  return wrap;
}

function renderProfileList() {
  if (!profileList) return;
  // náº¿u Ä‘ang cÃ³ row thÃªm má»›i, bá» trÆ°á»›c khi render láº¡i
  if (addRowEl && addRowEl.parentNode) {
    addRowEl.parentNode.removeChild(addRowEl);
    addRowEl = null;
  }
  profileList.innerHTML = '';
  const ids = Object.keys(profileState.profiles || {});
  if (ids.length === 0) {
    profileList.classList.add('empty-state-box');
    profileList.innerHTML = '<p class="muted">ChÆ°a cÃ³ profile nÃ o</p>';
    return;
  }

  profileList.classList.remove('empty-state-box');
  ids.forEach((pid) => {
    const info = profileState.profiles[pid] || {};
    profileList.appendChild(buildProfileRow(pid, info));
  });
  updateSettingsActionButtons();
}

function showAddProfileRow() {
  if (!profileList) return;
  if (addRowEl && addRowEl.parentNode) return;

  addRowEl = document.createElement('div');
  addRowEl.className = 'profile-row add-profile-form';

  const input = document.createElement('input');
  input.type = 'text';
  input.placeholder = 'Nháº­p profile_id (UUID)';

  const saveBtn = document.createElement('button');
  saveBtn.type = 'button';
  saveBtn.className = 'btn-success';
  saveBtn.textContent = 'LÆ°u';
  saveBtn.addEventListener('click', () => {
    const value = (input.value || '').trim();
    if (!value) {
      showToast('Vui lÃ²ng nháº­p profile_id', 'error');
      return;
    }
    callBackend('/settings/profiles', {
      method: 'POST',
      body: JSON.stringify({ profile_id: value }),
    })
      .then(() => {
        if (!profileState.profiles[value]) {
          profileState.profiles[value] = { cookie: '', access_token: '', groups: [] };
        }
        saveProfileState();
        // ThÃªm row má»›i mÃ  khÃ´ng render láº¡i toÃ n bá»™ (trÃ¡nh nhÃ¡y)
        if (profileList.classList.contains('empty-state-box')) {
          profileList.classList.remove('empty-state-box');
          profileList.innerHTML = '';
        }
        const newRow = buildProfileRow(value, profileState.profiles[value]);
        // insert trÆ°á»›c addRowEl Ä‘á»ƒ form váº«n á»Ÿ cuá»‘i
        profileList.insertBefore(newRow, addRowEl);
        // remove form add
        addRowEl.remove();
        addRowEl = null;
      })
      .catch(() => showToast('KhÃ´ng thÃªm Ä‘Æ°á»£c profile (kiá»ƒm tra FastAPI).', 'error'));
  });

  const cancelBtn = document.createElement('button');
  cancelBtn.type = 'button';
  cancelBtn.className = 'btn-secondary';
  cancelBtn.textContent = 'Há»§y';
  cancelBtn.addEventListener('click', () => {
    if (addRowEl && addRowEl.parentNode) {
      addRowEl.parentNode.removeChild(addRowEl);
      addRowEl = null;
    }
  });

  addRowEl.appendChild(input);
  addRowEl.appendChild(saveBtn);
  addRowEl.appendChild(cancelBtn);
  // luÃ´n Ä‘á»ƒ form á»Ÿ cuá»‘i list
  if (profileList.classList.contains('empty-state-box')) {
    profileList.classList.remove('empty-state-box');
    profileList.innerHTML = '';
  }
  profileList.appendChild(addRowEl);
  input.focus();
}

if (saveApiKeyBtn) {
  saveApiKeyBtn.addEventListener('click', () => {
    profileState.apiKey = (settingApiKeyInput?.value || '').trim();
    // LÆ°u local trÆ°á»›c Ä‘á»ƒ khÃ´ng máº¥t dá»¯ liá»‡u náº¿u backend lá»—i
    saveProfileState();

    callBackend('/settings/api-key', {
      method: 'PUT',
      body: JSON.stringify({ api_key: profileState.apiKey }),
    })
      .then(() => showToast('ÄÃ£ lÆ°u API Key', 'success'))
      .catch(() => {
        showToast('KhÃ´ng lÆ°u Ä‘Æ°á»£c API Key (kiá»ƒm tra FastAPI).', 'error');
      });
  });
}

if (addProfileRowBtn) {
  addProfileRowBtn.addEventListener('click', showAddProfileRow);
}

if (feedAccountSettingBtn) {
  feedAccountSettingBtn.addEventListener('click', () => {
    const selected = getSelectedProfileIds();
    if (selected.length === 0) {
      showToast('HÃ£y tick Ã­t nháº¥t 1 profile trÆ°á»›c.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return;
    }
    if (!feedConfigPanel) {
      showToast('Thiáº¿u UI feedConfigPanel.', 'error');
      return;
    }
    // Náº¿u panel quÃ©t bÃ i viáº¿t Ä‘ang má»Ÿ thÃ¬ táº¯t Ä‘i Ä‘á»ƒ khá»i chá»“ng UI
    if (scanConfigPanel) scanConfigPanel.style.display = 'none';
    // Náº¿u panel quÃ©t theo group Ä‘ang má»Ÿ thÃ¬ táº¯t Ä‘i Ä‘á»ƒ khá»i chá»“ng UI
    if (groupScanPanel) groupScanPanel.style.display = 'none';
    feedConfigPanel.style.display = (feedConfigPanel.style.display === 'none' || !feedConfigPanel.style.display) ? 'block' : 'none';
  });
}

if (feedCancelBtn && feedConfigPanel) {
  feedCancelBtn.addEventListener('click', () => {
    feedConfigPanel.style.display = 'none';
  });
}

if (feedStartBtn) {
  feedStartBtn.addEventListener('click', async () => {
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ nuÃ´i acc.', 'error');
      return;
    }

    const modeEl = document.querySelector('input[name="feedMode"]:checked');
    const mode = modeEl ? String(modeEl.value || 'feed') : 'feed';
    const text = String(feedTextInput?.value || '').trim();
    const runMinutes = parseInt(String(feedRunMinutesInput?.value || '30').trim(), 10);
    const restMinutes = parseInt(String(feedRestMinutesInput?.value || '0').trim(), 10);

    // Feed: cho phÃ©p text rá»—ng (quÃ©t theo keyword máº·c Ä‘á»‹nh). Search: báº¯t buá»™c cÃ³ text.
    if (!text && mode === 'search') {
      showToast('Search cáº§n nháº­p text.', 'error');
      return;
    }
    if (!runMinutes || runMinutes <= 0) {
      showToast('Cháº¡y (phÃºt) khÃ´ng há»£p lá»‡.', 'error');
      return;
    }
    if (!Number.isFinite(restMinutes) || restMinutes < 0) {
      showToast('Nghá»‰ (phÃºt) khÃ´ng há»£p lá»‡.', 'error');
      return;
    }

    setButtonLoading(feedStartBtn, true, 'Äang cháº¡y...');
    setButtonLoading(feedAccountSettingBtn, true, 'Äang nuÃ´i acc...');
    try {
      const res = await callBackend('/feed/start', {
        method: 'POST',
        body: JSON.stringify({
          profile_ids: selected,
          mode,
          text,
          run_minutes: runMinutes,
          rest_minutes: restMinutes,
        }),
      });
      const started = res && Array.isArray(res.started) ? res.started.length : 0;
      const skipped = res && Array.isArray(res.skipped) ? res.skipped.length : 0;
      const loopText = (restMinutes > 0) ? ` (loop: ${runMinutes}p / nghá»‰ ${restMinutes}p)` : '';
      showToast(`ÄÃ£ cháº¡y nuÃ´i acc (${mode})${loopText}: started=${started}, skipped=${skipped}`, 'success', 2600);
      if (feedConfigPanel) feedConfigPanel.style.display = 'none';

      // Náº¿u cháº¡y vÃ²ng láº·p (restMinutes > 0) thÃ¬ coi nhÆ° cháº¡y liÃªn tá»¥c -> khÃ´ng poll "hoÃ n thÃ nh"
      if (restMinutes <= 0) {
        if (feedPollTimer) clearInterval(feedPollTimer);
        feedPollTimer = setInterval(async () => {
          try {
            const st = await callBackendNoAlert('/feed/status', { method: 'GET' });
            const running = (st && Array.isArray(st.running)) ? st.running : [];
            const still = selected.filter((pid) => running.includes(pid));
            if (still.length === 0) {
              clearInterval(feedPollTimer);
              feedPollTimer = null;
              setButtonLoading(feedStartBtn, false);
              setButtonLoading(feedAccountSettingBtn, false);
              showToast('âœ… NuÃ´i acc: HoÃ n thÃ nh', 'success', 2000);
            }
          } catch (e) {
            clearInterval(feedPollTimer);
            feedPollTimer = null;
            setButtonLoading(feedStartBtn, false);
            setButtonLoading(feedAccountSettingBtn, false);
            showToast('KhÃ´ng láº¥y Ä‘Æ°á»£c tráº¡ng thÃ¡i nuÃ´i acc (kiá»ƒm tra FastAPI).', 'error');
          }
        }, 4000);
      }
    } catch (e) {
      setButtonLoading(feedStartBtn, false);
      setButtonLoading(feedAccountSettingBtn, false);
      showToast('KhÃ´ng cháº¡y Ä‘Æ°á»£c nuÃ´i acc (kiá»ƒm tra FastAPI).', 'error');
    }
  });
}

if (autoJoinGroupBtn) {
  autoJoinGroupBtn.addEventListener('click', async () => {
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ auto join group.', 'error');
      return;
    }

    // Spinner + thÃ´ng bÃ¡o
    setButtonLoading(autoJoinGroupBtn, true, 'Äang auto join...');
    try {
      const res = await callBackend('/groups/join', {
        method: 'POST',
        body: JSON.stringify({ profile_ids: selected }),
      });
      const started = res && Array.isArray(res.started) ? res.started.length : 0;
      const skipped = res && Array.isArray(res.skipped) ? res.skipped.length : 0;
      showToast(`ÄÃ£ cháº¡y auto join group: started=${started}, skipped=${skipped}`, 'success', 2200);

      // Poll Ä‘áº¿n khi hoÃ n táº¥t (running khÃ´ng cÃ²n cÃ¡c profile Ä‘Ã£ chá»n)
      if (joinGroupPollTimer) clearInterval(joinGroupPollTimer);
      joinGroupPollTimer = setInterval(async () => {
        try {
          const st = await callBackendNoAlert('/groups/join/status', { method: 'GET' });
          const running = (st && Array.isArray(st.running)) ? st.running : [];
          const still = selected.filter((pid) => running.includes(pid));
          if (still.length === 0) {
            clearInterval(joinGroupPollTimer);
            joinGroupPollTimer = null;
            setButtonLoading(autoJoinGroupBtn, false);
            showToast('âœ… Auto join group: HoÃ n thÃ nh', 'success', 2000);
          }
        } catch (e) {
          // Náº¿u lá»—i poll thÃ¬ dá»«ng poll Ä‘á»ƒ khÃ´ng spam
          clearInterval(joinGroupPollTimer);
          joinGroupPollTimer = null;
          setButtonLoading(autoJoinGroupBtn, false);
          showToast('KhÃ´ng láº¥y Ä‘Æ°á»£c tráº¡ng thÃ¡i auto join (kiá»ƒm tra FastAPI).', 'error');
        }
      }, 4000);
    } catch (e) {
      showToast('KhÃ´ng cháº¡y Ä‘Æ°á»£c auto join group (kiá»ƒm tra FastAPI).', 'error');
      setButtonLoading(autoJoinGroupBtn, false);
    }
  });
}

// NÃºt "QuÃ©t bÃ i viáº¿t" trong tab Setting profile
if (scanPostsSettingBtn) {
  scanPostsSettingBtn.addEventListener('click', () => {
    const selected = getSelectedProfileIds();
    if (selected.length === 0) {
      showToast('HÃ£y tick Ã­t nháº¥t 1 profile trÆ°á»›c.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return;
    }
    if (!scanConfigPanel) {
      showToast('Thiáº¿u UI scanConfigPanel.', 'error');
      return;
    }
    // ÄÃ³ng panel nuÃ´i acc náº¿u Ä‘ang má»Ÿ Ä‘á»ƒ khá»i rá»‘i
    if (feedConfigPanel) feedConfigPanel.style.display = 'none';
    // ÄÃ³ng panel quÃ©t theo group náº¿u Ä‘ang má»Ÿ
    if (groupScanPanel) groupScanPanel.style.display = 'none';
    const isOpen = scanConfigPanel.style.display !== 'none';
    scanConfigPanel.style.display = isOpen ? 'none' : 'block';
  });
}

if (scanCancelBtn && scanConfigPanel) {
  scanCancelBtn.addEventListener('click', () => {
    scanConfigPanel.style.display = 'none';
  });
}

// NÃºt "QuÃ©t theo group" (UI only)
if (scanGroupSettingBtn) {
  scanGroupSettingBtn.addEventListener('click', () => {
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile trÆ°á»›c.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return;
    }
    if (!groupScanPanel) {
      showToast('Thiáº¿u UI groupScanPanel.', 'error');
      return;
    }
    // ÄÃ³ng cÃ¡c panel khÃ¡c Ä‘á»ƒ khá»i chá»“ng UI
    if (feedConfigPanel) feedConfigPanel.style.display = 'none';
    if (scanConfigPanel) scanConfigPanel.style.display = 'none';

    const isOpen = groupScanPanel.style.display !== 'none';
    groupScanPanel.style.display = isOpen ? 'none' : 'block';
    if (!isOpen && groupScanUrlInput) groupScanUrlInput.focus();
  });
}

if (groupScanCancelBtn && groupScanPanel) {
  groupScanCancelBtn.addEventListener('click', () => {
    groupScanPanel.style.display = 'none';
  });
}

// UI only: báº¥m "Cháº¡y" thÃ¬ chá»‰ validate + toast (chÆ°a gá»i API)
if (groupScanStartBtn) {
  groupScanStartBtn.addEventListener('click', () => {
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile trÆ°á»›c.', 'error');
      return;
    }
    const raw = String(groupScanUrlInput?.value || '');
    const urls = raw
      .split(/\r?\n/)
      .map((s) => String(s || '').trim())
      .filter(Boolean);
    const postCount = parseInt(String(groupScanPostCountInput?.value || '0').trim(), 10);
    if (urls.length === 0) {
      showToast('Nháº­p Ã­t nháº¥t 1 URL group (má»—i dÃ²ng 1 URL).', 'error');
      return;
    }
    if (!Number.isFinite(postCount) || postCount < 0) {
      showToast('Sá»‘ bÃ i viáº¿t theo dÃµi khÃ´ng há»£p lá»‡.', 'error');
      return;
    }
    showToast(`âœ… ÄÃ£ nháº­n ${urls.length} group URL + sá»‘ bÃ i theo dÃµi: ${postCount}`, 'success', 2200);
  });
}

if (scanStartBtn) {
  scanStartBtn.addEventListener('click', async () => {
    // Náº¿u Ä‘ang quÃ©t thÃ¬ khÃ´ng cho báº¥m láº¡i
    if (isScanning) {
      showToast('Äang quÃ©t, vui lÃ²ng Ä‘á»£i hoáº·c báº¥m dá»«ng trÆ°á»›c', 'warning');
      return;
    }
    
    // Náº¿u nÃºt Ä‘ang loading thÃ¬ khÃ´ng cho báº¥m láº¡i
    if (scanStartBtn.classList.contains('btn-loading')) {
      return;
    }
    
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ quÃ©t bÃ i viáº¿t.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return;
    }

    const runMinutes = parseInt(String(scanRunMinutesInput?.value || '0').trim(), 10);
    const restMinutes = parseInt(String(scanRestMinutesInput?.value || '0').trim(), 10);
    const text = String(scanTextInput?.value || '').trim();
    const mode = String(document.querySelector('input[name="scanMode"]:checked')?.value || 'feed').trim().toLowerCase();

    if (mode === 'search' && !text) {
      showToast('Search cáº§n nháº­p text Ä‘á»ƒ search.', 'error');
      return;
    }

    // cho user tháº¥y káº¿t quáº£ ngay á»Ÿ tab danh sÃ¡ch quÃ©t
    try { switchTab('scan'); } catch (_) { }

    setButtonLoading(scanStartBtn, true, 'Äang cháº¡y...');
    setButtonLoading(scanPostsSettingBtn, true, 'Äang quÃ©t...');
    try {
      await startScanFlow({ runMinutes, restMinutes, text, mode });
      // Ä‘Ã³ng panel sau khi cháº¡y
      if (scanConfigPanel) scanConfigPanel.style.display = 'none';
    } catch (e) {
      showToast('KhÃ´ng cháº¡y Ä‘Æ°á»£c quÃ©t bÃ i viáº¿t (kiá»ƒm tra FastAPI).', 'error');
      setButtonLoading(scanStartBtn, false);
      setButtonLoading(scanPostsSettingBtn, false);
      setScanning(false);
    }
    // KhÃ´ng reset loading á»Ÿ Ä‘Ã¢y vÃ¬ setScanning(true) sáº½ giá»¯ tráº¡ng thÃ¡i
  });
}

async function handleStopAll() {
  console.log('[UI] STOP ALL triggered');
  // stop-all cÃ³ thá»ƒ báº¥m tá»« left panel hoáº·c tá»« setting header
  const btns = [stopAllBtn, stopAllSettingBtn].filter(Boolean);
  btns.forEach((b) => setButtonLoading(b, true, 'Äang dá»«ng táº¥t cáº£...'));
  try {
    // Æ¯u tiÃªn endpoint má»›i theo spec, fallback endpoint cÅ© Ä‘á»ƒ khá»i vá»¡ UI
    let res = null;
    try {
      res = await callBackend('/control/stop-all', { method: 'POST' });
    } catch (_) {
      res = await callBackend('/jobs/stop-all', { method: 'POST' }); // backward-compat
    }
    const botStopped = res && res.stopped ? Boolean(res.stopped.bot) : false;
    const joinStopped = res && res.stopped && Array.isArray(res.stopped.join_groups) ? res.stopped.join_groups.length : 0;
    const nstOk = res && Array.isArray(res.nst_stop_ok) ? res.nst_stop_ok.length : 0;
    const nstAttempted = res && Array.isArray(res.nst_stop_attempted) ? res.nst_stop_attempted.length : 0;
    const nstAll = res && typeof res.nst_stop_all_ok === 'boolean' ? res.nst_stop_all_ok : false;
    showToast(`ÄÃ£ dá»«ng táº¥t cáº£: bot=${botStopped ? 'OK' : 'NO'}, join_groups=${joinStopped}, NST=${nstOk}/${nstAttempted}${nstAll ? ' +ALL' : ''}`, 'success', 2800);
  } catch (e) {
    showToast('KhÃ´ng dá»«ng Ä‘Æ°á»£c táº¥t cáº£ (kiá»ƒm tra FastAPI).', 'error');
  } finally {
    // Reset UI quÃ©t (trÃ¡nh káº¹t spinner náº¿u user dá»«ng báº±ng stop-all)
    if (timerId) {
      clearInterval(timerId);
      timerId = null;
    }
    if (dataCheckInterval) {
      clearInterval(dataCheckInterval);
      dataCheckInterval = null;
    }
    setScanning(false);
    setButtonLoading(scanStartBtn, false);
    setButtonLoading(scanPostsSettingBtn, false);
    setButtonLoading(stopBtn, false);

    btns.forEach((b) => setButtonLoading(b, false));
    if (joinGroupPollTimer) {
      clearInterval(joinGroupPollTimer);
      joinGroupPollTimer = null;
    }
    if (feedPollTimer) {
      clearInterval(feedPollTimer);
      feedPollTimer = null;
    }
    setButtonLoading(autoJoinGroupBtn, false);
    setButtonLoading(feedAccountSettingBtn, false);
    setButtonLoading(feedStartBtn, false);
    if (feedConfigPanel) feedConfigPanel.style.display = 'none';
  }
}

async function handleStopSelectedProfiles() {
  const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
  if (selected.length === 0) {
    showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ dá»«ng.', 'error');
    return;
  }
  if (!stopSelectedProfilesBtn) return;
  if (stopSelectedProfilesBtn.classList.contains('btn-loading')) return;

  console.log(`[UI] STOP selected profiles=${selected.join(',')}`);
  setButtonLoading(stopSelectedProfilesBtn, true, 'Äang dá»«ng...');

  try {
    const res = await callBackend('/control/stop-profiles', {
      method: 'POST',
      body: JSON.stringify({ profile_ids: selected }),
    });

    const okCount = res && Array.isArray(res.nst_ok) ? res.nst_ok.length : 0;
    const failCount = res && Array.isArray(res.nst_fail) ? res.nst_fail.length : 0;
    showToast(`ÄÃ£ dá»«ng ${selected.length} profile (NST ok=${okCount}, fail=${failCount})`, 'success', 2400);

    // Refresh state Ä‘á»ƒ badge vá» Sáº´N SÃ€NG ngay
    try {
      const jobs = await callBackendNoAlert('/jobs/status', { method: 'GET' });
      if (jobs) lastJobsStatus = jobs;
    } catch (_) { }
    try { await refreshControlState(); } catch (_) { }
    try { updateStopPauseButtonsByJobs(); } catch (_) { }
    // Náº¿u khÃ´ng cÃ²n bot_profile_ids thÃ¬ UI quÃ©t pháº£i vá» "Sáºµn sÃ ng"
    try {
      const botHasProfiles = Array.isArray(lastJobsStatus && lastJobsStatus.bot_profile_ids) && lastJobsStatus.bot_profile_ids.length > 0;
      if (!botHasProfiles) {
        if (dataCheckInterval) { clearInterval(dataCheckInterval); dataCheckInterval = null; }
        setScanning(false);
        setButtonLoading(scanStartBtn, false);
        setButtonLoading(scanPostsSettingBtn, false);
      }
    } catch (_) { }
  } catch (e) {
    showToast('KhÃ´ng dá»«ng Ä‘Æ°á»£c profile Ä‘Ã£ chá»n (kiá»ƒm tra FastAPI).', 'error');
  } finally {
    setButtonLoading(stopSelectedProfilesBtn, false);
  }
}

if (stopSelectedProfilesBtn) {
  stopSelectedProfilesBtn.addEventListener('click', handleStopSelectedProfiles);
}

async function handlePauseSelectedProfiles() {
  const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
  if (selected.length === 0) {
    showToast('Chá»n (tick) Ã­t nháº¥t 1 profile Ä‘á»ƒ pause.', 'error');
    return;
  }
  if (!pauseSelectedProfilesBtn) return;
  if (pauseSelectedProfilesBtn.classList.contains('btn-loading')) return;

  // Toggle: náº¿u cÃ³ Ã­t nháº¥t 1 profile Ä‘ang paused -> RESUME, ngÆ°á»£c láº¡i -> PAUSE
  const st0 = await callBackendNoAlert('/control/state', { method: 'GET' });
  const pausedSet = new Set(Array.isArray(st0 && st0.paused_profiles) ? st0.paused_profiles.map((x) => String(x)) : []);
  const anyPaused = selected.some((pid) => pausedSet.has(String(pid)));
  const action = anyPaused ? 'RESUME' : 'PAUSE';
  console.log(`[UI] ${action} selected profiles=${selected.join(',')}`);
  setButtonLoading(pauseSelectedProfilesBtn, true, anyPaused ? 'Äang tiáº¿p tá»¥c...' : 'Äang táº¡m dá»«ng...');
  try {
    const endpoint = anyPaused ? '/control/resume-profiles' : '/control/pause-profiles';
    await callBackend(endpoint, { method: 'POST', body: JSON.stringify({ profile_ids: selected }) });
    showToast(anyPaused ? `ÄÃ£ tiáº¿p tá»¥c ${selected.length} profile` : `ÄÃ£ táº¡m dá»«ng ${selected.length} profile`, 'success', 2200);
  } catch (e) {
    showToast('KhÃ´ng pause Ä‘Æ°á»£c profile Ä‘Ã£ tick (kiá»ƒm tra FastAPI).', 'error');
  } finally {
    setButtonLoading(pauseSelectedProfilesBtn, false);
    try { await refreshControlState(); } catch (_) { }
  }
}

if (pauseSelectedProfilesBtn) {
  pauseSelectedProfilesBtn.addEventListener('click', handlePauseSelectedProfiles);
}

async function refreshControlState() {
  try {
    const st = await callBackendNoAlert('/control/state', { method: 'GET' });
    if (!st) return;
    isPausedAll = Boolean(st.global_pause);
    try { updateSettingsActionButtons(); } catch (_) { }
    try { syncRunningLabelsWithPauseState(); } catch (_) { }
    setPauseAllButtonLabel(isPausedAll);
    try { applyControlStateToProfileRows(st); } catch (_) { }
    try { updateStopPauseButtonsByJobs(); } catch (_) { }
    // Update label cá»§a nÃºt pause-selected theo tráº¡ng thÃ¡i paused_profiles
    try {
      if (pauseSelectedProfilesBtn && !pauseSelectedProfilesBtn.classList.contains('btn-loading')) {
        const selected = getSelectedProfileIds();
        const pausedSet = new Set(Array.isArray(st.paused_profiles) ? st.paused_profiles.map((x) => String(x)) : []);
        const anyPaused = selected.some((pid) => pausedSet.has(String(pid)));
        pauseSelectedProfilesBtn.textContent = anyPaused ? 'Tiáº¿p tá»¥c profile Ä‘Ã£ chá»n' : 'Táº¡m dá»«ng profile Ä‘Ã£ chá»n';
      }
    } catch (_) { }
  } catch (_) { }
}

function _clearIntervalSafe(kind) {
  try {
    if (kind === 'scan' && scanBackendPollTimer) clearInterval(scanBackendPollTimer);
    if (kind === 'join' && joinGroupPollTimer) clearInterval(joinGroupPollTimer);
    if (kind === 'feed' && feedPollTimer) clearInterval(feedPollTimer);
  } catch (_) { }
  if (kind === 'scan') scanBackendPollTimer = null;
  if (kind === 'join') joinGroupPollTimer = null;
  if (kind === 'feed') feedPollTimer = null;
}

function startScanBackendPoll({ silent = true } = {}) {
  _clearIntervalSafe('scan');
  scanBackendPollTimer = setInterval(async () => {
    const st = await callBackendNoAlert('/jobs/status', { method: 'GET' });
    if (st) lastJobsStatus = st;
    updateStopPauseButtonsByJobs();
    const botHasProfiles = Array.isArray(st && st.bot_profile_ids) && st.bot_profile_ids.length > 0;
    const running = !!(st && st.bot_running && botHasProfiles);
    if (!running) {
      _clearIntervalSafe('scan');
      if (dataCheckInterval) {
        clearInterval(dataCheckInterval);
        dataCheckInterval = null;
      }
      setScanning(false);
      setButtonLoading(scanStartBtn, false);
      setButtonLoading(scanPostsSettingBtn, false);
      if (!silent) showToast('âœ… QuÃ©t: HoÃ n thÃ nh', 'success', 1800);
    } else {
      syncRunningLabelsWithPauseState();
      try { refreshControlState(); } catch (_) { }
    }
  }, 4000);
}

function startJoinBackendPoll({ silent = true } = {}) {
  _clearIntervalSafe('join');
  joinGroupPollTimer = setInterval(async () => {
    const st = await callBackendNoAlert('/jobs/status', { method: 'GET' });
    if (st) lastJobsStatus = st;
    updateStopPauseButtonsByJobs();
    const running = (st && Array.isArray(st.join_groups_running)) ? st.join_groups_running : [];
    if (running.length === 0) {
      _clearIntervalSafe('join');
      setButtonLoading(autoJoinGroupBtn, false);
      if (!silent) showToast('âœ… Auto join group: HoÃ n thÃ nh', 'success', 1800);
    } else {
      syncRunningLabelsWithPauseState();
      try { refreshControlState(); } catch (_) { }
    }
  }, 4000);
}

function startFeedBackendPoll({ silent = true } = {}) {
  _clearIntervalSafe('feed');
  feedPollTimer = setInterval(async () => {
    const st = await callBackendNoAlert('/jobs/status', { method: 'GET' });
    if (st) lastJobsStatus = st;
    updateStopPauseButtonsByJobs();
    const running = (st && Array.isArray(st.feed_running)) ? st.feed_running : [];
    if (running.length === 0) {
      _clearIntervalSafe('feed');
      setButtonLoading(feedStartBtn, false);
      setButtonLoading(feedAccountSettingBtn, false);
      if (!silent) showToast('âœ… NuÃ´i acc: HoÃ n thÃ nh', 'success', 1800);
    } else {
      syncRunningLabelsWithPauseState();
      try { refreshControlState(); } catch (_) { }
    }
  }, 4000);
}

async function resyncUiFromBackendAfterReload() {
  // Sync pause state trÆ°á»›c Ä‘á»ƒ label chuáº©n
  await refreshControlState();

  const jobs = await callBackendNoAlert('/jobs/status', { method: 'GET' });
  if (!jobs) return;
  lastJobsStatus = jobs;
  updateStopPauseButtonsByJobs();

  // --- Scan (AppRunner) ---
  if (jobs.bot_running) {
    setScanning(true);
    setButtonLoading(scanStartBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang cháº¡y...');
    setButtonLoading(scanPostsSettingBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang quÃ©t...');
    if (!dataCheckInterval) dataCheckInterval = setInterval(checkForNewData, 5000);
    startScanBackendPoll({ silent: true });
  } else {
    setScanning(false);
    setButtonLoading(scanStartBtn, false);
    setButtonLoading(scanPostsSettingBtn, false);
    _clearIntervalSafe('scan');
  }

  // --- Join groups ---
  const joinRunning = Array.isArray(jobs.join_groups_running) ? jobs.join_groups_running : [];
  if (joinRunning.length > 0) {
    setButtonLoading(autoJoinGroupBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang auto join...');
    startJoinBackendPoll({ silent: true });
  } else {
    setButtonLoading(autoJoinGroupBtn, false);
    _clearIntervalSafe('join');
  }

  // --- Feed ---
  const feedRunning = Array.isArray(jobs.feed_running) ? jobs.feed_running : [];
  if (feedRunning.length > 0) {
    setButtonLoading(feedStartBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang cháº¡y...');
    setButtonLoading(feedAccountSettingBtn, true, isPausedAll ? 'Äang táº¡m dá»«ng...' : 'Äang nuÃ´i acc...');
    startFeedBackendPoll({ silent: true });
  } else {
    setButtonLoading(feedStartBtn, false);
    setButtonLoading(feedAccountSettingBtn, false);
    _clearIntervalSafe('feed');
  }

  syncRunningLabelsWithPauseState();
  // Re-apply control state sau khi Ä‘Ã£ cÃ³ lastJobsStatus Ä‘á»ƒ badge khÃ´ng bá»‹ sai lÃºc vá»«a vÃ o trang
  try { await refreshControlState(); } catch (_) { }
}

async function handlePauseAllToggle() {
  if (!pauseAllBtn) return;
  if (pauseAllBtn.classList.contains('btn-loading')) return;
  try {
    if (!isPausedAll) {
      console.log('[UI] PAUSE ALL triggered');
      setButtonLoading(pauseAllBtn, true, 'Äang táº¡m dá»«ng...');
      // update UI ngay Ä‘á»ƒ trÃ¡nh user tháº¥y "Ä‘ang quÃ©t" khi Ä‘Ã£ pause
      isPausedAll = true;
      syncRunningLabelsWithPauseState();
      await callBackend('/control/pause-all', { method: 'POST' });
      showToast('ÄÃ£ táº¡m dá»«ng táº¥t cáº£', 'success');
    } else {
      console.log('[UI] RESUME ALL triggered');
      setButtonLoading(pauseAllBtn, true, 'Äang tiáº¿p tá»¥c...');
      isPausedAll = false;
      syncRunningLabelsWithPauseState();
      await callBackend('/control/resume-all', { method: 'POST' });
      showToast('ÄÃ£ tiáº¿p tá»¥c táº¥t cáº£', 'success');
    }
  } catch (e) {
    showToast('KhÃ´ng pause/resume Ä‘Æ°á»£c (kiá»ƒm tra FastAPI).', 'error');
  } finally {
    setButtonLoading(pauseAllBtn, false);
    await refreshControlState();
  }
}

if (pauseAllBtn) {
  pauseAllBtn.addEventListener('click', handlePauseAllToggle);
}

if (stopAllBtn) {
  stopAllBtn.addEventListener('click', handleStopAll);
}

if (stopAllSettingBtn) {
  stopAllSettingBtn.addEventListener('click', handleStopAll);
}

function getTypeColorClass(type) {
  const typeLower = String(type).toLowerCase().trim();

  // Xanh cho: scan, success, ok, completed
  if (typeLower === 'type1' || typeLower === 'success' || typeLower === 'ok' || typeLower === 'completed') {
    return 'type-green';
  }

  // VÃ ng cho: retry, warning, pending, processing
  if (typeLower === 'type2' || typeLower === 'warning' || typeLower === 'pending' || typeLower === 'processing') {
    return 'type-yellow';
  }

  // Äá» cho: error, fail, failed, cancel
  if (typeLower === 'type3' || typeLower === 'fail' || typeLower === 'failed' || typeLower === 'cancel') {
    return 'type-red';
  }

  // Máº·c Ä‘á»‹nh: xanh
  return 'type-green';
}

// Map flag -> type cho quáº£n lÃ½ post
function mapFlagToType(flag) {
  const f = String(flag || '').toLowerCase();
  if (f === 'xanh') return 'type1';
  if (f === 'vÃ ng' || f === 'vang') return 'type2';
  if (f === 'Ä‘á»' || f === 'do') return 'type3';
  return 'type1';
}

function appendRow({ id, userId, name, react, comment, time, type }) {
  const tr = document.createElement('tr');
  const typeColorClass = getTypeColorClass(type);
  // React: hiá»ƒn thá»‹ dáº¥u tÃ­ch náº¿u cÃ³, khÃ´ng thÃ¬ Ä‘á»ƒ trá»‘ng
  const reactDisplay = react ? 'âœ“' : '';
  // Link cho ID BÃ i Post vÃ  ID User
  const postIdDisplay = id
    ? `<a href="https://fb.com/${id}" target="_blank" rel="noopener noreferrer" class="id-link">${id}</a>`
    : '';
  const userIdDisplay = userId
    ? `<a href="https://fb.com/${userId}" target="_blank" rel="noopener noreferrer" class="id-link">${userId}</a>`
    : '';
  // Comment: náº¿u cÃ³ comment thÃ¬ hiá»ƒn thá»‹ icon con máº¯t, click má»›i xem ná»™i dung
  const hasComment = !!comment;
  const commentDisplay = hasComment ? '<button class="comment-eye-btn" type="button" title="Xem comment">ðŸ‘</button>' : '';

  // LÆ°u timestamp Ä‘á»ƒ sáº¯p xáº¿p
  const timestamp = parseTime(time || '');
  tr.dataset.timestamp = timestamp;
  tr.dataset.hasReact = react ? 'true' : 'false';
  tr.dataset.hasComment = hasComment ? 'true' : 'false';

  tr.innerHTML = `
    <td>${postIdDisplay}</td>
    <td>${userIdDisplay}</td>
    <td>${name || ''}</td>
    <td>${reactDisplay}</td>
    <td>${commentDisplay}</td>
    <td>${time || ''}</td>
    <td class="type-cell ${typeColorClass}">${type || ''}</td>
  `;
  tr.style.opacity = '0';
  tr.style.transform = 'translateY(-10px)';
  tbody.appendChild(tr);

  // Gáº¯n dá»¯ liá»‡u comment vÃ  sá»± kiá»‡n click cho icon con máº¯t
  if (hasComment) {
    const commentCell = tr.children[4]; // cá»™t Comment
    commentCell.dataset.comment = comment;
    commentCell.dataset.showingText = 'false'; // Tráº¡ng thÃ¡i: false = Ä‘ang hiá»ƒn thá»‹ icon, true = Ä‘ang hiá»ƒn thá»‹ text

    const eyeBtn = commentCell.querySelector('.comment-eye-btn');
    if (eyeBtn) {
      // HÃ m toggle giá»¯a icon vÃ  text
      const toggleComment = (e) => {
        if (e) e.stopPropagation();
        const text = commentCell.dataset.comment || '';
        if (!text) return;

        const isShowingText = commentCell.dataset.showingText === 'true';

        if (isShowingText) {
          // Äang hiá»ƒn thá»‹ text â†’ chuyá»ƒn vá» icon
          commentCell.innerHTML = '<button class="comment-eye-btn" type="button" title="Xem comment">ðŸ‘</button>';
          commentCell.dataset.showingText = 'false';
          // Gáº¯n láº¡i event listener cho icon má»›i
          const newEyeBtn = commentCell.querySelector('.comment-eye-btn');
          if (newEyeBtn) {
            newEyeBtn.addEventListener('click', toggleComment);
          }
        } else {
          // Äang hiá»ƒn thá»‹ icon â†’ chuyá»ƒn sang text
          commentCell.innerHTML = `<span class="comment-text" style="cursor: pointer; color: var(--text-primary);">${text}</span>`;
          commentCell.dataset.showingText = 'true';
          // Gáº¯n event listener cho text Ä‘á»ƒ click láº¡i sáº½ hiá»‡n icon
          const commentText = commentCell.querySelector('.comment-text');
          if (commentText) {
            commentText.addEventListener('click', toggleComment);
          }
        }
      };

      eyeBtn.addEventListener('click', toggleComment);
    }
  }

  // Animation
  setTimeout(() => {
    tr.style.transition = 'all 0.3s ease';
    tr.style.opacity = '1';
    tr.style.transform = 'translateY(0)';
  }, 10);

  emptyState.classList.remove('show');
  updateRowCount();
}

// ThÃªm dÃ²ng cho báº£ng Quáº£n lÃ½ post
function appendPostRow(post) {
  if (!postTableBody) return;
  const type = mapFlagToType(post.flag);
  const typeClass = getTypeColorClass(type);
  const tr = document.createElement('tr');
  const postId = post.id || '';
  const text = post.text || '';

  const postLink = postId
    ? `<a href="https://fb.com/${postId}" target="_blank" rel="noopener noreferrer" class="id-link">${postId}</a>`
    : '';

  tr.innerHTML = `
    <td>${postLink}</td>
    <td>${text}</td>
    <td class="type-cell ${typeClass}">${type}</td>
  `;

  postTableBody.appendChild(tr);
}

function addGeneratedRow() {
  // Táº¡o type ngáº«u nhiÃªn Ä‘á»ƒ cÃ³ mÃ u sáº¯c Ä‘a dáº¡ng
  const types = ['type1', 'type2', 'type3'];
  const randomType = types[Math.floor(Math.random() * types.length)];
  const names = ['Nguyá»…n VÄƒn A', 'Tráº§n Thá»‹ B', 'LÃª VÄƒn C', 'Pháº¡m Thá»‹ D', 'HoÃ ng VÄƒn E'];
  const randomName = names[Math.floor(Math.random() * names.length)];
  const comments = ['Ráº¥t hay!', 'Cáº£m Æ¡n báº¡n', 'Tuyá»‡t vá»i', 'Äá»“ng Ã½', ''];
  const randomComment = comments[Math.floor(Math.random() * comments.length)];

  appendRow({
    id: counter++,
    userId: `user_${Math.floor(Math.random() * 1000000)}`,
    name: randomName,
    react: Math.random() > 0.3, // 70% cÃ³ react
    comment: randomComment,
    time: new Date().toLocaleTimeString('vi-VN'),
    type: randomType,
  });
}

// HÃ m kiá»ƒm tra vÃ  thÃªm dá»¯ liá»‡u má»›i
async function checkForNewData() {
  try {
    const res = await fetch('../backend/data/results/all_results_summary.json');
    if (!res.ok) throw new Error('Fetch failed');
    const data = await res.json();

    // Láº¥y táº¥t cáº£ posts tá»« results_by_file
    const allPosts = [];
    Object.values(data.results_by_file || {}).forEach(filePosts => {
      if (Array.isArray(filePosts)) {
        allPosts.push(...filePosts);
      }
    });

    let newCount = 0;
    // Chá»‰ thÃªm nhá»¯ng user má»›i (gá»™p cáº£ react & comment)
    allPosts.forEach((post) => {
      const postId = post.post_id || '';
      if (!postId) return;

      // Map flag thÃ nh type
      let type = 'type1';
      const flag = (post.flag || '').toLowerCase();
      if (flag === 'xanh') {
        type = 'type1';
      } else if (flag === 'vÃ ng' || flag === 'vang') {
        type = 'type2';
      } else if (flag === 'Ä‘á»' || flag === 'do') {
        type = 'type3';
      }

      // Thá»i gian máº·c Ä‘á»‹nh: comment má»›i nháº¥t cá»§a bÃ i (náº¿u cÃ³)
      let defaultTime = new Date().toLocaleTimeString('vi-VN');
      if (post.comments && post.comments.length > 0) {
        const sortedAllComments = [...post.comments].sort((a, b) => {
          const timeA = new Date(a.created_time_vn || 0);
          const timeB = new Date(b.created_time_vn || 0);
          return timeB - timeA;
        });
        if (sortedAllComments[0] && sortedAllComments[0].created_time_vn) {
          defaultTime = sortedAllComments[0].created_time_vn;
        }
      }

      // Gom reactions theo userId
      const reactionsByUser = new Map();
      if (post.reactions && post.reactions.length > 0) {
        post.reactions.forEach((r) => {
          const uid = r && r.id ? String(r.id) : '';
          if (!uid) return;
          reactionsByUser.set(uid, r);
        });
      }

      // Gom comments theo userId (láº¥y comment má»›i nháº¥t cá»§a tá»«ng user)
      const commentsByUser = new Map();
      if (post.comments && post.comments.length > 0) {
        post.comments.forEach((c) => {
          const uid = c && c.id ? String(c.id) : '';
          if (!uid) return;
          const prev = commentsByUser.get(uid);
          if (!prev) {
            commentsByUser.set(uid, c);
          } else {
            const prevTime = new Date(prev.created_time_vn || 0);
            const curTime = new Date(c.created_time_vn || 0);
            if (curTime > prevTime) {
              commentsByUser.set(uid, c);
            }
          }
        });
      }

      // Táº­p táº¥t cáº£ user xuáº¥t hiá»‡n á»Ÿ react hoáº·c comment
      const allUserIds = new Set([
        ...reactionsByUser.keys(),
        ...commentsByUser.keys(),
      ]);

      allUserIds.forEach((uid) => {
        const reaction = reactionsByUser.get(uid);
        const comment = commentsByUser.get(uid);

        const userId = uid;
        const name =
          (reaction && reaction.name) ||
          (comment && comment.name) ||
          '';

        const hasReact = !!reaction;
        const commentText = comment && comment.text ? comment.text : '';
        const time =
          (comment && comment.created_time_vn) ? comment.created_time_vn : defaultTime;

        const uniqueKey = `${postId}_${userId}`;
        if (uniqueKey && !loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: userId,
            name: name,
            react: hasReact,        // chá»‰ tick náº¿u cÃ³ trong reactions
            comment: commentText,   // chá»‰ cÃ³ text náº¿u user cÃ³ comment
            time: time,
            type: type,
          });

          loadedPostIds.add(uniqueKey);
          newCount++;
        }
      });
    });

    if (newCount > 0) {
      console.log(`ÄÃ£ thÃªm ${newCount} dÃ²ng dá»¯ liá»‡u má»›i`);
    }
  } catch (err) {
    console.error('KhÃ´ng kiá»ƒm tra Ä‘Æ°á»£c dá»¯ liá»‡u má»›i:', err);
  }
}

async function loadInitialData() {
  // Reset Ä‘á»ƒ cÃ³ thá»ƒ load láº¡i khi click
  initialLoaded = false;
  // XÃ³a dá»¯ liá»‡u cÅ© trÆ°á»›c khi load má»›i
  tbody.innerHTML = '';
  counter = 1;
  loadedPostIds.clear(); // XÃ³a danh sÃ¡ch post_id Ä‘Ã£ load

  try {
    // Äá»c tá»« all_results_summary.json
    const res = await fetch('../backend/data/results/all_results_summary.json');
    if (!res.ok) {
      throw new Error(`HTTP error! status: ${res.status}`);
    }
    const data = await res.json();
    console.log('ÄÃ£ load file JSON thÃ nh cÃ´ng, tá»•ng sá»‘ files:', data.total_files);

    // Láº¥y táº¥t cáº£ posts tá»« results_by_file
    const allPosts = [];
    Object.values(data.results_by_file || {}).forEach(filePosts => {
      if (Array.isArray(filePosts)) {
        allPosts.push(...filePosts);
      }
    });

    console.log(`Tá»•ng sá»‘ posts cáº§n hiá»ƒn thá»‹: ${allPosts.length}`);

    // Chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u sang format cá»§a báº£ng
    let displayedCount = 0;
    allPosts.forEach((post) => {
      const postId = post.post_id || '';
      if (!postId) return; // Bá» qua náº¿u khÃ´ng cÃ³ post_id

      // Map flag thÃ nh type (xanh -> type1, vÃ ng -> type2, Ä‘á» -> type3)
      let type = 'type1'; // máº·c Ä‘á»‹nh
      const flag = (post.flag || '').toLowerCase();
      if (flag === 'xanh') {
        type = 'type1';
      } else if (flag === 'vÃ ng' || flag === 'vang') {
        type = 'type2';
      } else if (flag === 'Ä‘á»' || flag === 'do') {
        type = 'type3';
      }

      // Thá»i gian máº·c Ä‘á»‹nh: comment má»›i nháº¥t cá»§a bÃ i (náº¿u cÃ³)
      let defaultTime = new Date().toLocaleTimeString('vi-VN');
      if (post.comments && post.comments.length > 0) {
        const sortedAllComments = [...post.comments].sort((a, b) => {
          const timeA = new Date(a.created_time_vn || 0);
          const timeB = new Date(b.created_time_vn || 0);
          return timeB - timeA;
        });
        if (sortedAllComments[0] && sortedAllComments[0].created_time_vn) {
          defaultTime = sortedAllComments[0].created_time_vn;
        }
      }

      // Gom reactions theo userId
      const reactionsByUser = new Map();
      if (post.reactions && post.reactions.length > 0) {
        post.reactions.forEach((r) => {
          const uid = r && r.id ? String(r.id) : '';
          if (!uid) return;
          reactionsByUser.set(uid, r);
        });
      }

      // Gom comments theo userId (láº¥y comment má»›i nháº¥t cá»§a tá»«ng user)
      const commentsByUser = new Map();
      if (post.comments && post.comments.length > 0) {
        post.comments.forEach((c) => {
          const uid = c && c.id ? String(c.id) : '';
          if (!uid) return;
          const prev = commentsByUser.get(uid);
          if (!prev) {
            commentsByUser.set(uid, c);
          } else {
            const prevTime = new Date(prev.created_time_vn || 0);
            const curTime = new Date(c.created_time_vn || 0);
            if (curTime > prevTime) {
              commentsByUser.set(uid, c);
            }
          }
        });
      }

      // Táº­p táº¥t cáº£ user xuáº¥t hiá»‡n á»Ÿ react hoáº·c comment
      const allUserIds = new Set([
        ...reactionsByUser.keys(),
        ...commentsByUser.keys(),
      ]);

      allUserIds.forEach((uid) => {
        const reaction = reactionsByUser.get(uid);
        const comment = commentsByUser.get(uid);

        const userId = uid;
        const name =
          (reaction && reaction.name) ||
          (comment && comment.name) ||
          '';

        const hasReact = !!reaction;
        const commentText = comment && comment.text ? comment.text : '';
        const time =
          (comment && comment.created_time_vn) ? comment.created_time_vn : defaultTime;

        const uniqueKey = `${postId}_${userId}`; // Táº¡o key duy nháº¥t cho má»—i cáº·p post-user
        if (uniqueKey && !loadedPostIds.has(uniqueKey)) {
          appendRow({
            id: postId,
            userId: userId,
            name: name,
            react: hasReact,        // chá»‰ tÃ­ch náº¿u user cÃ³ react
            comment: commentText,   // chá»‰ cÃ³ text náº¿u user cÃ³ comment
            time: time,
            type: type,
          });

          // ÄÃ¡nh dáº¥u Ä‘Ã£ load
          loadedPostIds.add(uniqueKey);
          displayedCount++;
        }
      });
    });

    console.log(`ÄÃ£ hiá»ƒn thá»‹ ${displayedCount} dÃ²ng dá»¯ liá»‡u`);
    initialLoaded = true;
  } catch (err) {
    console.error('KhÃ´ng táº£i Ä‘Æ°á»£c all_results_summary.json', err);
    // Fallback: thá»­ load data.json cÅ©
    try {
      const res = await fetch('data.json');
      if (res.ok) {
        const rows = await res.json();
        rows.forEach((row) => {
          appendRow(row);
          counter = Math.max(counter, Number(row.id) + 1);
        });
        initialLoaded = true;
      }
    } catch (fallbackErr) {
      console.error('KhÃ´ng táº£i Ä‘Æ°á»£c data.json', fallbackErr);
    }
  }

  // Show empty state if no rows
  if (tbody.children.length === 0) {
    emptyState.classList.add('show');
  }
}

// Start quÃ©t bÃ i viáº¿t (dÃ¹ng chung cho nÃºt "Báº¯t Ä‘áº§u quÃ©t" vÃ  nÃºt trong tab Setting profile)
async function startScanFlow(options = {}) {
  // Náº¿u Ä‘ang quÃ©t thÃ¬ khÃ´ng cho cháº¡y láº¡i
  if (isScanning) {
    showToast('Äang quÃ©t, vui lÃ²ng Ä‘á»£i hoáº·c báº¥m dá»«ng trÆ°á»›c', 'warning');
    return;
  }
  
  const {
    runMinutes,
    restMinutes,
    text,
    mode,
  } = options || {};
  
  try {
    // Load vÃ  hiá»ƒn thá»‹ táº¥t cáº£ dá»¯ liá»‡u tá»« all_results_summary.json ngay láº­p tá»©c
    // KhÃ´ng cáº§n chá» backend, hiá»ƒn thá»‹ dá»¯ liá»‡u trÆ°á»›c
    await loadInitialData();

    // Náº¿u Ä‘ang cÃ³ interval check data cÅ© thÃ¬ clear trÆ°á»›c Ä‘á»ƒ trÃ¡nh setInterval chá»“ng
    if (dataCheckInterval) {
      clearInterval(dataCheckInterval);
      dataCheckInterval = null;
    }

    // Sau Ä‘Ã³ má»›i cháº¡y backend (náº¿u cáº§n)
    const ok = await triggerBackendRun({ runMinutes, restMinutes, text, mode });
    if (!ok) {
      setScanning(false);
      return;
    }

    // Tá»± Ä‘á»™ng kiá»ƒm tra dá»¯ liá»‡u má»›i má»—i 5 giÃ¢y Ä‘á»ƒ cáº­p nháº­t khi cÃ³ dá»¯ liá»‡u má»›i
    const checkInterval = 5000; // 5 giÃ¢y
    dataCheckInterval = setInterval(checkForNewData, checkInterval);

    setScanning(true);
    // Poll /jobs/status Ä‘á»ƒ sync UI nÃºt dá»«ng/táº¡m dá»«ng + tá»± táº¯t khi backend dá»«ng
    try { startScanBackendPoll({ silent: true }); } catch (_) { }
    try { updateStopPauseButtonsByJobs(); } catch (_) { }
    try { await refreshControlState(); } catch (_) { }
  } catch (err) {
    console.error('Lá»—i trong startScanFlow:', err);
    setScanning(false);
    throw err;
  }
}

startBtn.addEventListener(
  'click',
  async () => {
    // Náº¿u Ä‘ang quÃ©t thÃ¬ khÃ´ng cho báº¥m láº¡i
    if (isScanning) {
      showToast('Äang quÃ©t, vui lÃ²ng Ä‘á»£i hoáº·c báº¥m dá»«ng trÆ°á»›c', 'warning');
      return;
    }
    
    // Náº¿u nÃºt Ä‘ang loading thÃ¬ khÃ´ng cho báº¥m láº¡i
    if (startBtn.classList.contains('btn-loading')) {
      return;
    }
    
    try {
      await startScanFlow();
    } catch (err) {
      console.warn('KhÃ´ng startScanFlow Ä‘Æ°á»£c:', err);
      showToast('KhÃ´ng thá»ƒ khá»Ÿi Ä‘á»™ng quÃ©t', 'error');
      setScanning(false);
    }
  }
);

stopBtn.addEventListener('click', async () => {
  // Náº¿u Ä‘ang dá»«ng rá»“i thÃ¬ khÃ´ng lÃ m gÃ¬
  if (stopBtn.classList.contains('btn-loading')) {
    return;
  }
  
  // ThÃªm loading state cho nÃºt dá»«ng
  setButtonLoading(stopBtn, true, 'Äang dá»«ng...');
  
  try {
    // Dá»«ng táº¥t cáº£ intervals vÃ  timers
    if (timerId) {
      clearInterval(timerId);
      timerId = null;
    }
    // Dá»«ng kiá»ƒm tra dá»¯ liá»‡u má»›i
    if (dataCheckInterval) {
      clearInterval(dataCheckInterval);
      dataCheckInterval = null;
    }

    // Reset UI NGAY Láº¬P Tá»¨C Ä‘á»ƒ user báº¥m láº¡i Ä‘Æ°á»£c (khÃ´ng chá» backend)
    setScanning(false);
    setButtonLoading(scanStartBtn, false);
    setButtonLoading(scanPostsSettingBtn, false);

    // Gá»­i lá»‡nh dá»«ng backend (cÃ³ thá»ƒ cháº­m/timeout, nhÆ°ng UI khÃ´ng bá»‹ káº¹t)
    await sendStopSignal();
    
    showToast('ÄÃ£ dá»«ng quÃ©t', 'success');
  } catch (err) {
    console.warn('Lá»—i khi dá»«ng:', err);
    showToast('CÃ³ lá»—i khi dá»«ng quÃ©t', 'error');
  } finally {
    // Bá» loading state cá»§a nÃºt dá»«ng
    setButtonLoading(stopBtn, false);
  }
});

// Xuáº¥t file Excel
const exportExcelBtn = document.getElementById('exportExcelBtn');

function exportToExcel() {
  const table = document.getElementById('listTable');
  const rows = table.querySelectorAll('tr');

  if (rows.length <= 1) {
    alert('KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘á»ƒ xuáº¥t!');
    return;
  }

  // Táº¡o dá»¯ liá»‡u cho Excel
  const data = [];

  // ThÃªm header
  const headerRow = [];
  table.querySelectorAll('thead th').forEach(th => {
    headerRow.push(th.textContent);
  });
  data.push(headerRow);

  // ThÃªm dá»¯ liá»‡u
  table.querySelectorAll('tbody tr').forEach(tr => {
    const row = [];
    tr.querySelectorAll('td').forEach(td => {
      row.push(td.textContent);
    });
    data.push(row);
  });

  // Táº¡o workbook vÃ  worksheet
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.aoa_to_sheet(data);

  // Äáº·t Ä‘á»™ rá»™ng cá»™t
  ws['!cols'] = [
    { wch: 18 }, // ID BÃ i Post
    { wch: 18 }, // ID User
    { wch: 20 }, // Name
    { wch: 12 }, // React
    { wch: 12 }, // Comment
    { wch: 20 }, // Time
    { wch: 15 }  // Type
  ];

  // ThÃªm worksheet vÃ o workbook
  XLSX.utils.book_append_sheet(wb, ws, 'Danh sÃ¡ch quÃ©t');

  // Táº¡o tÃªn file vá»›i timestamp
  const now = new Date();
  const timestamp = now.toISOString().slice(0, 19).replace(/:/g, '-');
  const filename = `danh_sach_quet_${timestamp}.xlsx`;

  // Xuáº¥t file
  XLSX.writeFile(wb, filename);

  // Hiá»ƒn thá»‹ thÃ´ng bÃ¡o
  const btnText = exportExcelBtn.querySelector('span:last-child');
  const originalText = btnText.textContent;
  btnText.textContent = 'ÄÃ£ xuáº¥t!';
  exportExcelBtn.disabled = true;

  setTimeout(() => {
    btnText.textContent = originalText;
    exportExcelBtn.disabled = false;
  }, 2000);
}

exportExcelBtn.addEventListener('click', exportToExcel);

// ==== FastAPI integration ====

function setBackendStatus(message, isOnline = false) {
  backendStatus.textContent = message;
  statusDot.classList.toggle('online', isOnline);
}

async function callBackend(path, options = {}) {
  const url = `${API_BASE}${path}`;
  const method = (options.method || 'POST').toUpperCase();
  const headers = { ...(options.headers || {}) };
  // Chá»‰ set Content-Type khi cÃ³ body => trÃ¡nh preflight OPTIONS spam cho GET /status
  if (options.body != null && !headers['Content-Type']) {
    headers['Content-Type'] = 'application/json';
  }

  const res = await fetch(url, {
    method,
    headers,
    ...options,
  });

  let data = {};
  try {
    data = await res.json();
  } catch (e) {
    // ignore parse errors, will throw below if not ok
  }

  if (!res.ok) {
    let detail = data.detail || res.statusText || 'Request failed';
    // Náº¿u backend tráº£ detail dáº¡ng object (vd: {message, missing:[...]}) thÃ¬ format láº¡i cho dá»… Ä‘á»c
    try {
      if (detail && typeof detail === 'object') {
        const msg = detail.message ? String(detail.message) : 'Request failed';
        const missing = Array.isArray(detail.missing) ? detail.missing : [];
        if (missing.length > 0) {
          const lines = missing.map((x) => {
            const pid = (x && x.profile_id) ? String(x.profile_id) : '(unknown)';
            const fields = Array.isArray(x && x.missing) ? x.missing.join(', ') : '';
            return `${pid}${fields ? ` thiáº¿u: ${fields}` : ''}`;
          });
          detail = `${msg} ${lines.join(' | ')}`;
        } else {
          detail = msg;
        }
      }
    } catch (_) { }
    throw new Error(String(detail));
  }

  return data;
}

async function callBackendNoAlert(path, options = {}) {
  try {
    return await callBackend(path, options);
  } catch (e) {
    return null;
  }
}

async function triggerBackendRun(options = {}) {
  setBackendStatus('Äang gá»­i lá»‡nh cháº¡y...', false);
  try {
    // Báº¯t buá»™c pháº£i chá»n (tick) profile trÆ°á»›c khi cháº¡y backend
    const selected = Object.keys(profileState.selected || {}).filter((pid) => profileState.selected[pid]);
    if (selected.length === 0) {
      showToast('HÃ£y tick Ã­t nháº¥t 1 profile á»Ÿ tab "Setting profile" trÆ°á»›c khi cháº¡y.', 'error');
      try { switchTab('settings'); } catch (_) { }
      return false;
    }

    const runMinutes = (options.runMinutes != null) ? Number(options.runMinutes) : Number(runMinutesInput.value);
    // DÃ¹ng luÃ´n "Thá»i gian láº·p láº¡i (phÃºt)" lÃ m thá»i gian nghá»‰ giá»¯a phiÃªn (náº¿u khÃ´ng truyá»n override)
    const restMinutes = (options.restMinutes != null) ? Number(options.restMinutes) : Number(intervalInput.value);
    const text = (options.text != null) ? String(options.text || '').trim() : '';
    const mode = (options.mode != null) ? String(options.mode || '').trim().toLowerCase() : '';
    const payload = {};
    if (Number.isFinite(runMinutes) && runMinutes > 0) {
      payload.run_minutes = runMinutes;
    }
    if (Number.isFinite(restMinutes) && restMinutes > 0) {
      payload.rest_minutes = restMinutes;
    }
    payload.profile_ids = selected;
    if (text) payload.text = text;
    if (mode) payload.mode = mode;

    const data = await callBackend('/run', {
      body: JSON.stringify(payload),
    });
    const pidText = data.pid ? ` (PID ${data.pid})` : '';

    // XÃ¡c nháº­n backend tháº­t sá»± Ä‘ang cháº¡y (trÃ¡nh UI bÃ¡o "Äang quÃ©t" nhÆ°ng runner Ä‘Ã£ thoÃ¡t)
    const deadline = Date.now() + 2500;
    let jobs = null;
    while (Date.now() < deadline) {
      jobs = await callBackendNoAlert('/jobs/status', { method: 'GET' });
      if (jobs && jobs.bot_running) break;
      await new Promise((r) => setTimeout(r, 200));
    }
    if (jobs) lastJobsStatus = jobs;
    try { updateStopPauseButtonsByJobs(); } catch (_) { }

    if (!(jobs && jobs.bot_running)) {
      setBackendStatus(`Backend chÆ°a cháº¡y bot${pidText}`, false);
      showToast('Backend chÆ°a cháº¡y Ä‘Æ°á»£c bot (runner khÃ´ng alive).', 'error', 2200);
      return false;
    }

    setBackendStatus(`Bot Ä‘ang cháº¡y${pidText}`, true);
    return true;
  } catch (err) {
    console.error(err);
    alert('KhÃ´ng gá»i Ä‘Æ°á»£c backend. HÃ£y kiá»ƒm tra FastAPI Ä‘Ã£ cháº¡y chÆ°a.');
    setBackendStatus('Backend lá»—i hoáº·c chÆ°a khá»Ÿi Ä‘á»™ng', false);
    return false;
  } finally {
  }
}

async function sendStopSignal() {
  try {
    console.log('[UI] STOP triggered');
    // /stop Ä‘Ã£ Ä‘Æ°á»£c backend map sang STOP (GLOBAL_EMERGENCY_STOP + Ä‘Ã³ng NST best-effort)
    await callBackend('/stop');
    setBackendStatus('ÄÃ£ gá»­i lá»‡nh dá»«ng backend', false);
  } catch (err) {
    console.warn('KhÃ´ng dá»«ng Ä‘Æ°á»£c backend:', err);
    setBackendStatus('Backend cÃ³ thá»ƒ váº«n Ä‘ang cháº¡y', false);
  }
}

// Thá»­ kiá»ƒm tra tráº¡ng thÃ¡i backend khi táº£i trang
fetch(`${API_BASE}/status`)
  .then((res) => res.json())
  .then((data) => {
    const running = Boolean(data.running);
    setBackendStatus(running ? 'Backend Ä‘ang cháº¡y' : 'Backend chÆ°a cháº¡y', running);
  })
  .catch(() => {
    setBackendStatus('KhÃ´ng káº¿t ná»‘i Ä‘Æ°á»£c FastAPI', false);
  });

// ==== ThÃªm data nhÃ³m - Má»Ÿ file tá»« mÃ¡y tÃ­nh ====

const addGroupDataBtn = document.getElementById('addGroupDataBtn');

// HÃ m xá»­ lÃ½ nÃºt ThÃªm data nhÃ³m - chá»‰ má»Ÿ dialog chá»n file
function handleAddGroupData() {
  // Táº¡o input file áº©n
  const fileInput = document.createElement('input');
  fileInput.type = 'file';
  fileInput.accept = '.json,.xlsx,.xls,.txt,.csv';
  fileInput.style.display = 'none';

  fileInput.addEventListener('change', (e) => {
    const file = e.target.files[0];
    if (file) {
      console.log('File Ä‘Ã£ chá»n:', file.name);
      // Chá»‰ má»Ÿ file, khÃ´ng xá»­ lÃ½ gÃ¬ thÃªm
    }
    // XÃ³a input Ä‘á»ƒ cÃ³ thá»ƒ chá»n láº¡i file cÃ¹ng tÃªn
    fileInput.value = '';
  });

  // Trigger click Ä‘á»ƒ má»Ÿ dialog chá»n file
  document.body.appendChild(fileInput);
  fileInput.click();
  document.body.removeChild(fileInput);
}



// ==== Help Button vá»›i Tooltip ====

const helpBtn = document.getElementById('helpBtn');
const helpTooltip = document.getElementById('helpTooltip');
const tooltipClose = document.querySelector('.tooltip-close');

function toggleHelpTooltip() {
  helpTooltip.classList.toggle('show');
}

function closeHelpTooltip() {
  helpTooltip.classList.remove('show');
}

helpBtn.addEventListener('click', (e) => {
  e.stopPropagation();
  toggleHelpTooltip();
});

tooltipClose.addEventListener('click', closeHelpTooltip);

// ÄÃ³ng tooltip khi click ra ngoÃ i
document.addEventListener('click', (e) => {
  if (!helpBtn.contains(e.target) && !helpTooltip.contains(e.target)) {
    closeHelpTooltip();
  }
});
// ==== Bá»™ lá»c mÃ u sáº¯c, React, Comment vÃ  Sáº¯p xáº¿p ====

const filterButtons = document.querySelectorAll('.filter-btn[data-filter]');
const reactFilterButtons = document.querySelectorAll('.filter-btn[data-filter-react]');
const commentFilterButtons = document.querySelectorAll('.filter-btn[data-filter-comment]');
const timeFilterFrom = document.getElementById('timeFilterFrom');
const timeFilterTo = document.getElementById('timeFilterTo');
const applyTimeFilterBtn = document.getElementById('applyTimeFilterBtn');
const clearTimeFilterBtn = document.getElementById('clearTimeFilterBtn');

// Sá»­ dá»¥ng Set Ä‘á»ƒ lÆ°u cÃ¡c filter Ä‘Ã£ chá»n (cho phÃ©p nhiá»u lá»±a chá»n)
let selectedTypeFilters = new Set(['all']);
let selectedReactFilters = new Set(); // KhÃ´ng cÃ³ "all", rá»—ng = hiá»ƒn thá»‹ táº¥t cáº£
let selectedCommentFilters = new Set(); // KhÃ´ng cÃ³ "all", rá»—ng = hiá»ƒn thá»‹ táº¥t cáº£
let timeFilterFromValue = null; // Thá»i gian báº¯t Ä‘áº§u
let timeFilterToValue = null; // Thá»i gian káº¿t thÃºc

function toggleTypeFilter(filterType) {
  if (filterType === 'all') {
    // Náº¿u click "Táº¥t cáº£", bá» chá»n táº¥t cáº£ vÃ  chá»‰ chá»n "Táº¥t cáº£"
    selectedTypeFilters.clear();
    selectedTypeFilters.add('all');
  } else {
    // Bá» "all" náº¿u chá»n filter cá»¥ thá»ƒ
    selectedTypeFilters.delete('all');

    // Toggle filter
    if (selectedTypeFilters.has(filterType)) {
      selectedTypeFilters.delete(filterType);
    } else {
      selectedTypeFilters.add(filterType);
    }

    // Náº¿u khÃ´ng cÃ²n filter nÃ o Ä‘Æ°á»£c chá»n, tá»± Ä‘á»™ng chá»n "all"
    if (selectedTypeFilters.size === 0) {
      selectedTypeFilters.add('all');
    }
  }
  applyAllFilters();
}

function toggleReactFilter(reactFilter) {
  // Toggle filter (khÃ´ng cÃ³ "all" ná»¯a)
  if (selectedReactFilters.has(reactFilter)) {
    selectedReactFilters.delete(reactFilter);
  } else {
    selectedReactFilters.add(reactFilter);
  }
  applyAllFilters();
}

function toggleCommentFilter(commentFilter) {
  // Toggle filter (khÃ´ng cÃ³ "all" ná»¯a)
  if (selectedCommentFilters.has(commentFilter)) {
    selectedCommentFilters.delete(commentFilter);
  } else {
    selectedCommentFilters.add(commentFilter);
  }
  applyAllFilters();
}

function applyAllFilters() {
  const rows = tbody.querySelectorAll('tr');

  rows.forEach((row) => {
    let shouldShow = true;

    // Filter theo mÃ u (Type) - cÃ³ thá»ƒ chá»n nhiá»u
    if (!selectedTypeFilters.has('all')) {
      const typeCell = row.querySelector('.type-cell');
      let matchesType = false;

      selectedTypeFilters.forEach(filterType => {
        if (typeCell && typeCell.classList.contains(filterType)) {
          matchesType = true;
        }
      });

      if (!matchesType) {
        shouldShow = false;
      }
    }

    // Filter theo React - náº¿u Set rá»—ng thÃ¬ hiá»ƒn thá»‹ táº¥t cáº£
    if (shouldShow && selectedReactFilters.size > 0) {
      const reactCell = row.querySelector('td:nth-child(4)'); // Cá»™t React
      const hasReact = reactCell && reactCell.textContent.trim() === 'âœ“';
      let matchesReact = false;

      selectedReactFilters.forEach(reactFilter => {
        if (reactFilter === 'has' && hasReact) {
          matchesReact = true;
        } else if (reactFilter === 'none' && !hasReact) {
          matchesReact = true;
        }
      });

      if (!matchesReact) {
        shouldShow = false;
      }
    }

    // Filter theo Comment - náº¿u Set rá»—ng thÃ¬ hiá»ƒn thá»‹ táº¥t cáº£
    if (shouldShow && selectedCommentFilters.size > 0) {
      const commentCell = row.querySelector('td:nth-child(5)'); // Cá»™t Comment
      const hasComment = commentCell && commentCell.querySelector('.comment-eye-btn');
      let matchesComment = false;

      selectedCommentFilters.forEach(commentFilter => {
        if (commentFilter === 'has' && hasComment) {
          matchesComment = true;
        } else if (commentFilter === 'none' && !hasComment) {
          matchesComment = true;
        }
      });

      if (!matchesComment) {
        shouldShow = false;
      }
    }

    // Filter theo thá»i gian
    if (shouldShow && (timeFilterFromValue || timeFilterToValue)) {
      const timeCell = row.querySelector('td:nth-child(6)'); // Cá»™t Time
      const timeStr = timeCell ? timeCell.textContent.trim() : '';

      if (timeStr) {
        // Parse timestamp tá»« row hoáº·c tá»« text
        let rowTimestamp = row.dataset.timestamp ? parseInt(row.dataset.timestamp) : 0;
        if (!rowTimestamp) {
          rowTimestamp = parseTime(timeStr);
          row.dataset.timestamp = rowTimestamp; // LÆ°u láº¡i
        }

        // So sÃ¡nh vá»›i khoáº£ng thá»i gian Ä‘Ã£ chá»n
        if (timeFilterFromValue && rowTimestamp < timeFilterFromValue) {
          shouldShow = false;
        }
        if (timeFilterToValue && rowTimestamp > timeFilterToValue) {
          shouldShow = false;
        }
      } else {
        // Náº¿u khÃ´ng cÃ³ thá»i gian vÃ  cÃ³ filter thá»i gian thÃ¬ áº©n
        shouldShow = false;
      }
    }

    if (shouldShow) {
      row.classList.remove('filtered-out');
    } else {
      row.classList.add('filtered-out');
    }
  });

  // Cáº­p nháº­t tráº¡ng thÃ¡i active cá»§a cÃ¡c nÃºt filter mÃ u
  filterButtons.forEach((btn) => {
    const filterType = btn.dataset.filter;
    if (selectedTypeFilters.has(filterType)) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
  });

  // Cáº­p nháº­t tráº¡ng thÃ¡i active cá»§a cÃ¡c nÃºt filter React
  reactFilterButtons.forEach((btn) => {
    const reactFilter = btn.dataset.filterReact;
    if (selectedReactFilters.has(reactFilter)) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
  });

  // Cáº­p nháº­t tráº¡ng thÃ¡i active cá»§a cÃ¡c nÃºt filter Comment
  commentFilterButtons.forEach((btn) => {
    const commentFilter = btn.dataset.filterComment;
    if (selectedCommentFilters.has(commentFilter)) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
  });

  // Kiá»ƒm tra empty state
  const visibleRows = Array.from(rows).filter(row => !row.classList.contains('filtered-out'));
  if (visibleRows.length === 0 && rows.length > 0) {
    emptyState.classList.add('show');
  } else {
    emptyState.classList.remove('show');
  }
}

// Ãp dá»¥ng filter theo thá»i gian
function applyTimeFilter() {
  const fromValue = timeFilterFrom ? timeFilterFrom.value : '';
  const toValue = timeFilterTo ? timeFilterTo.value : '';

  // Chuyá»ƒn Ä‘á»•i tá»« datetime-local format (YYYY-MM-DDTHH:mm) sang timestamp
  if (fromValue) {
    timeFilterFromValue = new Date(fromValue).getTime();
  } else {
    timeFilterFromValue = null;
  }

  if (toValue) {
    // ThÃªm 1 ngÃ y vÃ  trá»« 1ms Ä‘á»ƒ bao gá»“m cáº£ ngÃ y cuá»‘i
    const toDate = new Date(toValue);
    toDate.setHours(23, 59, 59, 999);
    timeFilterToValue = toDate.getTime();
  } else {
    timeFilterToValue = null;
  }

  // Ãp dá»¥ng filter
  applyAllFilters();

  // Cáº­p nháº­t tráº¡ng thÃ¡i nÃºt
  if (applyTimeFilterBtn) {
    if (timeFilterFromValue || timeFilterToValue) {
      applyTimeFilterBtn.classList.add('active');
    } else {
      applyTimeFilterBtn.classList.remove('active');
    }
  }
}

// XÃ³a filter thá»i gian
function clearTimeFilter() {
  if (timeFilterFrom) timeFilterFrom.value = '';
  if (timeFilterTo) timeFilterTo.value = '';
  timeFilterFromValue = null;
  timeFilterToValue = null;

  // Ãp dá»¥ng láº¡i filter
  applyAllFilters();

  // Cáº­p nháº­t tráº¡ng thÃ¡i nÃºt
  if (applyTimeFilterBtn) {
    applyTimeFilterBtn.classList.remove('active');
  }
}

// HÃ m parse time tá»« string sang Date object
function parseTime(timeStr) {
  if (!timeStr) return 0;

  // Thá»­ parse cÃ¡c format thá»i gian phá»• biáº¿n
  // Format: "HH:mm:ss" hoáº·c "HH:mm" hoáº·c "dd/MM/yyyy HH:mm:ss"
  const now = new Date();

  // Náº¿u cÃ³ format Ä‘áº§y Ä‘á»§ vá»›i ngÃ y
  if (timeStr.includes('/')) {
    const parts = timeStr.split(' ');
    if (parts.length >= 2) {
      const datePart = parts[0].split('/');
      const timePart = parts[1].split(':');
      if (datePart.length === 3 && timePart.length >= 2) {
        const year = parseInt(datePart[2]);
        const month = parseInt(datePart[1]) - 1;
        const day = parseInt(datePart[0]);
        const hour = parseInt(timePart[0]);
        const minute = parseInt(timePart[1]);
        const second = timePart[2] ? parseInt(timePart[2]) : 0;
        return new Date(year, month, day, hour, minute, second).getTime();
      }
    }
  }

  // Náº¿u chá»‰ cÃ³ giá»:phÃºt:giÃ¢y
  if (timeStr.includes(':')) {
    const parts = timeStr.split(':');
    if (parts.length >= 2) {
      const hour = parseInt(parts[0]) || 0;
      const minute = parseInt(parts[1]) || 0;
      const second = parts[2] ? parseInt(parts[2]) : 0;
      const date = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hour, minute, second);
      return date.getTime();
    }
  }

  // Fallback: thá»­ parse trá»±c tiáº¿p
  const parsed = Date.parse(timeStr);
  return isNaN(parsed) ? 0 : parsed;
}

// Khá»Ÿi táº¡o: set tráº¡ng thÃ¡i active cho cÃ¡c nÃºt "Táº¥t cáº£"
function initializeFilters() {
  applyAllFilters();
}

// ThÃªm event listener cho cÃ¡c nÃºt filter mÃ u
filterButtons.forEach((btn) => {
  btn.addEventListener('click', () => {
    const filterType = btn.dataset.filter;
    if (filterType) {
      toggleTypeFilter(filterType);
    }
  });
});

// ThÃªm event listener cho cÃ¡c nÃºt filter React
reactFilterButtons.forEach((btn) => {
  btn.addEventListener('click', () => {
    const reactFilter = btn.dataset.filterReact;
    if (reactFilter) {
      toggleReactFilter(reactFilter);
    }
  });
});

// ThÃªm event listener cho cÃ¡c nÃºt filter Comment
commentFilterButtons.forEach((btn) => {
  btn.addEventListener('click', () => {
    const commentFilter = btn.dataset.filterComment;
    if (commentFilter) {
      toggleCommentFilter(commentFilter);
    }
  });
});

// ThÃªm event listener cho filter thá»i gian
if (applyTimeFilterBtn) {
  applyTimeFilterBtn.addEventListener('click', () => {
    applyTimeFilter();
  });
}

if (clearTimeFilterBtn) {
  clearTimeFilterBtn.addEventListener('click', () => {
    clearTimeFilter();
  });
}

// Cho phÃ©p Ã¡p dá»¥ng filter khi nháº¥n Enter trong input
if (timeFilterFrom) {
  timeFilterFrom.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      applyTimeFilter();
    }
  });
}

if (timeFilterTo) {
  timeFilterTo.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      applyTimeFilter();
    }
  });
}

// ==== Tabs: Danh sÃ¡ch quÃ©t / Quáº£n lÃ½ post / Setting profile ====
const tabConfig = {
  scan: { btn: tabScanList, view: scanView },
  post: { btn: tabPostManager, view: postView },
  settings: { btn: tabSettings, view: settingsView },
};

const ACTIVE_TAB_KEY = 'activeTab';

function switchTab(key) {
  Object.entries(tabConfig).forEach(([k, { btn, view }]) => {
    if (!btn || !view) return;
    const isActive = k === key;
    btn.classList.toggle('active', isActive);
    view.style.display = isActive ? 'block' : 'none';
  });

  if (key === 'post') {
    loadPostsForManager();
  }

  // nhá»› tab Ä‘ang má»Ÿ Ä‘á»ƒ khÃ´ng bá»‹ nháº£y vá» tab Ä‘áº§u
  try {
    localStorage.setItem(ACTIVE_TAB_KEY, key);
  } catch (e) {
    // ignore
  }
}

if (tabScanList) tabScanList.addEventListener('click', () => switchTab('scan'));
if (tabPostManager) tabPostManager.addEventListener('click', () => switchTab('post'));
if (tabSettings) tabSettings.addEventListener('click', () => switchTab('settings'));

// Khá»Ÿi táº¡o: luÃ´n vÃ o tab danh sÃ¡ch quÃ©t + load state profile
let initialTab = 'scan';
try {
  const saved = localStorage.getItem(ACTIVE_TAB_KEY);
  if (saved && tabConfig[saved]) initialTab = saved;
} catch (e) {
  // ignore
}
switchTab(initialTab);
// Khá»Ÿi táº¡o: load state profile rá»“i sync UI theo backend (Ä‘á»ƒ F5 khÃ´ng bá»‹ lá»‡ch tráº¡ng thÃ¡i)
(async () => {
  try {
    await loadProfileState();
  } catch (_) { }
  try {
    await resyncUiFromBackendAfterReload();
  } catch (_) { }
})();
// Khá»Ÿi táº¡o filter vá»›i tráº¡ng thÃ¡i máº·c Ä‘á»‹nh
initializeFilters();

--- END FILE: frontend\script.js ---

--- START FILE: frontend\style.css ---
* {
  box-sizing: border-box;
  margin    : 0;
  padding   : 0;
}

:root {
  --primary       : #6366f1;
  --primary-dark  : #4f46e5;
  --danger        : #ef4444;
  --danger-dark   : #dc2626;
  --success       : #10b981;
  --orange        : #f97316;
  --orange-dark   : #ea580c;
  --pause         : #0ea5a4;
  --pause-dark    : #0f766e;
  --bg-gradient   : linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --card-bg       : #ffffff;
  --text-primary  : #1f2937;
  --text-secondary: #6b7280;
  --border        : #e5e7eb;
  --shadow        : 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg     : 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

body {
  font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  background : var(--bg-gradient);
  height     : 100vh;
  overflow   : hidden;
  padding    : 12px;
  color      : var(--text-primary);
  line-height: 1.6;
}

body.splash-active {
  overflow: hidden;
}

/* Splash Screen */
.splash-screen {
  position       : fixed;
  top            : 0;
  left           : 0;
  width          : 100%;
  height         : 100%;
  background     : linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
  background-size: 400% 400%;
  animation      : gradientShift 15s ease infinite;
  display        : flex;
  align-items    : center;
  justify-content: center;
  z-index        : 10000;
  transition     : opacity 0.6s ease, visibility 0.6s ease;
}

.splash-screen.hidden {
  opacity   : 0;
  visibility: hidden;
}

@keyframes gradientShift {
  0% {
    background-position: 0% 50%;
  }

  50% {
    background-position: 100% 50%;
  }

  100% {
    background-position: 0% 50%;
  }
}

.splash-content {
  text-align: center;
  animation : fadeInUp 0.8s ease-out;
}

.splash-title {
  font-size     : 48px;
  font-weight   : 700;
  color         : white;
  margin        : 0 0 16px 0;
  text-shadow   : 0 4px 20px rgba(0, 0, 0, 0.3);
  letter-spacing: 2px;
  animation     : titleGlow 2s ease-in-out infinite alternate;
}

@keyframes titleGlow {
  from {
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), 0 0 30px rgba(255, 255, 255, 0.2);
  }

  to {
    text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), 0 0 40px rgba(255, 255, 255, 0.4);
  }
}

.splash-subtitle {
  font-size  : 18px;
  color      : rgba(255, 255, 255, 0.9);
  margin     : 0 0 40px 0;
  font-weight: 400;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.splash-btn {
  padding        : 16px 48px;
  font-size      : 18px;
  font-weight    : 600;
  color          : white;
  background     : rgba(255, 255, 255, 0.2);
  backdrop-filter: blur(10px);
  border         : 2px solid rgba(255, 255, 255, 0.3);
  border-radius  : 50px;
  cursor         : pointer;
  transition     : all 0.3s ease;
  box-shadow     : 0 8px 32px rgba(0, 0, 0, 0.2);
  text-transform : uppercase;
  letter-spacing : 1px;
}

.splash-btn:hover {
  background  : rgba(255, 255, 255, 0.3);
  border-color: rgba(255, 255, 255, 0.5);
  transform   : translateY(-3px) scale(1.05);
  box-shadow  : 0 12px 40px rgba(0, 0, 0, 0.3);
}

.splash-btn:active {
  transform: translateY(-1px) scale(1.02);
}

/* áº¨n container khi splash Ä‘ang hiá»ƒn thá»‹ */
body.splash-active .container {
  opacity       : 0;
  pointer-events: none;
}

.container {
  width         : 100%;
  max-width     : 100%;
  margin        : 0 auto;
  padding       : 0 12px 12px;
  height        : 100%;
  display       : flex;
  flex-direction: column;
}

/* Header */
.header {
  background     : rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-radius  : 16px;
  padding        : 2px;
  margin-bottom  : 18px;
  box-shadow     : 0 12px 30px rgba(0, 0, 0, 0.08);
  text-align     : center;
  animation      : slideDown 0.5s ease-out;
  position       : relative;
}

.header-content h1 {
  font-size  : 28px;
  font-weight: 700;
  color      : var(--text-primary);

  background             : var(--bg-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip        : text;
}

.subtitle {
  color      : var(--text-secondary);
  font-size  : 14px;
  font-weight: 500;
}

/* Color Legend */
.color-legend {
  display        : flex;
  gap            : 20px;
  align-items    : center;
  flex-wrap      : wrap;
  justify-content: center;
  margin-bottom  : 16px;
  padding        : 10px 16px;
  background     : #f9fafb;
  border-radius  : 8px;
  border         : 1px dashed var(--border);
  font-size      : 12px;
}

.legend-item {
  display    : flex;
  align-items: center;
  gap        : 6px;
  font-size  : 13px;
  font-weight: 500;
}

.legend-dot {
  width        : 12px;
  height       : 12px;
  border-radius: 50%;
  display      : inline-block;
  box-shadow   : 0 2px 4px rgba(0, 0, 0, 0.2);
}

.legend-green {
  background: #10b981;
}

.legend-yellow {
  background: #f59e0b;
}

.legend-red {
  background: #ef4444;
}

.legend-text {
  color      : var(--text-primary);
  white-space: nowrap;
}

/* Layout */
.layout {
  display              : grid;
  grid-template-columns: 320px 1fr;
  gap                  : 16px;
  align-items          : start;
  flex                 : 1;
  min-height           : 0;
  overflow             : hidden;
}

/* Panels */
.left-panel,
.right-panel {
  background   : var(--card-bg);
  border-radius: 16px;
  box-shadow   : var(--shadow-lg);
  overflow     : hidden;
  animation    : fadeInUp 0.6s ease-out;
  transition   : transform 0.3s ease, box-shadow 0.3s ease;
}

.left-panel {
  height    : 100%;
  overflow-y: auto;
}

.right-panel {
  min-height: 0;
  height    : 100%;
  overflow-y: auto;
}

/* Right panel: giá»¯ tab/header Ä‘á»©ng im, chá»‰ cuá»™n pháº§n ná»™i dung bÃªn dÆ°á»›i */
.right-panel .panel-header {
  position  : sticky;
  top       : 0;
  z-index   : 50;
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.08);
}

/* Thu nhá» scrollbar cho right-panel cho gá»n (giá»‘ng left-panel) */
.right-panel::-webkit-scrollbar {
  width: 8px;
}

.right-panel::-webkit-scrollbar-track {
  background: transparent;
}

.right-panel::-webkit-scrollbar-thumb {
  background   : rgba(99, 102, 241, 0.35);
  border-radius: 999px;
}

.right-panel::-webkit-scrollbar-thumb:hover {
  background: rgba(99, 102, 241, 0.55);
}

/* Thu nhá» thanh scroll cho left-panel */
.left-panel::-webkit-scrollbar {
  width: 6px;
}

.left-panel::-webkit-scrollbar-track {
  background: transparent;
}

.left-panel::-webkit-scrollbar-thumb {
  background   : rgba(99, 102, 241, 0.35);
  border-radius: 999px;
}

.left-panel::-webkit-scrollbar-thumb:hover {
  background: rgba(99, 102, 241, 0.55);
}

.panel-header {
  background     : linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding        : 20px 24px;
  display        : flex;
  justify-content: space-between;
  align-items    : center;
}

.panel-header h3 {
  color      : white;
  font-size  : 18px;
  font-weight: 600;
  margin     : 0;
  display    : flex;
  align-items: center;
  gap        : 8px;
}

.badge {
  background     : rgba(255, 255, 255, 0.2);
  color          : white;
  padding        : 4px 12px;
  border-radius  : 12px;
  font-size      : 12px;
  font-weight    : 600;
  backdrop-filter: blur(10px);
}

.panel-body {
  padding: 24px;
}

/* Fields */
.field {
  margin-bottom: 20px;
}

.field:last-child {
  margin-bottom: 0;
}

.field label {
  display      : flex;
  align-items  : center;
  gap          : 8px;
  margin-bottom: 10px;
  font-weight  : 600;
  font-size    : 14px;
  color        : var(--text-primary);
}

.label-icon {
  font-size: 16px;
}

.field input {
  width        : 100%;
  padding      : 12px 16px;
  border       : 2px solid var(--border);
  border-radius: 10px;
  font-size    : 15px;
  transition   : all 0.3s ease;
  background   : #f9fafb;
  color        : var(--text-primary);
}

.field input:focus {
  outline     : none;
  border-color: var(--primary);
  background  : white;
  box-shadow  : 0 0 0 4px rgba(99, 102, 241, 0.1);
  transform   : translateY(-1px);
}

.field input::placeholder {
  color: #9ca3af;
}

/* Buttons */
button {
  width          : 100%;
  padding        : 14px 20px;
  border         : none;
  border-radius  : 12px;
  font-size      : 15px;
  font-weight    : 600;
  cursor         : pointer;
  transition     : all 0.3s ease;
  display        : flex;
  align-items    : center;
  justify-content: center;
  gap            : 8px;
  position       : relative;
  overflow       : hidden;
}

/* Loading state (spinner) */
.btn-loading {
  opacity: 0.9;
  cursor : not-allowed;
}

.btn-loading::after {
  content         : "";
  width           : 14px;
  height          : 14px;
  border-radius   : 50%;
  border          : 2px solid rgba(255, 255, 255, 0.55);
  border-top-color: rgba(255, 255, 255, 1);
  animation       : btnSpin 0.9s linear infinite;
}

@keyframes btnSpin {
  from {
    transform: rotate(0deg);
  }

  to {
    transform: rotate(360deg);
  }
}

button::before {
  content      : '';
  position     : absolute;
  top          : 50%;
  left         : 50%;
  width        : 0;
  height       : 0;
  border-radius: 50%;
  background   : rgba(255, 255, 255, 0.3);
  transform    : translate(-50%, -50%);
  transition   : width 0.6s, height 0.6s;
}

button:hover::before {
  width : 300px;
  height: 300px;
}

button:active {
  transform: scale(0.98);
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color     : white;
  box-shadow: 0 4px 14px 0 rgba(99, 102, 241, 0.4);
}

.btn-primary:hover {
  box-shadow: 0 6px 20px 0 rgba(99, 102, 241, 0.5);
  transform : translateY(-2px);
}

.btn-primary:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
  transform : none;
}

.btn-danger {
  background: linear-gradient(135deg, var(--danger) 0%, var(--danger-dark) 100%);
  color     : white;
  box-shadow: 0 4px 14px 0 rgba(239, 68, 68, 0.4);
}

.btn-danger:hover {
  box-shadow: 0 6px 20px 0 rgba(239, 68, 68, 0.5);
  transform : translateY(-2px);
}

.btn-danger:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
  transform : none;
}

.btn-success {
  background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
  color     : white;
  box-shadow: 0 4px 14px 0 rgba(16, 185, 129, 0.4);
}

.btn-success:hover {
  box-shadow: 0 6px 20px 0 rgba(16, 185, 129, 0.5);
  transform : translateY(-2px);
}

.btn-success:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
  transform : none;
}

/* Stop selected (khÃ¡c mÃ u Stop all) */
.btn-orange {
  background: linear-gradient(135deg, var(--orange) 0%, var(--orange-dark) 100%);
  color     : white;
  box-shadow: 0 4px 14px 0 rgba(249, 115, 22, 0.4);
}

.btn-orange:hover {
  box-shadow: 0 6px 20px 0 rgba(249, 115, 22, 0.5);
  transform : translateY(-2px);
}

.btn-orange:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
  transform : none;
}

.btn-icon {
  font-size: 16px;
}

.status-line {
  display      : flex;
  align-items  : center;
  gap          : 12px;
  margin-top   : 12px;
  padding      : 12px;
  border       : 1px dashed var(--border);
  border-radius: 12px;
  background   : #f9fafb;
}

.status-text-group {
  display       : flex;
  flex-direction: column;
  gap           : 2px;
}

.status-dot {
  width        : 12px;
  height       : 12px;
  border-radius: 50%;
  background   : var(--danger);
  box-shadow   : 0 0 0 4px rgba(239, 68, 68, 0.15);
}

.status-dot.online {
  background: var(--success);
  box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.2);
  animation : pulse 2s infinite;
}

.status-label {
  font-weight: 700;
  color      : var(--text-primary);
  font-size  : 13px;
}

.status-text {
  color    : var(--text-secondary);
  font-size: 13px;
}

/* Filter Container */
.filter-container {
  margin-bottom : 16px;
  padding       : 12px 16px;
  background    : #f9fafb;
  border-radius : 10px;
  border        : 1px solid var(--border);
  display       : flex;
  flex-direction: column;
  gap           : 12px;
}

.filter-group {
  display       : flex;
  flex-direction: column;
  gap           : 8px;
}

.filter-group:not(:last-child) {
  padding-bottom: 12px;
  border-bottom : 1px dashed var(--border);
}

/* Time Filter - Compact Single Row - Beautiful Design */
.time-filter-compact {
  margin-top: 6px;
}

.time-filter-inline {
  display      : inline-flex;
  align-items  : center;
  gap          : 5px;
  background   : linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
  border       : 1.5px solid var(--border);
  border-radius: 8px;
  padding      : 5px 7px;
  max-width    : fit-content;
  box-shadow   : 0 2px 6px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);
  transition   : all 0.3s ease;
}

.time-filter-inline:hover {
  border-color: var(--primary);
  box-shadow  : 0 4px 12px rgba(99, 102, 241, 0.12), 0 2px 4px rgba(0, 0, 0, 0.06);
}

.time-filter-input-compact {
  width        : 135px;
  padding      : 6px 8px;
  border       : 1px solid rgba(99, 102, 241, 0.2);
  border-radius: 6px;
  font-size    : 12px;
  background   : white;
  color        : var(--text-primary);
  transition   : all 0.25s ease;
  font-family  : inherit;
  box-shadow   : 0 1px 2px rgba(0, 0, 0, 0.04);
}

.time-filter-input-compact:hover {
  border-color: var(--primary);
  box-shadow  : 0 2px 4px rgba(99, 102, 241, 0.15);
  transform   : translateY(-1px);
}

.time-filter-input-compact:focus {
  outline     : none;
  border-color: var(--primary);
  background  : white;
  box-shadow  : 0 0 0 3px rgba(99, 102, 241, 0.1), 0 2px 6px rgba(99, 102, 241, 0.2);
  transform   : translateY(-1px);
}

.time-filter-input-compact::placeholder {
  color     : #9ca3af;
  font-size : 11px;
  font-style: italic;
}

.time-filter-separator {
  color      : var(--primary);
  font-size  : 12px;
  font-weight: 700;
  padding    : 0 2px;
  flex-shrink: 0;
  opacity    : 0.6;
  transition : opacity 0.2s ease;
}

.time-filter-inline:hover .time-filter-separator {
  opacity: 1;
}

.time-filter-btn-compact {
  width          : 28px;
  height         : 28px;
  padding        : 0;
  border         : none;
  border-radius  : 6px;
  font-size      : 13px;
  font-weight    : 700;
  cursor         : pointer;
  transition     : all 0.25s ease;
  display        : flex;
  align-items    : center;
  justify-content: center;
  flex-shrink    : 0;
  box-shadow     : 0 2px 4px rgba(0, 0, 0, 0.1);
}

.time-filter-apply-compact {
  background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
  color     : white;
}

.time-filter-apply-compact:hover {
  background: linear-gradient(135deg, #059669 0%, var(--success) 100%);
  transform : translateY(-2px) scale(1.05);
  box-shadow: 0 4px 8px rgba(16, 185, 129, 0.4);
}

.time-filter-apply-compact:active {
  transform: translateY(0) scale(1);
}

.time-filter-apply-compact.active {
  background: linear-gradient(135deg, #047857 0%, #059669 100%);
  box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3), 0 4px 12px rgba(16, 185, 129, 0.4);
  animation : pulseSuccess 2s ease-in-out infinite;
}

@keyframes pulseSuccess {

  0%,
  100% {
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3), 0 4px 12px rgba(16, 185, 129, 0.4);
  }

  50% {
    box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.4), 0 6px 16px rgba(16, 185, 129, 0.5);
  }
}

.time-filter-clear-compact {
  background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
  color     : var(--text-secondary);
  border    : 1px solid var(--border);
}

.time-filter-clear-compact:hover {
  background  : linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
  color       : var(--danger);
  border-color: var(--danger);
  transform   : translateY(-2px) scale(1.05);
  box-shadow  : 0 4px 8px rgba(239, 68, 68, 0.2);
}

.time-filter-clear-compact:active {
  transform: translateY(0) scale(1);
}

/* Responsive */
@media (max-width: 768px) {
  .time-filter-inline {
    flex-wrap: wrap;
  }

  .time-filter-input-compact {
    min-width: 120px;
  }
}

.filter-label {
  font-size    : 13px;
  font-weight  : 600;
  color        : var(--text-primary);
  margin-bottom: 0;
}

.filter-buttons {
  display  : flex;
  gap      : 8px;
  flex-wrap: wrap;
}

.filter-btn {
  width        : auto;
  padding      : 8px 16px;
  font-size    : 13px;
  font-weight  : 600;
  border       : 2px solid var(--border);
  background   : white;
  color        : var(--text-primary);
  border-radius: 8px;
  cursor       : pointer;
  transition   : all 0.3s ease;
  display      : flex;
  align-items  : center;
  gap          : 6px;
}

.filter-btn:hover {
  border-color: var(--primary);
  transform   : translateY(-1px);
  box-shadow  : 0 2px 8px rgba(99, 102, 241, 0.2);
}

.filter-btn.active {
  background  : linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color       : white;
  border-color: var(--primary);
  box-shadow  : 0 2px 8px rgba(99, 102, 241, 0.3);
}

.filter-btn.filter-green.active {
  background  : linear-gradient(135deg, #10b981 0%, #059669 100%);
  border-color: #10b981;
  box-shadow  : 0 2px 8px rgba(16, 185, 129, 0.3);
}

.filter-btn.filter-yellow.active {
  background  : linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
  border-color: #f59e0b;
  box-shadow  : 0 2px 8px rgba(245, 158, 11, 0.3);
}

.filter-btn.filter-red.active {
  background  : linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
  border-color: #ef4444;
  box-shadow  : 0 2px 8px rgba(239, 68, 68, 0.3);
}

.filter-dot {
  width        : 10px;
  height       : 10px;
  border-radius: 50%;
  display      : inline-block;
  box-shadow   : 0 1px 3px rgba(0, 0, 0, 0.2);
}

.filter-dot-green {
  background: #10b981;
}

.filter-dot-yellow {
  background: #f59e0b;
}

.filter-dot-red {
  background: #ef4444;
}

.filter-btn.active .filter-dot {
  background: white;
}

tbody tr.filtered-out {
  display: none;
}

/* Table */
.table-container {
  overflow-x   : auto;
  border-radius: 12px;
  border       : 1px solid var(--border);
  margin       : 0 10px;
}

/* Tabs trong header bÃªn pháº£i */
.panel-tabs {
  display: flex;
  gap    : 8px;
}

.tab-button {
  width        : auto;
  padding      : 8px 14px;
  border-radius: 999px;
  border       : none;
  background   : rgba(255, 255, 255, 0.15);
  color        : #e5e7eb;
  font-size    : 13px;
  font-weight  : 600;
  cursor       : pointer;
  display      : inline-flex;
  align-items  : center;
  gap          : 6px;
  transition   : background 0.2s ease, color 0.2s ease, transform 0.1s ease;
}

.tab-button:hover {
  background: rgba(255, 255, 255, 0.25);
  transform : translateY(-1px);
}

.tab-button.active {
  background: #ffffff;
  color     : #111827;
}

/* Settings view */
.settings-stack {
  display       : flex;
  flex-direction: column;
  gap           : 14px;
  padding       : 10px;
}

.setting-card {
  background    : #f9fafb;
  border        : 1px solid var(--border);
  border-radius : 12px;
  padding       : 16px;
  display       : flex;
  flex-direction: column;
  gap           : 12px;
}

.feed-panel {
  padding      : 12px;
  border       : 1px dashed var(--border);
  border-radius: 10px;
  background   : #ffffff;
}

.feed-panel-row {
  display      : flex;
  gap          : 10px;
  align-items  : center;
  margin-bottom: 10px;
}

.feed-panel-row:last-child {
  margin-bottom: 0;
}

.feed-radio {
  display    : inline-flex;
  gap        : 6px;
  align-items: center;
  font-size  : 13px;
  font-weight: 600;
  color      : var(--text-primary);
}

.feed-duration {
  margin-left: auto;
  display    : inline-flex;
  gap        : 6px;
  align-items: center;
}

.feed-duration-left {
  margin-left: 0;
}

.feed-label {
  font-size  : 12px;
  color      : var(--text-secondary);
  font-weight: 700;
}

#feedDurationInput {
  width        : 70px;
  height       : 32px;
  padding      : 6px 10px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  font-size    : 13px;
}

#feedTextInput {
  width        : 100%;
  min-height   : 64px;
  resize       : vertical;
  padding      : 10px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  font-size    : 13px;
}

#scanTextInput,
#groupScanUrlInput {
  width        : 100%;
  min-height   : 96px;
  resize       : vertical;
  padding      : 10px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  font-size    : 13px;
  line-height  : 1.35;
}

.feed-panel-actions {
  justify-content: flex-end;
}

.feed-panel-actions button {
  width    : auto;
  min-width: 90px;
  height   : 32px;
  padding  : 6px 12px;
  font-size: 13px;
}

.setting-card-header {
  display        : flex;
  justify-content: space-between;
  align-items    : center;
  gap            : 8px;
}

.setting-card h4 {
  margin   : 0;
  font-size: 16px;
}

.muted {
  color    : var(--text-secondary);
  font-size: 13px;
  margin   : 0;
}

.inline-field {
  display: flex;
  gap    : 10px;
}

.inline-field input {
  flex: 1;
}

/* Settings: lÃ m input + button tháº¥p láº¡i (chá»‰ trong tab Setting profile) */
#settingsView .inline-field input,
#settingsView .add-profile-form input {
  height       : 34px;
  padding      : 6px 10px;
  font-size    : 13px;
  border-width : 1px;
  border-radius: 10px;
}

#settingsView .profile-id-input {
  height       : 34px;
  padding      : 6px 10px;
  flex         : 1;
  /* Äƒn toÃ n bá»™ pháº§n cÃ²n láº¡i */
  min-width    : 0;
  font-size    : 13px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  background   : #ffffff;
}

#settingsView button {
  width        : auto;
  height       : 34px;
  padding      : 6px 12px;
  font-size    : 13px;
  border-radius: 10px;
}

#settingsView .inline-field button {
  flex     : 0 0 auto;
  min-width: 120px;
}

.setting-card-actions {
  display: flex;
  gap    : 8px;
}

/* Settings: disable state rÃµ rÃ ng khi chÆ°a tick profile */
#settingsView .setting-card-actions button:disabled,
#settingsView .feed-panel button:disabled {
  opacity   : 0.55;
  cursor    : not-allowed;
  box-shadow: none !important;
  filter    : saturate(0.75);
}

.profile-list {
  display       : flex;
  flex-direction: column;
  gap           : 10px;
}

/* Settings: danh sÃ¡ch profile cuá»™n ná»™i bá»™ (khÃ´ng kÃ©o dÃ i trang) */
#settingsView #profileList.profile-list {
  max-height         : min(55vh, 520px);
  overflow-y         : auto;
  padding-right      : 6px;
  /* chá»«a chá»— cho scrollbar */
  overscroll-behavior: contain;
  scrollbar-width    : thin;
  /* Firefox */
  scrollbar-color    : rgba(100, 116, 139, 0.55) transparent;
}

#settingsView #profileList.profile-list::-webkit-scrollbar {
  width: 10px;
}

#settingsView #profileList.profile-list::-webkit-scrollbar-track {
  background: transparent;
}

#settingsView #profileList.profile-list::-webkit-scrollbar-thumb {
  background-color: rgba(100, 116, 139, 0.55);
  border-radius   : 999px;
  border          : 3px solid transparent;
  background-clip : content-box;
}

.profile-row-wrap {
  display       : flex;
  flex-direction: column;
  gap           : 8px;
}

.profile-row {
  display      : flex;
  align-items  : center;
  gap          : 8px;
  padding      : 10px 12px;
  background   : #ffffff;
  border       : 1px solid var(--border);
  border-radius: 10px;
}

.profile-select {
  flex           : 0 0 auto;
  display        : flex;
  align-items    : center;
  justify-content: center;
}

.profile-select-cb {
  width : 16px;
  height: 16px;
  cursor: pointer;
}

.group-panel {
  padding      : 10px 12px;
  background   : #f9fafb;
  border       : 1px dashed var(--border);
  border-radius: 10px;
}

.group-panel-header {
  font-size    : 12px;
  font-weight  : 700;
  color        : var(--text-primary);
  margin-bottom: 8px;
}

.group-textarea {
  width        : 100%;
  min-height   : 120px;
  resize       : vertical;
  padding      : 10px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  font-size    : 12px;
  background   : #ffffff;
  color        : var(--text-primary);
  outline      : none;
}

.group-textarea:focus {
  border-color: var(--primary);
  box-shadow  : 0 0 0 4px rgba(99, 102, 241, 0.1);
}

.group-panel-actions {
  display        : flex;
  gap            : 8px;
  justify-content: flex-end;
  margin-top     : 8px;
}


.profile-row .profile-id {
  flex       : 1 1 40%;
  font-weight: 700;
  font-size  : 14px;
  word-break : break-all;
}

.profile-row .profile-actions {
  display        : flex;
  gap            : 8px;
  flex-wrap      : wrap;
  justify-content: flex-end;
}

.profile-state-badge {
  display        : inline-flex;
  align-items    : center;
  justify-content: center;
  padding        : 6px 10px;
  border-radius  : 10px;
  font-weight    : 800;
  font-size      : 12px;
  min-width      : 84px;
  white-space    : nowrap;
  color          : #fff;
  box-shadow     : 0 2px 6px rgba(0, 0, 0, 0.12);
}

.profile-state-badge.state-running { background: #10b981; } /* green */
.profile-state-badge.state-paused  { background: rgb(157, 168, 0); } /* yellow */
.profile-state-badge.state-ready   { background: #64748b; } /* slate */

.profile-row .profile-actions button {
  width    : auto;
  flex     : 0 0 auto;
  min-width: 70px;
  height   : 30px;
  padding  : 4px 10px;
  font-size: 12px;
}

.add-profile-row {
  margin-top: 8px;
}

.add-profile-row button {
  width: 100%;
}

.add-profile-form {
  background  : #f8fafc;
  border-style: dashed;
  gap         : 8px;
}

.add-profile-form input {
  flex         : 1 1 60%;
  padding      : 12px 14px;
  border       : 1px solid var(--border);
  border-radius: 8px;
}

.add-profile-form button {
  min-width: 80px;
  height   : 30px;
  padding  : 4px 10px;
  font-size: 12px;
}

.empty-state-box {
  border       : 1px dashed var(--border);
  border-radius: 10px;
  padding      : 12px;
  text-align   : center;
}

.hint {
  font-size: 12px;
  color    : var(--text-secondary);
}

/* Toast (thay cho alert Ä‘á»ƒ khÃ´ng nhÃ¡y UI) */
.toast-container {
  position      : fixed;
  top           : 14px;
  left          : 50%;
  transform     : translateX(-50%);
  display       : flex;
  flex-direction: column;
  gap           : 8px;
  z-index       : 2000;
  pointer-events: none;
}

.toast {
  pointer-events: none;
  min-width     : 260px;
  max-width     : min(520px, calc(100vw - 24px));
  background    : rgba(17, 24, 39, 0.92);
  color         : #fff;
  border-radius : 12px;
  padding       : 10px 12px;
  box-shadow    : 0 10px 30px rgba(0, 0, 0, 0.25);
  font-size     : 13px;
  line-height   : 1.35;
  opacity       : 0;
  transform     : translateY(-6px);
  transition    : opacity 180ms ease, transform 180ms ease;
}

.toast.show {
  opacity  : 1;
  transform: translateY(0);
}

.toast.success {
  background: rgba(16, 185, 129, 0.92);
}

.toast.error {
  background: rgba(239, 68, 68, 0.92);
}

#settingsPreview {
  width        : 100%;
  padding      : 12px;
  border       : 1px solid var(--border);
  border-radius: 10px;
  background   : #0b1021;
  color        : #e5e7eb;
  font-family  : "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
  font-size    : 13px;
  resize       : vertical;
}

table {
  width          : 100%;
  border-collapse: collapse;
  font-size      : 14px;
  background     : white;
}

/* Tá»‘i Æ°u báº£ng Quáº£n lÃ½ post Ä‘á»ƒ háº¡n cháº¿ scroll ngang */
#postTable {
  table-layout: fixed;
}

#postTable th:nth-child(1) {
  width: 22%;
}

#postTable th:nth-child(2) {
  width: 58%;
}

#postTable th:nth-child(3) {
  width: 20%;
}

#postTable td:nth-child(2) {
  white-space: normal;
  word-break : break-word;
}

/* RiÃªng pháº§n Quáº£n lÃ½ post: áº©n háº³n thanh scroll ngang cho gá»n */
#postView .table-container {
  overflow-x        : auto;
  scrollbar-width   : none;
  /* Firefox */
  -ms-overflow-style: none;
  /* IE/Edge cÅ© */
}

#postView .table-container::-webkit-scrollbar {
  display: none;
  /* Chrome/Safari */
}

thead {
  background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
}

th {
  padding       : 16px;
  text-align    : left;
  font-weight   : 700;
  color         : var(--text-primary);
  text-transform: uppercase;
  font-size     : 12px;
  letter-spacing: 0.5px;
  border-bottom : 2px solid var(--border);
}

td {
  padding      : 16px;
  border-bottom: 1px solid var(--border);
  color        : var(--text-primary);
}

/* Link cho ID (ID BÃ i Post, ID User) */
.id-link {
  color          : #2563eb;
  text-decoration: none;
  font-weight    : 500;
}

.id-link:hover {
  text-decoration: underline;
}

/* Type column colors */
td.type-cell {
  font-weight: 600;
  text-align : center;
}

td.type-cell.type-green {
  background: #49ee98;
  color     : #065f46;
}

td.type-cell.type-yellow {
  background: #e9d47d;
  color     : #92400e;
}

td.type-cell.type-red {
  background: #ed7b7b;
  color     : #991b1b;
}

tbody tr {
  transition: all 0.2s ease;
}

tbody tr:hover {
  background: #f9fafb;
  transform : scale(1.01);
}

tbody tr:last-child td {
  border-bottom: none;
}

/* Empty State */
.empty {
  text-align: center;
  padding   : 60px 20px;
  color     : var(--text-secondary);
  display   : none;
}

.empty.show {
  display: block;
}

.empty-icon {
  font-size    : 64px;
  margin-bottom: 16px;
  opacity      : 0.5;
}

.empty p {
  font-size    : 16px;
  font-weight  : 600;
  margin-bottom: 8px;
  color        : var(--text-primary);
}

.empty-hint {
  font-size  : 14px;
  color      : var(--text-secondary);
  font-weight: 400;
}

/* Animations */
@keyframes slideDown {
  from {
    opacity  : 0;
    transform: translateY(-20px);
  }

  to {
    opacity  : 1;
    transform: translateY(0);
  }
}

@keyframes fadeInUp {
  from {
    opacity  : 0;
    transform: translateY(20px);
  }

  to {
    opacity  : 1;
    transform: translateY(0);
  }
}

@keyframes pulse {

  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.5;
  }
}

/* Modal */
.modal {
  position       : fixed;
  top            : 0;
  left           : 0;
  right          : 0;
  bottom         : 0;
  background     : rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
  display        : flex;
  align-items    : center;
  justify-content: center;
  z-index        : 1000;
  opacity        : 0;
  transition     : opacity 0.3s ease;
  pointer-events : none;
}

.modal.show {
  opacity       : 1;
  pointer-events: all;
}

.modal-content {
  background    : var(--card-bg);
  border-radius : 16px;
  box-shadow    : var(--shadow-lg);
  width         : 90%;
  max-width     : 500px;
  max-height    : 90vh;
  overflow      : hidden;
  display       : flex;
  flex-direction: column;
  transform     : scale(0.9) translateY(20px);
  transition    : transform 0.3s ease;
}

.modal.show .modal-content {
  transform: scale(1) translateY(0);
}

.modal-header {
  background     : linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding        : 20px 24px;
  display        : flex;
  justify-content: space-between;
  align-items    : center;
}

.modal-header h3 {
  color      : white;
  font-size  : 18px;
  font-weight: 600;
  margin     : 0;
}

.modal-close {
  background     : rgba(255, 255, 255, 0.2);
  border         : none;
  color          : white;
  font-size      : 24px;
  width          : 32px;
  height         : 32px;
  border-radius  : 50%;
  cursor         : pointer;
  display        : flex;
  align-items    : center;
  justify-content: center;
  transition     : all 0.3s ease;
  padding        : 0;
  line-height    : 1;
}

.modal-close:hover {
  background: rgba(255, 255, 255, 0.3);
  transform : rotate(90deg);
}

.modal-body {
  padding   : 24px;
  overflow-y: auto;
  flex      : 1;
}

.modal-body textarea {
  width        : 100%;
  padding      : 12px 16px;
  border       : 2px solid var(--border);
  border-radius: 10px;
  font-size    : 15px;
  transition   : all 0.3s ease;
  background   : #f9fafb;
  color        : var(--text-primary);
  font-family  : inherit;
  resize       : vertical;
}

.modal-body textarea:focus {
  outline     : none;
  border-color: var(--primary);
  background  : white;
  box-shadow  : 0 0 0 4px rgba(99, 102, 241, 0.1);
}

.modal-footer {
  padding        : 20px 24px;
  border-top     : 1px solid var(--border);
  display        : flex;
  gap            : 12px;
  justify-content: flex-end;
}

.modal-footer button {
  width    : auto;
  min-width: 100px;
  padding  : 10px 20px;
}

.btn-secondary {
  background: rgb(255, 255, 255);
  color     : rgb(0, 0, 0);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.btn-nuoiacc {
  background: rgb(0, 192, 26);
  color     : rgb(255, 255, 255);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.btn-yellow {
  background: rgb(157, 168, 0);
  color     : rgb(255, 255, 255);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.btn-yellow:hover {
  background: #e5e7eb;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

/* Pause selected (khÃ¡c mÃ u Pause all) */
.btn-pause {
  background: rgb(14, 165, 164);
  color     : rgb(255, 255, 255);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.btn-pause:hover {
  background: #e5e7eb;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.btn-nuoiacc:hover {
  background: #e5e7eb;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.btn-secondary:hover {
  background: #e5e7eb;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.btn-secondary:disabled {
  background: #9ca3af;
  cursor    : not-allowed;
  box-shadow: none;
}

/* Help Button */
.help-button {
  position       : fixed;
  top            : 24px;
  right          : 36px;
  width          : 48px;
  height         : 48px;
  border-radius  : 50%;
  background     : linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  color          : white;
  border         : none;
  font-size      : 24px;
  font-weight    : 700;
  cursor         : pointer;
  box-shadow     : 0 4px 14px 0 rgba(99, 102, 241, 0.4);
  transition     : all 0.3s ease;
  z-index        : 999;
  display        : flex;
  align-items    : center;
  justify-content: center;
  line-height    : 1;
}

.help-button:hover {
  transform : scale(1.1);
  box-shadow: 0 6px 20px 0 rgba(99, 102, 241, 0.6);
}

.help-button:active {
  transform: scale(0.95);
}

/* Help Tooltip */
.help-tooltip {
  position      : fixed;
  top           : 90px;
  right         : 24px;
  width         : 320px;
  background    : var(--card-bg);
  border-radius : 12px;
  box-shadow    : var(--shadow-lg);
  z-index       : 1000;
  opacity       : 0;
  transform     : translateY(-10px);
  transition    : all 0.3s ease;
  pointer-events: none;
  border        : 1px solid var(--border);
}

.help-tooltip.show {
  opacity       : 1;
  transform     : translateY(0);
  pointer-events: all;
}

.tooltip-header {
  background     : linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding        : 16px 20px;
  border-radius  : 12px 12px 0 0;
  display        : flex;
  justify-content: space-between;
  align-items    : center;
}

.tooltip-header h4 {
  color      : white;
  font-size  : 16px;
  font-weight: 600;
  margin     : 0;
}

.tooltip-close {
  background     : rgba(255, 255, 255, 0.2);
  border         : none;
  color          : white;
  font-size      : 20px;
  width          : 28px;
  height         : 28px;
  border-radius  : 50%;
  cursor         : pointer;
  display        : flex;
  align-items    : center;
  justify-content: center;
  transition     : all 0.3s ease;
  padding        : 0;
  line-height    : 1;
}

.tooltip-close:hover {
  background: rgba(255, 255, 255, 0.3);
  transform : rotate(90deg);
}

.tooltip-body {
  padding: 20px;
}

.tooltip-item {
  display      : flex;
  align-items  : flex-start;
  gap          : 12px;
  margin-bottom: 16px;
}

.tooltip-item:last-child {
  margin-bottom: 0;
}

.tooltip-dot {
  width        : 16px;
  height       : 16px;
  border-radius: 50%;
  display      : inline-block;
  flex-shrink  : 0;
  margin-top   : 2px;
  box-shadow   : 0 2px 4px rgba(0, 0, 0, 0.2);
}

.tooltip-green {
  background: #10b981;
}

.tooltip-yellow {
  background: #f59e0b;
}

.tooltip-red {
  background: #ef4444;
}

.tooltip-item div {
  flex       : 1;
  font-size  : 14px;
  line-height: 1.5;
  color      : var(--text-primary);
}

.tooltip-item strong {
  color      : var(--text-primary);
  font-weight: 600;
}

/* NÃºt xem comment (icon con máº¯t) */
.comment-eye-btn {
  background   : transparent;
  border       : none;
  cursor       : pointer;
  font-size    : 20px;
  line-height  : 1;
  padding      : 6px 8px;
  border-radius: 6px;
  transition   : background 0.2s ease, transform 0.1s ease;
}

.comment-eye-btn:hover {
  background: rgba(148, 163, 184, 0.15);
  transform : scale(1.05);
}

/* Text comment cÃ³ thá»ƒ click Ä‘á»ƒ áº©n */
.comment-text {
  cursor       : pointer;
  color        : var(--text-primary);
  padding      : 4px 8px;
  border-radius: 6px;
  transition   : background 0.2s ease;
  display      : inline-block;
  word-break   : break-word;
  max-width    : 100%;
}

.comment-text:hover {
  background: rgba(148, 163, 184, 0.1);
}

td:nth-child(5) {
  text-align: center;
}

/* Floating chat buttons (Messenger & Zalo) */
.chat-floating {
  position      : fixed;
  right         : 24px;
  bottom        : 24px;
  display       : flex;
  flex-direction: column;
  gap           : 10px;
  z-index       : 900;
}

.chat-btn {
  width          : 68px;
  height         : 68px;
  border-radius  : 50%;
  display        : flex;
  align-items    : center;
  justify-content: center;
  color          : #ffffff;
  font-weight    : 700;
  font-size      : 18px;
  text-decoration: none;
  box-shadow     : 0 6px 18px rgba(15, 23, 42, 0.45);
  transition     : transform 0.2s ease, box-shadow 0.2s ease, opacity 0.2s ease;
  opacity        : 0.95;
}

.chat-btn:hover {
  transform : translateY(-2px) scale(1.03);
  box-shadow: 0 10px 25px rgba(15, 23, 42, 0.55);
  opacity   : 1;
}

.chat-mess {
  background: linear-gradient(135deg, #f8f8f8 0%, #ffffff 100%);
}

.chat-zalo {
  background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%);
}

.chat-icon {
  width  : 50px;
  height : 50px;
  display: block;
}

/* Icon Messenger: vÃ²ng trÃ²n gradient + tia sÃ©t */
.chat-icon-mess {
  position     : relative;
  border-radius: 50%;
  background   : radial-gradient(circle at 30% 0, #ffffff 0, #ffffff 8%, transparent 20%),
    radial-gradient(circle at 30% 0, #ff7cf8 0, #ff7cf8 25%, transparent 55%),
    radial-gradient(circle at 70% 100%, #00c6ff 0, #0078ff 40%, #4b00ff 90%);
}

.chat-icon-mess::before {
  content      : '';
  position     : absolute;
  left         : 9px;
  top          : 11px;
  width        : 14px;
  height       : 8px;
  border-radius: 999px;
  border       : 2px solid #ffffff;
  border-top   : none;
  transform    : rotate(10deg);
}

.chat-icon-mess::after {
  content      : '';
  position     : absolute;
  left         : 13px;
  top          : 11px;
  width        : 6px;
  height       : 8px;
  border-right : 2px solid #ffffff;
  border-bottom: 2px solid #ffffff;
  transform    : rotate(25deg);
}

/* Icon Zalo: chá»¯ Z trong khung bo trÃ²n */
.chat-icon-zalo {
  position       : relative;
  border-radius  : 12px;
  background     : white;
  font-weight    : 700;
  font-size      : 13px;
  color          : #0066ff;
  display        : flex;
  align-items    : center;
  justify-content: center;
  font-family    : system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

.chat-icon-zalo::before {
  content: 'Z';
}

/* áº¢nh Zalo tháº­t */
.chat-img {
  width        : 50px;
  height       : 50px;
  display      : block;
  border-radius: 12px;
  object-fit   : cover;
}

/* Responsive */
@media (max-width: 1024px) {
  .layout {
    grid-template-columns: 1fr;
  }

  .left-panel {
    order: 2;
  }

  .right-panel {
    order: 1;
  }
}

@media (max-width: 768px) {
  body {
    padding: 12px;
  }

  .header {
    padding: 20px;
  }

  .header-content h1 {
    font-size: 24px;
  }

  .panel-body {
    padding: 20px;
  }

  th,
  td {
    padding  : 12px;
    font-size: 13px;
  }

  .splash-title {
    font-size     : 32px;
    letter-spacing: 1px;
  }

  .splash-subtitle {
    font-size    : 16px;
    margin-bottom: 30px;
  }

  .splash-btn {
    padding  : 14px 36px;
    font-size: 16px;
  }
}


#scanRunMinutesInput {
  border-radius: 5px;
  border       : 1px solid var(--border);
  padding      : 4px;
}

#scanRestMinutesInput {
  border-radius: 5px;
  border       : 1px solid var(--border);
  padding      : 4px;
}

#feedRunMinutesInput {
  border-radius: 5px;
  border       : 1px solid var(--border);
  padding      : 4px;
}

#feedRestMinutesInput {
  border-radius: 5px;
  border       : 1px solid var(--border);
  padding      : 4px;
}

/* groupScanUrlInput Ä‘Ã£ dÃ¹ng chung style textarea á»Ÿ phÃ­a trÃªn */
--- END FILE: frontend\style.css ---

